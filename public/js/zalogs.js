/*! jQuery UI - v1.9.2 - 2012-11-23
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2012 jQuery Foundation and other contributors; Licensed MIT */
(function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return e.expr.filters.visible(t)&&!e(t).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),function(){var t=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=t.length?!0:!1,e.ui.ie6=parseFloat(t[1],10)===6}(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})})(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a=t.split(".")[0];t=t.split(".")[1],i=a+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[a]=e[a]||{},s=e[a][t],o=e[a][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=r,s=i.apply(this,arguments),this._super=t,this._superApply=n,s}}())}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix:t},r,{constructor:o,namespace:a,widgetName:t,widgetBaseClass:i,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(e.isPlainObject(a)?n[u]=e.isPlainObject(n[u])?e.widget.extend({},n[u],a):e.widget.extend({},a):n[u]=a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():e.data(this,s,new i(o,this))}),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetName,this),e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^(\w+)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.delegate(l,f,u):n.bind(f,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&(e.effects.effect[u]||e.uiBackCompat!==!1&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(e){n=!1}),e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return!e.ui.ie||document.documentMode>=9||!!t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);var r=this.element[0],i=!1;while(r&&(r=r.parentNode))r==document&&(i=!0);if(!i&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!n||this.options.revert=="valid"&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var s=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){s._trigger("stop",t)!==!1&&s._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo=="parent"?this.element[0].parentNode:n.appendTo),r[0]!=this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[t.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(t.containment=="document"?0:e(window).scrollLeft())+e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t.containment=="document"?0:e(window).scrollTop())+(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)&&t.containment.constructor!=Array){var n=e(t.containment),r=n[0];if(!r)return;var i=n.offset(),s=e(r).css("overflow")!="hidden";this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(s?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(s?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}else t.containment.constructor==Array&&(this.containment=t.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var u;if(this.containment){if(this.relative_container){var a=this.relative_container.offset();u=[this.containment[0]+a.left,this.containment[1]+a.top,this.containment[2]+a.left,this.containment[3]+a.top]}else u=this.containment;t.pageX-this.offset.click.left<u[0]&&(s=u[0]+this.offset.click.left),t.pageY-this.offset.click.top<u[1]&&(o=u[1]+this.offset.click.top),t.pageX-this.offset.click.left>u[2]&&(s=u[2]+this.offset.click.left),t.pageY-this.offset.click.top>u[3]&&(o=u[3]+this.offset.click.top)}if(n.grid){var f=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=u?f-this.offset.click.top<u[1]||f-this.offset.click.top>u[3]?f-this.offset.click.top<u[1]?f+n.grid[1]:f-n.grid[1]:f:f;var l=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;s=u?l-this.offset.click.left<u[0]||l-this.offset.click.left>u[2]?l-this.offset.click.left<u[0]?l+n.grid[0]:l-n.grid[0]:l:l}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("draggable"),i=this,s=function(t){var n=this.offset.click.top,r=this.offset.click.left,i=this.positionAbs.top,s=this.positionAbs.left,o=t.height,u=t.width,a=t.top,f=t.left;return e.ui.isOver(i+n,s+r,a,f,o,u)};e.each(r.sortables,function(s){var o=!1,u=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!=u&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(u.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n){var r=e("body"),i=e(this).data("draggable").options;r.css("cursor")&&(i._cursor=r.css("cursor")),r.css("cursor",i.cursor)},stop:function(t,n){var r=e(this).data("draggable").options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(t,n){var r=e(this).data("draggable");r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"&&(r.overflowOffset=r.scrollParent.offset())},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=!1;if(r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"){if(!i.axis||i.axis!="x")r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed);if(!i.axis||i.axis!="y")r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed)}else{if(!i.axis||i.axis!="x")t.pageY-e(document).scrollTop()<i.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed));if(!i.axis||i.axis!="y")t.pageX-e(document).scrollLeft()<i.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed))}s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n){var r=e(this).data("draggable"),i=r.options;r.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!=r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=i.snapTolerance,o=n.offset.left,u=o+r.helperProportions.width,a=n.offset.top,f=a+r.helperProportions.height;for(var l=r.snapElements.length-1;l>=0;l--){var c=r.snapElements[l].left,h=c+r.snapElements[l].width,p=r.snapElements[l].top,d=p+r.snapElements[l].height;if(!(c-s<o&&o<h+s&&p-s<a&&a<d+s||c-s<o&&o<h+s&&p-s<f&&f<d+s||c-s<u&&u<h+s&&p-s<a&&a<d+s||c-s<u&&u<h+s&&p-s<f&&f<d+s)){r.snapElements[l].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=!1;continue}if(i.snapMode!="inner"){var v=Math.abs(p-f)<=s,m=Math.abs(d-a)<=s,g=Math.abs(c-u)<=s,y=Math.abs(h-o)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p-r.helperProportions.height,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left-r.margins.left)}var b=v||m||g||y;if(i.snapMode!="outer"){var v=Math.abs(p-a)<=s,m=Math.abs(d-f)<=s,g=Math.abs(c-o)<=s,y=Math.abs(h-u)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left-r.margins.left)}!r.snapElements[l].snapping&&(v||m||g||y||b)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=v||m||g||y||b}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n){var r=e(this).data("draggable").options,i=e.makeArray(e(r.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!i.length)return;var s=parseInt(i[0].style.zIndex)||0;e(i).each(function(e){this.style.zIndex=s+e}),this[0].style.zIndex=s+i.length}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){e.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];for(var n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){t=="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current;if(!r||(r.currentItem||r.element)[0]==this.element[0])return!1;var i=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope==r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(t,n,r){if(!n.offset)return!1;var i=(t.positionAbs||t.position.absolute).left,s=i+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,u=o+t.helperProportions.height,a=n.offset.left,f=a+n.proportions.width,l=n.offset.top,c=l+n.proportions.height;switch(r){case"fit":return a<=i&&s<=f&&l<=o&&u<=c;case"intersect":return a<i+t.helperProportions.width/2&&s-t.helperProportions.width/2<f&&l<o+t.helperProportions.height/2&&u-t.helperProportions.height/2<c;case"pointer":var h=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,p=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,d=e.ui.isOver(p,h,l,a,n.proportions.height,n.proportions.width);return d;case"touch":return(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c)&&(i>=a&&i<=f||s>=a&&s<=f||i<a&&s>f);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r=e.ui.ddmanager.droppables[t.options.scope]||[],i=n?n.type:null,s=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var o=0;o<r.length;o++){if(r[o].options.disabled||t&&!r[o].accept.call(r[o].element[0],t.currentItem||t.element))continue;for(var u=0;u<s.length;u++)if(s[u]==r[o].element[0]){r[o].proportions.height=0;continue e}r[o].visible=r[o].element.css("display")!="none";if(!r[o].visible)continue;i=="mousedown"&&r[o]._activate.call(r[o],n),r[o].offset=r[o].element.offset(),r[o].proportions={width:r[o].element[0].offsetWidth,height:r[o].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r=e.ui.intersect(t,this,this.options.tolerance),i=!r&&this.isover==1?"isout":r&&this.isover==0?"isover":null;if(!i)return;var s;if(this.options.greedy){var o=this.options.scope,u=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===o});u.length&&(s=e.data(u[0],"droppable"),s.greedyChild=i=="isover"?1:0)}s&&i=="isover"&&(s.isover=0,s.isout=1,s._out.call(s,n)),this[i]=1,this[i=="isout"?"isover":"isout"]=0,this[i=="isover"?"_over":"_out"].call(this,n),s&&i=="isout"&&(s.isout=0,s.isover=1,s._over.call(s,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var r=this.handles.split(",");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o="ui-resizable-"+s,u=e('<div class="ui-resizable-handle '+o+'"></div>');u.css({zIndex:n.zIndex}),"se"==s&&u.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(u)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0;i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth();var s=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(s,i),this._proportionallyResize()}if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(n.disabled)return;e(this).removeClass("ui-resizable-autohide"),t._handles.show()}).mouseleave(function(){if(n.disabled)return;t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")}).insertAfter(n),n.remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(s.is(".ui-draggable")||/absolute/.test(s.css("position")))&&s.css({position:"absolute",top:i.top,left:i.left}),this._renderProxy();var o=n(this.helper.css("left")),u=n(this.helper.css("top"));r.containment&&(o+=e(r.containment).scrollLeft()||0,u+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:u},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:o,top:u},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof r.aspectRatio=="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;var a=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor",a=="auto"?this.axis+"-resize":a),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(e){var t=this.helper,n=this.options,r={},i=this,s=this.originalMousePosition,o=this.axis,u=e.pageX-s.left||0,a=e.pageY-s.top||0,f=this._change[o];if(!f)return!1;var l=f.apply(this,[e,u,a]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey)l=this._updateRatio(l,e);return l=this._respectSize(l,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,r=this;if(this._helper){var i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:r.sizeDiff.height,u=s?0:r.sizeDiff.width,a={width:r.helper.width()-u,height:r.helper.height()-o},f=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,l=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;n.animate||this.element.css(e.extend(a,{top:l,left:f})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t=this.options,n,i,s,o,u;u={minWidth:r(t.minWidth)?t.minWidth:0,maxWidth:r(t.maxWidth)?t.maxWidth:Infinity,minHeight:r(t.minHeight)?t.minHeight:0,maxHeight:r(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)n=u.minHeight*this.aspectRatio,s=u.minWidth/this.aspectRatio,i=u.maxHeight*this.aspectRatio,o=u.maxWidth/this.aspectRatio,n>u.minWidth&&(u.minWidth=n),s>u.minHeight&&(u.minHeight=s),i<u.maxWidth&&(u.maxWidth=i),o<u.maxHeight&&(u.maxHeight=o);this._vBoundaries=u},_updateCache:function(e){var t=this.options;this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e,t){var n=this.options,i=this.position,s=this.size,o=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),o=="sw"&&(e.left=i.left+(s.width-e.width),e.top=null),o=="nw"&&(e.top=i.top+(s.height-e.height),e.left=i.left+(s.width-e.width)),e},_respectSize:function(e,t){var n=this.helper,i=this._vBoundaries,s=this._aspectRatio||t.shiftKey,o=this.axis,u=r(e.width)&&i.maxWidth&&i.maxWidth<e.width,a=r(e.height)&&i.maxHeight&&i.maxHeight<e.height,f=r(e.width)&&i.minWidth&&i.minWidth>e.width,l=r(e.height)&&i.minHeight&&i.minHeight>e.height;f&&(e.width=i.minWidth),l&&(e.height=i.minHeight),u&&(e.width=i.maxWidth),a&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,p=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);f&&p&&(e.left=c-i.minWidth),u&&p&&(e.left=c-i.maxWidth),l&&d&&(e.top=h-i.minHeight),a&&d&&(e.top=h-i.maxHeight);var v=!e.width&&!e.height;return v&&!e.left&&e.top?e.top=null:v&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){var t=this.options;if(!this._proportionallyResizeElements.length)return;var n=this.helper||this.element;for(var r=0;r<this._proportionallyResizeElements.length;r++){var i=this._proportionallyResizeElements[r];if(!this.borderDif){var s=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],o=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(s,function(e,t){var n=parseInt(e,10)||0,r=parseInt(o[t],10)||0;return n+r})}i.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var r=e.ui.ie6?1:0,i=e.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+i,height:this.element.outerHeight()+i,position:"absolute",left:this.elementOffset.left-r+"px",top:this.elementOffset.top-r+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t,n){return{width:this.originalSize.width+t}},w:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{top:s.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","alsoResize",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof i.alsoResize=="object"&&!i.alsoResize.parentNode?i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(t,n){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),u=o&&e.ui.hasScroll(s[0],"left")?0:r.sizeDiff.height,a=o?0:r.sizeDiff.width,f={width:r.size.width-a,height:r.size.height-u},l=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,c=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),r._updateCache(n),r._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(t,r){var i=e(this).data("resizable"),s=i.options,o=i.element,u=s.containment,a=u instanceof e?u.get(0):/parent/.test(u)?o.parent().get(0):u;if(!a)return;i.containerElement=e(a);if(/document/.test(u)||u==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var f=e(a),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,t){l[e]=n(f.css("padding"+t))}),i.containerOffset=f.offset(),i.containerPosition=f.position(),i.containerSize={height:f.innerHeight()-l[3],width:f.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,p=i.containerSize.width,d=e.ui.hasScroll(a,"left")?a.scrollWidth:p,v=e.ui.hasScroll(a)?a.scrollHeight:h;i.parentData={element:a,left:c.left,top:c.top,width:d,height:v}}},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.containerSize,o=r.containerOffset,u=r.size,a=r.position,f=r._aspectRatio||t.shiftKey,l={top:0,left:0},c=r.containerElement;c[0]!=document&&/static/.test(c.css("position"))&&(l=o),a.left<(r._helper?o.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-o.left:r.position.left-l.left),f&&(r.size.height=r.size.width/r.aspectRatio),r.position.left=i.helper?o.left:0),a.top<(r._helper?o.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-o.top:r.position.top),f&&(r.size.width=r.size.height*r.aspectRatio),r.position.top=r._helper?o.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top;var h=Math.abs((r._helper?r.offset.left-l.left:r.offset.left-l.left)+r.sizeDiff.width),p=Math.abs((r._helper?r.offset.top-l.top:r.offset.top-o.top)+r.sizeDiff.height),d=r.containerElement.get(0)==r.element.parent().get(0),v=/relative|absolute/.test(r.containerElement.css("position"));d&&v&&(h-=r.parentData.left),h+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-h,f&&(r.size.height=r.size.width/r.aspectRatio)),p+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-p,f&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.position,o=r.containerOffset,u=r.containerPosition,a=r.containerElement,f=e(r.helper),l=f.offset(),c=f.outerWidth()-r.sizeDiff.width,h=f.outerHeight()-r.sizeDiff.height;r._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h}),r._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h})}}),e.ui.plugin.add("resizable","ghost",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size;r.ghost=r.originalElement.clone(),r.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:""),r.ghost.appendTo(r.helper)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.ghost.css({position:"relative",height:r.size.height,width:r.size.width})},stop:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.helper&&r.helper.get(0).removeChild(r.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size,o=r.originalSize,u=r.originalPosition,a=r.axis,f=i._aspectRatio||t.shiftKey;i.grid=typeof i.grid=="number"?[i.grid,i.grid]:i.grid;var l=Math.round((s.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((s.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c):/^(ne)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c):/^(sw)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.left=u.left-l):(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c,r.position.left=u.left-l)}});var n=function(e){return parseInt(e,10)||0},r=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable"),this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]),n.addClass("ui-selectee"),n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=n.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;var r=this.options;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().andSelf().each(function(){var r=e.data(this,"selectable-item");if(r){var i=!t.metaKey&&!t.ctrlKey||!r.$element.hasClass("ui-selected");return r.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element}),!1}})},_mouseDrag:function(t){var n=this;this.dragged=!0;if(this.options.disabled)return;var r=this.options,i=this.opos[0],s=this.opos[1],o=t.pageX,u=t.pageY;if(i>o){var a=o;o=i,i=a}if(s>u){var a=u;u=s,s=a}return this.helper.css({left:i,top:s,width:o-i,height:u-s}),this.selectees.each(function(){var a=e.data(this,"selectable-item");if(!a||a.element==n.element[0])return;var f=!1;r.tolerance=="touch"?f=!(a.left>o||a.right<i||a.top>u||a.bottom<s):r.tolerance=="fit"&&(f=a.left>i&&a.right<o&&a.top>s&&a.bottom<u),f?(a.selected&&(a.$element.removeClass("ui-selected"),a.selected=!1),a.unselecting&&(a.$element.removeClass("ui-unselecting"),a.unselecting=!1),a.selecting||(a.$element.addClass("ui-selecting"),a.selecting=!0,n._trigger("selecting",t,{selecting:a.element}))):(a.selecting&&((t.metaKey||t.ctrlKey)&&a.startselected?(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.$element.addClass("ui-selected"),a.selected=!0):(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.startselected&&(a.$element.addClass("ui-unselecting"),a.unselecting=!0),n._trigger("unselecting",t,{unselecting:a.element}))),a.selected&&!t.metaKey&&!t.ctrlKey&&!a.startselected&&(a.$element.removeClass("ui-selected"),a.selected=!1,a.$element.addClass("ui-unselecting"),a.unselecting=!0,n._trigger("unselecting",t,{unselecting:a.element})))}),!1},_mouseStop:function(t){var n=this;this.dragged=!1;var r=this.options;return e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e,t){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(t);var i=null,s=e(t.target).parents().each(function(){if(e.data(this,r.widgetName+"-item")==r)return i=e(this),!1});e.data(t.target,r.widgetName+"-item")==r&&(i=e(t.target));if(!i)return!1;if(this.options.handle&&!n){var o=!1;e(this.options.handle,i).find("*").andSelf().each(function(){this==t.target&&(o=!0)});if(!o)return!1}return this.currentItem=i,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),i.containment&&this._setContainment(),i.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",i.cursor)),i.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",i.opacity)),i.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",i.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(var s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var n=this.options,r=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var i=this.items.length-1;i>=0;i--){var s=this.items[i],o=s.item[0],u=this._intersectsWithPointer(s);if(!u)continue;if(s.instance!==this.currentContainer)continue;if(o!=this.currentItem[0]&&this.placeholder[u==1?"next":"prev"]()[0]!=o&&!e.contains(this.placeholder[0],o)&&(this.options.type=="semi-dynamic"?!e.contains(this.element[0],o):!0)){this.direction=u==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&r+f<a&&t+l>s&&t+l<o;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(t){var n=this.options.axis==="x"||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r=this.options.axis==="y"||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=n&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o=="right"||s=="down"?2:1:s&&(s=="down"?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),r=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s=="right"&&r||s=="left"&&!r:i&&(i=="down"&&n||i=="up"&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],r=[],i=this._connectWith();if(i&&t)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&r.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}}r.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var s=r.length-1;s>=0;s--)r[s][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]==e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,r=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],i=this._connectWith();if(i&&this.ready)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&(r.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a))}}for(var s=r.length-1;s>=0;s--){var f=r[s][1],l=r[s][0];for(var u=0,c=l.length;u<c;u++){var h=e(l[u]);h.data(this.widgetName+"-item",f),n.push({item:h,instance:f,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var r=this.items[n];if(r.instance!=this.currentContainer&&this.currentContainer&&r.item[0]!=this.currentItem[0])continue;var i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;t||(r.width=i.outerWidth(),r.height=i.outerHeight());var s=i.offset();r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var s=this.containers[n].element.offset();this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var n=t.options;if(!n.placeholder||n.placeholder.constructor==String){var r=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(r||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return r||(n.style.visibility="hidden"),n},update:function(e,i){if(r&&!n.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n=null,r=null;for(var i=this.containers.length-1;i>=0;i--){if(e.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(n&&e.contains(this.containers[i].element[0],n.element[0]))continue;n=this.containers[i],r=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!n)return;if(this.containers.length===1)this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1;else{var s=1e4,o=null,u=this.containers[r].floating?"left":"top",a=this.containers[r].floating?"width":"height",f=this.positionAbs[u]+this.offset.click[u];for(var l=this.items.length-1;l>=0;l--){if(!e.contains(this.containers[r].element[0],this.items[l].item[0]))continue;if(this.items[l].item[0]==this.currentItem[0])continue;var c=this.items[l].item.offset()[u],h=!1;Math.abs(c-f)>Math.abs(c+this.items[l][a]-f)&&(h=!0,c+=this.items[l][a]),Math.abs(c-f)<s&&(s=Math.abs(c-f),o=this.items[l],this.direction=h?"up":"down")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[r],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[r].element,!0),this._trigger("change",t,this._uiHash()),this.containers[r]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper=="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(r[0].style.width==""||n.forceHelperSize)&&r.width(this.currentItem.width()),(r[0].style.height==""||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],r=e(t.containment).offset(),i=e(n).css("overflow")!="hidden";this.containment=[r.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,r.left+(i?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(i?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;if(this.originalPosition){this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top));if(n.grid){var u=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?u-this.offset.click.top<this.containment[1]||u-this.offset.click.top>this.containment[3]?u-this.offset.click.top<this.containment[1]?u+n.grid[1]:u-n.grid[1]:u:u;var a=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0];s=this.containment?a-this.offset.click.left<this.containment[0]||a-this.offset.click.left>this.containment[2]?a-this.offset.click.left<this.containment[0]?a+n.grid[0]:a-n.grid[0]:a:a}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i==this.counter&&this.refreshPositions(!r)})},_clear:function(t,n){this.reverting=!1;var r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS)if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static")this._storedCSS[i]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(var i=this.containers.length-1;i>=0;i--)n||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!n){for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),jQuery.effects||function(e,t){var n=e.uiBackCompat!==!1,r="ui-effects-";e.effects={effect:{}},function(t,n){function p(e,t,n){var r=a[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function d(e){var n=o(),r=n._rgba=[];return e=e.toLowerCase(),h(s,function(t,i){var s,o=i.re.exec(e),a=o&&i.parse(o),f=i.space||"rgba";if(a)return s=n[f](a),n[u[f].cache]=s[u[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&t.extend(r,c.transparent),n):c[e]}function v(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),i=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],o=t.Color=function(e,n,r,i){return new t.Color.fn.parse(e,n,r,i)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=o.support={},l=t("<p>")[0],c,h=t.each;l.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=l.style.backgroundColor.indexOf("rgba")>-1,h(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),o.fn=t.extend(o.prototype,{parse:function(r,i,s,a){if(r===n)return this._rgba=[null,null,null,null],this;if(r.jquery||r.nodeType)r=t(r).css(i),i=n;var f=this,l=t.type(r),v=this._rgba=[];i!==n&&(r=[r,i,s,a],l="array");if(l==="string")return this.parse(d(r)||c._default);if(l==="array")return h(u.rgba.props,function(e,t){v[t.idx]=p(r[t.idx],t)}),this;if(l==="object")return r instanceof o?h(u,function(e,t){r[t.cache]&&(f[t.cache]=r[t.cache].slice())}):h(u,function(t,n){var i=n.cache;h(n.props,function(e,t){if(!f[i]&&n.to){if(e==="alpha"||r[e]==null)return;f[i]=n.to(f._rgba)}f[i][t.idx]=p(r[e],t,!0)}),f[i]&&e.inArray(null,f[i].slice(0,3))<0&&(f[i][3]=1,n.from&&(f._rgba=n.from(f[i])))}),this},is:function(e){var t=o(e),n=!0,r=this;return h(u,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],h(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return h(u,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=o(e),r=n._space(),i=u[r],s=this.alpha()===0?o("transparent"):this,f=s[i.cache]||i.to(s._rgba),l=f.slice();return n=n[i.cache],h(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],u=a[r.type]||{};if(o===null)return;s===null?l[i]=o:(u.mod&&(o-s>u.mod/2?s+=u.mod:s-o>u.mod/2&&(s-=u.mod)),l[i]=p((o-s)*t+s,r))}),this[r](l)},blend:function(e){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=o(e)._rgba;return o(t.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),r=n.pop();return e&&n.push(~~(r*255)),"#"+t.map(n,function(e){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,u.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,f===0||f===1?c=f:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},u.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s;return[Math.round(v(o,s,t+1/3)*255),Math.round(v(o,s,t)*255),Math.round(v(o,s,t-1/3)*255),i]},h(u,function(e,r){var s=r.props,u=r.cache,a=r.to,f=r.from;o.fn[e]=function(e){a&&!this[u]&&(this[u]=a(this._rgba));if(e===n)return this[u].slice();var r,i=t.type(e),l=i==="array"||i==="object"?e:arguments,c=this[u].slice();return h(s,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=c[t.idx]),c[t.idx]=p(n,t)}),f?(r=o(f(c)),r[u]=c,r):o(c)},h(s,function(n,r){if(o.fn[n])return;o.fn[n]=function(s){var o=t.type(s),u=n==="alpha"?this._hsla?"hsla":"rgba":e,a=this[u](),f=a[r.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=t.type(s)),s==null&&r.empty?this:(o==="string"&&(l=i.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[r.idx]=s,this[u](a)))}})}),h(r,function(e,n){t.cssHooks[n]={set:function(e,r){var i,s,u="";if(t.type(r)!=="string"||(i=d(r))){r=o(i||r);if(!f.rgba&&r._rgba[3]!==1){s=n==="backgroundColor"?e.parentNode:e;while((u===""||u==="transparent")&&s&&s.style)try{u=t.css(s,"backgroundColor"),s=s.parentNode}catch(a){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{e.style[n]=r}catch(l){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=o(e.elem,n),e.end=o(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return h(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},c=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(){var t=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,n={},r,i;if(t&&t.length&&t[0]&&t[t[0]]){i=t.length;while(i--)r=t[i],typeof t[r]=="string"&&(n[e.camelCase(r)]=t[r])}else for(r in t)typeof t[r]=="string"&&(n[r]=t[r]);return n}function s(t,n){var i={},s,o;for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var r=e(this),o=r.attr("class")||"",u,f=a.children?r.find("*").andSelf():r;f=f.map(function(){var t=e(this);return{el:t,start:i.call(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i.call(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=jQuery.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function i(t,n,r,i){e.isPlainObject(t)&&(n=t,t=t.effect),t={effect:t},n==null&&(n={}),e.isFunction(n)&&(i=n,r=null,n={});if(typeof n=="number"||e.fx.speeds[n])i=r,r=n,n={};return e.isFunction(r)&&(i=r,r=null),n&&e.extend(t,n),r=r||n.duration,t.duration=e.fx.off?0:typeof r=="number"?r:r in e.fx.speeds?e.fx.speeds[r]:e.fx.speeds._default,t.complete=i||n.complete,t}function s(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]?n&&e.effects[t]?!1:!0:!1}e.extend(e.effects,{version:"1.9.2",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data(r+t[n],e[0].style[t[n]])},restore:function(e,n){var i,s;for(s=0;s<n.length;s++)n[s]!==null&&(i=e.data(r+n[s]),i===t&&(i=""),e.css(n[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(){function a(n){function u(){e.isFunction(i)&&i.call(r[0]),e.isFunction(n)&&n()}var r=e(this),i=t.complete,s=t.mode;(r.is(":hidden")?s==="hide":s==="show")?u():o.call(r[0],t,u)}var t=i.apply(this,arguments),r=t.mode,s=t.queue,o=e.effects.effect[t.effect],u=!o&&n&&e.effects[t.effect];return e.fx.off||!o&&!u?r?this[r](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):o?s===!1?this.each(a):this.queue(s||"fx",a):u.call(this,{options:t,duration:t.duration,callback:t.complete,mode:t.mode})},_show:e.fn.show,show:function(e){if(s(e))return this._show.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(s(e))return this._hide.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(s(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery),function(e,t){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n),r=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(r.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),!r.collapsible&&(r.active===!1||r.active==null)&&(r.active=0),r.active<0&&(r.active+=this.headers.length),this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(n){var r=e(this),i=r.attr("id"),s=r.next(),o=s.attr("id");i||(i=t+"-header-"+n,r.attr("id",i)),o||(o=t+"-panel-"+n,s.attr("id",o)),r.attr("aria-controls",o),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(r.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&e.css("height","")},_setOption:function(e,t){if(e==="active"){this._activate(t);return}e==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),e==="collapsible"&&!t&&this.options.active===!1&&this._activate(0),e==="icons"&&(this._destroyIcons(),t&&this._createIcons()),e==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t,n,r=this.options.heightStyle,i=this.element.parent();r==="fill"?(e.support.minHeight||(n=i.css("overflow"),i.css("overflow","hidden")),t=i.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");if(r==="absolute"||r==="fixed")return;t-=n.outerHeight(!0)}),n&&i.css("overflow",n),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):r==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];if(n===this.active[0])return;n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):e()},_setupEvents:function(t){var n={};if(!t)return;e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._on(this.headers,n)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1)return;n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active"))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};typeof h=="number"&&(u=h),typeof h=="string"&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration;if(!t.length)return e.animate(i,u,o,p);if(!e.length)return t.animate(r,u,o,p);s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round(e),n.prop!=="height"?f+=n.now:a.options.heightStyle!=="content"&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.uiBackCompat!==!1&&(function(e,t){e.extend(t.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var n=t._create;t._create=function(){if(this.options.navigation){var t=this,r=this.element.find(this.options.header),i=r.next(),s=r.add(i).find("a").filter(this.options.navigationFilter)[0];s&&r.add(i).each(function(n){if(e.contains(this,s))return t.options.active=Math.floor(n/2),!1})}n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var n=t._create,r=t._setOption;e.extend(t,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),n.call(this)},_setOption:function(e){if(e==="autoHeight"||e==="clearStyle"||e==="fillSpace")this.options.heightStyle=this._mergeHeightStyle();r.apply(this,arguments)},_mergeHeightStyle:function(){var e=this.options;if(e.fillSpace)return"fill";if(e.clearStyle)return"content";if(e.autoHeight)return"auto"}})}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var n=t._createIcons;t._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){t.activate=t._activate;var n=t._findActive;t._findActive=function(e){return e===-1&&(e=!1),e&&typeof e!="number"&&(e=this.headers.index(this.headers.filter(e)),e===-1&&(e=!1)),n.call(this,e)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(e,t){e.extend(t.options,{change:null,changestart:null});var n=t._trigger;t._trigger=function(e,t,r){var i=n.apply(this,arguments);return i?(e==="beforeActivate"?i=n.call(this,"changestart",t,{oldHeader:r.oldHeader,oldContent:r.oldPanel,newHeader:r.newHeader,newContent:r.newPanel}):e==="activate"&&(i=n.call(this,"change",t,{oldHeader:r.oldHeader,oldContent:r.oldPanel,newHeader:r.newHeader,newContent:r.newPanel})),i):!1}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{animate:null,animated:"slide"});var n=t._create;t._create=function(){var e=this.options;e.animate===null&&(e.animated?e.animated==="slide"?e.animate=300:e.animated==="bounceslide"?e.animate={duration:200,down:{easing:"easeOutBounce",duration:1e3}}:e.animate=e.animated:e.animate=!1),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype))}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(i){if(this.element.prop("readOnly")){t=!0,r=!0,n=!0;return}t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t){t=!1,r.preventDefault();return}if(n)return;var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}},input:function(e){if(r){r=!1,e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target!==t.element[0]&&r.target!==n&&!e.contains(n,r.target)&&t.close()})})},menufocus:function(t,n){if(this.isNewMenu){this.isNewMenu=!1;if(t.originalEvent&&/^mouse/.test(t.originalEvent.type)){this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});return}}var r=n.item.data("ui-autocomplete-item")||n.item.data("item.autocomplete");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item")||t.item.data("item.autocomplete"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),e==="source"&&this._initSource(),e==="appendTo"&&this.menu.element.appendTo(this.document.find(t||"body")[0]),e==="disabled"&&t&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):typeof this.options.source=="string"?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){e=e!=null?e:this._value(),this.term=this._value();if(e.length<this.options.minLength)return this.close(t);if(this._trigger("search",t)===!1)return;return this._search(e)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){t===n&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return typeof t=="string"?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){this._value(this.term),this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(e,t),t.preventDefault()}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch)return;e&&e.length?t=this.options.messages.results(e.length):t=this.options.messages.noResults,this.liveRegion.text(t)}})}(jQuery),function(e,t){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a=this.type==="checkbox"||this.type==="radio",c=a?"":"ui-state-active",h="ui-state-focus";u.label===null&&(u.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(u.disabled)return;this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(u.disabled)return;e(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change"+this.eventNamespace,function(){if(s)return;t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){if(u.disabled)return;s=!1,r=e.pageX,i=e.pageY}).bind("mouseup"+this.eventNamespace,function(e){if(u.disabled)return;if(r!==e.pageX||i!==e.pageY)s=!0})),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).toggleClass("ui-state-active"),t.buttonElement.attr("aria-pressed",t.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null})}).bind("mouseup"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(u.disabled)return!1;(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if(e==="disabled"){t?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){e==="disabled"&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(e,t){$.extend(e,t);for(var n in t)if(t[n]==null||t[n]==undefined)e[n]=t[n];return e}$.extend($.ui,{datepicker:{version:"1.9.2"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]);if(n.hasClass(this.markerClassName))return;this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t),t.settings.disabled&&this._disableDatepicker(e)},_attachments:function(e,t){var n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[r?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var i=this._get(t,"showOn");(i=="focus"||i=="both")&&e.focus(this._showDatepicker);if(i=="button"||i=="both"){var s=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:s,title:s}):$('<button type="button"></button>').addClass(this._triggerClass).html(o==""?s:$("<img/>").attr({src:o,alt:s,title:s}))),e[r?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var r=function(e){var t=0,n=0;for(var r=0;r<e.length;r++)e[r].length>t&&(t=e[r].length,n=r);return n};t.setMonth(r(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(r(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);if(n.hasClass(this.markerClassName))return;n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,n,r,i){var s=this._dialogInst;if(!s){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),s=this._dialogInst=this._newInst(this._dialogInput,!1),s.settings={},$.data(this._dialogInput[0],PROP_NAME,s)}extendRemove(s.settings,r||{}),t=t&&t.constructor==Date?this._formatDate(s,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null;if(!this._pos){var u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[u/2-100+f,a/2-150+l]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,s),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),r=="input"?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r=="div"||r=="span")&&t.removeClass(this.markerClassName).empty()},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var r=this._getInst(e);if(arguments.length==2&&typeof t=="string")return t=="defaults"?$.extend({},$.datepicker._defaults):r?t=="all"?$.extend({},r.settings):this._get(r,t):null;var i=t||{};typeof t=="string"&&(i={},i[t]=n);if(r){this._curInst==r&&this._hideDatepicker();var s=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(r,"min"),u=this._getMinMaxDate(r,"max");extendRemove(r.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(r.settings.minDate=this._formatDate(r,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(r.settings.maxDate=this._formatDate(r,u)),this._attachments($(e),r),this._autoSize(r),this._setDate(r,s),this._updateAlternate(r),this._updateDatepicker(r)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,r=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=!0;if($.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var i=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);i[0]&&$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,i[0]);var s=$.datepicker._get(t,"onSelect");if(s){var o=$.datepicker._formatDate(t);s.apply(t.input?t.input[0]:null,[o,t])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else e.keyCode==36&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||r<" "||!n||n.indexOf(r)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal)try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(r){$.datepicker.log(r)}return!0},_showDatepicker:function(e){e=e.target||e,e.nodeName.toLowerCase()!="input"&&(e=$("input",e.parentNode)[0]);if($.datepicker._isDisabledDatepicker(e)||$.datepicker._lastInput==e)return;var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var n=$.datepicker._get(t,"beforeShow"),r=n?n.apply(e,[e,t]):{};if(r===!1)return;extendRemove(t.settings,r),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var i=!1;$(e).parents().each(function(){return i|=$(this).css("position")=="fixed",!i});var s={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),s=$.datepicker._checkOffset(t,s,i),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":i?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"});if(!t.inline){var o=$.datepicker._get(t,"showAnim"),u=$.datepicker._get(t,"duration"),a=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(!!e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[o]||$.effects[o])?t.dpDiv.show(o,$.datepicker._get(t,"showOptions"),u,a):t.dpDiv[o||"show"](o?u:null,a),(!o||!u)&&a(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}},_updateDatepicker:function(e){this.maxRows=4;var t=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n=e.dpDiv.find("iframe.ui-datepicker-cover");!n.length||n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var r=this._getNumberOfMonths(e),i=r[1],s=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&e.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),e.dpDiv[(r[0]!=1||r[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus();if(e.yearshtml){var o=e.yearshtml;setTimeout(function(){o===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var r=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,u=document.documentElement.clientWidth+(n?0:$(document).scrollLeft()),a=document.documentElement.clientHeight+(n?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?r-s:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+o?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+r>u&&u>r?Math.abs(t.left+r-u):0),t.top-=Math.min(t.top,t.top+i>a&&a>i?Math.abs(i+o):0),t},_findPos:function(e){var t=this._getInst(e),n=this._get(t,"isRTL");while(e&&(e.type=="hidden"||e.nodeType!=1||$.expr.filters.hidden(e)))e=e[n?"previousSibling":"nextSibling"];var r=$(e).offset();return[r.left,r.top]},_hideDatepicker:function(e){var t=this._curInst;if(!t||e&&t!=$.data(e,PROP_NAME))return;if(this._datepickerShowing){var n=this._get(t,"showAnim"),r=this._get(t,"duration"),i=function(){$.datepicker._tidyDialog(t)};$.effects&&($.effects.effect[n]||$.effects[n])?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),r,i):t.dpDiv[n=="slideDown"?"slideUp":n=="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1;var s=this._get(t,"onClose");s&&s.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!$.datepicker._curInst)return;var t=$(e.target),n=$.datepicker._getInst(t[0]);(t[0].id!=$.datepicker._mainDivId&&t.parents("#"+$.datepicker._mainDivId).length==0&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=n)&&$.datepicker._hideDatepicker()},_adjustDate:function(e,t,n){var r=$(e),i=this._getInst(r[0]);if(this._isDisabledDatepicker(r[0]))return;this._adjustInstDate(i,t+(n=="M"?this._get(i,"showCurrentAtPos"):0),n),this._updateDatepicker(i)},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var r=new Date;n.selectedDay=r.getDate(),n.drawMonth=n.selectedMonth=r.getMonth(),n.drawYear=n.selectedYear=r.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var r=$(e),i=this._getInst(r[0]);i["selected"+(n=="M"?"Month":"Year")]=i["draw"+(n=="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(r)},_selectDay:function(e,t,n,r){var i=$(e);if($(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0]))return;var s=this._getInst(i[0]);s.selectedDay=s.currentDay=$("a",r).html(),s.selectedMonth=s.currentMonth=t,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(e){var t=$(e),n=this._getInst(t[0]);this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r),r.input&&r.input.val(t),this._updateAlternate(r);var i=this._get(r,"onSelect");i?i.apply(r.input?r.input[0]:null,[t,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],typeof r.input[0]!="object"&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),i=this.formatDate(n,r,this._getFormatConfig(e));$(t).each(function(){$(this).val(i)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(e,t,n){if(e==null||t==null)throw"Invalid arguments";t=typeof t=="object"?t.toString():t+"";if(t=="")return null;var r=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;r=typeof r!="string"?r:(new Date).getFullYear()%100+parseInt(r,10);var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=-1,f=-1,l=-1,c=-1,h=!1,p=function(t){var n=y+1<e.length&&e.charAt(y+1)==t;return n&&y++,n},d=function(e){var n=p(e),r=e=="@"?14:e=="!"?20:e=="y"&&n?4:e=="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=t.substring(g).match(i);if(!s)throw"Missing number at position "+g;return g+=s[0].length,parseInt(s[0],10)},v=function(e,n,r){var i=$.map(p(e)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),s=-1;$.each(i,function(e,n){var r=n[1];if(t.substr(g,r.length).toLowerCase()==r.toLowerCase())return s=n[0],g+=r.length,!1});if(s!=-1)return s+1;throw"Unknown name at position "+g},m=function(){if(t.charAt(g)!=e.charAt(y))throw"Unexpected literal at position "+g;g++},g=0;for(var y=0;y<e.length;y++)if(h)e.charAt(y)=="'"&&!p("'")?h=!1:m();else switch(e.charAt(y)){case"d":l=d("d");break;case"D":v("D",i,s);break;case"o":c=d("o");break;case"m":f=d("m");break;case"M":f=v("M",o,u);break;case"y":a=d("y");break;case"@":var b=new Date(d("@"));a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"!":var b=new Date((d("!")-this._ticksTo1970)/1e4);a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}if(g<t.length){var w=t.substr(g);if(!/^\s+/.test(w))throw"Extra/unparsed characters found in date: "+w}a==-1?a=(new Date).getFullYear():a<100&&(a+=(new Date).getFullYear()-(new Date).getFullYear()%100+(a<=r?0:-100));if(c>-1){f=1,l=c;do{var E=this._getDaysInMonth(a,f-1);if(l<=E)break;f++,l-=E}while(!0)}var b=this._daylightSavingAdjust(new Date(a,f-1,l));if(b.getFullYear()!=a||b.getMonth()+1!=f||b.getDate()!=l)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,i=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,u=function(t){var n=h+1<e.length&&e.charAt(h+1)==t;return n&&h++,n},a=function(e,t,n){var r=""+t;if(u(e))while(r.length<n)r="0"+r;return r},f=function(e,t,n,r){return u(e)?r[t]:n[t]},l="",c=!1;if(t)for(var h=0;h<e.length;h++)if(c)e.charAt(h)=="'"&&!u("'")?c=!1:l+=e.charAt(h);else switch(e.charAt(h)){case"d":l+=a("d",t.getDate(),2);break;case"D":l+=f("D",t.getDay(),r,i);break;case"o":l+=a("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":l+=a("m",t.getMonth()+1,2);break;case"M":l+=f("M",t.getMonth(),s,o);break;case"y":l+=u("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":l+=t.getTime();break;case"!":l+=t.getTime()*1e4+this._ticksTo1970;break;case"'":u("'")?l+="'":c=!0;break;default:l+=e.charAt(h)}return l},_possibleChars:function(e){var t="",n=!1,r=function(t){var n=i+1<e.length&&e.charAt(i+1)==t;return n&&i++,n};for(var i=0;i<e.length;i++)if(n)e.charAt(i)=="'"&&!r("'")?n=!1:t+=e.charAt(i);else switch(e.charAt(i)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":r("'")?t+="'":n=!0;break;default:t+=e.charAt(i)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()==e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i,s;i=s=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{i=this.parseDate(n,r,o)||s}catch(u){this.log(u),r=t?"":r}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=r?i.getDate():0,e.currentMonth=r?i.getMonth():0,e.currentYear=r?i.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var r=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},i=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}var r=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,i=r.getFullYear(),s=r.getMonth(),o=r.getDate(),u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=u.exec(t);while(a){switch(a[2]||"d"){case"d":case"D":o+=parseInt(a[1],10);break;case"w":case"W":o+=parseInt(a[1],10)*7;break;case"m":case"M":s+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s));break;case"y":case"Y":i+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s))}a=u.exec(t)}return new Date(i,s,o)},s=t==null||t===""?n:typeof t=="string"?i(t):typeof t=="number"?isNaN(t)?n:r(t):new Date(t.getTime());return s=s&&s.toString()=="Invalid Date"?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()==""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,-t,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,+t,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),r=this._get(e,"showButtonPanel"),i=this._get(e,"hideIfNoPrevNext"),s=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),u=this._get(e,"showCurrentAtPos"),a=this._get(e,"stepMonths"),f=o[0]!=1||o[1]!=1,l=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),c=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),p=e.drawMonth-u,d=e.drawYear;p<0&&(p+=12,d--);if(h){var v=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-o[0]*o[1]+1,h.getDate()));v=c&&v<c?c:v;while(this._daylightSavingAdjust(new Date(d,p,1))>v)p--,p<0&&(p=11,d--)}e.drawMonth=p,e.drawYear=d;var m=this._get(e,"prevText");m=s?this.formatDate(m,this._daylightSavingAdjust(new Date(d,p-a,1)),this._getFormatConfig(e)):m;var g=this._canAdjustMonth(e,-1,d,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":i?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",y=this._get(e,"nextText");y=s?this.formatDate(y,this._daylightSavingAdjust(new Date(d,p+a,1)),this._getFormatConfig(e)):y;var b=this._canAdjustMonth(e,1,d,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>":i?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>",w=this._get(e,"currentText"),E=this._get(e,"gotoCurrent")&&e.currentDay?l:t;w=s?this.formatDate(w,E,this._getFormatConfig(e)):w;var S=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",x=r?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?S:"")+(this._isInRange(e,E)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+w+"</button>":"")+(n?"":S)+"</div>":"",T=parseInt(this._get(e,"firstDay"),10);T=isNaN(T)?0:T;var N=this._get(e,"showWeek"),C=this._get(e,"dayNames"),k=this._get(e,"dayNamesShort"),L=this._get(e,"dayNamesMin"),A=this._get(e,"monthNames"),O=this._get(e,"monthNamesShort"),M=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),D=this._get(e,"selectOtherMonths"),P=this._get(e,"calculateWeek")||this.iso8601Week,H=this._getDefaultDate(e),B="";for(var j=0;j<o[0];j++){var F="";this.maxRows=4;for(var I=0;I<o[1];I++){var q=this._daylightSavingAdjust(new Date(d,p,e.selectedDay)),R=" ui-corner-all",U="";if(f){U+='<div class="ui-datepicker-group';if(o[1]>1)switch(I){case 0:U+=" ui-datepicker-group-first",R=" ui-corner-"+(n?"right":"left");break;case o[1]-1:U+=" ui-datepicker-group-last",R=" ui-corner-"+(n?"left":"right");break;default:U+=" ui-datepicker-group-middle",R=""}U+='">'}U+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&j==0?n?b:g:"")+(/all|right/.test(R)&&j==0?n?g:b:"")+this._generateMonthYearHeader(e,p,d,c,h,j>0||I>0,A,O)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var z=N?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"";for(var W=0;W<7;W++){var X=(W+T)%7;z+="<th"+((W+T+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+C[X]+'">'+L[X]+"</span></th>"}U+=z+"</tr></thead><tbody>";var V=this._getDaysInMonth(d,p);d==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,V));var J=(this._getFirstDayOfMonth(d,p)-T+7)%7,K=Math.ceil((J+V)/7),Q=f?this.maxRows>K?this.maxRows:K:K;this.maxRows=Q;var G=this._daylightSavingAdjust(new Date(d,p,1-J));for(var Y=0;Y<Q;Y++){U+="<tr>";var Z=N?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(G)+"</td>":"";for(var W=0;W<7;W++){var et=M?M.apply(e.input?e.input[0]:null,[G]):[!0,""],tt=G.getMonth()!=p,nt=tt&&!D||!et[0]||c&&G<c||h&&G>h;Z+='<td class="'+((W+T+6)%7>=5?" ui-datepicker-week-end":"")+(tt?" ui-datepicker-other-month":"")+(G.getTime()==q.getTime()&&p==e.selectedMonth&&e._keyEvent||H.getTime()==G.getTime()&&H.getTime()==q.getTime()?" "+this._dayOverClass:"")+(nt?" "+this._unselectableClass+" ui-state-disabled":"")+(tt&&!_?"":" "+et[1]+(G.getTime()==l.getTime()?" "+this._currentClass:"")+(G.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!tt||_)&&et[2]?' title="'+et[2]+'"':"")+(nt?"":' data-handler="selectDay" data-event="click" data-month="'+G.getMonth()+'" data-year="'+G.getFullYear()+'"')+">"+(tt&&!_?"&#xa0;":nt?'<span class="ui-state-default">'+G.getDate()+"</span>":'<a class="ui-state-default'+(G.getTime()==t.getTime()?" ui-state-highlight":"")+(G.getTime()==l.getTime()?" ui-state-active":"")+(tt?" ui-priority-secondary":"")+'" href="#">'+G.getDate()+"</a>")+"</td>",G.setDate(G.getDate()+1),G=this._daylightSavingAdjust(G)}U+=Z+"</tr>"}p++,p>11&&(p=0,d++),U+="</tbody></table>"+(f?"</div>"+(o[0]>0&&I==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),F+=U}B+=F}return B+=x+($.ui.ie6&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,B},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a=this._get(e,"changeMonth"),f=this._get(e,"changeYear"),l=this._get(e,"showMonthAfterYear"),c='<div class="ui-datepicker-title">',h="";if(s||!a)h+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{var p=r&&r.getFullYear()==n,d=i&&i.getFullYear()==n;h+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var v=0;v<12;v++)(!p||v>=r.getMonth())&&(!d||v<=i.getMonth())&&(h+='<option value="'+v+'"'+(v==t?' selected="selected"':"")+">"+u[v]+"</option>");h+="</select>"}l||(c+=h+(s||!a||!f?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!f)c+='<span class="ui-datepicker-year">'+n+"</span>";else{var m=this._get(e,"yearRange").split(":"),g=(new Date).getFullYear(),y=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?g+parseInt(e,10):parseInt(e,10);return isNaN(t)?g:t},b=y(m[0]),w=Math.max(b,y(m[1]||""));b=r?Math.max(b,r.getFullYear()):b,w=i?Math.min(w,i.getFullYear()):w,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;b<=w;b++)e.yearshtml+='<option value="'+b+'"'+(b==n?' selected="selected"':"")+">"+b+"</option>";e.yearshtml+="</select>",c+=e.yearshtml,e.yearshtml=null}}return c+=this._get(e,"yearSuffix"),l&&(c+=(s||!a||!f?"&#xa0;":"")+h),c+="</div>",c},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n=="Y"?t:0),i=e.drawMonth+(n=="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n=="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n=="M"||n=="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return i=r&&i>r?r:i,i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return typeof e!="string"||e!="isDisabled"&&e!="getDate"&&e!="widget"?e=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){typeof e=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.2",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",r={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var t=this,r=this.options,i=r.title||"&#160;",s,o,u,a,f;s=(this.uiDialog=e("<div>")).addClass(n+r.dialogClass).css({display:"none",outline:0,zIndex:r.zIndex}).attr("tabIndex",-1).keydown(function(n){r.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}).mousedown(function(e){t.moveToTop(!1,e)}).appendTo("body"),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(s),o=(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",function(){s.focus()}).prependTo(s),u=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault(),t.close(e)}).appendTo(o),(this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(r.closeText).appendTo(u),a=e("<span>").uniqueId().addClass("ui-dialog-title").html(i).prependTo(o),f=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(f),s.attr({role:"dialog","aria-labelledby":a.attr("id")}),o.find("*").add(o).disableSelection(),this._hoverable(u),this._focusable(u),r.draggable&&e.fn.draggable&&this._makeDraggable(),r.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(r.buttons),this._isOpen=!1,e.fn.bgiframe&&s.bgiframe(),this._on(s,{keydown:function(t){if(!r.modal||t.keyCode!==e.ui.keyCode.TAB)return;var n=e(":tabbable",s),i=n.filter(":first"),o=n.filter(":last");if(t.target===o[0]&&!t.shiftKey)return i.focus(1),!1;if(t.target===i[0]&&t.shiftKey)return o.focus(1),!1}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var n=this,r,i;if(!this._isOpen)return;if(!1===this._trigger("beforeClose",t))return;return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){n._trigger("close",t)}):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(r=0,e(".ui-dialog").each(function(){this!==n.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(r=Math.max(r,i)))}),e.ui.dialog.maxZ=r),this},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var r=this.options,i;return r.modal&&!t||!r.stack&&!r.modal?this._trigger("focus",n):(r.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=r.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),i={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(i),this._trigger("focus",n),this)},open:function(){if(this._isOpen)return;var t,n=this.options,r=this.uiDialog;return this._size(),this._position(n.position),r.show(n.show),this.overlay=n.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),t=this.element.find(":tabbable"),t.length||(t=this.uiDialogButtonPane.find(":tabbable"),t.length||(t=r)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this},_createButtons:function(t){var n=this,r=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),typeof t=="object"&&t!==null&&e.each(t,function(){return!(r=!0)}),r?(e.each(t,function(t,r){var i,s;r=e.isFunction(r)?{click:r,text:t}:r,r=e.extend({type:"button"},r),s=r.click,r.click=function(){s.apply(n.element[0],arguments)},i=e("<button></button>",r).appendTo(n.uiButtonSet),e.fn.button&&i.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function r(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){e(this).addClass("ui-dialog-dragging"),t._trigger("dragStart",n,r(i))},drag:function(e,n){t._trigger("drag",e,r(n))},stop:function(i,s){n.position=[s.position.left-t.document.scrollLeft(),s.position.top-t.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),t._trigger("dragStop",i,r(s)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function u(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}n=n===t?this.options.resizable:n;var r=this,i=this.options,s=this.uiDialog.css("position"),o=typeof n=="string"?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:o,start:function(t,n){e(this).addClass("ui-dialog-resizing"),r._trigger("resizeStart",t,u(n))},resize:function(e,t){r._trigger("resize",e,u(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing"),i.height=e(this).height(),i.width=e(this).width(),r._trigger("resizeStop",t,u(n)),e.ui.dialog.overlay.resize()}}).css("position",s).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n[0]+(r[0]<0?r[0]:"+"+r[0])+" "+n[1]+(r[1]<0?r[1]:"+"+r[1]),at:n.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()},_setOptions:function(t){var n=this,s={},o=!1;e.each(t,function(e,t){n._setOption(e,t),e in r&&(o=!0),e in i&&(s[e]=t)}),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,r){var i,s,o=this.uiDialog;switch(t){case"buttons":this._createButtons(r);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+r);break;case"dialogClass":o.removeClass(this.options.dialogClass).addClass(n+r);break;case"disabled":r?o.addClass("ui-dialog-disabled"):o.removeClass("ui-dialog-disabled");break;case"draggable":i=o.is(":data(draggable)"),i&&!r&&o.draggable("destroy"),!i&&r&&this._makeDraggable();break;case"position":this._position(r);break;case"resizable":s=o.is(":data(resizable)"),s&&!r&&o.resizable("destroy"),s&&typeof r=="string"&&o.resizable("option","handles",r),!s&&r!==!1&&this._makeResizable(r);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(r||"&#160;"))}this._super(t,r)},_size:function(){var t,n,r,i=this.options,s=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),i.minWidth>i.width&&(i.width=i.minWidth),t=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),n=Math.max(0,i.minHeight-t),i.height==="auto"?e.support.minHeight?this.element.css({minHeight:n,height:"auto"}):(this.uiDialog.show(),r=this.element.css("height","auto").height(),s||this.uiDialog.hide(),this.element.height(Math.max(r,n))):this.element.height(Math.max(i.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){this.instances.length===0&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){if(e(t.target).zIndex()<e.ui.dialog.overlay.maxZ)return!1})},1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",function(r){var i=e.ui.dialog.overlay.instances;i.length!==0&&i[i.length-1]===n&&t.options.closeOnEscape&&!r.isDefaultPrevented()&&r.keyCode&&r.keyCode===e.ui.keyCode.ESCAPE&&(t.close(r),r.preventDefault())}),n.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances),r=0;n!==-1&&this.oldInstances.push(this.instances.splice(n,1)[0]),this.instances.length===0&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,function(){r=Math.max(r,this.css("z-index"))}),this.maxZ=r},height:function(){var t,n;return e.ui.ie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),t<n?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return e.ui.ie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),t<n?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e,t){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d=u==="show",v,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"),u=o==="show",a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[],h,p,d,v,m,g;for(h=0;h<r;h++){v=a.top+h*l,g=h-(r-1)/2;for(p=0;p<i;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u,outerHeight:a.outerHeight*u,outerWidth:a.outerWidth*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r,i,s,o=e(this),u=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["position","top","bottom","left","right","overflow","opacity"],f=["width","height","overflow"],l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),d=t.restore||p!=="effect",v=t.scale||"both",m=t.origin||["middle","center"],g=o.css("position"),y=d?u:a,b={height:0,width:0,outerHeight:0,outerWidth:0};p==="show"&&o.show(),r={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},t.mode==="toggle"&&p==="show"?(o.from=t.to||b,o.to=t.from||r):(o.from=t.from||(p==="show"?b:r),o.to=t.to||(p==="hide"?b:r)),s={from:{y:o.from.height/r.height,x:o.from.width/r.width},to:{y:o.to.height/r.height,x:o.to.width/r.width}};if(v==="box"||v==="both")s.from.y!==s.to.y&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,s.from.y,o.from),o.to=e.effects.setTransition(o,c,s.to.y,o.to)),s.from.x!==s.to.x&&(y=y.concat(h),o.from=e.effects.setTransition(o,h,s.from.x,o.from),o.to=e.effects.setTransition(o,h,s.to.x,o.to));(v==="content"||v==="both")&&s.from.y!==s.to.y&&(y=y.concat(l).concat(f),o.from=e.effects.setTransition(o,l,s.from.y,o.from),o.to=e.effects.setTransition(o,l,s.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),m&&(i=e.effects.getBaseline(m,r),o.from.top=(r.outerHeight-o.outerHeight())*i.y,o.from.left=(r.outerWidth-o.outerWidth())*i.x,o.to.top=(r.outerHeight-o.to.outerHeight)*i.y,o.to.left=(r.outerWidth-o.to.outerWidth)*i.x),o.css(o.from);if(v==="content"||v==="both")c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),f=u.concat(c).concat(h),o.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width(),outerHeight:n.outerHeight(),outerWidth:n.outerWidth()};d&&e.effects.save(n,f),n.from={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},n.to={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x},s.from.y!==s.to.y&&(n.from=e.effects.setTransition(n,c,s.from.y,n.from),n.to=e.effects.setTransition(n,c,s.to.y,n.to)),s.from.x!==s.to.x&&(n.from=e.effects.setTransition(n,h,s.from.x,n.from),n.to=e.effects.setTransition(n,h,s.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){d&&e.effects.restore(n,f)})});o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o.to.opacity===0&&o.css("opacity",o.from.opacity),p==="hide"&&o.hide(),e.effects.restore(o,y),d||(g==="static"?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,n){var r=parseInt(n,10),i=e?o.to.left:o.to.top;return n==="auto"?i+"px":r+i+"px"})})),e.effects.removeWrapper(o),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery),function(e,t){var n=!1;e.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var r=e(t.target).closest(".ui-menu-item");!n&&r.not(".ui-state-disabled").length&&(n=!0,this.select(t),r.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),n=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,r,i,s,o,u=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:u=!1,r=this.previousFilter||"",i=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),i===r?s=!0:i=r+i,o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())}),n=s&&n.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):n,n.length||(i=String.fromCharCode(t.keyCode),o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}u&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus);r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),r=t.prev("a"),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",r.attr("id"))}),t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,t){var n,r;this.blur(e,e&&e.type==="focus"),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&e.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),i<0?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer);if(!this.active)return;this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active})},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true")return;this.timer=this._delay(function(){this._close(),this._open(e)},this.delay)},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(e==="first"||e==="last"?r=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):r=this.active[e+"All"](".ui-menu-item").eq(0));if(!r||!r.length||!this.active)r=this.activeMenu.children(".ui-menu-item")[t]();this.focus(n,r)},nextPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isLastItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r-i<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isFirstItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){function h(e,t,n){return[parseInt(e[0],10)*(l.test(e[0])?t/100:1),parseInt(e[1],10)*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,d,v,m,g=e(t.of),y=e.position.getWithinInfo(t.within),b=e.position.getScrollInfo(y),w=g[0],E=(t.collision||"flip").split(" "),S={};return w.nodeType===9?(l=g.width(),d=g.height(),v={top:0,left:0}):e.isWindow(w)?(l=g.width(),d=g.height(),v={top:g.scrollTop(),left:g.scrollLeft()}):w.preventDefault?(t.at="left top",l=d=0,v={top:w.pageY,left:w.pageX}):(l=g.outerWidth(),d=g.outerHeight(),v=g.offset()),m=e.extend({},v),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),S[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),E.length===1&&(E[1]=E[0]),t.at[0]==="right"?m.left+=l:t.at[0]==="center"&&(m.left+=l/2),t.at[1]==="bottom"?m.top+=d:t.at[1]==="center"&&(m.top+=d/2),n=h(S.at,l,d),m.left+=n[0],m.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),w=p(this,"marginLeft"),x=p(this,"marginTop"),T=f+w+p(this,"marginRight")+b.width,N=c+x+p(this,"marginBottom")+b.height,C=e.extend({},m),k=h(S.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:w,marginTop:x},e.each(["left","top"],function(r,i){e.ui.position[E[r]]&&e.ui.position[E[r]][i](C,{targetWidth:l,targetHeight:d,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:y,elem:a})}),e.fn.bgiframe&&a.bgiframe(),t.using&&(u=function(e){var n=v.left-C.left,s=n+l-f,o=v.top-C.top,u=o+d-c,h={target:{element:g,left:v.left,top:v.top,width:l,height:d},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),d<c&&i(o+u)<d&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&function(e){var n=e.fn.position;e.fn.position=function(r){if(!r||!r.offset)return n.call(this,r);var i=r.offset.split(" "),s=r.at.split(" ");return i.length===1&&(i[1]=i[0]),/^\d/.test(i[0])&&(i[0]="+"+i[0]),/^\d/.test(i[1])&&(i[1]="+"+i[1]),s.length===1&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center")),n.call(this,e.extend(r,{at:s[0]+i[0]+" "+s[1]+i[1],offset:t}))}}(jQuery)}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this._value():(this._setOption("value",e),this)},_setOption:function(e,t){e==="value"&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(e,t)},_value:function(){var e=this.options.value;return typeof e!="number"&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e)}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t,r,i=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",u=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(i.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),i.range&&(i.range===!0&&(i.values||(i.values=[this._valueMin(),this._valueMin()]),i.values.length&&i.values.length!==2&&(i.values=[i.values[0],i.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(i.range==="min"||i.range==="max"?" ui-slider-range-"+i.range:""))),r=i.values&&i.values.length||1;for(t=s.length;t<r;t++)u.push(o);this.handles=s.add(e(u.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){i.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){i.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._on(this.handles,{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));i>n&&(i=n,s=e(this),o=t)}),c.range===!0&&this.values(1)===c.min&&(o+=1,s=e(this.handles[o])),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);i!==undefined&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){if(!t)return;if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()},"mousedown .ui-spinner-button":function(t){function r(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),r.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,r.call(this)});if(this._start(t)===!1)return;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(!e(t.currentTarget).hasClass("ui-state-active"))return;if(this._start(t)===!1)return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(e.height()*.5)&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return!this.spinning&&this._trigger("start",e)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:n})!==!1)this._value(n),this.counter++},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return this.options.min!==null&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return n===-1?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=r.min!==null?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),r.max!==null&&e>r.max?r.max:r.min!==null&&e<r.min?r.min:e},_stop:function(e){if(!this.spinning)return;clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e)},_setOption:function(e,t){if(e==="culture"||e==="numberFormat"){var n=this._parse(this.element.val());this.options[e]=t,this.element.val(this._format(n));return}(e==="max"||e==="min"||e==="step")&&typeof t=="string"&&(t=this._parse(t)),this._super(e,t),e==="disabled"&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return typeof e=="string"&&e!==""&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),e===""||isNaN(e)?null:e},_format:function(e){return e===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;e!==""&&(n=this._parse(e),n!==null&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._spin((e||1)*this.options.step)},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._spin((e||1)*-this.options.step)},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function i(){return++n}function s(e){return e.hash.length>1&&e.href.replace(r,"")===location.href.replace(r,"").replace(/\s/g,"%20")}var n=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t=this,n=this.options,r=n.active,i=location.hash.substring(1);this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",n.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs();if(r===null){i&&this.tabs.each(function(t,n){if(e(n).attr("aria-controls")===i)return r=t,!1}),r===null&&(r=this.tabs.index(this.tabs.filter(".ui-tabs-active")));if(r===null||r===-1)r=this.tabs.length?0:!1}r!==!1&&(r=this.tabs.index(this.tabs.eq(r)),r===-1&&(r=n.collapsible?!1:0)),n.active=r,!n.collapsible&&n.active===!1&&this.anchors.length&&(n.active=0),e.isArray(n.disabled)&&(n.disabled=e.unique(n.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(this.options.active):this.active=e(),this._refresh(),this.active.length&&this.load(n.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(this._handlePageNav(t))return;switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:t.preventDefault(),clearTimeout(this.activating),this._activate(r);return;case e.ui.keyCode.ENTER:t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r);return;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))},_panelKeydown:function(t){if(this._handlePageNav(t))return;t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),t<0&&(t=r),t}var r=this.tabs.length-1;while(e.inArray(i(),this.options.disabled)!==-1)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="disabled"){this._setupDisabled(t);return}this._super(e,t),e==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),e==="event"&&this._setupEvents(t),e==="heightStyle"&&this._setupHeightStyle(t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,n=this.tablist.children(":has(a[href])");t.disabled=e.map(n.filter(".ui-state-disabled"),function(e){return n.index(e)}),this._processTabs(),t.active===!1||!this.anchors.length?(t.active=!1,this.active=e()):this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var i,o,u,a=e(r).uniqueId().attr("id"),f=e(r).closest("li"),l=f.attr("aria-controls");s(r)?(i=r.hash,o=t.element.find(t._sanitizeSelector(i))):(u=t._tabId(f),i="#"+u,o=t.element.find(i),o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),l&&f.data("ui-tabs-aria-controls",l),f.attr({"aria-controls":i.substring(1),"aria-labelledby":a}),o.attr("aria-labelledby",a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n=0,r;r=this.tabs[n];n++)t===!0||e.inArray(n,t)!==-1?e(r).addClass("ui-state-disabled").attr("aria-disabled","true"):e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r,i=this.element.parent();t==="fill"?(e.support.minHeight||(r=i.css("overflow"),i.css("overflow","hidden")),n=i.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if(r==="absolute"||r==="fixed")return;n-=t.outerHeight(!0)}),r&&i.css("overflow",r),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):t==="auto"&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault();if(s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1)return;n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),!f.length&&!a.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l)},_toggle:function(t,n){function o(){r.running=!1,r._trigger("activate",t,n)}function u(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),i.length&&r.options.show?r._show(i,r.options.show,o):(i.show(),o())}var r=this,i=n.newPanel,s=n.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),u()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),i.length&&s.length?n.oldTab.attr("tabIndex",-1):i.length&&this.tabs.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);if(r[0]===this.active[0])return;r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return typeof e=="string"&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n):t.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(n){var r=this.options.disabled;if(r===!1)return;n===t?r=!1:(n=this._getIndex(n),e.isArray(r)?r=e.map(r,function(e){return e!==n?e:null}):r=e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(r)},disable:function(n){var r=this.options.disabled;if(r===!0)return;if(n===t)r=!0;else{n=this._getIndex(n);if(e.inArray(n,r)!==-1)return;e.isArray(r)?r=e.merge([n],r).sort():r=[n]}this._setupDisabled(r)},load:function(t,n){t=this._getIndex(t);var r=this,i=this.tabs.eq(t),o=i.find(".ui-tabs-anchor"),u=this._getPanelForTab(i),a={tab:i,panel:u};if(s(o[0]))return;this.xhr=e.ajax(this._ajaxSettings(o,n,a)),this.xhr&&this.xhr.statusText!=="canceled"&&(i.addClass("ui-tabs-loading"),u.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){u.html(e),r._trigger("load",n,a)},1)}).complete(function(e,t){setTimeout(function(){t==="abort"&&r.panels.stop(!1,!0),i.removeClass("ui-tabs-loading"),u.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)}))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),e.uiBackCompat!==!1&&(e.ui.tabs.prototype._ui=function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}},e.widget("ui.tabs",e.ui.tabs,{url:function(e,t){this.anchors.eq(e).attr("href",t)}}),e.widget("ui.tabs",e.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var t=this;this._on({tabsbeforeload:function(n,r){if(e.data(r.tab[0],"cache.tabs")){n.preventDefault();return}r.jqXHR.success(function(){t.options.cache&&e.data(r.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(t,n,r){var i=this.options.ajaxOptions;return e.extend({},i,{error:function(e,t){try{i.error(e,t,r.tab.closest("li").index(),r.tab[0])}catch(n){}}},this._superApply(arguments))},_setOption:function(e,t){e==="cache"&&t===!1&&this.anchors.removeData("cache.tabs"),this._super(e,t)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(e){this.anchors.eq(e).removeData("cache.tabs"),this._superApply(arguments)}}),e.widget("ui.tabs",e.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(e,t){if(e.target!==this.element[0]||!this.options.spinner)return;var n=t.tab.find("span"),r=n.html();n.html(this.options.spinner),t.jqXHR.complete(function(){n.html(r)})}})}}),e.widget("ui.tabs",e.ui.tabs,{options:{enable:null,disable:null},enable:function(t){var n=this.options,r;if(t&&n.disabled===!0||e.isArray(n.disabled)&&e.inArray(t,n.disabled)!==-1)r=!0;this._superApply(arguments),r&&this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t]))},disable:function(t){var n=this.options,r;if(t&&n.disabled===!1||e.isArray(n.disabled)&&e.inArray(t,n.disabled)===-1)r=!0;this._superApply(arguments),r&&this._trigger("disable",null,this._ui(this.anchors[t],this.panels[t]))}}),e.widget("ui.tabs",e.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(n,r,i){i===t&&(i=this.anchors.length);var s,o,u=this.options,a=e(u.tabTemplate.replace(/#\{href\}/g,n).replace(/#\{label\}/g,r)),f=n.indexOf("#")?this._tabId(a):n.replace("#","");return a.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),a.attr("aria-controls",f),s=i>=this.tabs.length,o=this.element.find("#"+f),o.length||(o=this._createPanel(f),s?i>0?o.insertAfter(this.panels.eq(-1)):o.appendTo(this.element):o.insertBefore(this.panels[i])),o.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),s?a.appendTo(this.tablist):a.insertBefore(this.tabs[i]),u.disabled=e.map(u.disabled,function(e){return e>=i?++e:e}),this.refresh(),this.tabs.length===1&&u.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[i],this.panels[i])),this},remove:function(t){t=this._getIndex(t);var n=this.options,r=this.tabs.eq(t).remove(),i=this._getPanelForTab(r).remove();return r.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(t+(t+1<this.anchors.length?1:-1)),n.disabled=e.map(e.grep(n.disabled,function(e){return e!==t}),function(e){return e>=t?--e:e}),this.refresh(),this._trigger("remove",null,this._ui(r.find("a")[0],i[0])),this}}),e.widget("ui.tabs",e.ui.tabs,{length:function(){return this.anchors.length}}),e.widget("ui.tabs",e.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(t){var n=t.is("li")?t.find("a[href]"):t;return n=n[0],e(n).closest("li").attr("aria-controls")||n.title&&n.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+i()}}),e.widget("ui.tabs",e.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(t){return e(this.options.panelTemplate).attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),e.widget("ui.tabs",e.ui.tabs,{_create:function(){var e=this.options;e.active===null&&e.selected!==t&&(e.active=e.selected===-1?!1:e.selected),this._super(),e.selected=e.active,e.selected===!1&&(e.selected=-1)},_setOption:function(e,t){if(e!=="selected")return this._super(e,t);var n=this.options;this._super("active",t===-1?!1:t),n.selected=n.active,n.selected===!1&&(n.selected=-1)},_eventHandler:function(){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),e.widget("ui.tabs",e.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(e,t,n){var r,i,s=this._superApply(arguments);return s?(e==="beforeActivate"?(r=n.newTab.length?n.newTab:n.oldTab,i=n.newPanel.length?n.newPanel:n.oldPanel,s=this._super("select",t,{tab:r.find(".ui-tabs-anchor")[0],panel:i[0],index:r.closest("li").index()})):e==="activate"&&n.newTab.length&&(s=this._super("show",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()})),s):!1}}),e.widget("ui.tabs",e.ui.tabs,{select:function(e){e=this._getIndex(e);if(e===-1){if(!this.options.collapsible||this.options.selected===-1)return;e=this.options.selected}this.anchors.eq(e).trigger(this.options.event+this.eventNamespace)}}),function(){var t=0;e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var e=this.options,t;e.active==null&&e.cookie&&(t=parseInt(this._cookie(),10),t===-1&&(t=!1),e.active=t),this._super()},_cookie:function(n){var r=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++t)];return arguments.length&&(r.push(n===!1?-1:n),r.push(this.options.cookie)),e.cookie.apply(null,r)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),e.widget("ui.tabs",e.ui.tabs,{_trigger:function(t,n,r){var i=e.extend({},r);return t==="load"&&(i.panel=i.panel[0],i.tab=i.tab.find(".ui-tabs-anchor")[0]),this._super(t,n,i)}}),e.widget("ui.tabs",e.ui.tabs,{options:{fx:null},_getFx:function(){var t,n,r=this.options.fx;return r&&(e.isArray(r)?(t=r[0],n=r[1]):t=n=r),r?{show:n,hide:t}:null},_toggle:function(e,t){function o(){n.running=!1,n._trigger("activate",e,t)}function u(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&s.show?r.animate(s.show,s.show.duration,function(){o()}):(r.show(),o())}var n=this,r=t.newPanel,i=t.oldPanel,s=this._getFx();if(!s)return this._super(e,t);n.running=!0,i.length&&s.hide?i.animate(s.hide,s.hide.duration,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i.hide(),u())}}))}(jQuery),function(e){function n(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))}function r(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);i!==-1&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var t=0;e.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return e(this).attr("title")},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,n){var r=this;if(t==="disabled"){this[n?"_disable":"_enable"](),this.options[t]=n;return}this._super(t,n),t==="content"&&e.each(this.tooltips,function(e,t){r._updateContent(t)})},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=this,r=e(t?t.target:this.element).closest(this.options.items);if(!r.length||r.data("ui-tooltip-id"))return;r.attr("title")&&r.data("ui-tooltip-title",r.attr("title")),r.data("ui-tooltip-open",!0),t&&t.type==="mouseover"&&r.parents().each(function(){var t=e(this),r;t.data("ui-tooltip-open")&&(r=e.Event("blur"),r.target=r.currentTarget=this,n.close(r,!0)),t.attr("title")&&(t.uniqueId(),n.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(r,t)},_updateContent:function(e,t){var n,r=this.options.content,i=this,s=t?t.type:null;if(typeof r=="string")return this._open(t,e,r);n=r.call(e[0],function(n){if(!e.data("ui-tooltip-open"))return;i._delay(function(){t&&(t.type=s),this._open(t,e,n)})}),n&&this._open(t,e,n)},_open:function(t,r,i){function f(e){a.of=e;if(s.is(":hidden"))return;s.position(a)}var s,o,u,a=e.extend({},this.options.position);if(!i)return;s=this._find(r);if(s.length){s.find(".ui-tooltip-content").html(i);return}r.is("[title]")&&(t&&t.type==="mouseover"?r.attr("title",""):r.removeAttr("title")),s=this._tooltip(r),n(r,s.attr("id")),s.find(".ui-tooltip-content").html(i),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:f}),f(t)):s.position(e.extend({of:r},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.show&&this.options.show.delay&&(u=setInterval(function(){s.is(":visible")&&(f(a.of),clearInterval(u))},e.fx.interval)),this._trigger("open",t,{tooltip:s}),o={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=r[0],this.close(n,!0)}},remove:function(){this._removeTooltip(s)}};if(!t||t.type==="mouseover")o.mouseleave="close";if(!t||t.type==="focusin")o.focusout="close";this._on(!0,r,o)},close:function(t){var n=this,i=e(t?t.currentTarget:this.element),s=this._find(i);if(this.closing)return;i.data("ui-tooltip-title")&&i.attr("title",i.data("ui-tooltip-title")),r(i),s.stop(!0),this._hide(s,this.options.hide,function(){n._removeTooltip(e(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),t&&t.type==="mouseleave"&&e.each(this.parents,function(t,r){e(r.element).attr("title",r.title),delete n.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:s}),this.closing=!1},_tooltip:function(n){var r="ui-tooltip-"+t++,i=e("<div>").attr({id:r,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),e.fn.bgiframe&&i.bgiframe(),this.tooltips[r]=n,i},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery);;jQuery(function($){$.datepicker.regional['ru']={closeText:'',prevText:'&#x3c;',nextText:'&#x3e;',currentText:'',monthNames:['','','','','','','','','','','',''],monthNamesShort:['','','','','','','','','','','',''],dayNames:['','','','','','',''],dayNamesShort:['','','','','','',''],dayNamesMin:['','','','','','',''],weekHeader:'',dateFormat:'dd.mm.yy',firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:''};$.datepicker.setDefaults($.datepicker.regional['ru']);});;(function($){$.prettyPhoto={version:'3.1.6'};$.fn.prettyPhoto=function(pp_settings){pp_settings=jQuery.extend({hook:'rel',animation_speed:'fast',ajaxcallback:function(){},slideshow:5000,autoplay_slideshow:false,opacity:0.80,show_title:true,allow_resize:true,allow_expand:true,default_width:500,default_height:344,counter_separator_label:'/',theme:'pp_default',horizontal_padding:20,hideflash:false,wmode:'opaque',autoplay:true,modal:false,deeplinking:true,overlay_gallery:true,overlay_gallery_max:30,keyboard_shortcuts:true,changepicturecallback:function(){},callback:function(){},ie6_fallback:true,markup:'<div class="pp_pic_holder"> \
      <div class="ppt">&nbsp;</div> \
      <div class="pp_top"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
      <div class="pp_content_container"> \
       <div class="pp_left"> \
       <div class="pp_right"> \
        <div class="pp_content"> \
         <div class="pp_loaderIcon"></div> \
         <div class="pp_fade"> \
          <a href="#" class="pp_expand" title="Expand the image">Expand</a> \
          <div class="pp_hoverContainer"> \
           <a class="pp_next" href="#">next</a> \
           <a class="pp_previous" href="#">previous</a> \
          </div> \
          <div id="pp_full_res"></div> \
          <div class="pp_details"> \
           <div class="pp_nav"> \
            <a href="#" class="pp_arrow_previous">Previous</a> \
            <p class="currentTextHolder">0/0</p> \
            <a href="#" class="pp_arrow_next">Next</a> \
           </div> \
           <p class="pp_description"></p> \
           <div class="pp_social">{pp_social}</div> \
           <a class="pp_close" href="#">Close</a> \
          </div> \
         </div> \
        </div> \
       </div> \
       </div> \
      </div> \
      <div class="pp_bottom"> \
       <div class="pp_left"></div> \
       <div class="pp_middle"></div> \
       <div class="pp_right"></div> \
      </div> \
     </div> \
     <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery"> \
        <a href="#" class="pp_arrow_previous">Previous</a> \
        <div> \
         <ul> \
          {gallery} \
         </ul> \
        </div> \
        <a href="#" class="pp_arrow_next">Next</a> \
       </div>',image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="https://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="https://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:'',social_tools:'<div class="twitter"><a href="https://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},pp_settings);var matchedObjects=this,percentBased=false,pp_dimensions,pp_open,pp_contentHeight,pp_contentWidth,pp_containerHeight,pp_containerWidth,windowHeight=$(window).height(),windowWidth=$(window).width(),pp_slideshow;doresize=true,scroll_pos=_get_scroll();$(window).unbind('resize.prettyphoto').bind('resize.prettyphoto',function(){_center_overlay();_resize_overlay();});if(pp_settings.keyboard_shortcuts){$(document).unbind('keydown.prettyphoto').bind('keydown.prettyphoto',function(e){if(typeof $pp_pic_holder!='undefined'){if($pp_pic_holder.is(':visible')){switch(e.keyCode){case 37:$.prettyPhoto.changePage('previous');e.preventDefault();break;case 39:$.prettyPhoto.changePage('next');e.preventDefault();break;case 27:if(!settings.modal)
$.prettyPhoto.close();e.preventDefault();break;};};};});};$.prettyPhoto.initialize=function(){settings=pp_settings;if(settings.theme=='pp_default')settings.horizontal_padding=16;theRel=$(this).attr(settings.hook);galleryRegExp=/\[(?:.*)\]/;isSet=(galleryRegExp.exec(theRel))?true:false;pp_images=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return $(n).attr('href');}):$.makeArray($(this).attr('href'));pp_titles=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).find('img').attr('alt'))?$(n).find('img').attr('alt'):"";}):$.makeArray($(this).find('img').attr('alt'));pp_descriptions=(isSet)?jQuery.map(matchedObjects,function(n,i){if($(n).attr(settings.hook).indexOf(theRel)!=-1)return($(n).attr('title'))?$(n).attr('title'):"";}):$.makeArray($(this).attr('title'));if(pp_images.length>settings.overlay_gallery_max)settings.overlay_gallery=false;set_position=jQuery.inArray($(this).attr('href'),pp_images);rel_index=(isSet)?set_position:$("a["+settings.hook+"^='"+theRel+"']").index($(this));_build_overlay(this);if(settings.allow_resize)
$(window).bind('scroll.prettyphoto',function(){_center_overlay();});$.prettyPhoto.open();return false;}
$.prettyPhoto.open=function(event){if(typeof settings=="undefined"){settings=pp_settings;pp_images=$.makeArray(arguments[0]);pp_titles=(arguments[1])?$.makeArray(arguments[1]):$.makeArray("");pp_descriptions=(arguments[2])?$.makeArray(arguments[2]):$.makeArray("");isSet=(pp_images.length>1)?true:false;set_position=(arguments[3])?arguments[3]:0;_build_overlay(event.target);}
if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','hidden');_checkPosition($(pp_images).size());$('.pp_loaderIcon').show();if(settings.deeplinking)
setHashtag();if(settings.social_tools){facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));$pp_pic_holder.find('.pp_social').html(facebook_like_link);}
if($ppt.is(':hidden'))$ppt.css('opacity',0).show();$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity);$pp_pic_holder.find('.currentTextHolder').text((set_position+1)+settings.counter_separator_label+$(pp_images).size());if(typeof pp_descriptions[set_position]!='undefined'&&pp_descriptions[set_position]!=""){$pp_pic_holder.find('.pp_description').show().html(unescape(pp_descriptions[set_position]));}else{$pp_pic_holder.find('.pp_description').hide();}
movie_width=(parseFloat(getParam('width',pp_images[set_position])))?getParam('width',pp_images[set_position]):settings.default_width.toString();movie_height=(parseFloat(getParam('height',pp_images[set_position])))?getParam('height',pp_images[set_position]):settings.default_height.toString();percentBased=false;if(movie_height.indexOf('%')!=-1){movie_height=parseFloat(($(window).height()*parseFloat(movie_height)/100)-150);percentBased=true;}
if(movie_width.indexOf('%')!=-1){movie_width=parseFloat(($(window).width()*parseFloat(movie_width)/100)-150);percentBased=true;}
$pp_pic_holder.fadeIn(function(){(settings.show_title&&pp_titles[set_position]!=""&&typeof pp_titles[set_position]!="undefined")?$ppt.html(unescape(pp_titles[set_position])):$ppt.html('&nbsp;');imgPreloader="";skipInjection=false;switch(_getFileType(pp_images[set_position])){case'image':imgPreloader=new Image();nextImage=new Image();if(isSet&&set_position<$(pp_images).size()-1)nextImage.src=pp_images[set_position+1];prevImage=new Image();if(isSet&&pp_images[set_position-1])prevImage.src=pp_images[set_position-1];$pp_pic_holder.find('#pp_full_res')[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]);imgPreloader.onload=function(){pp_dimensions=_fitToViewport(imgPreloader.width,imgPreloader.height);_showContent();};imgPreloader.onerror=function(){alert('Image cannot be loaded. Make sure the path is correct and image exist.');$.prettyPhoto.close();};imgPreloader.src=pp_images[set_position];break;case'youtube':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=getParam('v',pp_images[set_position]);if(movie_id==""){movie_id=pp_images[set_position].split('youtu.be/');movie_id=movie_id[1];if(movie_id.indexOf('?')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('?'));if(movie_id.indexOf('&')>0)
movie_id=movie_id.substr(0,movie_id.indexOf('&'));}
movie='https://www.youtube.com/embed/'+movie_id;(getParam('rel',pp_images[set_position]))?movie+="?rel="+getParam('rel',pp_images[set_position]):movie+="?rel=1";if(settings.autoplay)movie+="&autoplay=1";toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,movie);break;case'vimeo':pp_dimensions=_fitToViewport(movie_width,movie_height);movie_id=pp_images[set_position];var regExp=/http(s?):\/\/(www\.)?vimeo.com\/(\d+)/;var match=movie_id.match(regExp);movie='https://player.vimeo.com/video/'+match[3]+'?title=0&amp;byline=0&amp;portrait=0';if(settings.autoplay)movie+="&autoplay=1;";vimeo_width=pp_dimensions['width']+'/embed/?moog_width='+pp_dimensions['width'];toInject=settings.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,movie);break;case'quicktime':pp_dimensions=_fitToViewport(movie_width,movie_height);pp_dimensions['height']+=15;pp_dimensions['contentHeight']+=15;pp_dimensions['containerHeight']+=15;toInject=settings.quicktime_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case'flash':pp_dimensions=_fitToViewport(movie_width,movie_height);flash_vars=pp_images[set_position];flash_vars=flash_vars.substring(pp_images[set_position].indexOf('flashvars')+10,pp_images[set_position].length);filename=pp_images[set_position];filename=filename.substring(0,filename.indexOf('?'));toInject=settings.flash_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+'?'+flash_vars);break;case'iframe':pp_dimensions=_fitToViewport(movie_width,movie_height);frame_url=pp_images[set_position];frame_url=frame_url.substr(0,frame_url.indexOf('iframe')-1);toInject=settings.iframe_markup.replace(/{width}/g,pp_dimensions['width']).replace(/{height}/g,pp_dimensions['height']).replace(/{path}/g,frame_url);break;case'ajax':doresize=false;pp_dimensions=_fitToViewport(movie_width,movie_height);doresize=true;skipInjection=true;$.get(pp_images[set_position],function(responseHTML){toInject=settings.inline_markup.replace(/{content}/g,responseHTML);$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();});break;case'custom':pp_dimensions=_fitToViewport(movie_width,movie_height);toInject=settings.custom_markup;break;case'inline':myClone=$(pp_images[set_position]).clone().append('<br clear="all" />').css({'width':settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo($('body')).show();doresize=false;pp_dimensions=_fitToViewport($(myClone).width(),$(myClone).height());doresize=true;$(myClone).remove();toInject=settings.inline_markup.replace(/{content}/g,$(pp_images[set_position]).html());break;};if(!imgPreloader&&!skipInjection){$pp_pic_holder.find('#pp_full_res')[0].innerHTML=toInject;_showContent();};});return false;};$.prettyPhoto.changePage=function(direction){currentGalleryPage=0;if(direction=='previous'){set_position--;if(set_position<0)set_position=$(pp_images).size()-1;}else if(direction=='next'){set_position++;if(set_position>$(pp_images).size()-1)set_position=0;}else{set_position=direction;};rel_index=set_position;if(!doresize)doresize=true;if(settings.allow_expand){$('.pp_contract').removeClass('pp_contract').addClass('pp_expand');}
_hideContent(function(){$.prettyPhoto.open();});};$.prettyPhoto.changeGalleryPage=function(direction){if(direction=='next'){currentGalleryPage++;if(currentGalleryPage>totalPage)currentGalleryPage=0;}else if(direction=='previous'){currentGalleryPage--;if(currentGalleryPage<0)currentGalleryPage=totalPage;}else{currentGalleryPage=direction;};slide_speed=(direction=='next'||direction=='previous')?settings.animation_speed:0;slide_to=currentGalleryPage*(itemsPerPage*itemWidth);$pp_gallery.find('ul').animate({left:-slide_to},slide_speed);};$.prettyPhoto.startSlideshow=function(){if(typeof pp_slideshow=='undefined'){$pp_pic_holder.find('.pp_play').unbind('click').removeClass('pp_play').addClass('pp_pause').click(function(){$.prettyPhoto.stopSlideshow();return false;});pp_slideshow=setInterval($.prettyPhoto.startSlideshow,settings.slideshow);}else{$.prettyPhoto.changePage('next');};}
$.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find('.pp_pause').unbind('click').removeClass('pp_pause').addClass('pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});clearInterval(pp_slideshow);pp_slideshow=undefined;}
$.prettyPhoto.close=function(){if($pp_overlay.is(":animated"))return;$.prettyPhoto.stopSlideshow();$pp_pic_holder.stop().find('object,embed').css('visibility','hidden');$('div.pp_pic_holder,div.ppt,.pp_fade').fadeOut(settings.animation_speed,function(){$(this).remove();});$pp_overlay.fadeOut(settings.animation_speed,function(){if(settings.hideflash)$('object,embed,iframe[src*=youtube],iframe[src*=vimeo]').css('visibility','visible');$(this).remove();$(window).unbind('scroll.prettyphoto');clearHashtag();settings.callback();doresize=true;pp_open=false;delete settings;});};function _showContent(){$('.pp_loaderIcon').hide();projectedTop=scroll_pos['scrollTop']+((windowHeight/2)-(pp_dimensions['containerHeight']/2));if(projectedTop<0)projectedTop=0;$ppt.fadeTo(settings.animation_speed,1);$pp_pic_holder.find('.pp_content').animate({height:pp_dimensions['contentHeight'],width:pp_dimensions['contentWidth']},settings.animation_speed);$pp_pic_holder.animate({'top':projectedTop,'left':((windowWidth/2)-(pp_dimensions['containerWidth']/2)<0)?0:(windowWidth/2)-(pp_dimensions['containerWidth']/2),width:pp_dimensions['containerWidth']},settings.animation_speed,function(){$pp_pic_holder.find('.pp_hoverContainer,#fullResImage').height(pp_dimensions['height']).width(pp_dimensions['width']);$pp_pic_holder.find('.pp_fade').fadeIn(settings.animation_speed);if(isSet&&_getFileType(pp_images[set_position])=="image"){$pp_pic_holder.find('.pp_hoverContainer').show();}else{$pp_pic_holder.find('.pp_hoverContainer').hide();}
if(settings.allow_expand){if(pp_dimensions['resized']){$('a.pp_expand,a.pp_contract').show();}else{$('a.pp_expand').hide();}}
if(settings.autoplay_slideshow&&!pp_slideshow&&!pp_open)$.prettyPhoto.startSlideshow();settings.changepicturecallback();pp_open=true;});_insert_gallery();pp_settings.ajaxcallback();};function _hideContent(callback){$pp_pic_holder.find('#pp_full_res object,#pp_full_res embed').css('visibility','hidden');$pp_pic_holder.find('.pp_fade').fadeOut(settings.animation_speed,function(){$('.pp_loaderIcon').show();callback();});};function _checkPosition(setCount){(setCount>1)?$('.pp_nav').show():$('.pp_nav').hide();};function _fitToViewport(width,height){resized=false;_getDimensions(width,height);imageWidth=width,imageHeight=height;if(((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight))&&doresize&&settings.allow_resize&&!percentBased){resized=true,fitting=false;while(!fitting){if((pp_containerWidth>windowWidth)){imageWidth=(windowWidth-200);imageHeight=(height/width)*imageWidth;}else if((pp_containerHeight>windowHeight)){imageHeight=(windowHeight-200);imageWidth=(width/height)*imageHeight;}else{fitting=true;};pp_containerHeight=imageHeight,pp_containerWidth=imageWidth;};if((pp_containerWidth>windowWidth)||(pp_containerHeight>windowHeight)){_fitToViewport(pp_containerWidth,pp_containerHeight)};_getDimensions(imageWidth,imageHeight);};return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(pp_containerHeight),containerWidth:Math.floor(pp_containerWidth)+(settings.horizontal_padding*2),contentHeight:Math.floor(pp_contentHeight),contentWidth:Math.floor(pp_contentWidth),resized:resized};};function _getDimensions(width,height){width=parseFloat(width);height=parseFloat(height);$pp_details=$pp_pic_holder.find('.pp_details');$pp_details.width(width);detailsHeight=parseFloat($pp_details.css('marginTop'))+parseFloat($pp_details.css('marginBottom'));$pp_details=$pp_details.clone().addClass(settings.theme).width(width).appendTo($('body')).css({'position':'absolute','top':-10000});detailsHeight+=$pp_details.height();detailsHeight=(detailsHeight<=34)?36:detailsHeight;$pp_details.remove();$pp_title=$pp_pic_holder.find('.ppt');$pp_title.width(width);titleHeight=parseFloat($pp_title.css('marginTop'))+parseFloat($pp_title.css('marginBottom'));$pp_title=$pp_title.clone().appendTo($('body')).css({'position':'absolute','top':-10000});titleHeight+=$pp_title.height();$pp_title.remove();pp_contentHeight=height+detailsHeight;pp_contentWidth=width;pp_containerHeight=pp_contentHeight+titleHeight+$pp_pic_holder.find('.pp_top').height()+$pp_pic_holder.find('.pp_bottom').height();pp_containerWidth=width;}
function _getFileType(itemSrc){if(itemSrc.match(/youtube\.com\/watch/i)||itemSrc.match(/youtu\.be/i)){return'youtube';}else if(itemSrc.match(/vimeo\.com/i)){return'vimeo';}else if(itemSrc.match(/\b.mov\b/i)){return'quicktime';}else if(itemSrc.match(/\b.swf\b/i)){return'flash';}else if(itemSrc.match(/\biframe=true\b/i)){return'iframe';}else if(itemSrc.match(/\bajax=true\b/i)){return'ajax';}else if(itemSrc.match(/\bcustom=true\b/i)){return'custom';}else if(itemSrc.substr(0,1)=='#'){return'inline';}else{return'image';};};function _center_overlay(){if(doresize&&typeof $pp_pic_holder!='undefined'){scroll_pos=_get_scroll();contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width();projectedTop=(windowHeight/2)+scroll_pos['scrollTop']-(contentHeight/2);if(projectedTop<0)projectedTop=0;if(contentHeight>windowHeight)
return;$pp_pic_holder.css({'top':projectedTop,'left':(windowWidth/2)+scroll_pos['scrollLeft']-(contentwidth/2)});};};function _get_scroll(){if(self.pageYOffset){return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset};}else if(document.documentElement&&document.documentElement.scrollTop){return{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft};}else if(document.body){return{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft};};};function _resize_overlay(){windowHeight=$(window).height(),windowWidth=$(window).width();if(typeof $pp_overlay!="undefined")$pp_overlay.height($(document).height()).width(windowWidth);};function _insert_gallery(){if(isSet&&settings.overlay_gallery&&_getFileType(pp_images[set_position])=="image"){itemWidth=52+5;navWidth=(settings.theme=="facebook"||settings.theme=="pp_default")?50:30;itemsPerPage=Math.floor((pp_dimensions['containerWidth']-100-navWidth)/itemWidth);itemsPerPage=(itemsPerPage<pp_images.length)?itemsPerPage:pp_images.length;totalPage=Math.ceil(pp_images.length/itemsPerPage)-1;if(totalPage==0){navWidth=0;$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').hide();}else{$pp_gallery.find('.pp_arrow_next,.pp_arrow_previous').show();};galleryWidth=itemsPerPage*itemWidth;fullGalleryWidth=pp_images.length*itemWidth;$pp_gallery.css('margin-left',-((galleryWidth/2)+(navWidth/2))).find('div:first').width(galleryWidth+5).find('ul').width(fullGalleryWidth).find('li.selected').removeClass('selected');goToPage=(Math.floor(set_position/itemsPerPage)<totalPage)?Math.floor(set_position/itemsPerPage):totalPage;$.prettyPhoto.changeGalleryPage(goToPage);$pp_gallery_li.filter(':eq('+set_position+')').addClass('selected');}else{$pp_pic_holder.find('.pp_content').unbind('mouseenter mouseleave');}}
function _build_overlay(caller){if(settings.social_tools)
facebook_like_link=settings.social_tools.replace('{location_href}',encodeURIComponent(location.href));settings.markup=settings.markup.replace('{pp_social}','');$('body').append(settings.markup);$pp_pic_holder=$('.pp_pic_holder'),$ppt=$('.ppt'),$pp_overlay=$('div.pp_overlay');if(isSet&&settings.overlay_gallery){currentGalleryPage=0;toInject="";for(var i=0;i<pp_images.length;i++){if(!pp_images[i].match(/\b(jpg|jpeg|png|gif)\b/gi)){classname='default';img_src='';}else{classname='';img_src=pp_images[i];}
toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>";};toInject=settings.gallery_markup.replace(/{gallery}/g,toInject);$pp_pic_holder.find('#pp_full_res').after(toInject);$pp_gallery=$('.pp_pic_holder .pp_gallery'),$pp_gallery_li=$pp_gallery.find('li');$pp_gallery.find('.pp_arrow_next').click(function(){$.prettyPhoto.changeGalleryPage('next');$.prettyPhoto.stopSlideshow();return false;});$pp_gallery.find('.pp_arrow_previous').click(function(){$.prettyPhoto.changeGalleryPage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_content').hover(function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeIn();},function(){$pp_pic_holder.find('.pp_gallery:not(.disabled)').fadeOut();});itemWidth=52+5;$pp_gallery_li.each(function(i){$(this).find('a').click(function(){$.prettyPhoto.changePage(i);$.prettyPhoto.stopSlideshow();return false;});});};if(settings.slideshow){$pp_pic_holder.find('.pp_nav').prepend('<a href="#" class="pp_play">Play</a>')
$pp_pic_holder.find('.pp_nav .pp_play').click(function(){$.prettyPhoto.startSlideshow();return false;});}
$pp_pic_holder.attr('class','pp_pic_holder '+settings.theme);$pp_overlay.css({'opacity':0,'height':$(document).height(),'width':$(window).width()}).bind('click',function(){if(!settings.modal)$.prettyPhoto.close();});$('a.pp_close').bind('click',function(){$.prettyPhoto.close();return false;});if(settings.allow_expand){$('a.pp_expand').bind('click',function(e){if($(this).hasClass('pp_expand')){$(this).removeClass('pp_expand').addClass('pp_contract');doresize=false;}else{$(this).removeClass('pp_contract').addClass('pp_expand');doresize=true;};_hideContent(function(){$.prettyPhoto.open();});return false;});}
$pp_pic_holder.find('.pp_previous, .pp_nav .pp_arrow_previous').bind('click',function(){$.prettyPhoto.changePage('previous');$.prettyPhoto.stopSlideshow();return false;});$pp_pic_holder.find('.pp_next, .pp_nav .pp_arrow_next').bind('click',function(){$.prettyPhoto.changePage('next');$.prettyPhoto.stopSlideshow();return false;});_center_overlay();};if(!pp_alreadyInitialized&&getHashtag()){pp_alreadyInitialized=true;hashIndex=getHashtag();hashRel=hashIndex;hashIndex=hashIndex.substring(hashIndex.indexOf('/')+1,hashIndex.length-1);hashRel=hashRel.substring(0,hashRel.indexOf('/'));setTimeout(function(){$("a["+pp_settings.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger('click');},50);}
return this.unbind('click.prettyphoto').bind('click.prettyphoto',$.prettyPhoto.initialize);};function getHashtag(){var url=location.href;hashtag=(url.indexOf('#prettyPhoto')!==-1)?decodeURI(url.substring(url.indexOf('#prettyPhoto')+1,url.length)):false;if(hashtag){hashtag=hashtag.replace(/<|>/g,'');}
return hashtag;};function setHashtag(){if(typeof theRel=='undefined')return;location.hash=theRel+'/'+rel_index+'/';};function clearHashtag(){if(location.href.indexOf('#prettyPhoto')!==-1)location.hash="prettyPhoto";}
function getParam(name,url){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);return(results==null)?"":results[1];}})(jQuery);var pp_alreadyInitialized=false;;function browserDetectNav(chrAfterPoint){var UA=window.navigator.userAgent,OperaB=/Opera[ \/]+\w+\.\w+/i,OperaV=/Version[ \/]+\w+\.\w+/i,FirefoxB=/Firefox\/\w+\.\w+/i,ChromeB=/Chrome\/\w+\.\w+/i,SafariB=/Version\/\w+\.\w+/i,IEB=/MSIE *\d+\.\w+/i,SafariV=/Safari\/\w+\.\w+/i,browser=new Array(),browserSplit=/[ \/\.]/i,OperaV=UA.match(OperaV),Firefox=UA.match(FirefoxB),Chrome=UA.match(ChromeB),Safari=UA.match(SafariB),SafariV=UA.match(SafariV),IE=UA.match(IEB),Opera=UA.match(OperaB);if((!Opera=="")&(!OperaV=="")){browser[0]=OperaV[0].replace(/Version/,"Opera")}else if(!Opera==""){browser[0]=Opera[0]}else if(!IE==""){browser[0]=IE[0]}else if(!Firefox==""){browser[0]=Firefox[0]}else if(!Chrome==""){browser[0]=Chrome[0]}else if((!Safari=="")&&(!SafariV=="")){browser[0]=Safari[0].replace("Version","Safari");}
var outputData;if(browser[0]!=null){outputData=browser[0].split(browserSplit);}
if(((chrAfterPoint==null)|(chrAfterPoint==0))&(outputData!=null)){chrAfterPoint=outputData[2].length;outputData[2]=outputData[2].substring(0,chrAfterPoint);return(outputData);}else if(chrAfterPoint!=null){outputData[2]=outputData[2].substr(0,chrAfterPoint);return(outputData);}else{return(false);}}
function browserDetectJS(){var
browser=new Array();if(window.opera){browser[0]="Opera";browser[1]=window.opera.version();}else if(window.chrome){browser[0]="Chrome";}else if(window.sidebar){browser[0]="Firefox";}else if((!window.external)&&(browser[0]!=="Opera")){browser[0]="Safari";}else if(window.ActiveXObject){browser[0]="MSIE";if(window.navigator.userProfile){browser[1]="6"}else if(window.Storage){browser[1]="8"}else if((!window.Storage)&&(!window.navigator.userProfile)){browser[1]="7"}else{browser[1]="Unknown";}}else if(navigator.userAgent.indexOf('MSIE')!==-1||navigator.appVersion.indexOf('Trident/')>0){browser[0]="MSIE";}
if(!browser){return(false)}else{return(browser);}}
function getBrowser(chrAfterPoint){var browserNav=browserDetectNav(chrAfterPoint),browserJS=browserDetectJS();if(browserNav[0]==browserJS[0]){return(browserNav)}else if(browserNav[0]!=browserJS[0]){return(browserJS)}else{return(false);}}
function isItBrowser(browserCom,browserVer,detectMethod){var browser;switch(detectMethod){case 1:browser=browserDetectNav();break;case 2:browser=browserDetectJS();break;default:browser=getBrowser();}
if((browserCom==browser[0])&(browserVer==browser[1])){return(true)}else if((browserCom==browser[0])&((browserVer==null)||(browserVer==0))){return(true)}else{return(false);}};function setCookie(name,value,expires,path,domain,secure){document.cookie=name+"="+escape(value)+
((expires)?"; expires="+(new Date(expires)):"")+
((path)?"; path="+path:"")+
((domain)?"; domain="+domain:"")+
((secure)?"; secure":"");}
function getCookie(name){var pattern="(?:; )?"+name+"=([^;]*);?";var regexp=new RegExp(pattern);if(regexp.test(document.cookie)){return decodeURIComponent(RegExp["$1"]);}
return false;}
function deleteCookie(name){setCookie(name,'',0,'/')};var watch_time_interval_id;(function($){$.fn.boxShadow=function(o){if(!o)
return;var b=o.split(' '),x=parseInt(b[0]),y=parseInt(b[1]),blur=0,color='';if(b.length==3){color=b[2]}else{blur=parseInt(b[2]);color=b[3]};return $(this).each(function(){var a=$(this),off=a.offset();a.after('<div></div>').next().css({width:a.width()+parseInt(a.css('padding-left'))+parseInt(a.css('padding-right')),height:a.height()+parseInt(a.css('padding-bottom'))+parseInt(a.css('padding-top')),position:'absolute','z-index':-1,backgroundColor:color,left:off.left+x-blur+'px',top:off.top+y-blur+'px'});if(blur)
a.next().css('filter','progid:DXImageTransform.Microsoft.Blur(pixelradius='+blur+', enabled="true")')});};})(jQuery);$(document).ready(function(){$("a[rel^='prettyPhoto']").prettyPhoto({default_width:800,default_height:640});$("#back-top").hide();$(function(){$(window).scroll(function(){if($(this).scrollTop()>100){$('#back-top').fadeIn();}else{$('#back-top').fadeOut();}});$('#back-top a').click(function(){$('body,html').animate({scrollTop:0},800);return false;});});ajaxApiStatusGet();setInterval(function(){ajaxApiStatusGet();},300000);$(".hmenu ul.nav li").hover(function(){$(this).addClass("hover");},function(){$(this).removeClass("hover");});});$(document).ready(function(){hiddenshowCookie=$.cookie('hidden_show');if(hiddenshowCookie==='show'){$("div.search_exp_body").css("display","none");$('.search_exp_btn_link img').attr("src","/img/arrow_down.png");$('.search_exp_btn_link').attr("title","   ");}else{$("div.search_exp_body").css("display","block");$('.search_exp_btn_link img').attr("src","/img/arrow_up.png");$('.search_exp_btn_link').attr("title","   ");}
$("div.search_exp_body").each(function(){$(this).css("height",$(this).height()+"px");});$(".search_exp_btn_link").mouseup(function(){var body=$(this).parent().parent().children("div.search_exp_body");if(body.is(":hidden")){body.slideDown();}else{body.slideUp();}});});$('.search_exp_btn_link').live('click',function(){if($.cookie('hidden_show')==='show'){$(this).find('img').attr("src","/img/arrow_up.png");$(this).attr("title","   ");setCookie('hidden_show','hidden',(new Date).getTime()+(9999*9999*999),'/');}else{$(this).find('img').attr("src","/img/arrow_down.png");$(this).attr("title","   ");setCookie('hidden_show','show',(new Date).getTime()+(9999*9999*999),'/');}});function pause(n){today=new Date();today2=today;while((today2-today)<=n){today2=new Date();}}
function in_array(what,where){for(var i=0,length_array=where.length;i<length_array;i++)
if(what==where[i]){return true;}
return false;}
function updateURLParameter(url,key,value){var re=new RegExp("([?&])"+key+"=.*?(&|$)","i");var separator=url.indexOf('?')!==-1?"&":"?";if(url.match(re)){return url.replace(re,'$1'+key+"="+value+'$2');}else{return url+separator+key+"="+value;}}
function getURLParameter(val){var result=false,tmp=[];var items=location.search.substr(1).split("&");for(var index=0;index<items.length;index++){tmp=items[index].split("=");if(tmp[0]===val){result=decodeURIComponent(tmp[1]);}}
return result;}
function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+\b)/g," ");}
$(document).ready(function(){var body=$("div.client_exp_body");$("div#client_exp_btn, #about_name .client_name").mouseup(function(){if(body.is(":hidden")){body.slideDown("slow");$('div#client_exp_btn').find('img').attr('src','/img/profile_open_addit.png');}else{body.slideUp("slow");$('div#client_exp_btn').find('img').attr('src','/img/profile_close_addit.png');}});if($('#ajax_results').data('rescount')=='0'){$('#more_result img').trigger('click');}
if(!getCookie('alert_error_browser')){setCookie('alert_error_browser','on',0,'/');}
function bdetect(){var data=getBrowser();if(data[0]!="Safari"&&data[0]!="Chrome"&&data[0]!="Firefox"&&getCookie('alert_error_browser')=='on'){if(data[0]=='MSIE'){data[0]='Internet Explorer';}
$('body').prepend('<div class="alert_error_browser">!    '+data[0]+'.          .      .           : <a href="https://www.google.com/intl/ru/chrome/browser/" target="_blank">Google Chrome</a> , <a href="http://www.mozilla.org/ru/firefox/fx/" target="_blank">Mozilla FireFox</a> , <a href="http://browser.yandex.ru/" target="_blank"> </a> , <a href="http://www.apple.com/ru/safari/" target="_blank">Apple Safari</a>.<span>x</span></div>');$('.alert_error_browser span').click(function(){$(this).parent().remove();setCookie('alert_error_browser','off',0,'/');});}}
window.onload=bdetect;$('.button_add_op_main').click(function(e){if(!$(this).next(".hint").is(':visible')){$(this).next(".hint").show();$(this).next('.hint').css("left",195);$(this).next('.hint').css("top",-1);}else{$(this).next(".hint").hide();}});$(document).on("click",".show-formula-button",function(){$(".formula").toggle();});});$(document).bind('click',function(e){if(!$(e.target).closest('.hint').length&&!$(e.target).is('.button_add_op_main')&&!$(e.target).is('.button_add_op_main span')){$('.hint').hide();}});function close_this(id){var div=$("#sub_operations_td"+id).children();var trdiv=$("#sub_operations_td_"+id);var partrdiv=$("#parent_sub_operations_td_"+id);div.css("height",div.height()+"px");trdiv.css("height",(40+div.height())+"px");if(trdiv.is(":hidden")){}else{trdiv.hide('').queue(function(){partrdiv.addClass('parent_sub_operations_inactive');partrdiv.removeClass('parent_sub_operations_active');$(this).dequeue();});}}
var nextPage=1;function ajaxGetLombard(){$("#preloader_main_page").html("<div style='text-align:center; height:0px;'><img src='/img/main_ajax_loader.gif'></div>");var b=$('#wp_id').text();$.ajax({type:'POST',url:'/ajax/more_operationl.php',dataType:'json',cache:false,data:{page:nextPage,wp:b},success:function(a){$("#preloader_main_page").html("");$("#header_cash_tbl").show();$("#today_nothing").hide();$("#ajax_results").append(a['html']);$('#ajax_results table:last').hide().show('fast');nextPage=a['next_page'];}});return false;}
$('#ajaxGetLombard').live({click:function(){ajaxGetLombard();}});function confirmSubmitForm(nameForm,textMessage){if(confirm(textMessage)){document.forms[nameForm].submit();}else{return false;}}
var AppSL={open_cash:function(confirmMessage,callback){var do_action=function(){$.ajax({url:"/cash/open",type:"GET",dataType:"json",success:function(result){callback(result);},error:function(xhr,str){console.log(" : "+xhr.responseCode+";  : "+str);}});};if(confirmMessage){swal({title:confirmMessage,type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},function(isConfirmed){if(isConfirmed){do_action();}else{callback(false);}});}else{do_action();}},close_cash:function(cash_id,confirmMessage,callback){var do_action=function(){$.ajax({url:"/cash/close/"+cash_id,type:"GET",dataType:"json",success:function(result){callback(result);},error:function(xhr,str){console.log(" : "+xhr.responseCode+";  : "+str);}});};if(confirmMessage){swal({title:confirmMessage,type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},function(isConfirmed){if(isConfirmed){do_action();}else{callback(false);}});}else{do_action();}}};function handleEnter(field,event){var keyCode=event.keyCode?event.keyCode:event.which?event.which:event.charCode;if(keyCode==13){var i;for(i=0;i<field.form.elements.length;i++)
if(field==field.form.elements[i]){break;}
i=(i+1)%field.form.elements.length;if(event.target.type=='radio'&&event.target.value=='1'){field.form.elements[i+1].focus();}else{field.form.elements[i].focus();}
return false;}else if(event.target.type=='checkbox'&&(keyCode==38||keyCode==40)){if(event.target.checked){event.target.checked=false;}else{event.target.checked=true;}
console.log(keyCode);}else{return true;}}
function tabEnter(form,event){if(event.keyCode!=13){return true;}
if(event.srcElement){event.keyCode=9;return true;}
if(!event.target||event.target.type=="submit"){return true;}
for(var i=0;i<form.length;i++){if(form[i]==event.target){var o=form[(i+1)%form.length];o.focus();if(o.type=="text"){o.select();}
return false;}}}
function ajaxApiStatusGet(){$.ajax({type:'POST',url:'/status/get/',dataType:'json',success:function(data){if(data.fail){alert(data.fail);window.location.href='/login/';}else if(!data.workplace){if(location&&location.pathname!=='/choose_wp/'&&location.pathname!=='/admin2/settings/wokplaces/add/'){window.location.href='/choose_wp/';}}
clearInterval(watch_time_interval_id);var watch_time=new Date(data.date);digitalClock(watch_time);unreadMessages.show(data.messages);if(data.messagesCount>0){$('#messages .inner').html('('+data.messagesCount+')');$('#messages a').addClass('bold');}else if(data.messagesCount==0){$('#messages .inner').html('');$('#messages a').removeClass('bold');}},error:function(data){console.log('mails fail: ',data);}});}
var unreadMessages=(function(){var messages_pool,$mail_block;function getContentBody(){if(!$mail_block||$mail_block.length){$mail_block=$('.mails');}
return $mail_block;}
return{show:function(messages){var buffer='';var count=0;messages_pool=messages;if(messages){for(var index in messages){if(count>=3){break;}
buffer+='<div id="message_'+index+'" data-id="'+index+'" class="message" title="'+messages[index]+'">'
+'<a target="_blank" href="/messages/?message='+index+'">'
+messages[index]
+'</a><img src="/img/cross_ico.png" class="close_msg" title=" "></img></div>';count++;}}
getContentBody().html(buffer);},markReaded:function(id){var that=this;$.ajax({type:'GET',url:'/ajax/mails.php',dataType:'json',data:{id:id},success:function(){$mail_block.find('#message_'+id+'.message').fadeOut('slow',function(){delete messages_pool[id];that.show(messages_pool);});}});}};})();$('.mails .message .close_msg, .mails .message a').live('click',function(){var id=$(this).parent().data('id');unreadMessages.markReaded(id);});var search_timer;function showSearchResult(str){clearTimeout(search_timer);search_timer=setTimeout(function(){var str_limit=3;str=jQuery.trim(str);if(str==''){return;}
if(/[^[0-9]/.test(str)){str_limit=3;}
if(str.length<str_limit){if(!isNaN(parseInt(str))){}else{$('#ajax_search_results').hide();$("#ajax_search_results").html("");return;}}
if(str.length>=str_limit){$("#ajax_search_results").html("<div style='text-align:center; height:18px;'><img src='/img/main_ajax_loader.gif'></div>");$.ajax({type:'GET',url:'/search/',dataType:'json',data:{q:str},cache:false,success:function(data){$("#ajax_search_results").html(data.html);$('#ajax_search_results').show();}});}},800);return false;}
var clients_search_timer_id;function showSearchClients(str){clearTimeout(clients_search_timer_id);$("#ajax_clients_results").html('<div class="loader-conainer" style="text-align:center; height:18px;"><img src="/img/main_ajax_loader.gif" /></div>');clients_search_timer_id=setTimeout(function(){str=$.trim(str);$.ajax({type:'GET',url:'/ajax/client_search.php?q='+str,dataType:'json',data:{},cache:false,success:function(data){$("#ajax_clients_results").html("");$("#ajax_clients_results").append(data['html']);$('#ajax_clients_results').show();}});},800);return false;}
function onClickpp(e){e=e||window.event;var target=e.target||e.srcElement;var popup=document.getElementById('ajax_search_results');var own_input=document.getElementById('search_input');while(target.parentNode&&target.tagName.toLowerCase()!='body'){if(target==popup||target==own_input){var own_input_text=$('#ajax_search_results').val();if(own_input_text.length<3){return;}else{$('#ajax_search_results').show();}
return;}
target=target.parentNode;}
$('#ajax_search_results').hide();}
document.onclick=function(e){onClickpp(e);};function getDateDiff(date1,date2,interval){var second=1000,minute=second*60,hour=minute*60,day=hour*24,week=day*7;interval=interval||'days';date1=new Date(date1).getTime();date2=(date2=='now')?new Date().getTime():new Date(date2).getTime();var timediff=date1-date2;if(isNaN(timediff)){return NaN;}
switch(interval){case"years":return date2.getFullYear()-date1.getFullYear();case"months":return((date2.getFullYear()*12+date2.getMonth())-(date1.getFullYear()*12+date1.getMonth()));case"weeks":return Math.floor(timediff/week);case"days":return Math.floor(timediff/day);case"hours":return Math.floor(timediff/hour);case"minutes":return Math.floor(timediff/minute);case"seconds":return Math.floor(timediff/second);default:return undefined;}}
var Utf8={encode:function(string){string=string.replace(/\r\n/g,"\n");var utftext="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c);}else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128);}else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128);}}
return utftext;},decode:function(utftext){var string="";var i=0;var c=c1=c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++;}else if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return string;}};function fClearLabel(_this,isEmpty){isEmpty=isEmpty&&_this.value=='';_this.parentNode.className=isEmpty?'date-item':'date-item hide_label';}
$(function(){$.each($('.date-item input'),function(){fClearLabel(this,true);});});$('.date-item label').live('click',function(){fClearLabel(this);});$('.date-item input').live('focus',function(){fClearLabel(this);});$('.date-item input').live('blur',function(){fClearLabel(this,true);});function goToByScroll(id){$('html,body').animate({scrollTop:$("#parent_sub_operations_td_"+id).offset().top},'slow');}
function expand_accessory(id){var div=$("#sub_operations_td"+id).children();var trdiv=$("#sub_operations_td_"+id);var partrdiv=$("#parent_sub_operations_td_"+id);div.css("height",div.height()+"px");trdiv.css("height",(40+div.height())+"px");if(trdiv.is(":hidden")){$('.parent_accessories_active').removeClass('parent_accessories_active').addClass('parent_accessories_inactive');trdiv.show();partrdiv.addClass('parent_accessories_active');partrdiv.removeClass('parent_accessories_inactive');$('.sub_operations:not(#sub_operations_td_'+id+')').hide();}else{trdiv.hide().queue(function(){partrdiv.addClass('parent_accessories_inactive');partrdiv.removeClass('parent_accessories_active');$(this).dequeue();});}}
function expand_sub_accessory(id){var div=$("#sub_sub_operations_td"+id).children();var trdiv=$("#sub_sub_operations_td_"+id);var imgdiv=$("#sub_operations_img_"+id+" .accessories_table_item img");div.css("height",div.height()+"px");trdiv.css("height",(40+div.height())+"px");if(trdiv.is(":hidden")){trdiv.show();$('.sub_sub_operations:not(#sub_sub_operations_td_'+id+')').hide();$(".accessories_table_item img").attr('src','/img/accessories_cat_closed.png');imgdiv.attr('src','/img/accessories_cat_opened.png');}else{trdiv.hide().queue(function(){imgdiv.attr('src','/img/accessories_cat_closed.png');$(this).dequeue();});}}
function accessories_active(id){var trdiv=$("#accessories_id_"+id+" td");$('.accessories_item_a').removeClass('accessories_item_a').addClass('accessories_item_ina');trdiv.addClass('accessories_item_a');trdiv.removeClass('accessories_item_ina');}
function plus_accessory(id){var value=Number($("#acs_input_"+id).val());var price=Number($("#acs_input_pr_"+id).val());var max_count=Number($("#acs_input_mc_"+id).val());value=value+1;if(value>max_count){value=max_count;}
price_txt="x "+price+" = "+price*value+" "+$('#curr_place').data('curr');$("#acs_input_"+id).val(value);$("#acc_sum_"+id).text(price_txt);}
function minus_accessory(id){var value=Number($("#acs_input_"+id).val());var price=Number($("#acs_input_pr_"+id).val());value=value-1;if(value<1){value=1;}
price_txt="x "+price+" = "+price*value+" "+$('#curr_place').data('curr');$("#acs_input_"+id).val(value);$("#acc_sum_"+id).text(price_txt);}
$('.accessories_count_input').live({keyup:function(event){var keyCode=event.keyCode?event.keyCode:event.which?event.which:event.charCode;if(keyCode!=8&&keyCode!=46){var id=$(this).attr('id').split('_')[2];var max_count=Number($("#acs_input_mc_"+id).val());var value=Number($("#acs_input_"+id).val());if(max_count==0){var max_val=0;}else{var max_val=1;}
if(isNaN(value)){value=max_val;}
if(value>max_count){value=max_count;}else if(value<1){value=max_val;}
$("#acs_input_"+id).val(value);}}});$(document).ready(function(){$(".button_add_op_main").click(function(){$("#fancybox-overlay").show();});$("#fancybox-overlay").click(function(){$("#fancybox-overlay").hide();});var $plus=$('.accessories_count_plus');$plus.mousedown(function(){$count_input=$(this).siblings('.accessories_count_input_div').children('.accessories_count_input');var mc_acc=parseInt($(this).siblings('.accessories_count_input_div').children('[name="mc_acc"]').val());px=setInterval(function(){var count=$count_input.val();if(count>=mc_acc){clearInterval(window.px);}else{$count_input.val(++count);}},200);$plus.mouseup(function(){clearInterval(window.px);});});var $minus=$('.accessories_count_minus');$minus.mousedown(function(){$count_input=$(this).siblings('.accessories_count_input_div').children('.accessories_count_input');mx=setInterval(function(){var count=$count_input.val();if(count<=1){clearInterval(window.mx);}else{$count_input.val(--count);}},200);$minus.mouseup(function(){clearInterval(window.mx);});});});function other_wp_op(){$('.other_wp_op').toggle();}
$(document).ready(function(){$(".cb-enable").click(function(){var parent=$(this).parents('.switch');$('.cb-disable',parent).removeClass('selected');$(this).addClass('selected');$('.checkbox',parent).attr('checked',true);$('.not_on_this_place').hide();$('.not_on_this_place').next('.sub_operations').hide();$('.not_operations').show();if($('.parent_sub_operations_inactive:visible').length){$('.profile_table_head').show();}else{$('.profile_table_head').hide();}});$(".cb-disable").click(function(){var parent=$(this).parents('.switch');$('.cb-enable',parent).removeClass('selected');$(this).addClass('selected');$('.checkbox',parent).attr('checked',false);$('.not_on_this_place').show();$('.not_operations').hide();if($('.parent_sub_operations_inactive:visible').length){$('.profile_table_head').show();}else{$('.profile_table_head').hide();}});$(".cb-enable").trigger('click');var copy_document_id=getCookie('copy_document_id');if(copy_document_id){deleteCookie('copy_document_id');var $new_tr=$('#table_result tr[data-doc-id="'+copy_document_id+'"]');var scrollHeight=$("body").height();$("body").animate({scrollTop:scrollHeight},0);$new_tr.animate({'backgroundColor':"#f3eee2"},300).animate({'backgroundColor':"#ffffff"},300).animate({'backgroundColor':"#f3eee2"},300).animate({'backgroundColor':"#ffffff"},300).animate({'backgroundColor':"#f3eee2"},300).animate({'backgroundColor':"#ffffff"},600);}});function link_from_to(f_i,s_i,t_i){f_val=Number($('#'+f_i).val());s_val=Number($('#'+s_i).val());t_val=f_val+s_val;$("#"+t_i).val(t_val);console.log(t_val);}
$('input#zalog').live({mouseover:function(){$(this).attr('src','/img/add_operation_h.png');},mouseout:function(){$(this).attr('src','/img/add_operation_n.png');},mousedown:function(){$(this).attr('src','/img/add_operation_s.png');},mouseup:function(){$(this).attr('src','/img/add_operation_n.png');}});$('input#search_btn').live({mouseover:function(){$(this).attr('src','/img/find_btn_h.png');},mouseout:function(){$(this).attr('src','/img/find_btn_n.png');},mousedown:function(){$(this).attr('src','/img/find_btn_s.png');},mouseup:function(){$(this).attr('src','/img/find_btn_n.png');}});$('img#more_result_btn').live({mouseover:function(){$(this).attr('src','/img/more_result_btn_h.png');},mouseout:function(){$(this).attr('src','/img/more_result_btn_n.png');},mousedown:function(){$(this).attr('src','/img/more_result_btn_s.png');},mouseup:function(){$(this).attr('src','/img/more_result_btn_n.png');}});$('img#open_cash_btn').live({mouseover:function(){$(this).attr('src','/img/open_cash_btn_h.png');},mouseout:function(){$(this).attr('src','/img/open_cash_btn_n.png');},mousedown:function(){$(this).attr('src','/img/open_cash_btn_s.png');},mouseup:function(){$(this).attr('src','/img/open_cash_btn_n.png');}});$('img.add_black_btn').live({mouseover:function(){$(this).attr('src','/img/add_black_btn_h.png');},mouseout:function(){$(this).attr('src','/img/add_black_btn_n.png');},mousedown:function(){$(this).attr('src','/img/add_black_btn_a.png');},mouseup:function(){$(this).attr('src','/img/add_black_btn_n.png');}});$('img#edit_profile_btn').live({mouseover:function(){$(this).attr('src','/img/edit_profile_btn_h.png');},mouseout:function(){$(this).attr('src','/img/edit_profile_btn_n.png');},mousedown:function(){$(this).attr('src','/img/edit_profile_btn_s.png');},mouseup:function(){$(this).attr('src','/img/edit_profile_btn_n.png');}});$('input.sell_acc_btn').live({mouseover:function(){$(this).attr('src','/img/btn_sell_acc_h.png');},mouseout:function(){$(this).attr('src','/img/btn_sell_acc_n.png');},mousedown:function(){$(this).attr('src','/img/btn_sell_acc_s.png');},mouseup:function(){$(this).attr('src','/img/btn_sell_acc_n.png');}});$('input#add_accessories').live({mouseover:function(){$(this).attr('src','/img/btn_add_new_acc_h.png');},mouseout:function(){$(this).attr('src','/img/btn_add_new_acc_n.png');},mousedown:function(){$(this).attr('src','/img/btn_add_new_acc_s.png');},mouseup:function(){$(this).attr('src','/img/btn_add_new_acc_n.png');}});function form_del_res(link,option1,option2){option1=option1||0;option2=option2||0;if(option1=='delete'){if(prompt('\n!     "'+option2+'"   .      ,  12345')=='12345'){location.href=link;}}else if(option1=='recovery'){if(prompt('\n!       .       ,      .     ,   12345')=='12345'){location.href=link;}}else if(prompt('\n  : 12345')=='12345'){location.href=link;}}
$(document).ready(function(e){maint0=".maintree0";$(maint0).sortable({placeholder:"ui-sortable-placeholder",opacity:0.6,cursor:'move',update:function(){var result='Count=6&'+$(this).sortable("serialize");$.post("/ajax/quicklinks_sort.php",result,function(theResponse){});}});$(maint0).disableSelection();$(".fancybox").fancybox();$(".fancybox.unique_change_password").fancybox({ajax:{type:"POST"},onComplete:function(){$("#form_new_pass .field_input:first").children(":first").focus();}});$("#add_op_button").fancybox({onComplete:function(){$('.client_search_box .client_search_textarea input').focus();showSearchClients();}});$('.tooltip_target').hover(function(event){var titleText=$(this).attr('title');$(this).data('tipText',titleText).removeAttr('title');$('<p class="tooltip_box"></p>').text(titleText).appendTo('body').css('top',(event.pageY-10)+'px').css('left',(event.pageX+20)+'px').fadeIn('slow');},function(){$(this).attr('title',$(this).data('tipText'));$('.tooltip_box').remove();}).mousemove(function(event){$('.tooltip_box').css('top',(event.pageY-10)+'px').css('left',(event.pageX+20)+'px');});jewelry_inserts_weight('input[name="good_extra_weight_inserts"]','input[name="good_extra_estimate_inserts"]');$('.datepicker').datepicker({dateFormat:'dd.mm.yy'});tableGenerator.init();$('#block_print_btm.jewelry-print').on('click',function(){$('.generator-table-container').printElement({printMode:'popup',overrideElementCSS:['/css/print.css']});});$('#workplace_activities_share_check').on('change',function(){const $container_common=$("#workplace_general_entities_fieldset"),$container_different=$("#workplace_general_entities_fieldset2");if($(this).val()==0){$container_different.trigger('close',function(){$container_different.addClass('hidden');$container_common.removeClass('hidden').trigger('open');});}else{$container_common.trigger('close',function(){$container_common.addClass('hidden');$container_different.removeClass('hidden').trigger('open');});}});});function ask_to_open_cash(callback_success_open){if(!callback_success_open){console.log('empty success callback');callback_success_open=function(){};}
var text='        ,      .    ?';AppSL.open_cash(text,function(result){if(result){if(result.status){alert(' ,       .        ""');callback_success_open(result);}else{alert(result.message);}
if(result.url){window.location.href=result.url;}}});}
function check_new_list_only($obj){$.ajax({type:"POST",url:"/more/moved/ajax_check_new_move_list/?good_id="+$obj.data("good"),dataType:"json",success:function(data){if(data){location.href="/more/moved/new_list/?action=new_good_list_add&good_id="+data;}else{$.fancybox({autoScale:true,height:"100%",width:"auto",href:$obj.attr('href'),onComplete:function(){$('.create_transfer_list_wp').fancybox();}});}},error:function(xhr,str){console.log(" : "+xhr.responseCode+";  : "+str);}});return true;}
function jewelry_inserts_weight(inserts_input_selector,inserts_sum_input_selector){var namespace='.jiw';function checkInputValue($inserts_input,$inserts_sum_input){if($inserts_sum_input.length){var $inserts_sum_container=$inserts_sum_input.closest('.form_row');if($inserts_input.val()===''||isNaN(parseFloat($inserts_input.val()))||parseFloat($inserts_input.val())===0){$inserts_sum_container.hide();$inserts_sum_input.val(0);}else{$inserts_sum_container.show();}}}
$(window).on('need-init-fileupload'+namespace,function(){var $inserts_input=$(inserts_input_selector);var $inserts_sum_input=$(inserts_sum_input_selector);checkInputValue($inserts_input,$inserts_sum_input);});$(document).on('input'+namespace,inserts_input_selector,function(){var $inserts_input=$(this);var $inserts_sum_input=$(inserts_sum_input_selector);checkInputValue($inserts_input,$inserts_sum_input);});}
function estimatePrice($this){var $form=$this.closest('form');var weight_ins=$form.find('[name="good_extra_weight_inserts"]').val();var weight=$form.find('[name="good_extra_weight"]').val();var standart_id=$form.find('[name="good_extra_standart_id"]').val();var product_or_scrap=$form.find('[name="scrap_product"]').val();var inserts_estimate_sum=$form.find('[name="good_extra_estimate_inserts"]').val();var type_operation=$form.find('[name="type_operation"]').val();$.ajax({type:'POST',url:'/ajax/ajax_new_op.php',dataType:'json',cache:false,data:{act:'estimate',standart_id:standart_id,product_type:product_or_scrap,weight:weight,weight_inserts:weight_ins,inserts_estimate:inserts_estimate_sum,type_operation:type_operation,},success:function(data){if(!weight_ins){weight_ins='0';}
if(weight!=''){var w_shift=symbAfterDot(weight)>symbAfterDot(weight_ins)?symbAfterDot(weight):symbAfterDot(weight_ins);var weight_clear=numZerosCut((weight-weight_ins).toFixed(w_shift));var new_sell_price;var jewel_type_additional_text;if(product_or_scrap==0){new_sell_price=numZerosCut((weight_clear*data.sell_price).toFixed(2));jewel_type_additional_text="";}else{new_sell_price=numZerosCut((weight_clear*data.sell_price_scrap).toFixed(2));jewel_type_additional_text="  ";}
$('.estimate_box').html(data.html);$('.jewelry_type').html(jewel_type_additional_text);$('.sell-price-input').val(parseInt(new_sell_price));}else{$('.estimate_box').empty();$('.sell-price-input').val('');}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});return true;}
function getObjectValues(object){var array=[];for(var index in object){array.push(object[index]);}
return array;}
function replace_subcategory_options(parent_id,selector){$.ajax({type:"POST",url:"/ajax/ajax_new_op.php",dataType:"json",cache:false,data:{act:"subcategory",parent_id:parent_id},success:function(result){$(selector).html(result);get_fast_button();},error:function(xhr,str){alert(" : "+xhr.responseCode+";  : "+str);}});}
function digitalClock(date){var month_name=new Array("","","","","","","","","","","","");function digitalClockRender(date){var month_num=date.getMonth();var day=date.getDate();var hours=date.getHours();var minutes=date.getMinutes();if(minutes<10)minutes="0"+minutes;$("#header_date").html(day+" "+month_name[month_num]+" "+hours+":"+minutes);}
digitalClockRender(date);watch_time_interval_id=setInterval(function(){date.setMilliseconds(date.getUTCMilliseconds()+1000*60);digitalClockRender(date);},1000*60);}
function executeCustomCallback(callback,param1,param2,param3){console.log('Call custom callback');if(typeof callback==="function"){return callback(param1,param2,param3);}else{if(window[callback]){callback=window[callback];return callback(param1,param2,param3);}else{console.error('Callback '+callback+' not found!');}}
return;};Date.dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];Date.abbrDayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];Date.monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];Date.abbrMonthNames=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];Date.firstDayOfWeek=1;Date.format='dd/mm/yyyy';Date.fullYearStart='20';(function(){function add(name,method){if(!Date.prototype[name]){Date.prototype[name]=method;}};add("isLeapYear",function(){var y=this.getFullYear();return(y%4==0&&y%100!=0)||y%400==0;});add("isWeekend",function(){return this.getDay()==0||this.getDay()==6;});add("isWeekDay",function(){return!this.isWeekend();});add("getDaysInMonth",function(){return[31,(this.isLeapYear()?29:28),31,30,31,30,31,31,30,31,30,31][this.getMonth()];});add("getDayName",function(abbreviated){return abbreviated?Date.abbrDayNames[this.getDay()]:Date.dayNames[this.getDay()];});add("getMonthName",function(abbreviated){return abbreviated?Date.abbrMonthNames[this.getMonth()]:Date.monthNames[this.getMonth()];});add("getDayOfYear",function(){var tmpdtm=new Date("1/1/"+this.getFullYear());return Math.floor((this.getTime()-tmpdtm.getTime())/86400000);});add("getWeekOfYear",function(){return Math.ceil(this.getDayOfYear()/7);});add("setDayOfYear",function(day){this.setMonth(0);this.setDate(day);return this;});add("addYears",function(num){this.setFullYear(this.getFullYear()+num);return this;});add("addMonths",function(num){var tmpdtm=this.getDate();this.setMonth(this.getMonth()+num);if(tmpdtm>this.getDate())
this.addDays(-this.getDate());return this;});add("addDays",function(num){this.setTime(this.getTime()+(num*86400000));return this;});add("addHours",function(num){this.setHours(this.getHours()+num);return this;});add("addMinutes",function(num){this.setMinutes(this.getMinutes()+num);return this;});add("addSeconds",function(num){this.setSeconds(this.getSeconds()+num);return this;});add("zeroTime",function(){this.setMilliseconds(0);this.setSeconds(0);this.setMinutes(0);this.setHours(0);return this;});add("asString",function(format){var r=format||Date.format;if(r.split('mm').length>1){r=r.split('mmmm').join(this.getMonthName(false)).split('mmm').join(this.getMonthName(true)).split('mm').join(_zeroPad(this.getMonth()+1))}else{r=r.split('m').join(this.getMonth()+1);}
r=r.split('yyyy').join(this.getFullYear()).split('yy').join((this.getFullYear()+'').substring(2)).split('dd').join(_zeroPad(this.getDate())).split('d').join(this.getDate());return r;});Date.fromString=function(s)
{var f=Date.format;var d=new Date('01/01/1970');if(s=='')return d;s=s.toLowerCase();var matcher='';var order=[];var r=/(dd?d?|mm?m?|yy?yy?)+([^(m|d|y)])?/g;var results;while((results=r.exec(f))!=null)
{switch(results[1]){case'd':case'dd':case'm':case'mm':case'yy':case'yyyy':matcher+='(\\d+\\d?\\d?\\d?)+';order.push(results[1].substr(0,1));break;case'mmm':matcher+='([a-z]{3})';order.push('M');break;}
if(results[2]){matcher+=results[2];}}
var dm=new RegExp(matcher);var result=s.match(dm);for(var i=0;i<order.length;i++){var res=result[i+1];switch(order[i]){case'd':d.setDate(res);break;case'm':d.setMonth(Number(res)-1);break;case'M':for(var j=0;j<Date.abbrMonthNames.length;j++){if(Date.abbrMonthNames[j].toLowerCase()==res)break;}
d.setMonth(j);break;case'y':d.setYear(res);break;}}
return d;};var _zeroPad=function(num){var s='0'+num;return s.substring(s.length-2)};})();
;/*!
  SerializeJSON jQuery plugin.
  https://github.com/marioizquierdo/jquery.serializeJSON
  version 2.8.1 (Dec, 2016)

  Copyright (c) 2012, 2017 Mario Izquierdo
  Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
  and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
*/
!function(a){if("function"==typeof define&&define.amd)define(["jquery"],a);else if("object"==typeof exports){var b=require("jquery");module.exports=a(b)}else a(window.jQuery||window.Zepto||window.$)}(function(a){"use strict";a.fn.serializeJSON=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o;return c=a.serializeJSON,d=this,e=c.setupOpts(b),f=d.serializeArray(),c.readCheckboxUncheckedValues(f,e,d),g={},a.each(f,function(a,b){h=b.name,i=b.value,k=c.extractTypeAndNameWithNoType(h),l=k.nameWithNoType,m=k.type,m||(m=c.attrFromInputWithName(d,h,"data-value-type")),c.validateType(h,m,e),"skip"!==m&&(n=c.splitInputNameIntoKeysArray(l),j=c.parseValue(i,h,m,e),o=!j&&c.shouldSkipFalsy(d,h,l,m,e),o||c.deepSet(g,n,j,e))}),g},a.serializeJSON={defaultOptions:{checkboxUncheckedValue:void 0,parseNumbers:!1,parseBooleans:!1,parseNulls:!1,parseAll:!1,parseWithFunction:null,skipFalsyValuesForTypes:[],skipFalsyValuesForFields:[],customTypes:{},defaultTypes:{string:function(a){return String(a)},number:function(a){return Number(a)},boolean:function(a){var b=["false","null","undefined","","0"];return b.indexOf(a)===-1},null:function(a){var b=["false","null","undefined","","0"];return b.indexOf(a)===-1?a:null},array:function(a){return JSON.parse(a)},object:function(a){return JSON.parse(a)},auto:function(b){return a.serializeJSON.parseValue(b,null,null,{parseNumbers:!0,parseBooleans:!0,parseNulls:!0})},skip:null},useIntKeysAsArrayIndex:!1},setupOpts:function(b){var c,d,e,f,g,h;h=a.serializeJSON,null==b&&(b={}),e=h.defaultOptions||{},d=["checkboxUncheckedValue","parseNumbers","parseBooleans","parseNulls","parseAll","parseWithFunction","skipFalsyValuesForTypes","skipFalsyValuesForFields","customTypes","defaultTypes","useIntKeysAsArrayIndex"];for(c in b)if(d.indexOf(c)===-1)throw new Error("serializeJSON ERROR: invalid option '"+c+"'. Please use one of "+d.join(", "));return f=function(a){return b[a]!==!1&&""!==b[a]&&(b[a]||e[a])},g=f("parseAll"),{checkboxUncheckedValue:f("checkboxUncheckedValue"),parseNumbers:g||f("parseNumbers"),parseBooleans:g||f("parseBooleans"),parseNulls:g||f("parseNulls"),parseWithFunction:f("parseWithFunction"),skipFalsyValuesForTypes:f("skipFalsyValuesForTypes"),skipFalsyValuesForFields:f("skipFalsyValuesForFields"),typeFunctions:a.extend({},f("defaultTypes"),f("customTypes")),useIntKeysAsArrayIndex:f("useIntKeysAsArrayIndex")}},parseValue:function(b,c,d,e){var f,g;return f=a.serializeJSON,g=b,e.typeFunctions&&d&&e.typeFunctions[d]?g=e.typeFunctions[d](b):e.parseNumbers&&f.isNumeric(b)?g=Number(b):!e.parseBooleans||"true"!==b&&"false"!==b?e.parseNulls&&"null"==b&&(g=null):g="true"===b,e.parseWithFunction&&!d&&(g=e.parseWithFunction(g,c)),g},isObject:function(a){return a===Object(a)},isUndefined:function(a){return void 0===a},isValidArrayIndex:function(a){return/^[0-9]+$/.test(String(a))},isNumeric:function(a){return a-parseFloat(a)>=0},optionKeys:function(a){if(Object.keys)return Object.keys(a);var b,c=[];for(b in a)c.push(b);return c},readCheckboxUncheckedValues:function(b,c,d){var e,f,g,h,i;null==c&&(c={}),i=a.serializeJSON,e="input[type=checkbox][name]:not(:checked):not([disabled])",f=d.find(e).add(d.filter(e)),f.each(function(d,e){if(g=a(e),h=g.attr("data-unchecked-value"),null==h&&(h=c.checkboxUncheckedValue),null!=h){if(e.name&&e.name.indexOf("[][")!==-1)throw new Error("serializeJSON ERROR: checkbox unchecked values are not supported on nested arrays of objects like '"+e.name+"'. See https://github.com/marioizquierdo/jquery.serializeJSON/issues/67");b.push({name:e.name,value:h})}})},extractTypeAndNameWithNoType:function(a){var b;return(b=a.match(/(.*):([^:]+)$/))?{nameWithNoType:b[1],type:b[2]}:{nameWithNoType:a,type:null}},shouldSkipFalsy:function(b,c,d,e,f){var g=a.serializeJSON,h=g.attrFromInputWithName(b,c,"data-skip-falsy");if(null!=h)return"false"!==h;var i=f.skipFalsyValuesForFields;if(i&&(i.indexOf(d)!==-1||i.indexOf(c)!==-1))return!0;var j=f.skipFalsyValuesForTypes;return null==e&&(e="string"),!(!j||j.indexOf(e)===-1)},attrFromInputWithName:function(a,b,c){var d,e,f;return d=b.replace(/(:|\.|\[|\]|\s)/g,"\\$1"),e='[name="'+d+'"]',f=a.find(e).add(a.filter(e)),f.attr(c)},validateType:function(b,c,d){var e,f;if(f=a.serializeJSON,e=f.optionKeys(d?d.typeFunctions:f.defaultOptions.defaultTypes),c&&e.indexOf(c)===-1)throw new Error("serializeJSON ERROR: Invalid type "+c+" found in input name '"+b+"', please use one of "+e.join(", "));return!0},splitInputNameIntoKeysArray:function(b){var c,d;return d=a.serializeJSON,c=b.split("["),c=a.map(c,function(a){return a.replace(/\]/g,"")}),""===c[0]&&c.shift(),c},deepSet:function(b,c,d,e){var f,g,h,i,j,k;if(null==e&&(e={}),k=a.serializeJSON,k.isUndefined(b))throw new Error("ArgumentError: param 'o' expected to be an object or array, found undefined");if(!c||0===c.length)throw new Error("ArgumentError: param 'keys' expected to be an array with least one element");f=c[0],1===c.length?""===f?b.push(d):b[f]=d:(g=c[1],""===f&&(i=b.length-1,j=b[i],f=k.isObject(j)&&(k.isUndefined(j[g])||c.length>2)?i:i+1),""===g?!k.isUndefined(b[f])&&a.isArray(b[f])||(b[f]=[]):e.useIntKeysAsArrayIndex&&k.isValidArrayIndex(g)?!k.isUndefined(b[f])&&a.isArray(b[f])||(b[f]=[]):!k.isUndefined(b[f])&&k.isObject(b[f])||(b[f]={}),h=c.slice(1),k.deepSet(b[f],h,d,e))}}});
;;(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','jquery.ui.widget'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('./vendor/jquery.ui.widget'));}else{factory(window.jQuery);}}(function($){'use strict';$.support.fileInput=!(new RegExp('(Android (1\\.[0156]|2\\.[01]))'+'|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)'+'|(w(eb)?OSBrowser)|(webOS)'+'|(Kindle/(1\\.0|2\\.[05]|3\\.0))').test(window.navigator.userAgent)||$('<input type="file">').prop('disabled'));$.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);function getDragHandler(type){var isDragOver=type==='dragover';return function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer;if(dataTransfer&&$.inArray('Files',dataTransfer.types)!==-1&&this._trigger(type,$.Event(type,{delegatedEvent:e}))!==false){e.preventDefault();if(isDragOver){dataTransfer.dropEffect='copy';}}};}
$.widget('blueimp.fileupload',{options:{dropZone:$(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:'Uploaded bytes exceed file size'},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace('{'+key+'}',value);});}
return message;},formData:function(form){return form.serializeArray();},add:function(e,data){if(e.isDefaultPrevented()){return false;}
if(data.autoUpload||(data.autoUpload!==false&&$(this).fileupload('option','autoUpload'))){data.process().done(function(){data.submit();});}},processData:false,contentType:false,cache:false,timeout:0},_specialOptions:['fileInput','dropZone','pasteZone','multipart','forceIframeTransport'],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments);},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1000/timeDiff)*8;this.loaded=loaded;this.timestamp=now;}
return this.bitrate;};},_isXHRUpload:function(options){return!options.forceIframeTransport&&((!options.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload);},_getFormData:function(options){var formData;if($.type(options.formData)==='function'){return options.formData(options.form);}
if($.isArray(options.formData)){return options.formData;}
if($.type(options.formData)==='object'){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value});});return formData;}
return[];},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1;});return total;},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress);}else{obj._progress=progress;}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop];}}}else{obj._response={};}},_onProgress:function(e,data){if(e.lengthComputable){var now=((Date.now)?Date.now():(new Date()).getTime()),loaded;if(data._time&&data.progressInterval&&(now-data._time<data.progressInterval)&&e.loaded!==e.total){return;}
data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=(loaded-data._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger('progress',$.Event('progress',{delegatedEvent:e}),data);this._trigger('progressall',$.Event('progressall',{delegatedEvent:e}),this._progress);}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind('progress',function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options);});options.xhr=function(){return xhr;};}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)==='[object '+type+']';},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=$.type(options.paramName)==='array'?options.paramName[0]:options.paramName;options.headers=$.extend({},options.headers);if(options.contentRange){options.headers['Content-Range']=options.contentRange;}
if(!multipart||options.blob||!this._isInstanceOf('File',file)){options.headers['Content-Disposition']='attachment; filename="'+
encodeURI(file.name)+'"';}
if(!multipart){options.contentType=file.type||'application/octet-stream';options.data=options.blob||file;}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob});}else{$.each(options.files,function(index,file){formData.push({name:($.type(options.paramName)==='array'&&options.paramName[index])||paramName,value:file});});}}else{if(that._isInstanceOf('FormData',options.formData)){formData=options.formData;}else{formData=new FormData();$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value);});}
if(options.blob){formData.append(paramName,options.blob,file.name);}else{$.each(options.files,function(index,file){if(that._isInstanceOf('File',file)||that._isInstanceOf('Blob',file)){formData.append(($.type(options.paramName)==='array'&&options.paramName[index])||paramName,file,file.uploadName||file.name);}});}}
options.data=formData;}
options.blob=null;},_initIframeSettings:function(options){var targetHost=$('<a></a>').prop('href',options.url).prop('host');options.dataType='iframe '+(options.dataType||'');options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||'redirect',value:options.redirect});}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options);}
this._initProgressListener(options);}
if(options.postMessage){options.dataType='postmessage '+(options.dataType||'');}}else{this._initIframeSettings(options);}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop('name')||'files[]',i=(input.prop('files')||[1]).length;while(i){paramName.push(name);i-=1;}});if(!paramName.length){paramName=[fileInput.prop('name')||'files[]'];}}else if(!$.isArray(paramName)){paramName=[paramName];}
return paramName;},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop('form'));if(!options.form.length){options.form=$(this.options.fileInput.prop('form'));}}
options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop('action')||location.href;}
options.type=(options.type||($.type(options.form.prop('method'))==='string'&&options.form.prop('method'))||'').toUpperCase();if(options.type!=='POST'&&options.type!=='PUT'&&options.type!=='PATCH'){options.type='POST';}
if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr('accept-charset');}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options;},_getDeferredState:function(deferred){if(deferred.state){return deferred.state();}
if(deferred.isResolved()){return'resolved';}
if(deferred.isRejected()){return'rejected';}
return'pending';},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise;},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args);}else if(resolveOrReject===false){dfd.rejectWith(context,args);}
promise.abort=dfd.promise;return this._enhancePromise(promise);},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(args){return $.Deferred().resolveWith(that,args).promise();};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise([this])).then(function(){if(data.errorThrown){return $.Deferred().rejectWith(that,[data]).promise();}
return getPromise(arguments);}).then(resolveFunc,rejectFunc);}
return this._processQueue||getPromise([this]);};data.submit=function(){if(this.state()!=='pending'){data.jqXHR=this.jqXHR=(that._trigger('submit',$.Event('submit',{delegatedEvent:e}),this)!==false)&&that._onSend(e,this);}
return this.jqXHR||that._getXHRPromise();};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort();}
this.errorThrown='abort';that._trigger('fail',null,this);return that._getXHRPromise(false);};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR);}
if(this._processQueue){return that._getDeferredState(this._processQueue);}};data.processing=function(){return!this.jqXHR&&this._processQueue&&that._getDeferredState(this._processQueue)==='pending';};data.progress=function(){return this._progress;};data.response=function(){return this._response;};},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader('Range'),parts=range&&range.split('-'),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1;},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false;}
if(testOnly){return true;}
if(ub>=fs){file.error=options.i18n('uploadedBytes');return this._getXHRPromise(false,options.context,[null,'error',file.error]);}
upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange='bytes '+ub+'-'+
(ub+o.chunkSize-1)+'/'+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=((that._trigger('chunksend',null,o)!==false&&$.ajax(o))||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||(ub+o.chunkSize);if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event('progress',{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o);}
options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger('chunkdone',null,o);that._trigger('chunkalways',null,o);if(ub<fs){upload();}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR]);}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger('chunkfail',null,o);that._trigger('chunkalways',null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown]);});};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort();};upload();return promise;},_beforeSend:function(e,data){if(this._active===0){this._trigger('start');this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0;}
this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total;},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event('progress',{lengthComputable:true,loaded:total,total:total}),options);}
response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger('done',null,options);},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total;}
response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger('fail',null,options);},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger('always',null,options);},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data);}
var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer();jqXHR=jqXHR||(((aborted||that._trigger('send',$.Event('send',{delegatedEvent:e}),options)===false)&&that._getXHRPromise(false,options.context,aborted))||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options);}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options);}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)==='pending'){nextSlot.resolve();break;}
nextSlot=that._slots.shift();}}
if(that._active===0){that._trigger('stop');}});return jqXHR;};this._beforeSend(e,options);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.then(send);}else{this._sequence=this._sequence.then(send,send);pipe=this._sequence;}
pipe.abort=function(){aborted=[undefined,'abort','abort'];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted);}
return send();}
return jqXHR.abort();};return this._enhancePromise(pipe);}
return send();},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),files=data.files,filesLength=files.length,limit=options.limitMultiFileUploads,limitSize=options.limitMultiFileUploadSize,overhead=options.limitMultiFileUploadSizeOverhead,batchSize=0,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i,j=0;if(!filesLength){return false;}
if(limitSize&&files[0].size===undefined){limitSize=undefined;}
if(!(options.singleFileUploads||limit||limitSize)||!this._isXHRUpload(options)){fileSet=[files];paramNameSet=[paramName];}else if(!(options.singleFileUploads||limitSize)&&limit){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i+=limit){fileSet.push(files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);}}else if(!options.singleFileUploads&&limitSize){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i=i+1){batchSize+=files[i].size+overhead;if(i+1===filesLength||((batchSize+files[i+1].size+overhead)>limitSize)||(limit&&i+1-j>=limit)){fileSet.push(files.slice(j,i+1));paramNameSlice=paramName.slice(j,i+1);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);j=i+1;batchSize=0;}}}else{paramNameSet=paramName;}
data.originalFiles=files;$.each(fileSet||files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger('add',$.Event('add',{delegatedEvent:e}),newData);return result;});return result;},_replaceFileInput:function(data){var input=data.fileInput,inputClone=input.clone(true),restoreFocus=input.is(document.activeElement);data.fileInputClone=inputClone;$('<form></form>').append(inputClone)[0].reset();input.after(inputClone).detach();if(restoreFocus){inputClone.focus();}
$.cleanData(input.unbind('remove'));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0];}
return el;});if(input[0]===this.element[0]){this.element=inputClone;}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry;}
dfd.resolve([e]);},successHandler=function(entries){that._handleFileTreeEntries(entries,path+entry.name+'/').done(function(files){dfd.resolve(files);}).fail(errorHandler);},readEntries=function(){dirReader.readEntries(function(results){if(!results.length){successHandler(entries);}else{entries=entries.concat(results);readEntries();}},errorHandler);},dirReader,entries=[];path=path||'';if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file);}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file);},errorHandler);}}else if(entry.isDirectory){dirReader=entry.createReader();readEntries();}else{dfd.resolve([]);}
return dfd.promise();},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path);})).then(function(){return Array.prototype.concat.apply([],arguments);});},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile();}
return entry;}
return item.getAsEntry();}));}
return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise();},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop('webkitEntries')||fileInput.prop('entries'),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries);}
files=$.makeArray(fileInput.prop('files'));if(!files.length){value=fileInput.prop('value');if(!value){return $.Deferred().resolve([]).promise();}
files=[{name:value.replace(/^.*\\/,'')}];}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize;});}
return $.Deferred().resolve(files).promise();},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput);}
return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).then(function(){return Array.prototype.concat.apply([],arguments);});},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data);}
if(that._trigger('change',$.Event('change',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file);}});if(this._trigger('paste',$.Event('paste',{delegatedEvent:e}),data)!==false){this._onAdd(e,data);}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger('drop',$.Event('drop',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});}},_onDragOver:getDragHandler('dragover'),_onDragEnter:getDragHandler('dragenter'),_onDragLeave:getDragHandler('dragleave'),_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave});this._on(this.options.pasteZone,{paste:this._onPaste});}
if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange});}},_destroyEventHandlers:function(){this._off(this.options.dropZone,'dragenter dragleave dragover drop');this._off(this.options.pasteZone,'paste');this._off(this.options.fileInput,'change');},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers();}
this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers();}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]');}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput);}
if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone);}
if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone);}},_getRegExp:function(str){var parts=str.split('/'),modifiers=parts.pop();parts.shift();return new RegExp(parts.join('/'),modifiers);},_isRegExpOption:function(key,value){return key!=='url'&&$.type(value)==='string'&&/^\/.*\/[igm]{0,3}$/.test(value);},_initDataAttributes:function(){var that=this,options=this.options,data=this.element.data();$.each(this.element[0].attributes,function(index,attr){var key=attr.name.toLowerCase(),value;if(/^data-/.test(key)){key=key.slice(5).replace(/-[a-z]/g,function(str){return str.charAt(1).toUpperCase();});value=data[key];if(that._isRegExpOption(key,value)){value=that._getRegExp(value);}
options[key]=value;}});},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers();},active:function(){return this._active;},progress:function(){return this._progress;},add:function(data){var that=this;if(!data||this.options.disabled){return;}
if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data);});}else{data.files=$.makeArray(data.files);this._onAdd(null,data);}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort();}
dfd.reject(null,'abort','abort');return promise;};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return;}
if(!files.length){dfd.reject();return;}
data.files=files;jqXHR=that._onSend(null,data);jqXHR.then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR);},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown);});});return this._enhancePromise(promise);}
data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data);}}
return this._getXHRPromise(false,data&&data.context);}});}));;$(function(){$(window).trigger('need-init-fileupload');});$(window).on('need-init-fileupload',function(){$.fileuploader();});function fileuploadDefaultImage(image){image.onerror="";image.src="/img/noimage.gif";}
function take_snapshot(){WebcamUploader.upload();}
WebcamUploader={previewSelector:'my_camera',resultSelector:'my_result',mainSelector:'webcam-uploader-container',storageName:'webcam',mobile:null,miniLive:false,showResultPreview:false,capturedImage:null,uploadUrl:null,curResType:null,playSound:true,soundFile:null,onCapture:null,onInitError:null,onBeforeUpload:null,onUploadComplete:null,onUploadError:null,onResolutionChanged:null,webcamPluginParams:{flashNotDetectedText:': Adobe Flash Player  .      ,  Adobe Flash Player.',noInterfaceFoundText:'   .',pluginNotLoadedText:'   ',upload_name:'files[]',width:null,height:null,dest_width:null,dest_height:null,image_format:'jpeg',jpeg_quality:75},resultType:{240:{src:{w:352,h:240},dest:{w:352,h:240}},360:{src:{w:480,h:360},dest:{w:480,h:360}},480:{src:{w:640,h:480},dest:{w:640,h:480}},720:{src:{w:960,h:720},dest:{w:960,h:720}}},init:function(){var that=this,vorbis_audio="audio/ogg; codecs=vorbis",mpeg_audio="audio/mpeg";function can_play(type){var elem=document.createElement("video");return!!(elem.canPlayType&&elem.canPlayType(type).replace(/no/,''));}
if(can_play(vorbis_audio)){that.soundFile='/js/webcamjs/shutter.ogg';}else if(can_play(mpeg_audio)){that.soundFile='/js/webcamjs/shutter.mp3';}else{that.playSound=false;}
localforage.getItem(that.storageName,function(err,value){if(typeof value==='string'){value=JSON.parse(value);that.curResType=value.resolution||480;}else{that.curResType=480;}});function mobileAndTabletCheck(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(userAgent.substr(0,4))){return true;}
return false;}
that.mobile=mobileAndTabletCheck();if(Webcam===undefined){if(that.onInitError){that.onInitError();}
return false;}else{return true;}},changeResolution:function(resType){var that=this;if(this.resultType[resType]===undefined){alert('  ');return false;}
localforage.setItem(this.storageName,JSON.stringify({resolution:resType}),function(err){if(err!==null){console.error('Error happened when changing res type');}else{var old_res=that.curResType;that.curResType=resType;that.webcamPluginParams.width=null;that.webcamPluginParams.height=null;that.webcamPluginParams.dest_width=null;that.webcamPluginParams.dest_height=null;Webcam.reset();if(that.onResolutionChanged){that.onResolutionChanged(resType,old_res);}
if($('.'+that.mainSelector).length){that.popup();}}});},capture:function(callback){var that=this;if(that.playSound){var shutter=new Audio();shutter.autoplay=false;shutter.src=that.soundFile;}
Webcam.snap(function(data_uri){that.capturedImage=data_uri;if(that.playSound){try{shutter.currentTime=0;}catch(e){;}
shutter.play();}
if(callback!==undefined){callback(that,data_uri);}
if(that.showResultPreview){var $previewContainer=$('#'+that.resultSelector);if($previewContainer.length){$previewContainer.html('<img src="'+data_uri+'"/>');}}});},getCurrentResolution:function(){return this.resultType[this.curResType];},upload:function(url,useExisting){var that=this;url=(url?url:this.uploadUrl);if(that.onBeforeUpload&&!that.onBeforeUpload()){return false;}
var sending=function(context,imageData){Webcam.upload(imageData,url,function(responseCode,responseBody){if(responseCode===200){if(that.onUploadComplete){that.onUploadComplete(responseCode,responseBody,url);}}});};if(useExisting){sending(that,that.capturedImage);}else{that.capture(sending);}},hide:function($target){var that=this;that.webcamPluginParams.width=null;that.webcamPluginParams.height=null;that.webcamPluginParams.dest_width=null;that.webcamPluginParams.dest_height=null;Webcam.reset();$target=$target||$('.'+that.mainSelector+':visible');$target.hide().html('');},popup:function($target){var that=this;var res=that.getCurrentResolution();$target=$target||$('.'+that.mainSelector+':visible');function compileHtml(){var container,resolution_buttons_types,resolution_buttons;resolution_buttons_types={240:' (SD)',360:'',480:'',720:' (HD)'};resolution_buttons='';for(var index in resolution_buttons_types){var link,text;text=index+'p';if(resolution_buttons_types[index]!==''){text+=resolution_buttons_types[index];}
if(that.curResType==index){link=text;}else{link='<a href="javascript:void(WebcamUploader.changeResolution('+index+'))">'+text+'</a>';}
resolution_buttons+='<div class="webcam-resolution-button">'+link+'</div>';}
container='<div class="webcam-resolution-buttons">'+resolution_buttons+'<div class="webcam-snap-button"><a href="javascript:void(take_snapshot())"> </a></div>\n\
                        </div>\n\
                        <div style="text-align: center;">\n\
                            <div id="'+that.previewSelector+'"></div>\n\
                            <div id="'+that.resultSelector+'"></div>\n\
                        </div>';return container;}
if($target&&$target.length){that.hide();$target.html(compileHtml());if(that.miniLive){that.webcamPluginParams.width=260;that.webcamPluginParams.height=177;}else{that.webcamPluginParams.width=that.webcamPluginParams.width||res.dest.w;that.webcamPluginParams.height=that.webcamPluginParams.height||res.dest.h;}
that.webcamPluginParams.dest_width=that.webcamPluginParams.dest_width||res.src.w;that.webcamPluginParams.dest_height=that.webcamPluginParams.dest_height||res.src.h;Webcam.set(that.webcamPluginParams);if($('#'+that.previewSelector).length){Webcam.attach('#'+that.previewSelector);}
$target.fadeIn("slow",function(){});}}};$.fileuploader=function(){var selector=$('.fileupload'),path='/upload/',messageImageMain='   ()',messageImageSeconds='   ()';var externalConfig;if(typeof fileUploaderConfig!=='undefined'){externalConfig=fileUploaderConfig;}else{externalConfig={};}
$.each(selector,function(){if($(this).hasClass('initialized')){return;}else{$(this).addClass('initialized');}
var $this=$(this),maxExceededMessage='   .',type=$this.data('type'),item_id=(!!$this.data('id')?parseInt($this.data('id')):0),uploadMultipleFiles=($this.data('multiple')&&parseInt($this.data('multiple'))>1?true:false),singleMode=$this.hasClass('single'),enabledWebCamera=($this.data('webcam')===undefined||parseInt($this.data('webcam'))!==0?true:false),max=uploadMultipleFiles?parseInt($this.data('multiple')):1,uploadedIds=$this.data('loaded-ids'),syncMainImageUrl=(externalConfig.syncMainImageUrl===undefined?path+'sync_main/?id=':externalConfig.syncMainImageUrl),removeImageUrl=(externalConfig.removeImageUrl===undefined?path+'remove/?id=':externalConfig.removeImageUrl),downloadUrlPart=(externalConfig.downloadUrlPart===undefined?path+'download/?id=':externalConfig.downloadUrlPart),viewUrlPart=(externalConfig.viewUrlPart===undefined?path+'view/?id=':externalConfig.viewUrlPart),uploadUrl=(externalConfig.uploadUrl===undefined?path+'?type='+type:externalConfig.uploadUrl+type),uploadUrlId=uploadUrl+'&id='+(item_id===0?'new':parseInt(item_id));var exceedMaxUploads=function(data){data=data||{files:[1]};var len=$this.children('.images').children('.image-mini:not(.image-default)').length;if((!singleMode&&(len+data.files.length>max))||(singleMode&&data.files.length>max)){return true;}
return false;};$this.fileuploaderDragging=0;$this.html('<div class="images cf"></div>'+'<button class="button-upload"> '+(type==='document_template'?'':'')+(type==='client'?'  ':'')+'</button>'+'<span class="help"></span>'+'<div class="drop-file-here">(  ())</div>'+
(enabledWebCamera&&WebcamUploader&&!WebcamUploader.mobile?'<div><button class="webcam-uploader-button">    </button></div>':'')+'<input type="file" name="files[]" '+(uploadMultipleFiles?'multiple="multiple"':'')+' />'+'<input type="hidden" name="fileupload_ids" class="fileupload_ids">'+
(enabledWebCamera&&WebcamUploader&&!WebcamUploader.mobile?'<div class="webcam-uploader-container"></div>':''));$($this).off('click.webcam-uploader');if(enabledWebCamera&&WebcamUploader){WebcamUploader.onInitError=function(){console.error('Cannot initialize WebcamUploader');};if(WebcamUploader.init()){$($this).on('click.webcam-uploader','.webcam-uploader-button',function(event){event.preventDefault();var $webcamContainer=$($this).find('.'+WebcamUploader.mainSelector);var webcam_mini=$this.data('webcam-mini');if($webcamContainer.is(':visible')){WebcamUploader.hide($webcamContainer);}else{WebcamUploader.onBeforeUpload=function(){if(exceedMaxUploads()){alert(maxExceededMessage);return false;}
return true;};WebcamUploader.onUploadComplete=function(responseCode,responseBody,uploadUrl){parseAnswer(JSON.parse(responseBody));};WebcamUploader.uploadUrl=uploadUrlId;WebcamUploader.miniLive=webcam_mini;WebcamUploader.popup($webcamContainer);}});}}
$this.children('.button-upload').on('click',function(event){event.preventDefault();$this.children('input[type="file"]').trigger('click');});$this.children('input[type="file"]').fileupload({url:uploadUrlId,singleFileUploads:false,maxNumberOfFiles:uploadMultipleFiles?parseInt($this.data('multiple')):1,dataType:'json',dropZone:$this,autoUpload:false,add:function(e,data){var uploadErrors=[];var acceptFileTypes=/^image\/(gif|jpe?g|png)$/i;var allowedDocumentsExtensions=['docx','odt','xlsx','xls','ods'];var acceptingDocumentsRegular=new RegExp("\.("+allowedDocumentsExtensions.join('|')+")$","i");for(var index in data.originalFiles){if(!data.originalFiles[index]['name'].length){uploadErrors.push('    .');}else if(type==='document_template'&&!acceptingDocumentsRegular.test(data.originalFiles[index]['name'])){uploadErrors.push('  : '+allowedDocumentsExtensions.join(', ')+'. ( '+data.originalFiles[index]['name']+')');}else if(type!=='client'&&type!=='document_template'&&data.originalFiles[index]['type'].length&&!acceptFileTypes.test(data.originalFiles[index]['type'])){uploadErrors.push('  : png, jpeg, jpg, gif. ( '+data.originalFiles[index]['name']+')');}}
for(var index in data.originalFiles){if(data.originalFiles[index]['size']&&data.originalFiles[index]['size']>2097152){uploadErrors.push('      2mb (2048kb). ( '+data.originalFiles[index]['name']+')');}}
if(exceedMaxUploads(data)){uploadErrors.push(maxExceededMessage);}
if(uploadErrors.length>0){alert(uploadErrors.join("\n"));}else{data.formData={alreadyLoaded:$this.find('.fileupload_ids').val()};data.submit();}},submit:function(e,data){if(exceedMaxUploads(data)){alert(maxExceededMessage);return false;}
$this.addClass('loading');$this.find('.images').after('<div class="progress progress-striped active" role="progressbar" aria-valuemax="100" aria-valuemin="0" aria-valuenow="0"><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>');},progress:function(e,data){var progress=Math.floor(data.loaded/data.total*100);$this.find('.progress').attr('aria-valuenow',progress).children().first().css('width',progress+'%');},done:function(e,data){parseAnswer(data.result);},fail:function(e,data){alert(' ,   . .');},always:function(e,data){$this.removeClass('loading');$this.find('.progress').remove();}});if(uploadedIds){$.post(uploadUrl,{'pawngoods':uploadedIds},function(answer){if(answer&&answer.files){render(answer);}},'json');}else{if(item_id!==0||max===1){$.post(uploadUrlId,{},function(answer){if(answer&&answer.files){render(answer);}},'json');}else{$.post(uploadUrl,{'help':1},function(answer){if(answer){render(answer);}},'json');}}
$this.on('dragenter',function(event){$this.fileuploaderDragging++;$this.addClass('fileupload-drop-zone');event.stopPropagation();event.preventDefault();return false;});$this.on('dragover',function(event){$this.addClass('fileupload-drop-zone');event.stopPropagation();event.preventDefault();return false;});$this.on('drop',function(event){$this.removeClass('fileupload-drop-zone');$this.fileuploaderDragging--;event.stopPropagation();event.preventDefault();return false;});$this.on('dragleave',function(event){$this.fileuploaderDragging--;if($this.fileuploaderDragging===0){$this.removeClass('fileupload-drop-zone');}
event.stopPropagation();event.preventDefault();return false;});$this.on('click','.fileupload-remove-file',function(event){if(confirm("    ?")){var $this=$(this),attachmentId=parseInt($this.data('id'));$.post(removeImageUrl+attachmentId,{},function(answer){if((answer&&answer.success)||answer.files){$this.parent().remove();removeId(attachmentId);if(answer.files&&answer.files[0]&&answer.files[0].default){addImage(answer.files[0]);}
if(type!=='client'&&type!=='document_template'){setDefaultActiveImage();}}else{alert(answer.errors);}},'json');}});$this.on('click','.image-container',function(event){if(type==='client'||singleMode){return;}
var $that=$(this);if(!$that.hasClass('is-active')&&!$that.parent().hasClass('image-default')){$this.find('.image-container').removeClass('is-active');$that.addClass('is-active');$this.find('.image-container').attr('title',messageImageSeconds);$that.attr('title',messageImageMain);syncMainImage();}});function parseAnswer(answer){if(typeof answer.errors==='string'){alert(answer.errors);}else{render(answer,function(){for(var x in answer.errors){alert(answer.errors[x].error);}});}}
function syncMainImage(){if((type==='client')||(singleMode)){return;}
var active=$this.find('.image-container.is-active');var attachmentId=parseInt(active.data('id'));if(attachmentId){$.post(syncMainImageUrl+attachmentId,{},function(answer){},'json');}}
function render(data,fn){if(fn!==undefined){setTimeout(fn,0);}
if(data&&data.help){$this.children('.help').attr('title',data.help).addClass('hyper-active');}
if(data&&data.files){if(singleMode){$this.children('.images').children('.image-mini:not(.image-default)').empty();}}else{return;}
var files=data.files;if(files&&files.length>0){$this.children('.images').children('.image-default').remove();for(var x in files){addImage(files[x]);}
if(type!=='client'&&type!=='document_template'&&!singleMode){setDefaultActiveImage();}}}
function setDefaultActiveImage(){var $activeImages=$this.find('.image-container.is-active');var $notDefaultImages=$this.find('.image-mini:not(.image-default)');if($notDefaultImages.length>=1){if($activeImages.length>1){$activeImages.removeClass('is-active');$activeImages.find('img').attr('title',messageImageSeconds);$activeImages.first().addClass('is-active');$activeImages.first().find('img').attr('title',messageImageMain);syncMainImage();}else if($activeImages.length<1){$notDefaultImages.first().children('.image-container').addClass('is-active');$notDefaultImages.find('img').attr('title',messageImageSeconds);$notDefaultImages.first().find('img').attr('title',messageImageMain);syncMainImage();}}}
function addImage(file){if(!file.default){addId(file.id);}
var notDefaultIcons='<span class="fileupload-buttons fileupload-remove-file" title=" " data-id="'+file.id+'"></span>'+'<a class="fileupload-buttons fileupload-download-file" title="" data-id="'+file.id+'" href="'+(downloadUrlPart+file.id)+'"></a>'+
(file.image!=1?'<a class="fileupload-buttons fileupload-show-file" title="   " data-id="'+file.id+'" href="'+(type==='document_template'?viewUrlPart+file.id:file.urlfull)+'" target="_blank"></a>':'');$this.children('.images').append('<div class="image-mini'+(file.default==1?' image-default':'')+'">'+'<div class="image-container '+(file.main==1&&file.default!=1&&type!=='client'?'is-active':'')+'" data-id="'+file.id+'" '+'title="'+(type!=='client'&&!singleMode?(file.main==1?messageImageMain:messageImageSeconds):'')+'">'+
(singleMode?'<a href="'+file.urlfull+'" target="_blank">':'')+'<img src="'+file.url+'" alt onerror="fileuploadDefaultImage(this)">'+
(singleMode?'</a>':'')+
(singleMode?'':'<div class="is-main-image" title="'+messageImageMain+'"></div>')+'</div>'+
(file.default==1?'':notDefaultIcons)+'</div>');}
function addId(id){var $input=$this.children('.fileupload_ids'),ids=($input.val()==''?[]:$input.val().split(','));ids.push(id);if(ids.length>0&&!singleMode){$input.val(ids.join(','));}else{$input.val(id);}}
function removeId(id){var $input=$this.children('.fileupload_ids'),ids=($input.val()==''?[]:$input.val().split(','));for(var x in ids){if(ids[x]==id){ids.splice(x,1);}}
$input.val(ids.join(','));}});}
;!function(){function n(n,t){return t>n?-1:n>t?1:n>=t?0:0/0}function t(n){return null===n?0/0:+n}function e(n){return!isNaN(n)}function r(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)<0?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)>0?u=i:r=i+1}return r}}}function u(n){return n.length}function i(n){for(var t=1;n*t%1;)t*=10;return t}function o(n,t){for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}function a(){this._=Object.create(null)}function c(n){return(n+="")===da||n[0]===ma?ma+n:n}function l(n){return(n+="")[0]===ma?n.slice(1):n}function s(n){return c(n)in this._}function f(n){return(n=c(n))in this._&&delete this._[n]}function h(){var n=[];for(var t in this._)n.push(l(t));return n}function g(){var n=0;for(var t in this._)++n;return n}function p(){for(var n in this._)return!1;return!0}function v(){this._=Object.create(null)}function d(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function m(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e=0,r=ya.length;r>e;++e){var u=ya[e]+t;if(u in n)return u}}function y(){}function M(){}function x(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new a;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function b(){ta.event.preventDefault()}function _(){for(var n,t=ta.event;n=t.sourceEvent;)t=n;return t}function w(n){for(var t=new M,e=0,r=arguments.length;++e<r;)t[arguments[e]]=x(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=ta.event;u.target=n,ta.event=u,t[u.type].apply(e,r)}finally{ta.event=i}}},t}function S(n){return xa(n,ka),n}function k(n){return"function"==typeof n?n:function(){return ba(n,this)}}function E(n){return"function"==typeof n?n:function(){return _a(n,this)}}function A(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=ta.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function N(n){return n.trim().replace(/\s+/g," ")}function C(n){return new RegExp("(?:^|\\s+)"+ta.requote(n)+"(?:\\s+|$)","g")}function z(n){return(n+"").trim().split(/^|\s+/)}function q(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=z(n).map(L);var u=n.length;return"function"==typeof t?r:e}function L(n){var t=C(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",N(u+" "+n))):e.setAttribute("class",N(u.replace(t," ")))}}function T(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function R(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function D(n){return"function"==typeof n?n:(n=ta.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,n)}}function P(){var n=this.parentNode;n&&n.removeChild(this)}function U(n){return{__data__:n}}function j(n){return function(){return Sa(this,n)}}function F(t){return arguments.length||(t=n),function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}}function H(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],o=0,a=i.length;a>o;o++)(u=i[o])&&t(u,o,e);return n}function O(n){return xa(n,Aa),n}function Y(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;);return o}}function I(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=c(t,ra(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+ta.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),c=Z;a>0&&(n=n.slice(0,a));var l=Ca.get(n);return l&&(n=l,c=V),a?t?u:r:t?y:i}function Z(n,t){return function(e){var r=ta.event;ta.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{ta.event=r}}}function V(n,t){var e=Z(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function X(){var n=".dragsuppress-"+ ++qa,t="click"+n,e=ta.select(oa).on("touchmove"+n,b).on("dragstart"+n,b).on("selectstart"+n,b);if(za){var r=ia.style,u=r[za];r[za]="none"}return function(i){if(e.on(n,null),za&&(r[za]=u),i){var o=function(){e.on(t,null)};e.on(t,function(){b(),o()},!0),setTimeout(o,0)}}}function $(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();if(0>La&&(oa.scrollX||oa.scrollY)){e=ta.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var u=e[0][0].getScreenCTM();La=!(u.f||u.e),e.remove()}return La?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}function B(){return ta.event.changedTouches[0].identifier}function W(){return ta.event.target}function J(){return oa}function G(n){return n>0?1:0>n?-1:0}function K(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function Q(n){return n>1?0:-1>n?Da:Math.acos(n)}function nt(n){return n>1?ja:-1>n?-ja:Math.asin(n)}function tt(n){return((n=Math.exp(n))-1/n)/2}function et(n){return((n=Math.exp(n))+1/n)/2}function rt(n){return((n=Math.exp(2*n))-1)/(n+1)}function ut(n){return(n=Math.sin(n/2))*n}function it(){}function ot(n,t,e){return this instanceof ot?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof ot?new ot(n.h,n.s,n.l):xt(""+n,bt,ot):new ot(n,t,e)}function at(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,i=2*e-o,new dt(u(n+120),u(n),u(n-120))}function ct(n,t,e){return this instanceof ct?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof ct?new ct(n.h,n.c,n.l):n instanceof st?ht(n.l,n.a,n.b):ht((n=_t((n=ta.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new ct(n,t,e)}function lt(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new st(e,Math.cos(n*=Fa)*t,Math.sin(n)*t)}function st(n,t,e){return this instanceof st?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof st?new st(n.l,n.a,n.b):n instanceof ct?lt(n.h,n.c,n.l):_t((n=dt(n)).r,n.g,n.b):new st(n,t,e)}function ft(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=gt(u)*Ja,r=gt(r)*Ga,i=gt(i)*Ka,new dt(vt(3.2404542*u-1.5371385*r-.4985314*i),vt(-.969266*u+1.8760108*r+.041556*i),vt(.0556434*u-.2040259*r+1.0572252*i))}function ht(n,t,e){return n>0?new ct(Math.atan2(e,t)*Ha,Math.sqrt(t*t+e*e),n):new ct(0/0,0/0,n)}function gt(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function pt(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function vt(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function dt(n,t,e){return this instanceof dt?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof dt?new dt(n.r,n.g,n.b):xt(""+n,dt,at):new dt(n,t,e)}function mt(n){return new dt(n>>16,255&n>>8,255&n)}function yt(n){return mt(n)+""}function Mt(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function xt(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(St(u[0]),St(u[1]),St(u[2]))}return(i=tc.get(n))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.slice(1),16))||(4===n.length?(o=(3840&i)>>4,o=o>>4|o,a=240&i,a=a>>4|a,c=15&i,c=c<<4|c):7===n.length&&(o=(16711680&i)>>16,a=(65280&i)>>8,c=255&i)),t(o,a,c))}function bt(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),new ot(r,u,c)}function _t(n,t,e){n=wt(n),t=wt(t),e=wt(e);var r=pt((.4124564*n+.3575761*t+.1804375*e)/Ja),u=pt((.2126729*n+.7151522*t+.072175*e)/Ga),i=pt((.0193339*n+.119192*t+.9503041*e)/Ka);return st(116*u-16,500*(r-u),200*(u-i))}function wt(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function St(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function kt(n){return"function"==typeof n?n:function(){return n}}function Et(n){return n}function At(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),Nt(t,e,n,r)}}function Nt(n,t,e,r){function u(){var n,t=c.status;if(!t&&zt(c)||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return o.error.call(i,r),void 0}o.load.call(i,n)}else o.error.call(i,c)}var i={},o=ta.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,l=null;return!oa.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=ta.event;ta.event=n;try{o.progress.call(i,c)}finally{ta.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(l=n,i):l},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(ra(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),c.setRequestHeader)for(var s in a)c.setRequestHeader(s,a[s]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=l&&(c.responseType=l),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},ta.rebind(i,o,"on"),null==r?i:i.get(Ct(r))}function Ct(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function zt(n){var t=n.responseType;return t&&"text"!==t?n.response:n.responseText}function qt(){var n=Lt(),t=Tt()-n;t>24?(isFinite(t)&&(clearTimeout(ic),ic=setTimeout(qt,t)),uc=0):(uc=1,ac(qt))}function Lt(){var n=Date.now();for(oc=ec;oc;)n>=oc.t&&(oc.f=oc.c(n-oc.t)),oc=oc.n;return n}function Tt(){for(var n,t=ec,e=1/0;t;)t.f?t=n?n.n=t.n:ec=t.n:(t.t<e&&(e=t.t),t=(n=t).n);return rc=n,e}function Rt(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Dt(n,t){var e=Math.pow(10,3*va(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function Pt(n){var t=n.decimal,e=n.thousands,r=n.grouping,u=n.currency,i=r&&e?function(n,t){for(var u=n.length,i=[],o=0,a=r[0],c=0;u>0&&a>0&&(c+a+1>t&&(a=Math.max(1,t-c)),i.push(n.substring(u-=a,u+a)),!((c+=a+1)>t));)a=r[o=(o+1)%r.length];return i.reverse().join(e)}:Et;return function(n){var e=lc.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"-",c=e[4]||"",l=e[5],s=+e[6],f=e[7],h=e[8],g=e[9],p=1,v="",d="",m=!1,y=!0;switch(h&&(h=+h.substring(1)),(l||"0"===r&&"="===o)&&(l=r="0",o="="),g){case"n":f=!0,g="g";break;case"%":p=100,d="%",g="f";break;case"p":p=100,d="%",g="r";break;case"b":case"o":case"x":case"X":"#"===c&&(v="0"+g.toLowerCase());case"c":y=!1;case"d":m=!0,h=0;break;case"s":p=-1,g="r"}"$"===c&&(v=u[0],d=u[1]),"r"!=g||h||(g="g"),null!=h&&("g"==g?h=Math.max(1,Math.min(21,h)):("e"==g||"f"==g)&&(h=Math.max(0,Math.min(20,h)))),g=sc.get(g)||Ut;var M=l&&f;return function(n){var e=d;if(m&&n%1)return"";var u=0>n||0===n&&0>1/n?(n=-n,"-"):"-"===a?"":a;if(0>p){var c=ta.formatPrefix(n,h);n=c.scale(n),e=c.symbol+d}else n*=p;n=g(n,h);var x,b,_=n.lastIndexOf(".");if(0>_){var w=y?n.lastIndexOf("e"):-1;0>w?(x=n,b=""):(x=n.substring(0,w),b=n.substring(w))}else x=n.substring(0,_),b=t+n.substring(_+1);!l&&f&&(x=i(x,1/0));var S=v.length+x.length+b.length+(M?0:u.length),k=s>S?new Array(S=s-S+1).join(r):"";return M&&(x=i(k+x,k.length?s-b.length:1/0)),u+=v,n=x+b,("<"===o?u+n+k:">"===o?k+u+n:"^"===o?k.substring(0,S>>=1)+u+n+k.substring(S):u+(M?n:k+n))+e}}}function Ut(n){return n+""}function jt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ft(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new hc(e-1)),1),e}function i(n,e){return t(n=new hc(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1)for(;r>o;)e(o)%i||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{hc=jt;var r=new jt;return r._=n,o(r,t,e)}finally{hc=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=Ht(n);return c.floor=c,c.round=Ht(r),c.ceil=Ht(u),c.offset=Ht(i),c.range=a,n}function Ht(n){return function(t,e){try{hc=jt;var r=new jt;return r._=t,n(r,e)._}finally{hc=Date}}}function Ot(n){function t(n){function t(t){for(var e,u,i,o=[],a=-1,c=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.slice(c,a)),null!=(u=pc[e=n.charAt(++a)])&&(e=n.charAt(++a)),(i=N[e])&&(e=i(t,null==u?"e"===e?" ":"0":u)),o.push(e),c=a+1);return o.push(n.slice(c,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},u=e(r,n,t,0);if(u!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&hc!==jt,o=new(i?jt:hc);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+(0|r.Z/100),r.M+r.Z%100,r.S,r.L),i?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var u,i,o,a=0,c=t.length,l=e.length;c>a;){if(r>=l)return-1;if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=C[o in pc?t.charAt(a++):o],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){_.lastIndex=0;var r=_.exec(t.slice(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){x.lastIndex=0;var r=x.exec(t.slice(e));return r?(n.w=b.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){E.lastIndex=0;var r=E.exec(t.slice(e));return r?(n.m=A.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.slice(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,N.c.toString(),t,r)}function c(n,t,r){return e(n,N.x.toString(),t,r)}function l(n,t,r){return e(n,N.X.toString(),t,r)}function s(n,t,e){var r=M.get(t.slice(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var f=n.dateTime,h=n.date,g=n.time,p=n.periods,v=n.days,d=n.shortDays,m=n.months,y=n.shortMonths;t.utc=function(n){function e(n){try{hc=jt;var t=new hc;return t._=n,r(t)}finally{hc=Date}}var r=t(n);return e.parse=function(n){try{hc=jt;var t=r.parse(n);return t&&t._}finally{hc=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=ae;var M=ta.map(),x=It(v),b=Zt(v),_=It(d),w=Zt(d),S=It(m),k=Zt(m),E=It(y),A=Zt(y);p.forEach(function(n,t){M.set(n.toLowerCase(),t)});var N={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return y[n.getMonth()]},B:function(n){return m[n.getMonth()]},c:t(f),d:function(n,t){return Yt(n.getDate(),t,2)},e:function(n,t){return Yt(n.getDate(),t,2)},H:function(n,t){return Yt(n.getHours(),t,2)},I:function(n,t){return Yt(n.getHours()%12||12,t,2)},j:function(n,t){return Yt(1+fc.dayOfYear(n),t,3)},L:function(n,t){return Yt(n.getMilliseconds(),t,3)},m:function(n,t){return Yt(n.getMonth()+1,t,2)},M:function(n,t){return Yt(n.getMinutes(),t,2)},p:function(n){return p[+(n.getHours()>=12)]},S:function(n,t){return Yt(n.getSeconds(),t,2)},U:function(n,t){return Yt(fc.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Yt(fc.mondayOfYear(n),t,2)},x:t(h),X:t(g),y:function(n,t){return Yt(n.getFullYear()%100,t,2)},Y:function(n,t){return Yt(n.getFullYear()%1e4,t,4)},Z:ie,"%":function(){return"%"}},C={a:r,A:u,b:i,B:o,c:a,d:Qt,e:Qt,H:te,I:te,j:ne,L:ue,m:Kt,M:ee,p:s,S:re,U:Xt,w:Vt,W:$t,x:c,X:l,y:Wt,Y:Bt,Z:Jt,"%":oe};return t}function Yt(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function It(n){return new RegExp("^(?:"+n.map(ta.requote).join("|")+")","i")}function Zt(n){for(var t=new a,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Vt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Xt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e));return r?(n.U=+r[0],e+r[0].length):-1}function $t(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e));return r?(n.W=+r[0],e+r[0].length):-1}function Bt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Wt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.y=Gt(+r[0]),e+r[0].length):-1}function Jt(n,t,e){return/^[+-]\d{4}$/.test(t=t.slice(e,e+5))?(n.Z=-t,e+5):-1}function Gt(n){return n+(n>68?1900:2e3)}function Kt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Qt(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function ne(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function te(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function ee(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function re(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ue(n,t,e){vc.lastIndex=0;var r=vc.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function ie(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=0|va(t)/60,u=va(t)%60;return e+Yt(r,"0",2)+Yt(u,"0",2)}function oe(n,t,e){dc.lastIndex=0;var r=dc.exec(t.slice(e,e+1));return r?e+r[0].length:-1}function ae(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ce(){}function le(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function se(n,t){n&&xc.hasOwnProperty(n.type)&&xc[n.type](n,t)}function fe(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function he(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)fe(n[e],t,1);t.polygonEnd()}function ge(){function n(n,t){n*=Fa,t=t*Fa/2+Da/4;var e=n-r,o=e>=0?1:-1,a=o*e,c=Math.cos(t),l=Math.sin(t),s=i*l,f=u*c+s*Math.cos(a),h=s*o*Math.sin(a);_c.add(Math.atan2(h,f)),r=n,u=c,i=l}var t,e,r,u,i;wc.point=function(o,a){wc.point=n,r=(t=o)*Fa,u=Math.cos(a=(e=a)*Fa/2+Da/4),i=Math.sin(a)},wc.lineEnd=function(){n(t,e)}}function pe(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function ve(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function de(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function me(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function ye(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Me(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function xe(n){return[Math.atan2(n[1],n[0]),nt(n[2])]}function be(n,t){return va(n[0]-t[0])<Ta&&va(n[1]-t[1])<Ta}function _e(n,t){n*=Fa;var e=Math.cos(t*=Fa);we(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function we(n,t,e){++Sc,Ec+=(n-Ec)/Sc,Ac+=(t-Ac)/Sc,Nc+=(e-Nc)/Sc}function Se(){function n(n,u){n*=Fa;var i=Math.cos(u*=Fa),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),l=Math.atan2(Math.sqrt((l=e*c-r*a)*l+(l=r*o-t*c)*l+(l=t*a-e*o)*l),t*o+e*a+r*c);kc+=l,Cc+=l*(t+(t=o)),zc+=l*(e+(e=a)),qc+=l*(r+(r=c)),we(t,e,r)}var t,e,r;Dc.point=function(u,i){u*=Fa;var o=Math.cos(i*=Fa);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),Dc.point=n,we(t,e,r)}}function ke(){Dc.point=_e}function Ee(){function n(n,t){n*=Fa;var e=Math.cos(t*=Fa),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),l=u*c-i*a,s=i*o-r*c,f=r*a-u*o,h=Math.sqrt(l*l+s*s+f*f),g=r*o+u*a+i*c,p=h&&-Q(g)/h,v=Math.atan2(h,g);Lc+=p*l,Tc+=p*s,Rc+=p*f,kc+=v,Cc+=v*(r+(r=o)),zc+=v*(u+(u=a)),qc+=v*(i+(i=c)),we(r,u,i)}var t,e,r,u,i;Dc.point=function(o,a){t=o,e=a,Dc.point=n,o*=Fa;var c=Math.cos(a*=Fa);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),we(r,u,i)},Dc.lineEnd=function(){n(t,e),Dc.lineEnd=ke,Dc.point=_e}}function Ae(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function Ne(){return!0}function Ce(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(be(e,r)){u.lineStart();for(var a=0;t>a;++a)u.point((e=n[a])[0],e[1]);return u.lineEnd(),void 0}var c=new qe(e,n,null,!0),l=new qe(e,null,c,!1);c.o=l,i.push(c),o.push(l),c=new qe(r,n,null,!1),l=new qe(r,null,c,!0),c.o=l,i.push(c),o.push(l)}}),o.sort(t),ze(i),ze(o),i.length){for(var a=0,c=e,l=o.length;l>a;++a)o[a].e=c=!c;for(var s,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;s=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var a=0,l=s.length;l>a;++a)u.point((f=s[a])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){s=g.p.z;for(var a=s.length-1;a>=0;--a)u.point((f=s[a])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,s=g.z,p=!p}while(!g.v);u.lineEnd()}}}function ze(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function qe(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Le(n,t,e,r){return function(u,i){function o(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function a(n,t){var e=u(n,t);d.point(e[0],e[1])}function c(){y.point=a,d.lineStart()}function l(){y.point=o,d.lineEnd()}function s(n,t){v.push([n,t]);var e=u(n,t);x.point(e[0],e[1])}function f(){x.lineStart(),v=[]}function h(){s(v[0][0],v[0][1]),x.lineEnd();var n,t=x.clean(),e=M.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r)if(1&t){n=e[0];var u,r=n.length-1,o=-1;if(r>0){for(b||(i.polygonStart(),b=!0),i.lineStart();++o<r;)i.point((u=n[o])[0],u[1]);i.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Te))}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:o,lineStart:c,lineEnd:l,polygonStart:function(){y.point=s,y.lineStart=f,y.lineEnd=h,g=[],p=[]},polygonEnd:function(){y.point=o,y.lineStart=c,y.lineEnd=l,g=ta.merge(g);var n=Fe(m,p);g.length?(b||(i.polygonStart(),b=!0),Ce(g,De,n,e,i)):n&&(b||(i.polygonStart(),b=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),b&&(i.polygonEnd(),b=!1),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},M=Re(),x=t(M),b=!1;return y}}function Te(n){return n.length>1}function Re(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:y,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function De(n,t){return((n=n.x)[0]<0?n[1]-ja-Ta:ja-n[1])-((t=t.x)[0]<0?t[1]-ja-Ta:ja-t[1])}function Pe(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?Da:-Da,c=va(i-e);va(c-Da)<Ta?(n.point(e,r=(r+o)/2>0?ja:-ja),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=Da&&(va(e-u)<Ta&&(e-=u*Ta),va(i-a)<Ta&&(i-=a*Ta),r=Ue(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function Ue(n,t,e,r){var u,i,o=Math.sin(n-e);return va(o)>Ta?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function je(n,t,e,r){var u;if(null==n)u=e*ja,r.point(-Da,u),r.point(0,u),r.point(Da,u),r.point(Da,0),r.point(Da,-u),r.point(0,-u),r.point(-Da,-u),r.point(-Da,0),r.point(-Da,u);else if(va(n[0]-t[0])>Ta){var i=n[0]<t[0]?Da:-Da;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function Fe(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=0;_c.reset();for(var a=0,c=t.length;c>a;++a){var l=t[a],s=l.length;if(s)for(var f=l[0],h=f[0],g=f[1]/2+Da/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===s&&(d=0),n=l[d];var m=n[0],y=n[1]/2+Da/4,M=Math.sin(y),x=Math.cos(y),b=m-h,_=b>=0?1:-1,w=_*b,S=w>Da,k=p*M;if(_c.add(Math.atan2(k*_*Math.sin(w),v*x+k*Math.cos(w))),i+=S?b+_*Pa:b,S^h>=e^m>=e){var E=de(pe(f),pe(n));Me(E);var A=de(u,E);Me(A);var N=(S^b>=0?-1:1)*nt(A[2]);(r>N||r===N&&(E[0]||E[1]))&&(o+=S^b>=0?1:-1)}if(!d++)break;h=m,p=M,v=x,f=n}}return(-Ta>i||Ta>i&&0>_c)^1&o}function He(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,c,l,s;return{lineStart:function(){l=c=!1,s=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=o?v?0:u(f,h):v?u(f+(0>f?Da:-Da),h):0;if(!e&&(l=c=v)&&n.lineStart(),v!==c&&(g=r(e,p),(be(e,g)||be(p,g))&&(p[0]+=Ta,p[1]+=Ta,v=t(p[0],p[1]))),v!==c)s=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(a&&e&&o^v){var m;d&i||!(m=r(p,e,!0))||(s=0,o?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&be(e,p)||n.point(p[0],p[1]),e=p,c=v,i=d},lineEnd:function(){c&&n.lineEnd(),e=null},clean:function(){return s|(l&&c)<<1}}}function r(n,t,e){var r=pe(n),u=pe(t),o=[1,0,0],a=de(r,u),c=ve(a,a),l=a[0],s=c-l*l;if(!s)return!e&&n;var f=i*c/s,h=-i*l/s,g=de(o,a),p=ye(o,f),v=ye(a,h);me(p,v);var d=g,m=ve(p,d),y=ve(d,d),M=m*m-y*(ve(p,p)-1);if(!(0>M)){var x=Math.sqrt(M),b=ye(d,(-m-x)/y);if(me(b,p),b=xe(b),!e)return b;var _,w=n[0],S=t[0],k=n[1],E=t[1];w>S&&(_=w,w=S,S=_);var A=S-w,N=va(A-Da)<Ta,C=N||Ta>A;if(!N&&k>E&&(_=k,k=E,E=_),C?N?k+E>0^b[1]<(va(b[0]-w)<Ta?k:E):k<=b[1]&&b[1]<=E:A>Da^(w<=b[0]&&b[0]<=S)){var z=ye(d,(-m+x)/y);return me(z,p),[b,xe(z)]}}}function u(t,e){var r=o?n:Da-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),o=i>0,a=va(i)>Ta,c=gr(n,6*Fa);return Le(t,e,c,o?[0,-n]:[-Da,n-Da])}function Oe(n,t,e,r){return function(u){var i,o=u.a,a=u.b,c=o.x,l=o.y,s=a.x,f=a.y,h=0,g=1,p=s-c,v=f-l;if(i=n-c,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-c,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-l,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-l,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:c+h*p,y:l+h*v}),1>g&&(u.b={x:c+g*p,y:l+g*v}),u}}}}}}function Ye(n,t,e,r){function u(r,u){return va(r[0]-n)<Ta?u>0?0:3:va(r[0]-e)<Ta?u>0?2:1:va(r[1]-t)<Ta?u>0?1:0:u>0?3:2}function i(n,t){return o(n.x,t.x)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n){for(var t=0,e=d.length,r=n[1],u=0;e>u;++u)for(var i,o=1,a=d[u],c=a.length,l=a[0];c>o;++o)i=a[o],l[1]<=r?i[1]>r&&K(l,i,n)>0&&++t:i[1]<=r&&K(l,i,n)<0&&--t,l=i;return 0!==t}function l(i,a,c,l){var s=0,f=0;if(null==i||(s=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do l.point(0===s||3===s?n:e,s>1?r:t);while((s=(s+c+4)%4)!==f)}else l.point(a[0],a[1])}function s(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function f(n,t){s(n,t)&&a.point(n,t)}function h(){C.point=p,d&&d.push(m=[]),S=!0,w=!1,b=_=0/0}function g(){v&&(p(y,M),x&&w&&A.rejoin(),v.push(A.buffer())),C.point=f,w&&a.lineEnd()}function p(n,t){n=Math.max(-Uc,Math.min(Uc,n)),t=Math.max(-Uc,Math.min(Uc,t));var e=s(n,t);if(d&&m.push([n,t]),S)y=n,M=t,x=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:b,y:_},b:{x:n,y:t}};N(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}b=n,_=t,w=e}var v,d,m,y,M,x,b,_,w,S,k,E=a,A=Re(),N=Oe(n,t,e,r),C={point:f,lineStart:h,lineEnd:g,polygonStart:function(){a=A,v=[],d=[],k=!0},polygonEnd:function(){a=E,v=ta.merge(v);var t=c([n,r]),e=k&&t,u=v.length;(e||u)&&(a.polygonStart(),e&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),u&&Ce(v,i,t,l,a),a.polygonEnd()),v=d=m=null}};return C}}function Ie(n){var t=0,e=Da/3,r=ir(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*Da/180,e=n[1]*Da/180):[180*(t/Da),180*(e/Da)]},u}function Ze(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,nt((i-(n*n+e*e)*u*u)/(2*u))]},e}function Ve(){function n(n,t){Fc+=u*n-r*t,r=n,u=t}var t,e,r,u;Zc.point=function(i,o){Zc.point=n,t=r=i,e=u=o},Zc.lineEnd=function(){n(t,e)}}function Xe(n,t){Hc>n&&(Hc=n),n>Yc&&(Yc=n),Oc>t&&(Oc=t),t>Ic&&(Ic=t)}function $e(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=Be(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=Be(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Be(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function We(n,t){Ec+=n,Ac+=t,++Nc}function Je(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);Cc+=o*(t+n)/2,zc+=o*(e+r)/2,qc+=o,We(t=n,e=r)}var t,e;Xc.point=function(r,u){Xc.point=n,We(t=r,e=u)}}function Ge(){Xc.point=We}function Ke(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);Cc+=o*(r+n)/2,zc+=o*(u+t)/2,qc+=o,o=u*n-r*t,Lc+=o*(r+n),Tc+=o*(u+t),Rc+=3*o,We(r=n,u=t)}var t,e,r,u;Xc.point=function(i,o){Xc.point=n,We(t=r=i,e=u=o)},Xc.lineEnd=function(){n(t,e)}}function Qe(n){function t(t,e){n.moveTo(t+o,e),n.arc(t,e,o,0,Pa)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:y};return a}function nr(n){function t(n){return(a?r:e)(n)}function e(t){return rr(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){M=0/0,S.point=i,t.lineStart()}function i(e,r){var i=pe([e,r]),o=n(e,r);u(M,x,y,b,_,w,M=o[0],x=o[1],y=e,b=i[0],_=i[1],w=i[2],a,t),t.point(M,x)}function o(){S.point=e,t.lineEnd()}function c(){r(),S.point=l,S.lineEnd=s}function l(n,t){i(f=n,h=t),g=M,p=x,v=b,d=_,m=w,S.point=i}function s(){u(M,x,y,b,_,w,g,p,f,v,d,m,a,t),S.lineEnd=o,o()}var f,h,g,p,v,d,m,y,M,x,b,_,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=c},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function u(t,e,r,a,c,l,s,f,h,g,p,v,d,m){var y=s-t,M=f-e,x=y*y+M*M;if(x>4*i&&d--){var b=a+g,_=c+p,w=l+v,S=Math.sqrt(b*b+_*_+w*w),k=Math.asin(w/=S),E=va(va(w)-1)<Ta||va(r-h)<Ta?(r+h)/2:Math.atan2(_,b),A=n(E,k),N=A[0],C=A[1],z=N-t,q=C-e,L=M*z-y*q;
(L*L/x>i||va((y*z+M*q)/x-.5)>.3||o>a*g+c*p+l*v)&&(u(t,e,r,a,c,l,N,C,E,b/=S,_/=S,w,d,m),m.point(N,C),u(N,C,E,b,_,w,s,f,h,g,p,v,d,m))}}var i=.5,o=Math.cos(30*Fa),a=16;return t.precision=function(n){return arguments.length?(a=(i=n*n)>0&&16,t):Math.sqrt(i)},t}function tr(n){var t=nr(function(t,e){return n([t*Ha,e*Ha])});return function(n){return or(t(n))}}function er(n){this.stream=n}function rr(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function ur(n){return ir(function(){return n})()}function ir(n){function t(n){return n=a(n[0]*Fa,n[1]*Fa),[n[0]*h+c,l-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(l-n[1])/h),n&&[n[0]*Ha,n[1]*Ha]}function r(){a=Ae(o=lr(m,y,M),i);var n=i(v,d);return c=g-n[0]*h,l=p+n[1]*h,u()}function u(){return s&&(s.valid=!1,s=null),t}var i,o,a,c,l,s,f=nr(function(n,t){return n=i(n,t),[n[0]*h+c,l-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,y=0,M=0,x=Pc,b=Et,_=null,w=null;return t.stream=function(n){return s&&(s.valid=!1),s=or(x(o,f(b(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(x=null==n?(_=n,Pc):He((_=+n)*Fa),u()):_},t.clipExtent=function(n){return arguments.length?(w=n,b=n?Ye(n[0][0],n[0][1],n[1][0],n[1][1]):Et,u()):w},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Fa,d=n[1]%360*Fa,r()):[v*Ha,d*Ha]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Fa,y=n[1]%360*Fa,M=n.length>2?n[2]%360*Fa:0,r()):[m*Ha,y*Ha,M*Ha]},ta.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function or(n){return rr(n,function(t,e){n.point(t*Fa,e*Fa)})}function ar(n,t){return[n,t]}function cr(n,t){return[n>Da?n-Pa:-Da>n?n+Pa:n,t]}function lr(n,t,e){return n?t||e?Ae(fr(n),hr(t,e)):fr(n):t||e?hr(t,e):cr}function sr(n){return function(t,e){return t+=n,[t>Da?t-Pa:-Da>t?t+Pa:t,e]}}function fr(n){var t=sr(n);return t.invert=sr(-n),t}function hr(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*r+a*u;return[Math.atan2(c*i-s*o,a*r-l*u),nt(s*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*i-c*o;return[Math.atan2(c*i+l*o,a*r+s*u),nt(s*r-a*u)]},e}function gr(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=pr(e,u),i=pr(e,i),(o>0?i>u:u>i)&&(u+=o*Pa)):(u=n+o*Pa,i=n-.5*c);for(var l,s=u;o>0?s>i:i>s;s-=c)a.point((l=xe([e,-r*Math.cos(s),-r*Math.sin(s)]))[0],l[1])}}function pr(n,t){var e=pe(t);e[0]-=n,Me(e);var r=Q(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Ta)%(2*Math.PI)}function vr(n,t,e){var r=ta.range(n,t-Ta,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function dr(n,t,e){var r=ta.range(n,t-Ta,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function mr(n){return n.source}function yr(n){return n.target}function Mr(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),l=u*Math.sin(n),s=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(ut(r-t)+u*o*ut(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*s,u=e*l+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Ha,Math.atan2(o,Math.sqrt(r*r+u*u))*Ha]}:function(){return[n*Ha,t*Ha]};return p.distance=h,p}function xr(){function n(n,u){var i=Math.sin(u*=Fa),o=Math.cos(u),a=va((n*=Fa)-t),c=Math.cos(a);$c+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;Bc.point=function(u,i){t=u*Fa,e=Math.sin(i*=Fa),r=Math.cos(i),Bc.point=n},Bc.lineEnd=function(){Bc.point=Bc.lineEnd=y}}function br(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function _r(n,t){function e(n,t){o>0?-ja+Ta>t&&(t=-ja+Ta):t>ja-Ta&&(t=ja-Ta);var e=o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(Da/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=G(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-ja]},e):Sr}function wr(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return va(u)<Ta?ar:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-G(u)*Math.sqrt(n*n+e*e)]},e)}function Sr(n,t){return[n,Math.log(Math.tan(Da/4+t/2))]}function kr(n){var t,e=ur(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=Da*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function Er(n,t){return[Math.log(Math.tan(Da/4+t/2)),-n]}function Ar(n){return n[0]}function Nr(n){return n[1]}function Cr(n){for(var t=n.length,e=[0,1],r=2,u=2;t>u;u++){for(;r>1&&K(n[e[r-2]],n[e[r-1]],n[u])<=0;)--r;e[r++]=u}return e.slice(0,r)}function zr(n,t){return n[0]-t[0]||n[1]-t[1]}function qr(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Lr(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],l=e[1],s=t[1]-c,f=r[1]-l,h=(a*(c-l)-f*(u-i))/(f*o-a*s);return[u+h*o,c+h*s]}function Tr(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function Rr(){tu(this),this.edge=this.site=this.circle=null}function Dr(n){var t=ol.pop()||new Rr;return t.site=n,t}function Pr(n){Xr(n),rl.remove(n),ol.push(n),tu(n)}function Ur(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,o=n.N,a=[n];Pr(n);for(var c=i;c.circle&&va(e-c.circle.x)<Ta&&va(r-c.circle.cy)<Ta;)i=c.P,a.unshift(c),Pr(c),c=i;a.unshift(c),Xr(c);for(var l=o;l.circle&&va(e-l.circle.x)<Ta&&va(r-l.circle.cy)<Ta;)o=l.N,a.push(l),Pr(l),l=o;a.push(l),Xr(l);var s,f=a.length;for(s=1;f>s;++s)l=a[s],c=a[s-1],Kr(l.edge,c.site,l.site,u);c=a[0],l=a[f-1],l.edge=Jr(c.site,l.site,null,u),Vr(c),Vr(l)}function jr(n){for(var t,e,r,u,i=n.x,o=n.y,a=rl._;a;)if(r=Fr(a,o)-i,r>Ta)a=a.L;else{if(u=i-Hr(a,o),!(u>Ta)){r>-Ta?(t=a.P,e=a):u>-Ta?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var c=Dr(n);if(rl.insert(t,c),t||e){if(t===e)return Xr(t),e=Dr(t.site),rl.insert(c,e),c.edge=e.edge=Jr(t.site,c.site),Vr(t),Vr(e),void 0;if(!e)return c.edge=Jr(t.site,c.site),void 0;Xr(t),Xr(e);var l=t.site,s=l.x,f=l.y,h=n.x-s,g=n.y-f,p=e.site,v=p.x-s,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,M=v*v+d*d,x={x:(d*y-g*M)/m+s,y:(h*M-v*y)/m+f};Kr(e.edge,l,p,x),c.edge=Jr(l,n,null,x),e.edge=Jr(n,p,null,x),Vr(t),Vr(e)}}function Fr(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var o=n.P;if(!o)return-1/0;e=o.site;var a=e.x,c=e.y,l=c-t;if(!l)return a;var s=a-r,f=1/i-1/l,h=s/l;return f?(-h+Math.sqrt(h*h-2*f*(s*s/(-2*l)-c+l/2+u-i/2)))/f+r:(r+a)/2}function Hr(n,t){var e=n.N;if(e)return Fr(e,t);var r=n.site;return r.y===t?r.x:1/0}function Or(n){this.site=n,this.edges=[]}function Yr(n){for(var t,e,r,u,i,o,a,c,l,s,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=el,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(a=i.edges,c=a.length,o=0;c>o;)s=a[o].end(),r=s.x,u=s.y,l=a[++o%c].start(),t=l.x,e=l.y,(va(r-t)>Ta||va(u-e)>Ta)&&(a.splice(o,0,new Qr(Gr(i.site,s,va(r-f)<Ta&&p-u>Ta?{x:f,y:va(t-f)<Ta?e:p}:va(u-p)<Ta&&h-r>Ta?{x:va(e-p)<Ta?t:h,y:p}:va(r-h)<Ta&&u-g>Ta?{x:h,y:va(t-h)<Ta?e:g}:va(u-g)<Ta&&r-f>Ta?{x:va(e-g)<Ta?t:f,y:g}:null),i.site,null)),++c)}function Ir(n,t){return t.angle-n.angle}function Zr(){tu(this),this.x=this.y=this.arc=this.site=this.cy=null}function Vr(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var o=u.x,a=u.y,c=r.x-o,l=r.y-a,s=i.x-o,f=i.y-a,h=2*(c*f-l*s);if(!(h>=-Ra)){var g=c*c+l*l,p=s*s+f*f,v=(f*g-l*p)/h,d=(c*p-s*g)/h,f=d+a,m=al.pop()||new Zr;m.arc=n,m.site=u,m.x=v+o,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,M=il._;M;)if(m.y<M.y||m.y===M.y&&m.x<=M.x){if(!M.L){y=M.P;break}M=M.L}else{if(!M.R){y=M;break}M=M.R}il.insert(y,m),y||(ul=m)}}}}function Xr(n){var t=n.circle;t&&(t.P||(ul=t.N),il.remove(t),al.push(t),tu(t),n.circle=null)}function $r(n){for(var t,e=tl,r=Oe(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!Br(t,n)||!r(t)||va(t.a.x-t.b.x)<Ta&&va(t.a.y-t.b.y)<Ta)&&(t.a=t.b=null,e.splice(u,1))}function Br(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,o=t[0][0],a=t[1][0],c=t[0][1],l=t[1][1],s=n.l,f=n.r,h=s.x,g=s.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(o>d||d>=a)return;if(h>p){if(i){if(i.y>=l)return}else i={x:d,y:c};e={x:d,y:l}}else{if(i){if(i.y<c)return}else i={x:d,y:l};e={x:d,y:c}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=l)return}else i={x:(c-u)/r,y:c};e={x:(l-u)/r,y:l}}else{if(i){if(i.y<c)return}else i={x:(l-u)/r,y:l};e={x:(c-u)/r,y:c}}else if(v>g){if(i){if(i.x>=a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}else{if(i){if(i.x<o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}return n.a=i,n.b=e,!0}function Wr(n,t){this.l=n,this.r=t,this.a=this.b=null}function Jr(n,t,e,r){var u=new Wr(n,t);return tl.push(u),e&&Kr(u,n,t,e),r&&Kr(u,t,n,r),el[n.i].edges.push(new Qr(u,n,t)),el[t.i].edges.push(new Qr(u,t,n)),u}function Gr(n,t,e){var r=new Wr(n,null);return r.a=t,r.b=e,tl.push(r),r}function Kr(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function Qr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function nu(){this._=null}function tu(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function eu(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function ru(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function uu(n){for(;n.L;)n=n.L;return n}function iu(n,t){var e,r,u,i=n.sort(ou).pop();for(tl=[],el=new Array(n.length),rl=new nu,il=new nu;;)if(u=ul,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(el[i.i]=new Or(i),jr(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;Ur(u.arc)}t&&($r(t),Yr(t));var o={cells:el,edges:tl};return rl=il=tl=el=null,o}function ou(n,t){return t.y-n.y||t.x-n.x}function au(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function cu(n){return n.x}function lu(n){return n.y}function su(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fu(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=.5*(e+u),a=.5*(r+i),c=t.nodes;c[0]&&fu(n,c[0],e,r,o,a),c[1]&&fu(n,c[1],o,r,u,a),c[2]&&fu(n,c[2],e,a,o,i),c[3]&&fu(n,c[3],o,a,u,i)}}function hu(n,t,e,r,u,i,o){var a,c=1/0;return function l(n,s,f,h,g){if(!(s>i||f>o||r>h||u>g)){if(p=n.point){var p,v=t-p[0],d=e-p[1],m=v*v+d*d;if(c>m){var y=Math.sqrt(c=m);r=t-y,u=e-y,i=t+y,o=e+y,a=p}}for(var M=n.nodes,x=.5*(s+h),b=.5*(f+g),_=t>=x,w=e>=b,S=w<<1|_,k=S+4;k>S;++S)if(n=M[3&S])switch(3&S){case 0:l(n,s,f,x,b);break;case 1:l(n,x,f,h,b);break;case 2:l(n,s,b,x,g);break;case 3:l(n,x,b,h,g)}}}(n,r,u,i,o),a}function gu(n,t){n=ta.rgb(n),t=ta.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+Mt(Math.round(e+i*n))+Mt(Math.round(r+o*n))+Mt(Math.round(u+a*n))}}function pu(n,t){var e,r={},u={};for(e in n)e in t?r[e]=mu(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function vu(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function du(n,t){var e,r,u,i=ll.lastIndex=sl.lastIndex=0,o=-1,a=[],c=[];for(n+="",t+="";(e=ll.exec(n))&&(r=sl.exec(t));)(u=r.index)>i&&(u=t.slice(i,u),a[o]?a[o]+=u:a[++o]=u),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:vu(e,r)})),i=sl.lastIndex;return i<t.length&&(u=t.slice(i),a[o]?a[o]+=u:a[++o]=u),a.length<2?c[0]?(t=c[0].x,function(n){return t(n)+""}):function(){return t}:(t=c.length,function(n){for(var e,r=0;t>r;++r)a[(e=c[r]).i]=e.x(n);return a.join("")})}function mu(n,t){for(var e,r=ta.interpolators.length;--r>=0&&!(e=ta.interpolators[r](n,t)););return e}function yu(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(mu(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;o>e;++e)u[e]=t[e];return function(n){for(e=0;a>e;++e)u[e]=r[e](n);return u}}function Mu(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function xu(n){return function(t){return 1-n(1-t)}}function bu(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function _u(n){return n*n}function wu(n){return n*n*n}function Su(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function ku(n){return function(t){return Math.pow(t,n)}}function Eu(n){return 1-Math.cos(n*ja)}function Au(n){return Math.pow(2,10*(n-1))}function Nu(n){return 1-Math.sqrt(1-n*n)}function Cu(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/Pa*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*Pa/t)}}function zu(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function qu(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Lu(n,t){n=ta.hcl(n),t=ta.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return lt(e+i*n,r+o*n,u+a*n)+""}}function Tu(n,t){n=ta.hsl(n),t=ta.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return at(e+i*n,r+o*n,u+a*n)+""}}function Ru(n,t){n=ta.lab(n),t=ta.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return ft(e+i*n,r+o*n,u+a*n)+""}}function Du(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Pu(n){var t=[n.a,n.b],e=[n.c,n.d],r=ju(t),u=Uu(t,e),i=ju(Fu(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Ha,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Ha:0}function Uu(n,t){return n[0]*t[0]+n[1]*t[1]}function ju(n){var t=Math.sqrt(Uu(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Fu(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Hu(n,t){var e,r=[],u=[],i=ta.transform(n),o=ta.transform(t),a=i.translate,c=o.translate,l=i.rotate,s=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:vu(a[0],c[0])},{i:3,x:vu(a[1],c[1])})):c[0]||c[1]?r.push("translate("+c+")"):r.push(""),l!=s?(l-s>180?s+=360:s-l>180&&(l+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:vu(l,s)})):s&&r.push(r.pop()+"rotate("+s+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:vu(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:vu(g[0],p[0])},{i:e-2,x:vu(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function Ou(n,t){return t=(t-=n=+n)||1/t,function(e){return(e-n)/t}}function Yu(n,t){return t=(t-=n=+n)||1/t,function(e){return Math.max(0,Math.min(1,(e-n)/t))}}function Iu(n){for(var t=n.source,e=n.target,r=Vu(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function Zu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Vu(n,t){if(n===t)return n;for(var e=Zu(n),r=Zu(t),u=e.pop(),i=r.pop(),o=null;u===i;)o=u,u=e.pop(),i=r.pop();return o}function Xu(n){n.fixed|=2}function $u(n){n.fixed&=-7}function Bu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function Wu(n){n.fixed&=-5}function Ju(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,o=n.nodes,a=o.length,c=-1;++c<a;)i=o[c],null!=i&&(Ju(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var l=t*e[n.point.index];n.charge+=n.pointCharge=l,r+=l*n.point.x,u+=l*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function Gu(n,t){return ta.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=ri,n}function Ku(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(u=n.children)&&(r=u.length))for(var r,u;--r>=0;)e.push(u[r])}function Qu(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(i=n.children)&&(u=i.length))for(var u,i,o=-1;++o<u;)e.push(i[o]);for(;null!=(n=r.pop());)t(n)}function ni(n){return n.children}function ti(n){return n.value}function ei(n,t){return t.value-n.value}function ri(n){return ta.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function ui(n){return n.x}function ii(n){return n.y}function oi(n,t,e){n.y0=t,n.y=e}function ai(n){return ta.range(n.length)}function ci(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function li(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function si(n){return n.reduce(fi,0)}function fi(n,t){return n+t[1]}function hi(n,t){return gi(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function gi(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function pi(n){return[ta.min(n),ta.max(n)]}function vi(n,t){return n.value-t.value}function di(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function mi(n,t){n._pack_next=t,t._pack_prev=n}function yi(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function Mi(n){function t(n){s=Math.min(n.x-n.r,s),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(l=e.length)){var e,r,u,i,o,a,c,l,s=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(xi),r=e[0],r.x=-r.r,r.y=0,t(r),l>1&&(u=e[1],u.x=u.r,u.y=0,t(u),l>2))for(i=e[2],wi(r,u,i),t(i),di(r,i),r._pack_prev=i,di(i,u),u=r._pack_next,o=3;l>o;o++){wi(r,u,i=e[o]);var p=0,v=1,d=1;for(a=u._pack_next;a!==u;a=a._pack_next,v++)if(yi(a,i)){p=1;break}if(1==p)for(c=r._pack_prev;c!==a._pack_prev&&!yi(c,i);c=c._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?mi(r,u=a):mi(r=c,u),o--):(di(r,i),u=i,t(i))}var m=(s+f)/2,y=(h+g)/2,M=0;for(o=0;l>o;o++)i=e[o],i.x-=m,i.y-=y,M=Math.max(M,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=M,e.forEach(bi)}}function xi(n){n._pack_next=n._pack_prev=n}function bi(n){delete n._pack_next,delete n._pack_prev}function _i(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,o=u.length;++i<o;)_i(u[i],t,e,r)}function wi(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=.5+(r-o)/(2*a),l=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+l*i,e.y=n.y+c*i-l*u}else e.x=n.x+r,e.y=n.y}function Si(n,t){return n.parent==t.parent?1:2}function ki(n){var t=n.children;return t.length?t[0]:n.t}function Ei(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function Ai(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function Ni(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Ci(n,t,e){return n.a.parent===t.parent?n.a:e}function zi(n){return 1+ta.max(n,function(n){return n.y})}function qi(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Li(n){var t=n.children;return t&&t.length?Li(t[0]):n}function Ti(n){var t,e=n.children;return e&&(t=e.length)?Ti(e[t-1]):n}function Ri(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Di(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Pi(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Ui(n){return n.rangeExtent?n.rangeExtent():Pi(n.range())}function ji(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Fi(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function Hi(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:bl}function Oi(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]));return function(t){var e=ta.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function Yi(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Oi:ji,c=r?Yu:Ou;return o=u(n,t,c,e),a=u(t,n,c,mu),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Du)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return Xi(n,t)},i.tickFormat=function(t,e){return $i(n,t,e)},i.nice=function(t){return Zi(n,t),u()},i.copy=function(){return Yi(n,t,e,r)},u()}function Ii(n,t){return ta.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Zi(n,t){return Fi(n,Hi(Vi(n,t)[2]))}function Vi(n,t){null==t&&(t=10);var e=Pi(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function Xi(n,t){return ta.range.apply(ta,Vi(n,t))}function $i(n,t,e){var r=Vi(n,t);if(e){var u=lc.exec(e);if(u.shift(),"s"===u[8]){var i=ta.formatPrefix(Math.max(va(r[0]),va(r[1])));return u[7]||(u[7]="."+Bi(i.scale(r[2]))),u[8]="f",e=ta.format(u.join("")),function(n){return e(i.scale(n))+i.symbol}}u[7]||(u[7]="."+Wi(u[8],r)),e=u.join("")}else e=",."+Bi(r[2])+"f";return ta.format(e)}function Bi(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function Wi(n,t){var e=Bi(t[2]);return n in _l?Math.abs(e-Bi(Math.max(va(t[0]),va(t[1]))))+ +("e"!==n):e-2*("%"===n)}function Ji(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=Fi(r.map(u),e?Math:Sl);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=Pi(r),o=[],a=n[0],c=n[1],l=Math.floor(u(a)),s=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(s-l)){if(e){for(;s>l;l++)for(var h=1;f>h;h++)o.push(i(l)*h);o.push(i(l))}else for(o.push(i(l));l++<s;)for(var h=f-1;h>0;h--)o.push(i(l)*h);for(l=0;o[l]<a;l++);for(s=o.length;o[s-1]>c;s--);o=o.slice(l,s)}return o},o.tickFormat=function(n,t){if(!arguments.length)return wl;arguments.length<2?t=wl:"function"!=typeof t&&(t=ta.format(t));var r,a=Math.max(.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return Ji(n.copy(),t,e,r)},Ii(o,n)}function Gi(n,t,e){function r(t){return n(u(t))}var u=Ki(t),i=Ki(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return Xi(e,n)},r.tickFormat=function(n,t){return $i(e,n,t)},r.nice=function(n){return r.domain(Zi(e,n))},r.exponent=function(o){return arguments.length?(u=Ki(t=o),i=Ki(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return Gi(n.copy(),t,e)},Ii(r,n)}function Ki(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function Qi(n,t){function e(e){return i[((u.get(e)||("range"===t.t?u.set(e,n.push(e)):0/0))-1)%i.length]}function r(t,e){return ta.range(n.length).map(function(n){return t+e*n})}var u,i,o;return e.domain=function(r){if(!arguments.length)return n;n=[],u=new a;for(var i,o=-1,c=r.length;++o<c;)u.has(i=r[o])||u.set(i,n.push(i));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(i=n,o=0,t={t:"range",a:arguments},e):i},e.rangePoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=(c+l)/2,0):(l-c)/(n.length-1+a);return i=r(c+s*a/2,s),o=0,t={t:"rangePoints",a:arguments},e},e.rangeRoundPoints=function(u,a){arguments.length<2&&(a=0);var c=u[0],l=u[1],s=n.length<2?(c=l=Math.round((c+l)/2),0):0|(l-c)/(n.length-1+a);return i=r(c+Math.round(s*a/2+(l-c-(n.length-1+a)*s)/2),s),o=0,t={t:"rangeRoundPoints",a:arguments},e},e.rangeBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=(f-s)/(n.length-a+2*c);return i=r(s+h*c,h),l&&i.reverse(),o=h*(1-a),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,a,c){arguments.length<2&&(a=0),arguments.length<3&&(c=a);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=Math.floor((f-s)/(n.length-a+2*c));return i=r(s+Math.round((f-s-(n.length-a)*h)/2),h),l&&i.reverse(),o=Math.round(h*(1-a)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return o},e.rangeExtent=function(){return Pi(t.a[0])},e.copy=function(){return Qi(n,t)},e.domain(n)}function no(r,u){function i(){var n=0,t=u.length;for(a=[];++n<t;)a[n-1]=ta.quantile(r,n/t);return o}function o(n){return isNaN(n=+n)?void 0:u[ta.bisect(a,n)]}var a;return o.domain=function(u){return arguments.length?(r=u.map(t).filter(e).sort(n),i()):r},o.range=function(n){return arguments.length?(u=n,i()):u},o.quantiles=function(){return a},o.invertExtent=function(n){return n=u.indexOf(n),0>n?[0/0,0/0]:[n>0?a[n-1]:r[0],n<a.length?a[n]:r[r.length-1]]},o.copy=function(){return no(r,u)},i()}function to(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return to(n,t,e)},u()}function eo(n,t){function e(e){return e>=e?t[ta.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return eo(n,t)},e}function ro(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Xi(n,t)},t.tickFormat=function(t,e){return $i(n,t,e)},t.copy=function(){return ro(n)},t}function uo(){return 0}function io(n){return n.innerRadius}function oo(n){return n.outerRadius}function ao(n){return n.startAngle}function co(n){return n.endAngle}function lo(n){return n&&n.padAngle}function so(n,t,e,r){return(n-e)*t-(t-r)*n>0?0:1}function fo(n,t,e,r,u){var i=n[0]-t[0],o=n[1]-t[1],a=(u?r:-r)/Math.sqrt(i*i+o*o),c=a*o,l=-a*i,s=n[0]+c,f=n[1]+l,h=t[0]+c,g=t[1]+l,p=(s+h)/2,v=(f+g)/2,d=h-s,m=g-f,y=d*d+m*m,M=e-r,x=s*g-h*f,b=(0>m?-1:1)*Math.sqrt(M*M*y-x*x),_=(x*m-d*b)/y,w=(-x*d-m*b)/y,S=(x*m+d*b)/y,k=(-x*d+m*b)/y,E=_-p,A=w-v,N=S-p,C=k-v;return E*E+A*A>N*N+C*C&&(_=S,w=k),[[_-c,w-l],[_*e/M,w*e/M]]}function ho(n){function t(t){function o(){l.push("M",i(n(s),a))}for(var c,l=[],s=[],f=-1,h=t.length,g=kt(e),p=kt(r);++f<h;)u.call(this,c=t[f],f)?s.push([+g.call(this,c,f),+p.call(this,c,f)]):s.length&&(o(),s=[]);return s.length&&o(),l.length?l.join(""):null}var e=Ar,r=Nr,u=Ne,i=go,o=i.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=zl.get(n)||go).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function go(n){return n.join("L")}function po(n){return go(n)+"Z"}function vo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function mo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function yo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function Mo(n,t){return n.length<4?go(n):n[1]+_o(n.slice(1,-1),wo(n,t))}function xo(n,t){return n.length<3?go(n):n[0]+_o((n.push(n[0]),n),wo([n[n.length-2]].concat(n,[n[1]]),t))}function bo(n,t){return n.length<3?go(n):n[0]+_o(n,wo(n,t))}function _o(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return go(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var l=2;l<t.length;l++,c++)i=n[c],a=t[l],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}if(e){var s=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+s[0]+","+s[1]}return r}function wo(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;)e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])]);return r}function So(n){if(n.length<3)return go(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",No(Tl,o),",",No(Tl,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Co(c,o,a);return n.pop(),c.push("L",r),c.join("")}function ko(n){if(n.length<4)return go(n);for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;)t=n[r],i.push(t[0]),o.push(t[1]);for(e.push(No(Tl,i)+","+No(Tl,o)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),Co(e,i,o);return e.join("")}function Eo(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;)e=n[r%u],o.push(e[0]),a.push(e[1]);for(t=[No(Tl,o),",",No(Tl,a)],--r;++r<i;)e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Co(t,o,a);return t.join("")}function Ao(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,l=-1;++l<=e;)r=n[l],u=l/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c);return So(n)}function No(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Co(n,t,e){n.push("C",No(ql,t),",",No(ql,e),",",No(Ll,t),",",No(Ll,e),",",No(Tl,t),",",No(Tl,e))}function zo(n,t){return(t[1]-n[1])/(t[0]-n[0])}function qo(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=zo(u,i);++t<e;)r[t]=(o+(o=zo(u=i,i=n[t+1])))/2;return r[t]=o,r}function Lo(n){for(var t,e,r,u,i=[],o=qo(n),a=-1,c=n.length-1;++a<c;)t=zo(n[a],n[a+1]),va(t)<Ta?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r));for(a=-1;++a<=c;)u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0]);return i}function To(n){return n.length<3?go(n):n[0]+_o(n,Lo(n))}function Ro(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]-ja,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Do(n){function t(t){function c(){v.push("M",a(n(m),f),s,l(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,M=t.length,x=kt(e),b=kt(u),_=e===r?function(){return g}:kt(r),w=u===i?function(){return p}:kt(i);++y<M;)o.call(this,h=t[y],y)?(d.push([g=+x.call(this,h,y),p=+b.call(this,h,y)]),m.push([+_.call(this,h,y),+w.call(this,h,y)])):d.length&&(c(),d=[],m=[]);return d.length&&c(),v.length?v.join(""):null}var e=Ar,r=Ar,u=0,i=Nr,o=Ne,a=go,c=a.key,l=a,s="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=zl.get(n)||go).key,l=a.reverse||a,s=a.closed?"M":"L",t):c
},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Po(n){return n.radius}function Uo(n){return[n.x,n.y]}function jo(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]-ja;return[e*Math.cos(r),e*Math.sin(r)]}}function Fo(){return 64}function Ho(){return"circle"}function Oo(n){var t=Math.sqrt(n/Da);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Yo(n){return function(){var t,e;(t=this[n])&&(e=t[t.active])&&(--t.count?delete t[t.active]:delete this[n],t.active+=.5,e.event&&e.event.interrupt.call(this,this.__data__,e.index))}}function Io(n,t,e){return xa(n,Hl),n.namespace=t,n.id=e,n}function Zo(n,t,e,r){var u=n.id,i=n.namespace;return H(n,"function"==typeof e?function(n,o,a){n[i][u].tween.set(t,r(e.call(n,n.__data__,o,a)))}:(e=r(e),function(n){n[i][u].tween.set(t,e)}))}function Vo(n){return null==n&&(n=""),function(){this.textContent=n}}function Xo(n){return null==n?"__transition__":"__transition_"+n+"__"}function $o(n,t,e,r,u){var i=n[e]||(n[e]={active:0,count:0}),o=i[r];if(!o){var c=u.time;o=i[r]={tween:new a,time:c,delay:u.delay,duration:u.duration,ease:u.ease,index:t},u=null,++i.count,ta.timer(function(u){function a(e){if(i.active>r)return s();var u=i[i.active];u&&(--i.count,delete i[i.active],u.event&&u.event.interrupt.call(n,n.__data__,u.index)),i.active=r,o.event&&o.event.start.call(n,n.__data__,t),o.tween.forEach(function(e,r){(r=r.call(n,n.__data__,t))&&v.push(r)}),h=o.ease,f=o.duration,ta.timer(function(){return p.c=l(e||1)?Ne:l,1},0,c)}function l(e){if(i.active!==r)return 1;for(var u=e/f,a=h(u),c=v.length;c>0;)v[--c].call(n,a);return u>=1?(o.event&&o.event.end.call(n,n.__data__,t),s()):void 0}function s(){return--i.count?delete i[r]:delete n[e],1}var f,h,g=o.delay,p=oc,v=[];return p.t=g+c,u>=g?a(u-g):(p.c=a,void 0)},0,c)}}function Bo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate("+(isFinite(r)?r:e(n))+",0)"})}function Wo(n,t,e){n.attr("transform",function(n){var r=t(n);return"translate(0,"+(isFinite(r)?r:e(n))+")"})}function Jo(n){return n.toISOString()}function Go(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=ta.bisect(Wl,u);return i==Wl.length?[t.year,Vi(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/Wl[i-1]<Wl[i]/u?i-1:i]:[Kl,Vi(n,e)[2]]}return r.invert=function(t){return Ko(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Ko)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Ko(+e+1),t).length}var i=r.domain(),o=Pi(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(Fi(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Ko(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Ko(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Pi(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],Ko(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Go(n.copy(),t,e)},Ii(r,n)}function Ko(n){return new Date(n)}function Qo(n){return JSON.parse(n.responseText)}function na(n){var t=ua.createRange();return t.selectNode(ua.body),t.createContextualFragment(n.responseText)}var ta={version:"3.5.3"};Date.now||(Date.now=function(){return+new Date});var ea=[].slice,ra=function(n){return ea.call(n)},ua=document,ia=ua.documentElement,oa=window;try{ra(ia.childNodes)[0].nodeType}catch(aa){ra=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}try{ua.createElement("div").style.setProperty("opacity",0,"")}catch(ca){var la=oa.Element.prototype,sa=la.setAttribute,fa=la.setAttributeNS,ha=oa.CSSStyleDeclaration.prototype,ga=ha.setProperty;la.setAttribute=function(n,t){sa.call(this,n,t+"")},la.setAttributeNS=function(n,t,e){fa.call(this,n,t,e+"")},ha.setProperty=function(n,t,e){ga.call(this,n,t+"",e)}}ta.ascending=n,ta.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},ta.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},ta.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i;)if(null!=(r=n[u])&&r>=r){e=r;break}for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i;)if(null!=(r=t.call(n,n[u],u))&&r>=r){e=r;break}for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},ta.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o;)if(null!=(r=n[i])&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<o;)if(null!=(r=t.call(n,n[i],i))&&r>=r){e=u=r;break}for(;++i<o;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},ta.sum=function(n,t){var r,u=0,i=n.length,o=-1;if(1===arguments.length)for(;++o<i;)e(r=+n[o])&&(u+=r);else for(;++o<i;)e(r=+t.call(n,n[o],o))&&(u+=r);return u},ta.mean=function(n,r){var u,i=0,o=n.length,a=-1,c=o;if(1===arguments.length)for(;++a<o;)e(u=t(n[a]))?i+=u:--c;else for(;++a<o;)e(u=t(r.call(n,n[a],a)))?i+=u:--c;return c?i/c:void 0},ta.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},ta.median=function(r,u){var i,o=[],a=r.length,c=-1;if(1===arguments.length)for(;++c<a;)e(i=t(r[c]))&&o.push(i);else for(;++c<a;)e(i=t(u.call(r,r[c],c)))&&o.push(i);return o.length?ta.quantile(o.sort(n),.5):void 0},ta.variance=function(n,r){var u,i,o=n.length,a=0,c=0,l=-1,s=0;if(1===arguments.length)for(;++l<o;)e(u=t(n[l]))&&(i=u-a,a+=i/++s,c+=i*(u-a));else for(;++l<o;)e(u=t(r.call(n,n[l],l)))&&(i=u-a,a+=i/++s,c+=i*(u-a));return s>1?c/(s-1):void 0},ta.deviation=function(){var n=ta.variance.apply(this,arguments);return n?Math.sqrt(n):n};var pa=r(n);ta.bisectLeft=pa.left,ta.bisect=ta.bisectRight=pa.right,ta.bisector=function(t){return r(1===t.length?function(e,r){return n(t(e),r)}:t)},ta.shuffle=function(n,t,e){(i=arguments.length)<3&&(e=n.length,2>i&&(t=0));for(var r,u,i=e-t;i;)u=0|Math.random()*i--,r=n[i+t],n[i+t]=n[u+t],n[u+t]=r;return n},ta.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},ta.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},ta.zip=function(){if(!(r=arguments.length))return[];for(var n=-1,t=ta.min(arguments,u),e=new Array(t);++n<t;)for(var r,i=-1,o=e[n]=new Array(r);++i<r;)o[i]=arguments[i][n];return e},ta.transpose=function(n){return ta.zip.apply(ta,n)},ta.keys=function(n){var t=[];for(var e in n)t.push(e);return t},ta.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},ta.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},ta.merge=function(n){for(var t,e,r,u=n.length,i=-1,o=0;++i<u;)o+=n[i].length;for(e=new Array(o);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--o]=r[t];return e};var va=Math.abs;ta.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),1/0===(t-n)/e)throw new Error("infinite range");var r,u=[],o=i(va(e)),a=-1;if(n*=o,t*=o,e*=o,0>e)for(;(r=n+e*++a)>t;)u.push(r/o);else for(;(r=n+e*++a)<t;)u.push(r/o);return u},ta.map=function(n,t){var e=new a;if(n instanceof a)n.forEach(function(n,t){e.set(n,t)});else if(Array.isArray(n)){var r,u=-1,i=n.length;if(1===arguments.length)for(;++u<i;)e.set(u,n[u]);else for(;++u<i;)e.set(t.call(n,r=n[u],u),r)}else for(var o in n)e.set(o,n[o]);return e};var da="__proto__",ma="\x00";o(a,{has:s,get:function(n){return this._[c(n)]},set:function(n,t){return this._[c(n)]=t},remove:f,keys:h,values:function(){var n=[];for(var t in this._)n.push(this._[t]);return n},entries:function(){var n=[];for(var t in this._)n.push({key:l(t),value:this._[t]});return n},size:g,empty:p,forEach:function(n){for(var t in this._)n.call(this,l(t),this._[t])}}),ta.nest=function(){function n(t,o,c){if(c>=i.length)return r?r.call(u,o):e?o.sort(e):o;for(var l,s,f,h,g=-1,p=o.length,v=i[c++],d=new a;++g<p;)(h=d.get(l=v(s=o[g])))?h.push(s):d.set(l,[s]);return t?(s=t(),f=function(e,r){s.set(e,n(t,r,c))}):(s={},f=function(e,r){s[e]=n(t,r,c)}),d.forEach(f),s}function t(n,e){if(e>=i.length)return n;var r=[],u=o[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,u={},i=[],o=[];return u.map=function(t,e){return n(e,t,0)},u.entries=function(e){return t(n(ta.map,e,0),0)},u.key=function(n){return i.push(n),u},u.sortKeys=function(n){return o[i.length-1]=n,u},u.sortValues=function(n){return e=n,u},u.rollup=function(n){return r=n,u},u},ta.set=function(n){var t=new v;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},o(v,{has:s,add:function(n){return this._[c(n+="")]=!0,n},remove:f,values:h,size:g,empty:p,forEach:function(n){for(var t in this._)n.call(this,l(t))}}),ta.behavior={},ta.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=d(n,t,t[e]);return n};var ya=["webkit","ms","moz","Moz","o","O"];ta.dispatch=function(){for(var n=new M,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=x(n);return n},M.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},ta.event=null,ta.requote=function(n){return n.replace(Ma,"\\$&")};var Ma=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,xa={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},ba=function(n,t){return t.querySelector(n)},_a=function(n,t){return t.querySelectorAll(n)},wa=ia.matches||ia[m(ia,"matchesSelector")],Sa=function(n,t){return wa.call(n,t)};"function"==typeof Sizzle&&(ba=function(n,t){return Sizzle(n,t)[0]||null},_a=Sizzle,Sa=Sizzle.matchesSelector),ta.selection=function(){return Na};var ka=ta.selection.prototype=[];ka.select=function(n){var t,e,r,u,i=[];n=k(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,l=r.length;++c<l;)(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return S(i)},ka.selectAll=function(n){var t,e,r=[];n=E(n);for(var u=-1,i=this.length;++u<i;)for(var o=this[u],a=-1,c=o.length;++a<c;)(e=o[a])&&(r.push(t=ra(n.call(e,e.__data__,a,u))),t.parentNode=e);return S(r)};var Ea={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ta.ns={prefix:Ea,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.slice(0,t),n=n.slice(t+1)),Ea.hasOwnProperty(e)?{space:Ea[e],local:n}:n}},ka.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=ta.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(A(t,n[t]));return this}return this.each(A(n,t))},ka.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=z(n)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!C(n[u]).test(t))return!1;return!0}for(t in n)this.each(q(t,n[t]));return this}return this.each(q(n,t))},ka.style=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(e in n)this.each(T(e,n[e],t));return this}if(2>r)return oa.getComputedStyle(this.node(),null).getPropertyValue(n);e=""}return this.each(T(n,t,e))},ka.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(R(t,n[t]));return this}return this.each(R(n,t))},ka.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},ka.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},ka.append=function(n){return n=D(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},ka.insert=function(n,t){return n=D(n),t=k(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},ka.remove=function(){return this.each(P)},ka.data=function(n,t){function e(n,e){var r,u,i,o=n.length,f=e.length,h=Math.min(o,f),g=new Array(f),p=new Array(f),v=new Array(o);if(t){var d,m=new a,y=new Array(o);for(r=-1;++r<o;)m.has(d=t.call(u=n[r],u.__data__,r))?v[r]=u:m.set(d,u),y[r]=d;for(r=-1;++r<f;)(u=m.get(d=t.call(e,i=e[r],r)))?u!==!0&&(g[r]=u,u.__data__=i):p[r]=U(i),m.set(d,!0);for(r=-1;++r<o;)m.get(y[r])!==!0&&(v[r]=n[r])}else{for(r=-1;++r<h;)u=n[r],i=e[r],u?(u.__data__=i,g[r]=u):p[r]=U(i);for(;f>r;++r)p[r]=U(e[r]);for(;o>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,c.push(p),l.push(g),s.push(v)}var r,u,i=-1,o=this.length;if(!arguments.length){for(n=new Array(o=(r=this[0]).length);++i<o;)(u=r[i])&&(n[i]=u.__data__);return n}var c=O([]),l=S([]),s=S([]);if("function"==typeof n)for(;++i<o;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<o;)e(r=this[i],n);return l.enter=function(){return c},l.exit=function(){return s},l},ka.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},ka.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=j(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return S(u)},ka.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},ka.sort=function(n){n=F.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},ka.each=function(n){return H(this,function(t,e,r){n.call(t,t.__data__,e,r)})},ka.call=function(n){var t=ra(arguments);return n.apply(t[0]=this,t),this},ka.empty=function(){return!this.node()},ka.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},ka.size=function(){var n=0;return H(this,function(){++n}),n};var Aa=[];ta.selection.enter=O,ta.selection.enter.prototype=Aa,Aa.append=ka.append,Aa.empty=ka.empty,Aa.node=ka.node,Aa.call=ka.call,Aa.size=ka.size,Aa.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var l=-1,s=u.length;++l<s;)(i=u[l])?(t.push(r[l]=e=n.call(u.parentNode,i.__data__,l,a)),e.__data__=i.__data__):t.push(null)}return S(o)},Aa.insert=function(n,t){return arguments.length<2&&(t=Y(this)),ka.insert.call(this,n,t)},ta.select=function(n){var t=["string"==typeof n?ba(n,ua):n];return t.parentNode=ia,S([t])},ta.selectAll=function(n){var t=ra("string"==typeof n?_a(n,ua):n);return t.parentNode=ia,S([t])};var Na=ta.select(ia);ka.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(I(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(I(n,t,e))};var Ca=ta.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ca.forEach(function(n){"on"+n in ua&&Ca.remove(n)});var za="onselectstart"in ua?null:m(ia.style,"userSelect"),qa=0;ta.mouse=function(n){return $(n,_())};var La=/WebKit/.test(oa.navigator.userAgent)?-1:0;ta.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=_().changedTouches),t)for(var r,u=0,i=t.length;i>u;++u)if((r=t[u]).identifier===e)return $(n,r)},ta.behavior.drag=function(){function n(){this.on("mousedown.drag",u).on("touchstart.drag",i)}function t(n,t,u,i,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-M[0],e=r[1]-M[1],p|=n|e,M=r,g({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:n,dy:e}))}function c(){t(h,v)&&(m.on(i+d,null).on(o+d,null),y(p&&ta.event.target===f),g({type:"dragend"}))}var l,s=this,f=ta.event.target,h=s.parentNode,g=e.of(s,arguments),p=0,v=n(),d=".drag"+(null==v?"":"-"+v),m=ta.select(u()).on(i+d,a).on(o+d,c),y=X(),M=t(h,v);r?(l=r.apply(s,arguments),l=[l.x-M[0],l.y-M[1]]):l=[0,0],g({type:"dragstart"})}}var e=w(n,"drag","dragstart","dragend"),r=null,u=t(y,ta.mouse,J,"mousemove","mouseup"),i=t(B,ta.touch,W,"touchmove","touchend");return n.origin=function(t){return arguments.length?(r=t,n):r},ta.rebind(n,e,"on")},ta.touches=function(n,t){return arguments.length<2&&(t=_().touches),t?ra(t).map(function(t){var e=$(n,t);return e.identifier=t.identifier,e}):[]};var Ta=1e-6,Ra=Ta*Ta,Da=Math.PI,Pa=2*Da,Ua=Pa-Ta,ja=Da/2,Fa=Da/180,Ha=180/Da,Oa=Math.SQRT2,Ya=2,Ia=4;ta.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=et(v),o=i/(Ya*h)*(e*rt(Oa*t+v)-tt(v));return[r+o*l,u+o*s,i*e/et(Oa*t+v)]}return[r+n*l,u+n*s,i*Math.exp(Oa*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],l=o-r,s=a-u,f=l*l+s*s,h=Math.sqrt(f),g=(c*c-i*i+Ia*f)/(2*i*Ya*h),p=(c*c-i*i-Ia*f)/(2*c*Ya*h),v=Math.log(Math.sqrt(g*g+1)-g),d=Math.log(Math.sqrt(p*p+1)-p),m=d-v,y=(m||Math.log(c/i))/Oa;return e.duration=1e3*y,e},ta.behavior.zoom=function(){function n(n){n.on(z,s).on(Xa+".zoom",h).on("dblclick.zoom",g).on(T,f)}function t(n){return[(n[0]-k.x)/k.k,(n[1]-k.y)/k.k]}function e(n){return[n[0]*k.k+k.x,n[1]*k.k+k.y]}function r(n){k.k=Math.max(A[0],Math.min(A[1],n))}function u(n,t){t=e(t),k.x+=n[0]-t[0],k.y+=n[1]-t[1]}function i(t,e,i,o){t.__chart__={x:k.x,y:k.y,k:k.k},r(Math.pow(2,o)),u(v=e,i),t=ta.select(t),N>0&&(t=t.transition().duration(N)),t.call(n.event)}function o(){x&&x.domain(M.range().map(function(n){return(n-k.x)/k.k}).map(M.invert)),S&&S.domain(_.range().map(function(n){return(n-k.y)/k.k}).map(_.invert))}function a(n){C++||n({type:"zoomstart"})}function c(n){o(),n({type:"zoom",scale:k.k,translate:[k.x,k.y]})}function l(n){--C||n({type:"zoomend"}),v=null}function s(){function n(){s=1,u(ta.mouse(r),h),c(o)}function e(){f.on(q,null).on(L,null),g(s&&ta.event.target===i),l(o)}var r=this,i=ta.event.target,o=R.of(r,arguments),s=0,f=ta.select(oa).on(q,n).on(L,e),h=t(ta.mouse(r)),g=X();Fl.call(r),a(o)}function f(){function n(){var n=ta.touches(p);return g=k.k,n.forEach(function(n){n.identifier in d&&(d[n.identifier]=t(n))}),n}function e(){var t=ta.event.target;ta.select(t).on(x,o).on(_,h),w.push(t);for(var e=ta.event.changedTouches,r=0,u=e.length;u>r;++r)d[e[r].identifier]=null;var a=n(),c=Date.now();if(1===a.length){if(500>c-y){var l=a[0];i(p,l,d[l.identifier],Math.floor(Math.log(k.k)/Math.LN2)+1),b()}y=c}else if(a.length>1){var l=a[0],s=a[1],f=l[0]-s[0],g=l[1]-s[1];m=f*f+g*g}}function o(){var n,t,e,i,o=ta.touches(p);Fl.call(p);for(var a=0,l=o.length;l>a;++a,i=null)if(e=o[a],i=d[e.identifier]){if(t)break;n=e,t=i}if(i){var s=(s=e[0]-n[0])*s+(s=e[1]-n[1])*s,f=m&&Math.sqrt(s/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+i[0])/2,(t[1]+i[1])/2],r(f*g)}y=null,u(n,t),c(v)}function h(){if(ta.event.touches.length){for(var t=ta.event.changedTouches,e=0,r=t.length;r>e;++e)delete d[t[e].identifier];for(var u in d)return void n()}ta.selectAll(w).on(M,null),S.on(z,s).on(T,f),E(),l(v)}var g,p=this,v=R.of(p,arguments),d={},m=0,M=".zoom-"+ta.event.changedTouches[0].identifier,x="touchmove"+M,_="touchend"+M,w=[],S=ta.select(p),E=X();e(),a(v),S.on(z,null).on(T,e)}function h(){var n=R.of(this,arguments);m?clearTimeout(m):(p=t(v=d||ta.mouse(this)),Fl.call(this),a(n)),m=setTimeout(function(){m=null,l(n)},50),b(),r(Math.pow(2,.002*Za())*k.k),u(v,p),c(n)}function g(){var n=ta.mouse(this),e=Math.log(k.k)/Math.LN2;i(this,n,t(n),ta.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var p,v,d,m,y,M,x,_,S,k={x:0,y:0,k:1},E=[960,500],A=Va,N=250,C=0,z="mousedown.zoom",q="mousemove.zoom",L="mouseup.zoom",T="touchstart.zoom",R=w(n,"zoomstart","zoom","zoomend");return n.event=function(n){n.each(function(){var n=R.of(this,arguments),t=k;Ul?ta.select(this).transition().each("start.zoom",function(){k=this.__chart__||{x:0,y:0,k:1},a(n)}).tween("zoom:zoom",function(){var e=E[0],r=E[1],u=v?v[0]:e/2,i=v?v[1]:r/2,o=ta.interpolateZoom([(u-k.x)/k.k,(i-k.y)/k.k,e/k.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),a=e/r[2];this.__chart__=k={x:u-r[0]*a,y:i-r[1]*a,k:a},c(n)}}).each("interrupt.zoom",function(){l(n)}).each("end.zoom",function(){l(n)}):(this.__chart__=k,a(n),c(n),l(n))})},n.translate=function(t){return arguments.length?(k={x:+t[0],y:+t[1],k:k.k},o(),n):[k.x,k.y]},n.scale=function(t){return arguments.length?(k={x:k.x,y:k.y,k:+t},o(),n):k.k},n.scaleExtent=function(t){return arguments.length?(A=null==t?Va:[+t[0],+t[1]],n):A},n.center=function(t){return arguments.length?(d=t&&[+t[0],+t[1]],n):d},n.size=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],n):E},n.duration=function(t){return arguments.length?(N=+t,n):N},n.x=function(t){return arguments.length?(x=t,M=t.copy(),k={x:0,y:0,k:1},n):x},n.y=function(t){return arguments.length?(S=t,_=t.copy(),k={x:0,y:0,k:1},n):S},ta.rebind(n,R,"on")};var Za,Va=[0,1/0],Xa="onwheel"in ua?(Za=function(){return-ta.event.deltaY*(ta.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ua?(Za=function(){return ta.event.wheelDelta},"mousewheel"):(Za=function(){return-ta.event.detail},"MozMousePixelScroll");ta.color=it,it.prototype.toString=function(){return this.rgb()+""},ta.hsl=ot;var $a=ot.prototype=new it;$a.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new ot(this.h,this.s,this.l/n)},$a.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new ot(this.h,this.s,n*this.l)},$a.rgb=function(){return at(this.h,this.s,this.l)},ta.hcl=ct;var Ba=ct.prototype=new it;Ba.brighter=function(n){return new ct(this.h,this.c,Math.min(100,this.l+Wa*(arguments.length?n:1)))},Ba.darker=function(n){return new ct(this.h,this.c,Math.max(0,this.l-Wa*(arguments.length?n:1)))},Ba.rgb=function(){return lt(this.h,this.c,this.l).rgb()},ta.lab=st;var Wa=18,Ja=.95047,Ga=1,Ka=1.08883,Qa=st.prototype=new it;Qa.brighter=function(n){return new st(Math.min(100,this.l+Wa*(arguments.length?n:1)),this.a,this.b)},Qa.darker=function(n){return new st(Math.max(0,this.l-Wa*(arguments.length?n:1)),this.a,this.b)},Qa.rgb=function(){return ft(this.l,this.a,this.b)},ta.rgb=dt;var nc=dt.prototype=new it;nc.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),new dt(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new dt(u,u,u)},nc.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new dt(n*this.r,n*this.g,n*this.b)},nc.hsl=function(){return bt(this.r,this.g,this.b)},nc.toString=function(){return"#"+Mt(this.r)+Mt(this.g)+Mt(this.b)};var tc=ta.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});tc.forEach(function(n,t){tc.set(n,mt(t))}),ta.functor=kt,ta.xhr=At(Et),ta.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=Nt(n,t,null==e?r:u(e),i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function i(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),c=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(s>=l)return o;if(u)return u=!1,i;var t=s;if(34===n.charCodeAt(t)){for(var e=t;e++<l;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}s=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++s):10===r&&(u=!0),n.slice(t+1,e).replace(/""/g,'"')}for(;l>s;){var r=n.charCodeAt(s++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(s)&&(++s,++a);else if(r!==c)continue;return n.slice(t,s-a)}return n.slice(t)}for(var r,u,i={},o={},a=[],l=n.length,s=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;)h.push(r),r=e();t&&null==(h=t(h,f++))||a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new v,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(o).join(n)].concat(t.map(function(t){return u.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(i).join("\n")},e},ta.csv=ta.dsv(",","text/csv"),ta.tsv=ta.dsv("	","text/tab-separated-values");var ec,rc,uc,ic,oc,ac=oa[m(oa,"requestAnimationFrame")]||function(n){setTimeout(n,17)};ta.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,f:!1,n:null};rc?rc.n=i:ec=i,rc=i,uc||(ic=clearTimeout(ic),uc=1,ac(qt))},ta.timer.flush=function(){Lt(),Tt()},ta.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var cc=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Dt);ta.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=ta.round(n,Rt(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),cc[8+e/3]};var lc=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,sc=ta.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=ta.round(n,Rt(n,t))).toFixed(Math.max(0,Math.min(20,Rt(n*(1+1e-15),t))))}}),fc=ta.time={},hc=Date;jt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){gc.setUTCDate.apply(this._,arguments)},setDay:function(){gc.setUTCDay.apply(this._,arguments)},setFullYear:function(){gc.setUTCFullYear.apply(this._,arguments)},setHours:function(){gc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){gc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){gc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){gc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){gc.setUTCSeconds.apply(this._,arguments)},setTime:function(){gc.setTime.apply(this._,arguments)}};var gc=Date.prototype;fc.year=Ft(function(n){return n=fc.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),fc.years=fc.year.range,fc.years.utc=fc.year.utc.range,fc.day=Ft(function(n){var t=new hc(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),fc.days=fc.day.range,fc.days.utc=fc.day.utc.range,fc.dayOfYear=function(n){var t=fc.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=fc[n]=Ft(function(n){return(n=fc.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=fc.year(n).getDay();return Math.floor((fc.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});fc[n+"s"]=e.range,fc[n+"s"].utc=e.utc.range,fc[n+"OfYear"]=function(n){var e=fc.year(n).getDay();return Math.floor((fc.dayOfYear(n)+(e+t)%7)/7)}}),fc.week=fc.sunday,fc.weeks=fc.sunday.range,fc.weeks.utc=fc.sunday.utc.range,fc.weekOfYear=fc.sundayOfYear;var pc={"-":"",_:" ",0:"0"},vc=/^\s*\d+/,dc=/^%/;ta.locale=function(n){return{numberFormat:Pt(n),timeFormat:Ot(n)}};var mc=ta.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ta.format=mc.numberFormat,ta.geo={},ce.prototype={s:0,t:0,add:function(n){le(n,this.t,yc),le(yc.s,this.s,this),this.s?this.t+=yc.t:this.s=yc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var yc=new ce;ta.geo.stream=function(n,t){n&&Mc.hasOwnProperty(n.type)?Mc[n.type](n,t):se(n,t)};var Mc={Feature:function(n,t){se(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)se(e[r].geometry,t)}},xc={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])
},LineString:function(n,t){fe(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)fe(e[r],t,0)},Polygon:function(n,t){he(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)he(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)se(e[r],t)}};ta.geo.area=function(n){return bc=0,ta.geo.stream(n,wc),bc};var bc,_c=new ce,wc={sphere:function(){bc+=4*Da},point:y,lineStart:y,lineEnd:y,polygonStart:function(){_c.reset(),wc.lineStart=ge},polygonEnd:function(){var n=2*_c;bc+=0>n?4*Da+n:n,wc.lineStart=wc.lineEnd=wc.point=y}};ta.geo.bounds=function(){function n(n,t){M.push(x=[s=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=pe([t*Fa,e*Fa]);if(m){var u=de(m,r),i=[u[1],-u[0],0],o=de(i,u);Me(o),o=xe(o);var c=t-p,l=c>0?1:-1,v=o[0]*Ha*l,d=va(c)>180;if(d^(v>l*p&&l*t>v)){var y=o[1]*Ha;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>l*p&&l*t>v)){var y=-o[1]*Ha;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t):h>=s?(s>t&&(s=t),t>h&&(h=t)):t>p?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t)}else n(t,e);m=r,p=t}function e(){b.point=t}function r(){x[0]=s,x[1]=h,b.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=va(r)>180?r+(r>0?360:-360):r}else v=n,d=e;wc.point(n,e),t(n,e)}function i(){wc.lineStart()}function o(){u(v,d),wc.lineEnd(),va(y)>Ta&&(s=-(h=180)),x[0]=s,x[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var s,f,h,g,p,v,d,m,y,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=u,b.lineStart=i,b.lineEnd=o,y=0,wc.polygonStart()},polygonEnd:function(){wc.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>_c?(s=-(h=180),f=-(g=90)):y>Ta?g=90:-Ta>y&&(f=-90),x[0]=s,x[1]=h}};return function(n){g=h=-(s=f=1/0),M=[],ta.geo.stream(n,b);var t=M.length;if(t){M.sort(c);for(var e,r=1,u=M[0],i=[u];t>r;++r)e=M[r],l(e[0],u)||l(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(o=a(u[1],e[0]))>p&&(p=o,s=e[0],h=u[1])}return M=x=null,1/0===s||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[s,f],[h,g]]}}(),ta.geo.centroid=function(n){Sc=kc=Ec=Ac=Nc=Cc=zc=qc=Lc=Tc=Rc=0,ta.geo.stream(n,Dc);var t=Lc,e=Tc,r=Rc,u=t*t+e*e+r*r;return Ra>u&&(t=Cc,e=zc,r=qc,Ta>kc&&(t=Ec,e=Ac,r=Nc),u=t*t+e*e+r*r,Ra>u)?[0/0,0/0]:[Math.atan2(e,t)*Ha,nt(r/Math.sqrt(u))*Ha]};var Sc,kc,Ec,Ac,Nc,Cc,zc,qc,Lc,Tc,Rc,Dc={sphere:y,point:_e,lineStart:Se,lineEnd:ke,polygonStart:function(){Dc.lineStart=Ee},polygonEnd:function(){Dc.lineStart=Se}},Pc=Le(Ne,Pe,je,[-Da,-Da/2]),Uc=1e9;ta.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=Ye(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(ta.geo.conicEqualArea=function(){return Ie(Ze)}).raw=Ze,ta.geo.albers=function(){return ta.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ta.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=ta.geo.albers(),o=ta.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ta.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?o:u>=.166&&.234>u&&r>=-.214&&-.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var l=i.scale(),s=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[s-.455*l,f-.238*l],[s+.455*l,f+.238*l]]).stream(c).point,r=o.translate([s-.307*l,f+.201*l]).clipExtent([[s-.425*l+Ta,f+.12*l+Ta],[s-.214*l-Ta,f+.234*l-Ta]]).stream(c).point,u=a.translate([s-.205*l,f+.212*l]).clipExtent([[s-.214*l+Ta,f+.166*l+Ta],[s-.115*l-Ta,f+.234*l-Ta]]).stream(c).point,n},n.scale(1070)};var jc,Fc,Hc,Oc,Yc,Ic,Zc={point:y,lineStart:y,lineEnd:y,polygonStart:function(){Fc=0,Zc.lineStart=Ve},polygonEnd:function(){Zc.lineStart=Zc.lineEnd=Zc.point=y,jc+=va(Fc/2)}},Vc={point:Xe,lineStart:y,lineEnd:y,polygonStart:y,polygonEnd:y},Xc={point:We,lineStart:Je,lineEnd:Ge,polygonStart:function(){Xc.lineStart=Ke},polygonEnd:function(){Xc.point=We,Xc.lineStart=Je,Xc.lineEnd=Ge}};ta.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),ta.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return jc=0,ta.geo.stream(n,u(Zc)),jc},n.centroid=function(n){return Ec=Ac=Nc=Cc=zc=qc=Lc=Tc=Rc=0,ta.geo.stream(n,u(Xc)),Rc?[Lc/Rc,Tc/Rc]:qc?[Cc/qc,zc/qc]:Nc?[Ec/Nc,Ac/Nc]:[0/0,0/0]},n.bounds=function(n){return Yc=Ic=-(Hc=Oc=1/0),ta.geo.stream(n,u(Vc)),[[Hc,Oc],[Yc,Ic]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||tr(n):Et,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new $e:new Qe(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(ta.geo.albersUsa()).context(null)},ta.geo.transform=function(n){return{stream:function(t){var e=new er(t);for(var r in n)e[r]=n[r];return e}}},er.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ta.geo.projection=ur,ta.geo.projectionMutator=ir,(ta.geo.equirectangular=function(){return ur(ar)}).raw=ar.invert=ar,ta.geo.rotation=function(n){function t(t){return t=n(t[0]*Fa,t[1]*Fa),t[0]*=Ha,t[1]*=Ha,t}return n=lr(n[0]%360*Fa,n[1]*Fa,n.length>2?n[2]*Fa:0),t.invert=function(t){return t=n.invert(t[0]*Fa,t[1]*Fa),t[0]*=Ha,t[1]*=Ha,t},t},cr.invert=ar,ta.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=lr(-n[0]*Fa,-n[1]*Fa,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Ha,n[1]*=Ha}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=gr((t=+r)*Fa,u*Fa),n):t},n.precision=function(r){return arguments.length?(e=gr(t*Fa,(u=+r)*Fa),n):u},n.angle(90)},ta.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Fa,u=n[1]*Fa,i=t[1]*Fa,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),l=Math.cos(u),s=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=l*s-c*f*a)*e),c*s+l*f*a)},ta.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return ta.range(Math.ceil(i/d)*d,u,d).map(h).concat(ta.range(Math.ceil(l/m)*m,c,m).map(g)).concat(ta.range(Math.ceil(r/p)*p,e,p).filter(function(n){return va(n%d)>Ta}).map(s)).concat(ta.range(Math.ceil(a/v)*v,o,v).filter(function(n){return va(n%m)>Ta}).map(f))}var e,r,u,i,o,a,c,l,s,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(l).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],l=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),l>c&&(t=l,l=c,c=t),n.precision(y)):[[i,l],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,s=vr(a,o,90),f=dr(r,e,y),h=vr(l,c,90),g=dr(i,u,y),n):y},n.majorExtent([[-180,-90+Ta],[180,90-Ta]]).minorExtent([[-180,-80-Ta],[180,80+Ta]])},ta.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=mr,u=yr;return n.distance=function(){return ta.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},ta.geo.interpolate=function(n,t){return Mr(n[0]*Fa,n[1]*Fa,t[0]*Fa,t[1]*Fa)},ta.geo.length=function(n){return $c=0,ta.geo.stream(n,Bc),$c};var $c,Bc={sphere:y,point:y,lineStart:xr,lineEnd:y,polygonStart:y,polygonEnd:y},Wc=br(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(ta.geo.azimuthalEqualArea=function(){return ur(Wc)}).raw=Wc;var Jc=br(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},Et);(ta.geo.azimuthalEquidistant=function(){return ur(Jc)}).raw=Jc,(ta.geo.conicConformal=function(){return Ie(_r)}).raw=_r,(ta.geo.conicEquidistant=function(){return Ie(wr)}).raw=wr;var Gc=br(function(n){return 1/n},Math.atan);(ta.geo.gnomonic=function(){return ur(Gc)}).raw=Gc,Sr.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-ja]},(ta.geo.mercator=function(){return kr(Sr)}).raw=Sr;var Kc=br(function(){return 1},Math.asin);(ta.geo.orthographic=function(){return ur(Kc)}).raw=Kc;var Qc=br(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(ta.geo.stereographic=function(){return ur(Qc)}).raw=Qc,Er.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-ja]},(ta.geo.transverseMercator=function(){var n=kr(Er),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=Er,ta.geom={},ta.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u=kt(e),i=kt(r),o=n.length,a=[],c=[];for(t=0;o>t;t++)a.push([+u.call(this,n[t],t),+i.call(this,n[t],t),t]);for(a.sort(zr),t=0;o>t;t++)c.push([a[t][0],-a[t][1]]);var l=Cr(a),s=Cr(c),f=s[0]===l[0],h=s[s.length-1]===l[l.length-1],g=[];for(t=l.length-1;t>=0;--t)g.push(n[a[l[t]][2]]);for(t=+f;t<s.length-h;++t)g.push(n[a[s[t]][2]]);return g}var e=Ar,r=Nr;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},ta.geom.polygon=function(n){return xa(n,nl),n};var nl=ta.geom.polygon.prototype=[];nl.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},nl.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[i*n,o*n]},nl.clip=function(n){for(var t,e,r,u,i,o,a=Tr(n),c=-1,l=this.length-Tr(this),s=this[l-1];++c<l;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],qr(o,s,u)?(qr(i,s,u)||n.push(Lr(i,o,s,u)),n.push(o)):qr(i,s,u)&&n.push(Lr(i,o,s,u)),i=o;a&&n.push(n[0]),s=u}return n};var tl,el,rl,ul,il,ol=[],al=[];Or.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Ir),t.length},Qr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},nu.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=uu(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(eu(this,e),n=e,e=n.U),e.C=!1,r.C=!0,ru(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(ru(this,e),n=e,e=n.U),e.C=!1,r.C=!0,eu(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,o=n.R;if(e=i?o?uu(o):i:o,u?u.L===n?u.L=e:u.R=e:this._=e,i&&o?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==o?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=o,o.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return n.C=!1,void 0;do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,eu(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,ru(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,eu(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,ru(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,eu(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,ru(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},ta.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],u=a[0][1],i=a[1][0],o=a[1][1];return iu(e(n),a).cells.forEach(function(e,a){var c=e.edges,l=e.site,s=t[a]=c.length?c.map(function(n){var t=n.start();return[t.x,t.y]}):l.x>=r&&l.x<=i&&l.y>=u&&l.y<=o?[[r,o],[i,o],[i,u],[r,u]]:[];s.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/Ta)*Ta,y:Math.round(o(n,t)/Ta)*Ta,i:t}})}var r=Ar,u=Nr,i=r,o=u,a=cl;return n?t(n):(t.links=function(n){return iu(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return iu(e(n)).cells.forEach(function(e,r){for(var u,i,o=e.site,a=e.edges.sort(Ir),c=-1,l=a.length,s=a[l-1].edge,f=s.l===o?s.r:s.l;++c<l;)u=s,i=f,s=a[c].edge,f=s.l===o?s.r:s.l,r<i.i&&r<f.i&&au(o,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=kt(r=n),t):r},t.y=function(n){return arguments.length?(o=kt(u=n),t):u},t.clipExtent=function(n){return arguments.length?(a=null==n?cl:n,t):a===cl?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===cl?null:a&&a[1]},t)};var cl=[[-1e6,-1e6],[1e6,1e6]];ta.geom.delaunay=function(n){return ta.geom.voronoi().triangles(n)},ta.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var c=n.x,s=n.y;if(null!=c)if(va(c-e)+va(s-r)<.01)l(n,t,e,r,u,i,o,a);else{var f=n.point;n.x=n.y=n.point=null,l(n,f,c,s,u,i,o,a),l(n,t,e,r,u,i,o,a)}else n.x=e,n.y=r,n.point=t}else l(n,t,e,r,u,i,o,a)}function l(n,t,e,r,u,o,a,c){var l=.5*(u+a),s=.5*(o+c),f=e>=l,h=r>=s,g=h<<1|f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=su()),f?u=l:a=l,h?o=s:c=s,i(n,t,e,r,u,o,a,c)}var s,f,h,g,p,v,d,m,y,M=kt(a),x=kt(c);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,o)for(g=0;p>g;++g)s=n[g],s.x<v&&(v=s.x),s.y<d&&(d=s.y),s.x>m&&(m=s.x),s.y>y&&(y=s.y),f.push(s.x),h.push(s.y);else for(g=0;p>g;++g){var b=+M(s=n[g],g),_=+x(s,g);v>b&&(v=b),d>_&&(d=_),b>m&&(m=b),_>y&&(y=_),f.push(b),h.push(_)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=su();if(k.add=function(n){i(k,n,+M(n,++g),+x(n,g),v,d,m,y)},k.visit=function(n){fu(n,k,v,d,m,y)},k.find=function(n){return hu(k,n[0],n[1],v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=s=null,k}var o,a=Ar,c=Nr;return(o=arguments.length)?(a=cu,c=lu,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},ta.interpolateRgb=gu,ta.interpolateObject=pu,ta.interpolateNumber=vu,ta.interpolateString=du;var ll=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sl=new RegExp(ll.source,"g");ta.interpolate=mu,ta.interpolators=[function(n,t){var e=typeof t;return("string"===e?tc.has(t)||/^(#|rgb\(|hsl\()/.test(t)?gu:du:t instanceof it?gu:Array.isArray(t)?yu:"object"===e&&isNaN(t)?pu:vu)(n,t)}],ta.interpolateArray=yu;var fl=function(){return Et},hl=ta.map({linear:fl,poly:ku,quad:function(){return _u},cubic:function(){return wu},sin:function(){return Eu},exp:function(){return Au},circle:function(){return Nu},elastic:Cu,back:zu,bounce:function(){return qu}}),gl=ta.map({"in":Et,out:xu,"in-out":bu,"out-in":function(n){return bu(xu(n))}});ta.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.slice(0,t):n,r=t>=0?n.slice(t+1):"in";return e=hl.get(e)||fl,r=gl.get(r)||Et,Mu(r(e.apply(null,ea.call(arguments,1))))},ta.interpolateHcl=Lu,ta.interpolateHsl=Tu,ta.interpolateLab=Ru,ta.interpolateRound=Du,ta.transform=function(n){var t=ua.createElementNS(ta.ns.prefix.svg,"g");return(ta.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Pu(e?e.matrix:pl)})(n)},Pu.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var pl={a:1,b:0,c:0,d:1,e:0,f:0};ta.interpolateTransform=Hu,ta.layout={},ta.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(Iu(n[e]));return t}},ta.layout.chord=function(){function n(){var n,l,f,h,g,p={},v=[],d=ta.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(l=0,g=-1;++g<i;)l+=u[h][g];v.push(l),m.push(ta.range(i)),n+=l}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(Pa-s*i)/n,l=0,h=-1;++h<i;){for(f=l,g=-1;++g<i;){var y=d[h],M=m[y][g],x=u[y][M],b=l,_=l+=x*n;p[y+"-"+M]={index:y,subindex:M,startAngle:b,endAngle:_,value:x}}r[y]={index:y,startAngle:f,endAngle:l,value:(l-f)/n},l+=s}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,l={},s=0;return l.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,l):u},l.padding=function(n){return arguments.length?(s=n,e=r=null,l):s},l.sortGroups=function(n){return arguments.length?(o=n,e=r=null,l):o},l.sortSubgroups=function(n){return arguments.length?(a=n,e=null,l):a},l.sortChords=function(n){return arguments.length?(c=n,e&&t(),l):c},l.chords=function(){return e||n(),e},l.groups=function(){return r||n(),r},l},ta.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=u-e,c=i*i+o*o;if(c>a*a/d){if(p>c){var l=t.charge/c;n.px-=i*l,n.py-=o*l}return!0}if(t.point&&c&&p>c){var l=t.pointCharge/c;n.px-=i*l,n.py-=o*l}}return!t.charge}}function t(n){n.px=ta.event.x,n.py=ta.event.y,a.resume()}var e,r,u,i,o,a={},c=ta.dispatch("start","tick","end"),l=[1,1],s=.9,f=vl,h=dl,g=-30,p=ml,v=.1,d=.64,m=[],y=[];return a.tick=function(){if((r*=.99)<.005)return c.end({type:"end",alpha:r=0}),!0;var t,e,a,f,h,p,d,M,x,b=m.length,_=y.length;for(e=0;_>e;++e)a=y[e],f=a.source,h=a.target,M=h.x-f.x,x=h.y-f.y,(p=M*M+x*x)&&(p=r*i[e]*((p=Math.sqrt(p))-u[e])/p,M*=p,x*=p,h.x-=M*(d=f.weight/(h.weight+f.weight)),h.y-=x*d,f.x+=M*(d=1-d),f.y+=x*d);if((d=r*v)&&(M=l[0]/2,x=l[1]/2,e=-1,d))for(;++e<b;)a=m[e],a.x+=(M-a.x)*d,a.y+=(x-a.y)*d;if(g)for(Ju(t=ta.geom.quadtree(m),r,o),e=-1;++e<b;)(a=m[e]).fixed||t.visit(n(a));for(e=-1;++e<b;)a=m[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*s,a.y-=(a.py-(a.py=a.y))*s);c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(m=n,a):m},a.links=function(n){return arguments.length?(y=n,a):y},a.size=function(n){return arguments.length?(l=n,a):l},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(s=+n,a):s},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.chargeDistance=function(n){return arguments.length?(p=n*n,a):Math.sqrt(p)},a.gravity=function(n){return arguments.length?(v=+n,a):v},a.theta=function(n){return arguments.length?(d=n*n,a):Math.sqrt(d)},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),ta.timer(a.tick)),a):r},a.start=function(){function n(n,r){if(!e){for(e=new Array(c),a=0;c>a;++a)e[a]=[];for(a=0;l>a;++a){var u=y[a];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var i,o=e[t],a=-1,l=o.length;++a<l;)if(!isNaN(i=o[a][n]))return i;return Math.random()*r}var t,e,r,c=m.length,s=y.length,p=l[0],v=l[1];for(t=0;c>t;++t)(r=m[t]).index=t,r.weight=0;for(t=0;s>t;++t)r=y[t],"number"==typeof r.source&&(r.source=m[r.source]),"number"==typeof r.target&&(r.target=m[r.target]),++r.source.weight,++r.target.weight;for(t=0;c>t;++t)r=m[t],isNaN(r.x)&&(r.x=n("x",p)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof f)for(t=0;s>t;++t)u[t]=+f.call(this,y[t],t);else for(t=0;s>t;++t)u[t]=f;if(i=[],"function"==typeof h)for(t=0;s>t;++t)i[t]=+h.call(this,y[t],t);else for(t=0;s>t;++t)i[t]=h;if(o=[],"function"==typeof g)for(t=0;c>t;++t)o[t]=+g.call(this,m[t],t);else for(t=0;c>t;++t)o[t]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=ta.behavior.drag().origin(Et).on("dragstart.force",Xu).on("drag.force",t).on("dragend.force",$u)),arguments.length?(this.on("mouseover.force",Bu).on("mouseout.force",Wu).call(e),void 0):e},ta.rebind(a,c,"on")};var vl=20,dl=1,ml=1/0;ta.layout.hierarchy=function(){function n(u){var i,o=[u],a=[];for(u.depth=0;null!=(i=o.pop());)if(a.push(i),(l=e.call(n,i,i.depth))&&(c=l.length)){for(var c,l,s;--c>=0;)o.push(s=l[c]),s.parent=i,s.depth=i.depth+1;r&&(i.value=0),i.children=l}else r&&(i.value=+r.call(n,i,i.depth)||0),delete i.children;return Qu(u,function(n){var e,u;t&&(e=n.children)&&e.sort(t),r&&(u=n.parent)&&(u.value+=n.value)}),a}var t=ei,e=ni,r=ti;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&(Ku(t,function(n){n.children&&(n.value=0)}),Qu(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},ta.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,l=-1;for(r=t.value?r/t.value:0;++l<o;)n(a=i[l],e,c=a.value*r,u),e+=c}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=ta.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},Gu(e,r)},ta.layout.pie=function(){function n(o){var a,c=o.length,l=o.map(function(e,r){return+t.call(n,e,r)}),s=+("function"==typeof r?r.apply(this,arguments):r),f=("function"==typeof u?u.apply(this,arguments):u)-s,h=Math.min(Math.abs(f)/c,+("function"==typeof i?i.apply(this,arguments):i)),g=h*(0>f?-1:1),p=(f-c*g)/ta.sum(l),v=ta.range(c),d=[];return null!=e&&v.sort(e===yl?function(n,t){return l[t]-l[n]}:function(n,t){return e(o[n],o[t])}),v.forEach(function(n){d[n]={data:o[n],value:a=l[n],startAngle:s,endAngle:s+=a*p+g,padAngle:h}}),d}var t=Number,e=yl,r=0,u=Pa,i=0;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n.padAngle=function(t){return arguments.length?(i=t,n):i},n};var yl={};ta.layout.stack=function(){function n(a,c){if(!(h=a.length))return a;var l=a.map(function(e,r){return t.call(n,e,r)}),s=l.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,s,c);l=ta.permute(l,f),s=ta.permute(s,f);var h,g,p,v,d=r.call(n,s,c),m=l[0].length;for(p=0;m>p;++p)for(u.call(n,l[0][p],v=d[p],s[0][p][1]),g=1;h>g;++g)u.call(n,l[g][p],v+=s[g-1][p][1],s[g][p][1]);return a}var t=Et,e=ai,r=ci,u=oi,i=ui,o=ii;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:Ml.get(t)||ai,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:xl.get(t)||ci,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var Ml=ta.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(li),i=n.map(si),o=ta.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,l=[],s=[];for(t=0;r>t;++t)e=o[t],c>a?(a+=i[e],l.push(e)):(c+=i[e],s.push(e));return s.reverse().concat(l)},reverse:function(n){return ta.range(n.length).reverse()},"default":ai}),xl=ta.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;i>e;++e)c[e]=(a-o[e])/2;return c},wiggle:function(n){var t,e,r,u,i,o,a,c,l,s=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=l=0,e=1;h>e;++e){for(t=0,u=0;s>t;++t)u+=n[t][e][1];for(t=0,i=0,a=f[e][0]-f[e-1][0];s>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,l>c&&(l=c)}for(e=0;h>e;++e)g[e]-=l;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=o}for(e=0;i>e;++e)a[e]=0;return a},zero:ci});ta.layout.histogram=function(){function n(n,i){for(var o,a,c=[],l=n.map(e,this),s=r.call(this,l,i),f=u.call(this,s,l,i),i=-1,h=l.length,g=f.length-1,p=t?1:1/h;++i<g;)o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0;if(g>0)for(i=-1;++i<h;)a=l[i],a>=s[0]&&a<=s[1]&&(o=c[ta.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]));return c}var t=!0,e=Number,r=pi,u=hi;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=kt(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return gi(n,t)}:kt(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},ta.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],l=u[1],s=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Qu(a,function(n){n.r=+s(n.value)}),Qu(a,Mi),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/l))/2;Qu(a,function(n){n.r+=f}),Qu(a,Mi),Qu(a,function(n){n.r-=f})}return _i(a,c/2,l/2,t?1:1/Math.max(2*a.r/c,2*a.r/l)),o}var t,e=ta.layout.hierarchy().sort(vi),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},Gu(n,e)},ta.layout.tree=function(){function n(n,u){var s=o.call(this,n,u),f=s[0],h=t(f);if(Qu(h,e),h.parent.m=-h.z,Ku(h,r),l)Ku(f,i);else{var g=f,p=f,v=f;Ku(f,function(n){n.x<g.x&&(g=n),n.x>p.x&&(p=n),n.depth>v.depth&&(v=n)});var d=a(g,p)/2-g.x,m=c[0]/(p.x+a(p,g)/2+d),y=c[1]/(v.depth||1);Ku(f,function(n){n.x=(n.x+d)*m,n.y=n.depth*y})}return s}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var u,i=t.children,o=0,a=i.length;a>o;++o)r.push((i[o]=u={_:i[o],parent:t,children:(u=i[o].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=u);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){Ni(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+a(n._,r._));n.parent.A=u(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,t,e){if(t){for(var r,u=n,i=n,o=t,c=u.parent.children[0],l=u.m,s=i.m,f=o.m,h=c.m;o=Ei(o),u=ki(u),o&&u;)c=ki(c),i=Ei(i),i.a=n,r=o.z+f-u.z-l+a(o._,u._),r>0&&(Ai(Ci(o,n,e),n,r),l+=r,s+=r),f+=o.m,l+=u.m,h+=c.m,s+=i.m;o&&!Ei(i)&&(i.t=o,i.m+=f-s),u&&!ki(c)&&(c.t=u,c.m+=l-h,e=n)}return e}function i(n){n.x*=c[0],n.y=n.depth*c[1]}var o=ta.layout.hierarchy().sort(null).value(null),a=Si,c=[1,1],l=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(l=null==(c=t)?i:null,n):l?null:c},n.nodeSize=function(t){return arguments.length?(l=null==(c=t)?null:i,n):l?c:null},Gu(n,o)},ta.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],l=0;Qu(c,function(n){var t=n.children;t&&t.length?(n.x=qi(t),n.y=zi(t)):(n.x=o?l+=e(n,o):0,n.y=0,o=n)});var s=Li(c),f=Ti(c),h=s.x-e(s,f)/2,g=f.x+e(f,s)/2;return Qu(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=ta.layout.hierarchy().sort(null).value(null),e=Si,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},Gu(n,t)},ta.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var o,a,c,l=f(e),s=[],h=i.slice(),p=1/0,v="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(n(h,l.dx*l.dy/e.value),s.area=0;(c=h.length)>0;)s.push(o=h[c-1]),s.area+=o.area,"squarify"!==g||(a=r(s,v))<=p?(h.pop(),p=a):(s.area-=s.pop().area,u(s,v,l,!1),v=Math.min(l.dx,l.dy),s.length=s.area=0,p=1/0);s.length&&(u(s,v,l,!0),s.length=s.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();)c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,l=e.y,s=t?c(n.area/t):0;if(t==e.dx){for((r||s>e.dy)&&(s=e.dy);++i<o;)u=n[i],u.x=a,u.y=l,u.dy=s,a+=u.dx=Math.min(e.x+e.dx-a,s?c(u.area/s):0);u.z=!0,u.dx+=e.x+e.dx-a,e.y+=s,e.dy-=s}else{for((r||s>e.dx)&&(s=e.dx);++i<o;)u=n[i],u.x=a,u.y=l,u.dx=s,l+=u.dy=Math.min(e.y+e.dy-l,s?c(u.area/s):0);u.z=!1,u.dy+=e.y+e.dy-l,e.x+=s,e.dx-=s}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=l[0],i.dy=l[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=ta.layout.hierarchy(),c=Math.round,l=[1,1],s=null,f=Ri,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(l=n,i):l},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Ri(t):Di(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Di(t,n)}if(!arguments.length)return s;var r;return f=null==(s=n)?Ri:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h
},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},Gu(i,a)},ta.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=ta.random.normal.apply(ta,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=ta.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},ta.scale={};var bl={floor:Et,ceil:Et};ta.scale.linear=function(){return Yi([0,1],[0,1],mu,!1)};var _l={s:1,g:1,p:1,r:1,e:1};ta.scale.log=function(){return Ji(ta.scale.linear().domain([0,1]),10,!0,[1,10])};var wl=ta.format(".0e"),Sl={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};ta.scale.pow=function(){return Gi(ta.scale.linear(),1,[0,1])},ta.scale.sqrt=function(){return ta.scale.pow().exponent(.5)},ta.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},ta.scale.category10=function(){return ta.scale.ordinal().range(kl)},ta.scale.category20=function(){return ta.scale.ordinal().range(El)},ta.scale.category20b=function(){return ta.scale.ordinal().range(Al)},ta.scale.category20c=function(){return ta.scale.ordinal().range(Nl)};var kl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(yt),El=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(yt),Al=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(yt),Nl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(yt);ta.scale.quantile=function(){return no([],[])},ta.scale.quantize=function(){return to(0,1,[0,1])},ta.scale.threshold=function(){return eo([.5],[0,1])},ta.scale.identity=function(){return ro([0,1])},ta.svg={},ta.svg.arc=function(){function n(){var n=Math.max(0,+e.apply(this,arguments)),l=Math.max(0,+r.apply(this,arguments)),s=o.apply(this,arguments)-ja,f=a.apply(this,arguments)-ja,h=Math.abs(f-s),g=s>f?0:1;if(n>l&&(p=l,l=n,n=p),h>=Ua)return t(l,g)+(n?t(n,1-g):"")+"Z";var p,v,d,m,y,M,x,b,_,w,S,k,E=0,A=0,N=[];if((m=(+c.apply(this,arguments)||0)/2)&&(d=i===Cl?Math.sqrt(n*n+l*l):+i.apply(this,arguments),g||(A*=-1),l&&(A=nt(d/l*Math.sin(m))),n&&(E=nt(d/n*Math.sin(m)))),l){y=l*Math.cos(s+A),M=l*Math.sin(s+A),x=l*Math.cos(f-A),b=l*Math.sin(f-A);var C=Math.abs(f-s-2*A)<=Da?0:1;if(A&&so(y,M,x,b)===g^C){var z=(s+f)/2;y=l*Math.cos(z),M=l*Math.sin(z),x=b=null}}else y=M=0;if(n){_=n*Math.cos(f-E),w=n*Math.sin(f-E),S=n*Math.cos(s+E),k=n*Math.sin(s+E);var q=Math.abs(s-f+2*E)<=Da?0:1;if(E&&so(_,w,S,k)===1-g^q){var L=(s+f)/2;_=n*Math.cos(L),w=n*Math.sin(L),S=k=null}}else _=w=0;if((p=Math.min(Math.abs(l-n)/2,+u.apply(this,arguments)))>.001){v=l>n^g?0:1;var T=null==S?[_,w]:null==x?[y,M]:Lr([y,M],[S,k],[x,b],[_,w]),R=y-T[0],D=M-T[1],P=x-T[0],U=b-T[1],j=1/Math.sin(Math.acos((R*P+D*U)/(Math.sqrt(R*R+D*D)*Math.sqrt(P*P+U*U)))/2),F=Math.sqrt(T[0]*T[0]+T[1]*T[1]);if(null!=x){var H=Math.min(p,(l-F)/(j+1)),O=fo(null==S?[_,w]:[S,k],[y,M],l,H,g),Y=fo([x,b],[_,w],l,H,g);p===H?N.push("M",O[0],"A",H,",",H," 0 0,",v," ",O[1],"A",l,",",l," 0 ",1-g^so(O[1][0],O[1][1],Y[1][0],Y[1][1]),",",g," ",Y[1],"A",H,",",H," 0 0,",v," ",Y[0]):N.push("M",O[0],"A",H,",",H," 0 1,",v," ",Y[0])}else N.push("M",y,",",M);if(null!=S){var I=Math.min(p,(n-F)/(j-1)),Z=fo([y,M],[S,k],n,-I,g),V=fo([_,w],null==x?[y,M]:[x,b],n,-I,g);p===I?N.push("L",V[0],"A",I,",",I," 0 0,",v," ",V[1],"A",n,",",n," 0 ",g^so(V[1][0],V[1][1],Z[1][0],Z[1][1]),",",1-g," ",Z[1],"A",I,",",I," 0 0,",v," ",Z[0]):N.push("L",V[0],"A",I,",",I," 0 0,",v," ",Z[0])}else N.push("L",_,",",w)}else N.push("M",y,",",M),null!=x&&N.push("A",l,",",l," 0 ",C,",",g," ",x,",",b),N.push("L",_,",",w),null!=S&&N.push("A",n,",",n," 0 ",q,",",1-g," ",S,",",k);return N.push("Z"),N.join("")}function t(n,t){return"M0,"+n+"A"+n+","+n+" 0 1,"+t+" 0,"+-n+"A"+n+","+n+" 0 1,"+t+" 0,"+n}var e=io,r=oo,u=uo,i=Cl,o=ao,a=co,c=lo;return n.innerRadius=function(t){return arguments.length?(e=kt(t),n):e},n.outerRadius=function(t){return arguments.length?(r=kt(t),n):r},n.cornerRadius=function(t){return arguments.length?(u=kt(t),n):u},n.padRadius=function(t){return arguments.length?(i=t==Cl?Cl:kt(t),n):i},n.startAngle=function(t){return arguments.length?(o=kt(t),n):o},n.endAngle=function(t){return arguments.length?(a=kt(t),n):a},n.padAngle=function(t){return arguments.length?(c=kt(t),n):c},n.centroid=function(){var n=(+e.apply(this,arguments)+ +r.apply(this,arguments))/2,t=(+o.apply(this,arguments)+ +a.apply(this,arguments))/2-ja;return[Math.cos(t)*n,Math.sin(t)*n]},n};var Cl="auto";ta.svg.line=function(){return ho(Et)};var zl=ta.map({linear:go,"linear-closed":po,step:vo,"step-before":mo,"step-after":yo,basis:So,"basis-open":ko,"basis-closed":Eo,bundle:Ao,cardinal:bo,"cardinal-open":Mo,"cardinal-closed":xo,monotone:To});zl.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var ql=[0,2/3,1/3,0],Ll=[0,1/3,2/3,0],Tl=[0,1/6,2/3,1/6];ta.svg.line.radial=function(){var n=ho(Ro);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},mo.reverse=yo,yo.reverse=mo,ta.svg.area=function(){return Do(Et)},ta.svg.area.radial=function(){var n=Do(Ro);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},ta.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),l=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,l)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)-ja,s=l.call(n,u,r)-ja;return{r:i,a0:o,a1:s,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(s),i*Math.sin(s)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>Da)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=mr,o=yr,a=Po,c=ao,l=co;return n.radius=function(t){return arguments.length?(a=kt(t),n):a},n.source=function(t){return arguments.length?(i=kt(t),n):i},n.target=function(t){return arguments.length?(o=kt(t),n):o},n.startAngle=function(t){return arguments.length?(c=kt(t),n):c},n.endAngle=function(t){return arguments.length?(l=kt(t),n):l},n},ta.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=mr,e=yr,r=Uo;return n.source=function(e){return arguments.length?(t=kt(e),n):t},n.target=function(t){return arguments.length?(e=kt(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},ta.svg.diagonal.radial=function(){var n=ta.svg.diagonal(),t=Uo,e=n.projection;return n.projection=function(n){return arguments.length?e(jo(t=n)):t},n},ta.svg.symbol=function(){function n(n,r){return(Rl.get(t.call(this,n,r))||Oo)(e.call(this,n,r))}var t=Ho,e=Fo;return n.type=function(e){return arguments.length?(t=kt(e),n):t},n.size=function(t){return arguments.length?(e=kt(t),n):e},n};var Rl=ta.map({circle:Oo,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*Pl)),e=t*Pl;return"M0,"+-t+"L"+e+",0"+" 0,"+t+" "+-e+",0"+"Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/Dl),e=t*Dl/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/Dl),e=t*Dl/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});ta.svg.symbolTypes=Rl.keys();var Dl=Math.sqrt(3),Pl=Math.tan(30*Fa);ka.transition=function(n){for(var t,e,r=Ul||++Ol,u=Xo(n),i=[],o=jl||{time:Date.now(),ease:Su,delay:0,duration:250},a=-1,c=this.length;++a<c;){i.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(e=l[s])&&$o(e,s,u,r,o),t.push(e)}return Io(i,u,r)},ka.interrupt=function(n){return this.each(null==n?Fl:Yo(Xo(n)))};var Ul,jl,Fl=Yo(Xo()),Hl=[],Ol=0;Hl.call=ka.call,Hl.empty=ka.empty,Hl.node=ka.node,Hl.size=ka.size,ta.transition=function(n,t){return n&&n.transition?Ul?n.transition(t):n:Na.transition(n)},ta.transition.prototype=Hl,Hl.select=function(n){var t,e,r,u=this.id,i=this.namespace,o=[];n=k(n);for(var a=-1,c=this.length;++a<c;){o.push(t=[]);for(var l=this[a],s=-1,f=l.length;++s<f;)(r=l[s])&&(e=n.call(r,r.__data__,s,a))?("__data__"in r&&(e.__data__=r.__data__),$o(e,s,i,u,r[i][u]),t.push(e)):t.push(null)}return Io(o,i,u)},Hl.selectAll=function(n){var t,e,r,u,i,o=this.id,a=this.namespace,c=[];n=E(n);for(var l=-1,s=this.length;++l<s;)for(var f=this[l],h=-1,g=f.length;++h<g;)if(r=f[h]){i=r[a][o],e=n.call(r,r.__data__,h,l),c.push(t=[]);for(var p=-1,v=e.length;++p<v;)(u=e[p])&&$o(u,p,a,o,i),t.push(u)}return Io(c,a,o)},Hl.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=j(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return Io(u,this.namespace,this.id)},Hl.tween=function(n,t){var e=this.id,r=this.namespace;return arguments.length<2?this.node()[r][e].tween.get(n):H(this,null==t?function(t){t[r][e].tween.remove(n)}:function(u){u[r][e].tween.set(n,t)})},Hl.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?Hu:mu,a=ta.ns.qualify(n);return Zo(this,"attr."+n,t,a.local?i:u)},Hl.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=ta.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Hl.style=function(n,t,e){function r(){this.style.removeProperty(n)}function u(t){return null==t?r:(t+="",function(){var r,u=oa.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=mu(u,t),function(t){this.style.setProperty(n,r(t),e)})})}var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(t="");for(e in n)this.style(e,n[e],t);return this}e=""}return Zo(this,"style."+n,t,u)},Hl.styleTween=function(n,t,e){function r(r,u){var i=t.call(this,r,u,oa.getComputedStyle(this,null).getPropertyValue(n));return i&&function(t){this.style.setProperty(n,i(t),e)}}return arguments.length<3&&(e=""),this.tween("style."+n,r)},Hl.text=function(n){return Zo(this,"text",n,Vo)},Hl.remove=function(){var n=this.namespace;return this.each("end.transition",function(){var t;this[n].count<2&&(t=this.parentNode)&&t.removeChild(this)})},Hl.ease=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].ease:("function"!=typeof n&&(n=ta.ease.apply(ta,arguments)),H(this,function(r){r[e][t].ease=n}))},Hl.delay=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].delay:H(this,"function"==typeof n?function(r,u,i){r[e][t].delay=+n.call(r,r.__data__,u,i)}:(n=+n,function(r){r[e][t].delay=n}))},Hl.duration=function(n){var t=this.id,e=this.namespace;return arguments.length<1?this.node()[e][t].duration:H(this,"function"==typeof n?function(r,u,i){r[e][t].duration=Math.max(1,n.call(r,r.__data__,u,i))}:(n=Math.max(1,n),function(r){r[e][t].duration=n}))},Hl.each=function(n,t){var e=this.id,r=this.namespace;if(arguments.length<2){var u=jl,i=Ul;try{Ul=e,H(this,function(t,u,i){jl=t[r][e],n.call(t,t.__data__,u,i)})}finally{jl=u,Ul=i}}else H(this,function(u){var i=u[r][e];(i.event||(i.event=ta.dispatch("start","end","interrupt"))).on(n,t)});return this},Hl.transition=function(){for(var n,t,e,r,u=this.id,i=++Ol,o=this.namespace,a=[],c=0,l=this.length;l>c;c++){a.push(n=[]);for(var t=this[c],s=0,f=t.length;f>s;s++)(e=t[s])&&(r=e[o][u],$o(e,s,o,i,{time:r.time,ease:r.ease,delay:r.delay+r.duration,duration:r.duration})),n.push(e)}return Io(a,o,i)},ta.svg.axis=function(){function n(n){n.each(function(){var n,l=ta.select(this),s=this.__chart__||e,f=this.__chart__=e.copy(),h=null==c?f.ticks?f.ticks.apply(f,a):f.domain():c,g=null==t?f.tickFormat?f.tickFormat.apply(f,a):Et:t,p=l.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Ta),d=ta.transition(p.exit()).style("opacity",Ta).remove(),m=ta.transition(p.order()).style("opacity",1),y=Math.max(u,0)+o,M=Ui(f),x=l.selectAll(".domain").data([0]),b=(x.enter().append("path").attr("class","domain"),ta.transition(x));v.append("line"),v.append("text");var _,w,S,k,E=v.select("line"),A=m.select("line"),N=p.select("text").text(g),C=v.select("text"),z=m.select("text"),q="top"===r||"left"===r?-1:1;if("bottom"===r||"top"===r?(n=Bo,_="x",S="y",w="x2",k="y2",N.attr("dy",0>q?"0em":".71em").style("text-anchor","middle"),b.attr("d","M"+M[0]+","+q*i+"V0H"+M[1]+"V"+q*i)):(n=Wo,_="y",S="x",w="y2",k="x2",N.attr("dy",".32em").style("text-anchor",0>q?"end":"start"),b.attr("d","M"+q*i+","+M[0]+"H0V"+M[1]+"H"+q*i)),E.attr(k,q*u),C.attr(S,q*y),A.attr(w,0).attr(k,q*u),z.attr(_,0).attr(S,q*y),f.rangeBand){var L=f,T=L.rangeBand()/2;s=f=function(n){return L(n)+T}}else s.rangeBand?s=f:d.call(n,f,s);v.call(n,s,f),m.call(n,f,f)})}var t,e=ta.scale.linear(),r=Yl,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Il?t+"":Yl,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Yl="bottom",Il={top:1,right:1,bottom:1,left:1};ta.svg.brush=function(){function n(i){i.each(function(){var i=ta.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=i.selectAll(".resize").data(p,Et);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Zl[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var s,f=ta.transition(i),h=ta.transition(o);c&&(s=Ui(c),h.attr("x",s[0]).attr("width",s[1]-s[0]),e(f)),l&&(s=Ui(l),h.attr("y",s[0]).attr("height",s[1]-s[0]),r(f)),t(f)})}function t(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+s[+/e$/.test(n)]+","+f[+/^s/.test(n)]+")"})}function e(n){n.select(".extent").attr("x",s[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function r(n){n.select(".extent").attr("y",f[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1]-f[0])}function u(){function u(){32==ta.event.keyCode&&(N||(y=null,z[0]-=s[1],z[1]-=f[1],N=2),b())}function p(){32==ta.event.keyCode&&2==N&&(z[0]+=s[1],z[1]+=f[1],N=0,b())}function v(){var n=ta.mouse(x),u=!1;M&&(n[0]+=M[0],n[1]+=M[1]),N||(ta.event.altKey?(y||(y=[(s[0]+s[1])/2,(f[0]+f[1])/2]),z[0]=s[+(n[0]<y[0])],z[1]=f[+(n[1]<y[1])]):y=null),E&&d(n,c,0)&&(e(S),u=!0),A&&d(n,l,1)&&(r(S),u=!0),u&&(t(S),w({type:"brush",mode:N?"move":"resize"}))}function d(n,t,e){var r,u,a=Ui(t),c=a[0],l=a[1],p=z[e],v=e?f:s,d=v[1]-v[0];return N&&(c-=p,l-=d+p),r=(e?g:h)?Math.max(c,Math.min(l,n[e])):n[e],N?u=(r+=p)+d:(y&&(p=Math.max(c,Math.min(l,2*y[e]-r))),r>p?(u=r,r=p):u=p),v[0]!=r||v[1]!=u?(e?o=null:i=null,v[0]=r,v[1]=u,!0):void 0}function m(){v(),S.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),ta.select("body").style("cursor",null),q.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),C(),w({type:"brushend"})}var y,M,x=this,_=ta.select(ta.event.target),w=a.of(x,arguments),S=ta.select(x),k=_.datum(),E=!/^(n|s)$/.test(k)&&c,A=!/^(e|w)$/.test(k)&&l,N=_.classed("extent"),C=X(),z=ta.mouse(x),q=ta.select(oa).on("keydown.brush",u).on("keyup.brush",p);if(ta.event.changedTouches?q.on("touchmove.brush",v).on("touchend.brush",m):q.on("mousemove.brush",v).on("mouseup.brush",m),S.interrupt().selectAll("*").interrupt(),N)z[0]=s[0]-z[0],z[1]=f[0]-z[1];else if(k){var L=+/w$/.test(k),T=+/^n/.test(k);M=[s[1-L]-z[0],f[1-T]-z[1]],z[0]=s[L],z[1]=f[T]}else ta.event.altKey&&(y=z.slice());S.style("pointer-events","none").selectAll(".resize").style("display",null),ta.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),v()}var i,o,a=w(n,"brushstart","brush","brushend"),c=null,l=null,s=[0,0],f=[0,0],h=!0,g=!0,p=Vl[0];return n.event=function(n){n.each(function(){var n=a.of(this,arguments),t={x:s,y:f,i:i,j:o},e=this.__chart__||t;this.__chart__=t,Ul?ta.select(this).transition().each("start.brush",function(){i=e.i,o=e.j,s=e.x,f=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=yu(s,t.x),r=yu(f,t.y);return i=o=null,function(u){s=t.x=e(u),f=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,o=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,p=Vl[!c<<1|!l],n):c},n.y=function(t){return arguments.length?(l=t,p=Vl[!c<<1|!l],n):l},n.clamp=function(t){return arguments.length?(c&&l?(h=!!t[0],g=!!t[1]):c?h=!!t:l&&(g=!!t),n):c&&l?[h,g]:c?h:l?g:null},n.extent=function(t){var e,r,u,a,h;return arguments.length?(c&&(e=t[0],r=t[1],l&&(e=e[0],r=r[0]),i=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(h=e,e=r,r=h),(e!=s[0]||r!=s[1])&&(s=[e,r])),l&&(u=t[0],a=t[1],c&&(u=u[1],a=a[1]),o=[u,a],l.invert&&(u=l(u),a=l(a)),u>a&&(h=u,u=a,a=h),(u!=f[0]||a!=f[1])&&(f=[u,a])),n):(c&&(i?(e=i[0],r=i[1]):(e=s[0],r=s[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(h=e,e=r,r=h))),l&&(o?(u=o[0],a=o[1]):(u=f[0],a=f[1],l.invert&&(u=l.invert(u),a=l.invert(a)),u>a&&(h=u,u=a,a=h))),c&&l?[[e,u],[r,a]]:c?[e,r]:l&&[u,a])},n.clear=function(){return n.empty()||(s=[0,0],f=[0,0],i=o=null),n},n.empty=function(){return!!c&&s[0]==s[1]||!!l&&f[0]==f[1]},ta.rebind(n,a,"on")};var Zl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Vl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Xl=fc.format=mc.timeFormat,$l=Xl.utc,Bl=$l("%Y-%m-%dT%H:%M:%S.%LZ");Xl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Jo:Bl,Jo.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Jo.toString=Bl.toString,fc.second=Ft(function(n){return new hc(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),fc.seconds=fc.second.range,fc.seconds.utc=fc.second.utc.range,fc.minute=Ft(function(n){return new hc(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),fc.minutes=fc.minute.range,fc.minutes.utc=fc.minute.utc.range,fc.hour=Ft(function(n){var t=n.getTimezoneOffset()/60;return new hc(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),fc.hours=fc.hour.range,fc.hours.utc=fc.hour.utc.range,fc.month=Ft(function(n){return n=fc.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),fc.months=fc.month.range,fc.months.utc=fc.month.utc.range;var Wl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Jl=[[fc.second,1],[fc.second,5],[fc.second,15],[fc.second,30],[fc.minute,1],[fc.minute,5],[fc.minute,15],[fc.minute,30],[fc.hour,1],[fc.hour,3],[fc.hour,6],[fc.hour,12],[fc.day,1],[fc.day,2],[fc.week,1],[fc.month,1],[fc.month,3],[fc.year,1]],Gl=Xl.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",Ne]]),Kl={range:function(n,t,e){return ta.range(Math.ceil(n/e)*e,+t,e).map(Ko)},floor:Et,ceil:Et};Jl.year=fc.year,fc.scale=function(){return Go(ta.scale.linear(),Jl,Gl)};var Ql=Jl.map(function(n){return[n[0].utc,n[1]]}),ns=$l.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",Ne]]);Ql.year=fc.year.utc,fc.scale.utc=function(){return Go(ta.scale.linear(),Ql,ns)},ta.text=At(function(n){return n.responseText}),ta.json=function(n,t){return Nt(n,"application/json",Qo,t)},ta.html=function(n,t){return Nt(n,"text/html",na,t)},ta.xml=At(function(n){return n.responseXML}),"function"==typeof define&&define.amd?define(ta):"object"==typeof module&&module.exports&&(module.exports=ta),this.d3=ta}();
;function c3js_init($obj){if($obj.data('type')=='ajax'){}else{var chartOptionsJson=JSON.parse($obj.text()),bind_to=chartOptionsJson.bindto||'#chart',$wrapper=$(bind_to);if($wrapper.length===0){var newDiv=document.createElement("div");newDiv.setAttribute("id",bind_to.replace(/[#\.]/gi,''));$obj.after(newDiv);$wrapper=$(newDiv);}
var chartObject=c3.generate(chartOptionsJson),wrp_classes=$wrapper.attr('class')||'',chart_classes=$obj.attr('class')||'';$wrapper.attr('class',$.merge(wrp_classes.split(' '),chart_classes.split(' ')).join(' '));}}
$(document).ready(function(){var d3_ru_RU=d3.locale({"decimal":",","thousands":"\xa0","grouping":[3],"currency":[""," ."],"dateTime":"%A, %e %B %Y . %X","date":"%d.%m.%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["","","","","","",""],"shortDays":["","","","","","",""],"months":["","","","","","","","","","","",""],"shortMonths":["","","","","","","","","","","",""]});if(d3){d3.time.format=d3_ru_RU.timeFormat;}
$('chart').each(function(){c3js_init($(this));});});;(function(window){'use strict';var c3={version:"0.4.10"};var c3_chart_fn,c3_chart_internal_fn,c3_chart_internal_axis_fn;function API(owner){this.owner=owner;}
function inherit(base,derived){if(Object.create){derived.prototype=Object.create(base.prototype);}else{var f=function f(){};f.prototype=base.prototype;derived.prototype=new f();}
derived.prototype.constructor=derived;return derived;}
function Chart(config){var $$=this.internal=new ChartInternal(this);$$.loadConfig(config);$$.init();(function bindThis(fn,target,argThis){Object.keys(fn).forEach(function(key){target[key]=fn[key].bind(argThis);if(Object.keys(fn[key]).length>0){bindThis(fn[key],target[key],argThis);}});})(c3_chart_fn,this,this);}
function ChartInternal(api){var $$=this;$$.d3=window.d3?window.d3:typeof require!=='undefined'?require("d3"):undefined;$$.api=api;$$.config=$$.getDefaultConfig();$$.data={};$$.cache={};$$.axes={};}
c3.generate=function(config){return new Chart(config);};c3.chart={fn:Chart.prototype,internal:{fn:ChartInternal.prototype,axis:{fn:Axis.prototype}}};c3_chart_fn=c3.chart.fn;c3_chart_internal_fn=c3.chart.internal.fn;c3_chart_internal_axis_fn=c3.chart.internal.axis.fn;c3_chart_internal_fn.init=function(){var $$=this,config=$$.config;$$.initParams();if(config.data_url){$$.convertUrlToData(config.data_url,config.data_mimeType,config.data_keys,$$.initWithData);}
else if(config.data_json){$$.initWithData($$.convertJsonToData(config.data_json,config.data_keys));}
else if(config.data_rows){$$.initWithData($$.convertRowsToData(config.data_rows));}
else if(config.data_columns){$$.initWithData($$.convertColumnsToData(config.data_columns));}
else{throw Error('url or json or rows or columns is required.');}};c3_chart_internal_fn.initParams=function(){var $$=this,d3=$$.d3,config=$$.config;$$.clipId="c3-"+(+new Date())+'-clip',$$.clipIdForXAxis=$$.clipId+'-xaxis',$$.clipIdForYAxis=$$.clipId+'-yaxis',$$.clipIdForGrid=$$.clipId+'-grid',$$.clipIdForSubchart=$$.clipId+'-subchart',$$.clipPath=$$.getClipPath($$.clipId),$$.clipPathForXAxis=$$.getClipPath($$.clipIdForXAxis),$$.clipPathForYAxis=$$.getClipPath($$.clipIdForYAxis);$$.clipPathForGrid=$$.getClipPath($$.clipIdForGrid),$$.clipPathForSubchart=$$.getClipPath($$.clipIdForSubchart),$$.dragStart=null;$$.dragging=false;$$.flowing=false;$$.cancelClick=false;$$.mouseover=false;$$.transiting=false;$$.color=$$.generateColor();$$.levelColor=$$.generateLevelColor();$$.dataTimeFormat=config.data_xLocaltime?d3.time.format:d3.time.format.utc;$$.axisTimeFormat=config.axis_x_localtime?d3.time.format:d3.time.format.utc;$$.defaultAxisTimeFormat=$$.axisTimeFormat.multi([[".%L",function(d){return d.getMilliseconds();}],[":%S",function(d){return d.getSeconds();}],["%I:%M",function(d){return d.getMinutes();}],["%I %p",function(d){return d.getHours();}],["%-m/%-d",function(d){return d.getDay()&&d.getDate()!==1;}],["%-m/%-d",function(d){return d.getDate()!==1;}],["%-m/%-d",function(d){return d.getMonth();}],["%Y/%-m/%-d",function(){return true;}]]);$$.hiddenTargetIds=[];$$.hiddenLegendIds=[];$$.focusedTargetIds=[];$$.defocusedTargetIds=[];$$.xOrient=config.axis_rotated?"left":"bottom";$$.yOrient=config.axis_rotated?(config.axis_y_inner?"top":"bottom"):(config.axis_y_inner?"right":"left");$$.y2Orient=config.axis_rotated?(config.axis_y2_inner?"bottom":"top"):(config.axis_y2_inner?"left":"right");$$.subXOrient=config.axis_rotated?"left":"bottom";$$.isLegendRight=config.legend_position==='right';$$.isLegendInset=config.legend_position==='inset';$$.isLegendTop=config.legend_inset_anchor==='top-left'||config.legend_inset_anchor==='top-right';$$.isLegendLeft=config.legend_inset_anchor==='top-left'||config.legend_inset_anchor==='bottom-left';$$.legendStep=0;$$.legendItemWidth=0;$$.legendItemHeight=0;$$.currentMaxTickWidths={x:0,y:0,y2:0};$$.rotated_padding_left=30;$$.rotated_padding_right=config.axis_rotated&&!config.axis_x_show?0:30;$$.rotated_padding_top=5;$$.withoutFadeIn={};$$.intervalForObserveInserted=undefined;$$.axes.subx=d3.selectAll([]);};c3_chart_internal_fn.initChartElements=function(){if(this.initBar){this.initBar();}
if(this.initLine){this.initLine();}
if(this.initArc){this.initArc();}
if(this.initGauge){this.initGauge();}
if(this.initText){this.initText();}};c3_chart_internal_fn.initWithData=function(data){var $$=this,d3=$$.d3,config=$$.config;var defs,main,binding=true;$$.axis=new Axis($$);if($$.initPie){$$.initPie();}
if($$.initBrush){$$.initBrush();}
if($$.initZoom){$$.initZoom();}
if(!config.bindto){$$.selectChart=d3.selectAll([]);}
else if(typeof config.bindto.node==='function'){$$.selectChart=config.bindto;}
else{$$.selectChart=d3.select(config.bindto);}
if($$.selectChart.empty()){$$.selectChart=d3.select(document.createElement('div')).style('opacity',0);$$.observeInserted($$.selectChart);binding=false;}
$$.selectChart.html("").classed("c3",true);$$.data.xs={};$$.data.targets=$$.convertDataToTargets(data);if(config.data_filter){$$.data.targets=$$.data.targets.filter(config.data_filter);}
if(config.data_hide){$$.addHiddenTargetIds(config.data_hide===true?$$.mapToIds($$.data.targets):config.data_hide);}
if(config.legend_hide){$$.addHiddenLegendIds(config.legend_hide===true?$$.mapToIds($$.data.targets):config.legend_hide);}
if($$.hasType('gauge')){config.legend_show=false;}
$$.updateSizes();$$.updateScales();$$.x.domain(d3.extent($$.getXDomain($$.data.targets)));$$.y.domain($$.getYDomain($$.data.targets,'y'));$$.y2.domain($$.getYDomain($$.data.targets,'y2'));$$.subX.domain($$.x.domain());$$.subY.domain($$.y.domain());$$.subY2.domain($$.y2.domain());$$.orgXDomain=$$.x.domain();if($$.brush){$$.brush.scale($$.subX);}
if(config.zoom_enabled){$$.zoom.scale($$.x);}
$$.svg=$$.selectChart.append("svg").style("overflow","hidden").on('mouseenter',function(){return config.onmouseover.call($$);}).on('mouseleave',function(){return config.onmouseout.call($$);});defs=$$.svg.append("defs");$$.clipChart=$$.appendClip(defs,$$.clipId);$$.clipXAxis=$$.appendClip(defs,$$.clipIdForXAxis);$$.clipYAxis=$$.appendClip(defs,$$.clipIdForYAxis);$$.clipGrid=$$.appendClip(defs,$$.clipIdForGrid);$$.clipSubchart=$$.appendClip(defs,$$.clipIdForSubchart);$$.updateSvgSize();main=$$.main=$$.svg.append("g").attr("transform",$$.getTranslate('main'));if($$.initSubchart){$$.initSubchart();}
if($$.initTooltip){$$.initTooltip();}
if($$.initLegend){$$.initLegend();}
main.append("text").attr("class",CLASS.text+' '+CLASS.empty).attr("text-anchor","middle").attr("dominant-baseline","middle");$$.initRegion();$$.initGrid();main.append('g').attr("clip-path",$$.clipPath).attr('class',CLASS.chart);if(config.grid_lines_front){$$.initGridLines();}
$$.initEventRect();$$.initChartElements();main.insert('rect',config.zoom_privileged?null:'g.'+CLASS.regions).attr('class',CLASS.zoomRect).attr('width',$$.width).attr('height',$$.height).style('opacity',0).on("dblclick.zoom",null);if(config.axis_x_extent){$$.brush.extent($$.getDefaultExtent());}
$$.axis.init();$$.updateTargets($$.data.targets);if(binding){$$.updateDimension();$$.config.oninit.call($$);$$.redraw({withTransition:false,withTransform:true,withUpdateXDomain:true,withUpdateOrgXDomain:true,withTransitionForAxis:false});}
if(window.onresize==null){window.onresize=$$.generateResize();}
if(window.onresize.add){window.onresize.add(function(){config.onresize.call($$);});window.onresize.add(function(){$$.api.flush();});window.onresize.add(function(){config.onresized.call($$);});}
$$.api.element=$$.selectChart.node();};c3_chart_internal_fn.smoothLines=function(el,type){var $$=this;if(type==='grid'){el.each(function(){var g=$$.d3.select(this),x1=g.attr('x1'),x2=g.attr('x2'),y1=g.attr('y1'),y2=g.attr('y2');g.attr({'x1':Math.ceil(x1),'x2':Math.ceil(x2),'y1':Math.ceil(y1),'y2':Math.ceil(y2)});});}};c3_chart_internal_fn.updateSizes=function(){var $$=this,config=$$.config;var legendHeight=$$.legend?$$.getLegendHeight():0,legendWidth=$$.legend?$$.getLegendWidth():0,legendHeightForBottom=$$.isLegendRight||$$.isLegendInset?0:legendHeight,hasArc=$$.hasArcType(),xAxisHeight=config.axis_rotated||hasArc?0:$$.getHorizontalAxisHeight('x'),subchartHeight=config.subchart_show&&!hasArc?(config.subchart_size_height+xAxisHeight):0;$$.currentWidth=$$.getCurrentWidth();$$.currentHeight=$$.getCurrentHeight();$$.margin=config.axis_rotated?{top:$$.getHorizontalAxisHeight('y2')+$$.getCurrentPaddingTop(),right:hasArc?0:$$.getCurrentPaddingRight(),bottom:$$.getHorizontalAxisHeight('y')+legendHeightForBottom+$$.getCurrentPaddingBottom(),left:subchartHeight+(hasArc?0:$$.getCurrentPaddingLeft())}:{top:4+$$.getCurrentPaddingTop(),right:hasArc?0:$$.getCurrentPaddingRight(),bottom:xAxisHeight+subchartHeight+legendHeightForBottom+$$.getCurrentPaddingBottom(),left:hasArc?0:$$.getCurrentPaddingLeft()};$$.margin2=config.axis_rotated?{top:$$.margin.top,right:NaN,bottom:20+legendHeightForBottom,left:$$.rotated_padding_left}:{top:$$.currentHeight-subchartHeight-legendHeightForBottom,right:NaN,bottom:xAxisHeight+legendHeightForBottom,left:$$.margin.left};$$.margin3={top:0,right:NaN,bottom:0,left:0};if($$.updateSizeForLegend){$$.updateSizeForLegend(legendHeight,legendWidth);}
$$.width=$$.currentWidth-$$.margin.left-$$.margin.right;$$.height=$$.currentHeight-$$.margin.top-$$.margin.bottom;if($$.width<0){$$.width=0;}
if($$.height<0){$$.height=0;}
$$.width2=config.axis_rotated?$$.margin.left-$$.rotated_padding_left-$$.rotated_padding_right:$$.width;$$.height2=config.axis_rotated?$$.height:$$.currentHeight-$$.margin2.top-$$.margin2.bottom;if($$.width2<0){$$.width2=0;}
if($$.height2<0){$$.height2=0;}
$$.arcWidth=$$.width-($$.isLegendRight?legendWidth+10:0);$$.arcHeight=$$.height-($$.isLegendRight?0:10);if($$.hasType('gauge')){$$.arcHeight+=$$.height-$$.getGaugeLabelHeight();}
if($$.updateRadius){$$.updateRadius();}
if($$.isLegendRight&&hasArc){$$.margin3.left=$$.arcWidth/2+$$.radiusExpanded*1.1;}};c3_chart_internal_fn.updateTargets=function(targets){var $$=this;$$.updateTargetsForText(targets);$$.updateTargetsForBar(targets);$$.updateTargetsForLine(targets);if($$.hasArcType()&&$$.updateTargetsForArc){$$.updateTargetsForArc(targets);}
if($$.updateTargetsForSubchart){$$.updateTargetsForSubchart(targets);}
$$.showTargets();};c3_chart_internal_fn.showTargets=function(){var $$=this;$$.svg.selectAll('.'+CLASS.target).filter(function(d){return $$.isTargetToShow(d.id);}).transition().duration($$.config.transition_duration).style("opacity",1);};c3_chart_internal_fn.redraw=function(options,transitions){var $$=this,main=$$.main,d3=$$.d3,config=$$.config;var areaIndices=$$.getShapeIndices($$.isAreaType),barIndices=$$.getShapeIndices($$.isBarType),lineIndices=$$.getShapeIndices($$.isLineType);var withY,withSubchart,withTransition,withTransitionForExit,withTransitionForAxis,withTransform,withUpdateXDomain,withUpdateOrgXDomain,withTrimXDomain,withLegend,withEventRect,withDimension,withUpdateXAxis;var hideAxis=$$.hasArcType();var drawArea,drawBar,drawLine,xForText,yForText;var duration,durationForExit,durationForAxis;var waitForDraw,flow;var targetsToShow=$$.filterTargetsToShow($$.data.targets),tickValues,i,intervalForCulling,xDomainForZoom;var xv=$$.xv.bind($$),cx,cy;options=options||{};withY=getOption(options,"withY",true);withSubchart=getOption(options,"withSubchart",true);withTransition=getOption(options,"withTransition",true);withTransform=getOption(options,"withTransform",false);withUpdateXDomain=getOption(options,"withUpdateXDomain",false);withUpdateOrgXDomain=getOption(options,"withUpdateOrgXDomain",false);withTrimXDomain=getOption(options,"withTrimXDomain",true);withUpdateXAxis=getOption(options,"withUpdateXAxis",withUpdateXDomain);withLegend=getOption(options,"withLegend",false);withEventRect=getOption(options,"withEventRect",true);withDimension=getOption(options,"withDimension",true);withTransitionForExit=getOption(options,"withTransitionForExit",withTransition);withTransitionForAxis=getOption(options,"withTransitionForAxis",withTransition);duration=withTransition?config.transition_duration:0;durationForExit=withTransitionForExit?duration:0;durationForAxis=withTransitionForAxis?duration:0;transitions=transitions||$$.axis.generateTransitions(durationForAxis);if(withLegend&&config.legend_show){$$.updateLegend($$.mapToIds($$.data.targets),options,transitions);}else if(withDimension){$$.updateDimension(true);}
if($$.isCategorized()&&targetsToShow.length===0){$$.x.domain([0,$$.axes.x.selectAll('.tick').size()]);}
if(targetsToShow.length){$$.updateXDomain(targetsToShow,withUpdateXDomain,withUpdateOrgXDomain,withTrimXDomain);if(!config.axis_x_tick_values){tickValues=$$.axis.updateXAxisTickValues(targetsToShow);}}else{$$.xAxis.tickValues([]);$$.subXAxis.tickValues([]);}
if(config.zoom_rescale&&!options.flow){xDomainForZoom=$$.x.orgDomain();}
$$.y.domain($$.getYDomain(targetsToShow,'y',xDomainForZoom));$$.y2.domain($$.getYDomain(targetsToShow,'y2',xDomainForZoom));if(!config.axis_y_tick_values&&config.axis_y_tick_count){$$.yAxis.tickValues($$.axis.generateTickValues($$.y.domain(),config.axis_y_tick_count));}
if(!config.axis_y2_tick_values&&config.axis_y2_tick_count){$$.y2Axis.tickValues($$.axis.generateTickValues($$.y2.domain(),config.axis_y2_tick_count));}
$$.axis.redraw(transitions,hideAxis);$$.axis.updateLabels(withTransition);if((withUpdateXDomain||withUpdateXAxis)&&targetsToShow.length){if(config.axis_x_tick_culling&&tickValues){for(i=1;i<tickValues.length;i++){if(tickValues.length/i<config.axis_x_tick_culling_max){intervalForCulling=i;break;}}
$$.svg.selectAll('.'+CLASS.axisX+' .tick text').each(function(e){var index=tickValues.indexOf(e);if(index>=0){d3.select(this).style('display',index%intervalForCulling?'none':'block');}});}else{$$.svg.selectAll('.'+CLASS.axisX+' .tick text').style('display','block');}}
drawArea=$$.generateDrawArea?$$.generateDrawArea(areaIndices,false):undefined;drawBar=$$.generateDrawBar?$$.generateDrawBar(barIndices):undefined;drawLine=$$.generateDrawLine?$$.generateDrawLine(lineIndices,false):undefined;xForText=$$.generateXYForText(areaIndices,barIndices,lineIndices,true);yForText=$$.generateXYForText(areaIndices,barIndices,lineIndices,false);if(withY){$$.subY.domain($$.getYDomain(targetsToShow,'y'));$$.subY2.domain($$.getYDomain(targetsToShow,'y2'));}
$$.tooltip.style("display","none");$$.updateXgridFocus();main.select("text."+CLASS.text+'.'+CLASS.empty).attr("x",$$.width/2).attr("y",$$.height/2).text(config.data_empty_label_text).transition().style('opacity',targetsToShow.length?0:1);$$.updateGrid(duration);$$.updateRegion(duration);$$.updateBar(durationForExit);$$.updateLine(durationForExit);$$.updateArea(durationForExit);$$.updateCircle();if($$.hasDataLabel()){$$.updateText(durationForExit);}
if($$.redrawArc){$$.redrawArc(duration,durationForExit,withTransform);}
if($$.redrawSubchart){$$.redrawSubchart(withSubchart,transitions,duration,durationForExit,areaIndices,barIndices,lineIndices);}
main.selectAll('.'+CLASS.selectedCircles).filter($$.isBarType.bind($$)).selectAll('circle').remove();if(config.interaction_enabled&&!options.flow&&withEventRect){$$.redrawEventRect();if($$.updateZoom){$$.updateZoom();}}
$$.updateCircleY();cx=($$.config.axis_rotated?$$.circleY:$$.circleX).bind($$);cy=($$.config.axis_rotated?$$.circleX:$$.circleY).bind($$);if(options.flow){flow=$$.generateFlow({targets:targetsToShow,flow:options.flow,duration:options.flow.duration,drawBar:drawBar,drawLine:drawLine,drawArea:drawArea,cx:cx,cy:cy,xv:xv,xForText:xForText,yForText:yForText});}
if((duration||flow)&&$$.isTabVisible()){d3.transition().duration(duration).each(function(){var transitionsToWait=[];[$$.redrawBar(drawBar,true),$$.redrawLine(drawLine,true),$$.redrawArea(drawArea,true),$$.redrawCircle(cx,cy,true),$$.redrawText(xForText,yForText,options.flow,true),$$.redrawRegion(true),$$.redrawGrid(true),].forEach(function(transitions){transitions.forEach(function(transition){transitionsToWait.push(transition);});});waitForDraw=$$.generateWait();transitionsToWait.forEach(function(t){waitForDraw.add(t);});}).call(waitForDraw,function(){if(flow){flow();}
if(config.onrendered){config.onrendered.call($$);}});}
else{$$.redrawBar(drawBar);$$.redrawLine(drawLine);$$.redrawArea(drawArea);$$.redrawCircle(cx,cy);$$.redrawText(xForText,yForText,options.flow);$$.redrawRegion();$$.redrawGrid();if(config.onrendered){config.onrendered.call($$);}}
$$.mapToIds($$.data.targets).forEach(function(id){$$.withoutFadeIn[id]=true;});};c3_chart_internal_fn.updateAndRedraw=function(options){var $$=this,config=$$.config,transitions;options=options||{};options.withTransition=getOption(options,"withTransition",true);options.withTransform=getOption(options,"withTransform",false);options.withLegend=getOption(options,"withLegend",false);options.withUpdateXDomain=true;options.withUpdateOrgXDomain=true;options.withTransitionForExit=false;options.withTransitionForTransform=getOption(options,"withTransitionForTransform",options.withTransition);$$.updateSizes();if(!(options.withLegend&&config.legend_show)){transitions=$$.axis.generateTransitions(options.withTransitionForAxis?config.transition_duration:0);$$.updateScales();$$.updateSvgSize();$$.transformAll(options.withTransitionForTransform,transitions);}
$$.redraw(options,transitions);};c3_chart_internal_fn.redrawWithoutRescale=function(){this.redraw({withY:false,withSubchart:false,withEventRect:false,withTransitionForAxis:false});};c3_chart_internal_fn.isTimeSeries=function(){return this.config.axis_x_type==='timeseries';};c3_chart_internal_fn.isCategorized=function(){return this.config.axis_x_type.indexOf('categor')>=0;};c3_chart_internal_fn.isCustomX=function(){var $$=this,config=$$.config;return!$$.isTimeSeries()&&(config.data_x||notEmpty(config.data_xs));};c3_chart_internal_fn.isTimeSeriesY=function(){return this.config.axis_y_type==='timeseries';};c3_chart_internal_fn.getTranslate=function(target){var $$=this,config=$$.config,x,y;if(target==='main'){x=asHalfPixel($$.margin.left);y=asHalfPixel($$.margin.top);}else if(target==='context'){x=asHalfPixel($$.margin2.left);y=asHalfPixel($$.margin2.top);}else if(target==='legend'){x=$$.margin3.left;y=$$.margin3.top;}else if(target==='x'){x=0;y=config.axis_rotated?0:$$.height;}else if(target==='y'){x=0;y=config.axis_rotated?$$.height:0;}else if(target==='y2'){x=config.axis_rotated?0:$$.width;y=config.axis_rotated?1:0;}else if(target==='subx'){x=0;y=config.axis_rotated?0:$$.height2;}else if(target==='arc'){x=$$.arcWidth/2;y=$$.arcHeight/2;}
return"translate("+x+","+y+")";};c3_chart_internal_fn.initialOpacity=function(d){return d.value!==null&&this.withoutFadeIn[d.id]?1:0;};c3_chart_internal_fn.initialOpacityForCircle=function(d){return d.value!==null&&this.withoutFadeIn[d.id]?this.opacityForCircle(d):0;};c3_chart_internal_fn.opacityForCircle=function(d){var opacity=this.config.point_show?1:0;return isValue(d.value)?(this.isScatterType(d)?0.5:opacity):0;};c3_chart_internal_fn.opacityForText=function(){return this.hasDataLabel()?1:0;};c3_chart_internal_fn.xx=function(d){return d?this.x(d.x):null;};c3_chart_internal_fn.xv=function(d){var $$=this,value=d.value;if($$.isTimeSeries()){value=$$.parseDate(d.value);}
else if($$.isCategorized()&&typeof d.value==='string'){value=$$.config.axis_x_categories.indexOf(d.value);}
return Math.ceil($$.x(value));};c3_chart_internal_fn.yv=function(d){var $$=this,yScale=d.axis&&d.axis==='y2'?$$.y2:$$.y;return Math.ceil(yScale(d.value));};c3_chart_internal_fn.subxx=function(d){return d?this.subX(d.x):null;};c3_chart_internal_fn.transformMain=function(withTransition,transitions){var $$=this,xAxis,yAxis,y2Axis;if(transitions&&transitions.axisX){xAxis=transitions.axisX;}else{xAxis=$$.main.select('.'+CLASS.axisX);if(withTransition){xAxis=xAxis.transition();}}
if(transitions&&transitions.axisY){yAxis=transitions.axisY;}else{yAxis=$$.main.select('.'+CLASS.axisY);if(withTransition){yAxis=yAxis.transition();}}
if(transitions&&transitions.axisY2){y2Axis=transitions.axisY2;}else{y2Axis=$$.main.select('.'+CLASS.axisY2);if(withTransition){y2Axis=y2Axis.transition();}}
(withTransition?$$.main.transition():$$.main).attr("transform",$$.getTranslate('main'));xAxis.attr("transform",$$.getTranslate('x'));yAxis.attr("transform",$$.getTranslate('y'));y2Axis.attr("transform",$$.getTranslate('y2'));$$.main.select('.'+CLASS.chartArcs).attr("transform",$$.getTranslate('arc'));};c3_chart_internal_fn.transformAll=function(withTransition,transitions){var $$=this;$$.transformMain(withTransition,transitions);if($$.config.subchart_show){$$.transformContext(withTransition,transitions);}
if($$.legend){$$.transformLegend(withTransition);}};c3_chart_internal_fn.updateSvgSize=function(){var $$=this,brush=$$.svg.select(".c3-brush .background");$$.svg.attr('width',$$.currentWidth).attr('height',$$.currentHeight);$$.svg.selectAll(['#'+$$.clipId,'#'+$$.clipIdForGrid]).select('rect').attr('width',$$.width).attr('height',$$.height);$$.svg.select('#'+$$.clipIdForXAxis).select('rect').attr('x',$$.getXAxisClipX.bind($$)).attr('y',$$.getXAxisClipY.bind($$)).attr('width',$$.getXAxisClipWidth.bind($$)).attr('height',$$.getXAxisClipHeight.bind($$));$$.svg.select('#'+$$.clipIdForYAxis).select('rect').attr('x',$$.getYAxisClipX.bind($$)).attr('y',$$.getYAxisClipY.bind($$)).attr('width',$$.getYAxisClipWidth.bind($$)).attr('height',$$.getYAxisClipHeight.bind($$));$$.svg.select('#'+$$.clipIdForSubchart).select('rect').attr('width',$$.width).attr('height',brush.size()?brush.attr('height'):0);$$.svg.select('.'+CLASS.zoomRect).attr('width',$$.width).attr('height',$$.height);$$.selectChart.style('max-height',$$.currentHeight+"px");};c3_chart_internal_fn.updateDimension=function(withoutAxis){var $$=this;if(!withoutAxis){if($$.config.axis_rotated){$$.axes.x.call($$.xAxis);$$.axes.subx.call($$.subXAxis);}else{$$.axes.y.call($$.yAxis);$$.axes.y2.call($$.y2Axis);}}
$$.updateSizes();$$.updateScales();$$.updateSvgSize();$$.transformAll(false);};c3_chart_internal_fn.observeInserted=function(selection){var $$=this,observer;if(typeof MutationObserver==='undefined'){window.console.error("MutationObserver not defined.");return;}
observer=new MutationObserver(function(mutations){mutations.forEach(function(mutation){if(mutation.type==='childList'&&mutation.previousSibling){observer.disconnect();$$.intervalForObserveInserted=window.setInterval(function(){if(selection.node().parentNode){window.clearInterval($$.intervalForObserveInserted);$$.updateDimension();$$.config.oninit.call($$);$$.redraw({withTransform:true,withUpdateXDomain:true,withUpdateOrgXDomain:true,withTransition:false,withTransitionForTransform:false,withLegend:true});selection.transition().style('opacity',1);}},10);}});});observer.observe(selection.node(),{attributes:true,childList:true,characterData:true});};c3_chart_internal_fn.generateResize=function(){var resizeFunctions=[];function callResizeFunctions(){resizeFunctions.forEach(function(f){f();});}
callResizeFunctions.add=function(f){resizeFunctions.push(f);};return callResizeFunctions;};c3_chart_internal_fn.endall=function(transition,callback){var n=0;transition.each(function(){++n;}).each("end",function(){if(!--n){callback.apply(this,arguments);}});};c3_chart_internal_fn.generateWait=function(){var transitionsToWait=[],f=function(transition,callback){var timer=setInterval(function(){var done=0;transitionsToWait.forEach(function(t){if(t.empty()){done+=1;return;}
try{t.transition();}catch(e){done+=1;}});if(done===transitionsToWait.length){clearInterval(timer);if(callback){callback();}}},10);};f.add=function(transition){transitionsToWait.push(transition);};return f;};c3_chart_internal_fn.parseDate=function(date){var $$=this,parsedDate;if(date instanceof Date){parsedDate=date;}else if(typeof date==='string'){parsedDate=$$.dataTimeFormat($$.config.data_xFormat).parse(date);}else if(typeof date==='number'||!isNaN(date)){parsedDate=new Date(+date);}
if(!parsedDate||isNaN(+parsedDate)){window.console.error("Failed to parse x '"+date+"' to Date object");}
return parsedDate;};c3_chart_internal_fn.isTabVisible=function(){var hidden;if(typeof document.hidden!=="undefined"){hidden="hidden";}else if(typeof document.mozHidden!=="undefined"){hidden="mozHidden";}else if(typeof document.msHidden!=="undefined"){hidden="msHidden";}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";}
return document[hidden]?false:true;};c3_chart_internal_fn.getDefaultConfig=function(){var config={bindto:'#chart',size_width:undefined,size_height:undefined,padding_left:undefined,padding_right:undefined,padding_top:undefined,padding_bottom:undefined,zoom_enabled:false,zoom_extent:undefined,zoom_privileged:false,zoom_rescale:false,zoom_onzoom:function(){},zoom_onzoomstart:function(){},zoom_onzoomend:function(){},interaction_enabled:true,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:undefined,data_xs:{},data_xFormat:'%Y-%m-%d',data_xLocaltime:true,data_xSort:true,data_idConverter:function(id){return id;},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:undefined,data_types:{},data_labels:{},data_order:'desc',data_regions:{},data_color:undefined,data_colors:{},data_hide:false,data_filter:undefined,data_selection_enabled:false,data_selection_grouped:false,data_selection_isselectable:function(){return true;},data_selection_multiple:true,data_selection_draggable:false,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:undefined,data_json:undefined,data_rows:undefined,data_columns:undefined,data_mimeType:undefined,data_keys:undefined,data_empty_label_text:"",subchart_show:false,subchart_size_height:60,subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:true,legend_hide:false,legend_position:'bottom',legend_inset_anchor:'top-left',legend_inset_x:10,legend_inset_y:0,legend_inset_step:undefined,legend_item_onclick:undefined,legend_item_onmouseover:undefined,legend_item_onmouseout:undefined,legend_equally:false,axis_rotated:false,axis_x_show:true,axis_x_type:'indexed',axis_x_localtime:true,axis_x_categories:[],axis_x_tick_centered:false,axis_x_tick_format:undefined,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:undefined,axis_x_tick_fit:true,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:true,axis_x_tick_multiline:true,axis_x_tick_width:null,axis_x_max:undefined,axis_x_min:undefined,axis_x_padding:{},axis_x_height:undefined,axis_x_extent:undefined,axis_x_label:{},axis_y_show:true,axis_y_type:undefined,axis_y_max:undefined,axis_y_min:undefined,axis_y_inverted:false,axis_y_center:undefined,axis_y_inner:undefined,axis_y_label:{},axis_y_tick_format:undefined,axis_y_tick_outer:true,axis_y_tick_values:null,axis_y_tick_count:undefined,axis_y_tick_time_value:undefined,axis_y_tick_time_interval:undefined,axis_y_padding:{},axis_y_default:undefined,axis_y2_show:false,axis_y2_max:undefined,axis_y2_min:undefined,axis_y2_inverted:false,axis_y2_center:undefined,axis_y2_inner:undefined,axis_y2_label:{},axis_y2_tick_format:undefined,axis_y2_tick_outer:true,axis_y2_tick_values:null,axis_y2_tick_count:undefined,axis_y2_padding:{},axis_y2_default:undefined,grid_x_show:false,grid_x_type:'tick',grid_x_lines:[],grid_y_show:false,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:true,grid_lines_front:true,point_show:true,point_r:2.5,point_focus_expand_enabled:true,point_focus_expand_r:undefined,point_select_r:undefined,line_connectNull:false,line_step_type:'step',bar_width:undefined,bar_width_ratio:0.6,bar_width_max:undefined,bar_zerobased:true,area_zerobased:true,pie_label_show:true,pie_label_format:undefined,pie_label_threshold:0.05,pie_expand:true,gauge_label_show:true,gauge_label_format:undefined,gauge_expand:true,gauge_min:0,gauge_max:100,gauge_units:undefined,gauge_width:undefined,donut_label_show:true,donut_label_format:undefined,donut_label_threshold:0.05,donut_width:undefined,donut_expand:true,donut_title:"",regions:[],tooltip_show:true,tooltip_grouped:true,tooltip_format_title:undefined,tooltip_format_name:undefined,tooltip_format_value:undefined,tooltip_position:undefined,tooltip_contents:function(d,defaultTitleFormat,defaultValueFormat,color){return this.getTooltipContent?this.getTooltipContent(d,defaultTitleFormat,defaultValueFormat,color):'';},tooltip_init_show:false,tooltip_init_x:0,tooltip_init_position:{top:'0px',left:'50px'}};Object.keys(this.additionalConfig).forEach(function(key){config[key]=this.additionalConfig[key];},this);return config;};c3_chart_internal_fn.additionalConfig={};c3_chart_internal_fn.loadConfig=function(config){var this_config=this.config,target,keys,read;function find(){var key=keys.shift();if(key&&target&&typeof target==='object'&&key in target){target=target[key];return find();}
else if(!key){return target;}
else{return undefined;}}
Object.keys(this_config).forEach(function(key){target=config;keys=key.split('_');read=find();if(isDefined(read)){this_config[key]=read;}});};c3_chart_internal_fn.getScale=function(min,max,forTimeseries){return(forTimeseries?this.d3.time.scale():this.d3.scale.linear()).range([min,max]);};c3_chart_internal_fn.getX=function(min,max,domain,offset){var $$=this,scale=$$.getScale(min,max,$$.isTimeSeries()),_scale=domain?scale.domain(domain):scale,key;if($$.isCategorized()){offset=offset||function(){return 0;};scale=function(d,raw){var v=_scale(d)+offset(d);return raw?v:Math.ceil(v);};}else{scale=function(d,raw){var v=_scale(d);return raw?v:Math.ceil(v);};}
for(key in _scale){scale[key]=_scale[key];}
scale.orgDomain=function(){return _scale.domain();};if($$.isCategorized()){scale.domain=function(domain){if(!arguments.length){domain=this.orgDomain();return[domain[0],domain[1]+1];}
_scale.domain(domain);return scale;};}
return scale;};c3_chart_internal_fn.getY=function(min,max,domain){var scale=this.getScale(min,max,this.isTimeSeriesY());if(domain){scale.domain(domain);}
return scale;};c3_chart_internal_fn.getYScale=function(id){return this.axis.getId(id)==='y2'?this.y2:this.y;};c3_chart_internal_fn.getSubYScale=function(id){return this.axis.getId(id)==='y2'?this.subY2:this.subY;};c3_chart_internal_fn.updateScales=function(){var $$=this,config=$$.config,forInit=!$$.x;$$.xMin=config.axis_rotated?1:0;$$.xMax=config.axis_rotated?$$.height:$$.width;$$.yMin=config.axis_rotated?0:$$.height;$$.yMax=config.axis_rotated?$$.width:1;$$.subXMin=$$.xMin;$$.subXMax=$$.xMax;$$.subYMin=config.axis_rotated?0:$$.height2;$$.subYMax=config.axis_rotated?$$.width2:1;$$.x=$$.getX($$.xMin,$$.xMax,forInit?undefined:$$.x.orgDomain(),function(){return $$.xAxis.tickOffset();});$$.y=$$.getY($$.yMin,$$.yMax,forInit?config.axis_y_default:$$.y.domain());$$.y2=$$.getY($$.yMin,$$.yMax,forInit?config.axis_y2_default:$$.y2.domain());$$.subX=$$.getX($$.xMin,$$.xMax,$$.orgXDomain,function(d){return d%1?0:$$.subXAxis.tickOffset();});$$.subY=$$.getY($$.subYMin,$$.subYMax,forInit?config.axis_y_default:$$.subY.domain());$$.subY2=$$.getY($$.subYMin,$$.subYMax,forInit?config.axis_y2_default:$$.subY2.domain());$$.xAxisTickFormat=$$.axis.getXAxisTickFormat();$$.xAxisTickValues=$$.axis.getXAxisTickValues();$$.yAxisTickValues=$$.axis.getYAxisTickValues();$$.y2AxisTickValues=$$.axis.getY2AxisTickValues();$$.xAxis=$$.axis.getXAxis($$.x,$$.xOrient,$$.xAxisTickFormat,$$.xAxisTickValues,config.axis_x_tick_outer);$$.subXAxis=$$.axis.getXAxis($$.subX,$$.subXOrient,$$.xAxisTickFormat,$$.xAxisTickValues,config.axis_x_tick_outer);$$.yAxis=$$.axis.getYAxis($$.y,$$.yOrient,config.axis_y_tick_format,$$.yAxisTickValues,config.axis_y_tick_outer);$$.y2Axis=$$.axis.getYAxis($$.y2,$$.y2Orient,config.axis_y2_tick_format,$$.y2AxisTickValues,config.axis_y2_tick_outer);if(!forInit){if($$.brush){$$.brush.scale($$.subX);}
if(config.zoom_enabled){$$.zoom.scale($$.x);}}
if($$.updateArc){$$.updateArc();}};c3_chart_internal_fn.getYDomainMin=function(targets){var $$=this,config=$$.config,ids=$$.mapToIds(targets),ys=$$.getValuesAsIdKeyed(targets),j,k,baseId,idsInGroup,id,hasNegativeValue;if(config.data_groups.length>0){hasNegativeValue=$$.hasNegativeValueInTargets(targets);for(j=0;j<config.data_groups.length;j++){idsInGroup=config.data_groups[j].filter(function(id){return ids.indexOf(id)>=0;});if(idsInGroup.length===0){continue;}
baseId=idsInGroup[0];if(hasNegativeValue&&ys[baseId]){ys[baseId].forEach(function(v,i){ys[baseId][i]=v<0?v:0;});}
for(k=1;k<idsInGroup.length;k++){id=idsInGroup[k];if(!ys[id]){continue;}
ys[id].forEach(function(v,i){if($$.axis.getId(id)===$$.axis.getId(baseId)&&ys[baseId]&&!(hasNegativeValue&&+v>0)){ys[baseId][i]+=+v;}});}}}
return $$.d3.min(Object.keys(ys).map(function(key){return $$.d3.min(ys[key]);}));};c3_chart_internal_fn.getYDomainMax=function(targets){var $$=this,config=$$.config,ids=$$.mapToIds(targets),ys=$$.getValuesAsIdKeyed(targets),j,k,baseId,idsInGroup,id,hasPositiveValue;if(config.data_groups.length>0){hasPositiveValue=$$.hasPositiveValueInTargets(targets);for(j=0;j<config.data_groups.length;j++){idsInGroup=config.data_groups[j].filter(function(id){return ids.indexOf(id)>=0;});if(idsInGroup.length===0){continue;}
baseId=idsInGroup[0];if(hasPositiveValue&&ys[baseId]){ys[baseId].forEach(function(v,i){ys[baseId][i]=v>0?v:0;});}
for(k=1;k<idsInGroup.length;k++){id=idsInGroup[k];if(!ys[id]){continue;}
ys[id].forEach(function(v,i){if($$.axis.getId(id)===$$.axis.getId(baseId)&&ys[baseId]&&!(hasPositiveValue&&+v<0)){ys[baseId][i]+=+v;}});}}}
return $$.d3.max(Object.keys(ys).map(function(key){return $$.d3.max(ys[key]);}));};c3_chart_internal_fn.getYDomain=function(targets,axisId,xDomain){var $$=this,config=$$.config,targetsByAxisId=targets.filter(function(t){return $$.axis.getId(t.id)===axisId;}),yTargets=xDomain?$$.filterByXDomain(targetsByAxisId,xDomain):targetsByAxisId,yMin=axisId==='y2'?config.axis_y2_min:config.axis_y_min,yMax=axisId==='y2'?config.axis_y2_max:config.axis_y_max,yDomainMin=$$.getYDomainMin(yTargets),yDomainMax=$$.getYDomainMax(yTargets),domain,domainLength,padding,padding_top,padding_bottom,center=axisId==='y2'?config.axis_y2_center:config.axis_y_center,yDomainAbs,lengths,diff,ratio,isAllPositive,isAllNegative,isZeroBased=($$.hasType('bar',yTargets)&&config.bar_zerobased)||($$.hasType('area',yTargets)&&config.area_zerobased),isInverted=axisId==='y2'?config.axis_y2_inverted:config.axis_y_inverted,showHorizontalDataLabel=$$.hasDataLabel()&&config.axis_rotated,showVerticalDataLabel=$$.hasDataLabel()&&!config.axis_rotated;yDomainMin=isValue(yMin)?yMin:isValue(yMax)?(yDomainMin<yMax?yDomainMin:yMax-10):yDomainMin;yDomainMax=isValue(yMax)?yMax:isValue(yMin)?(yMin<yDomainMax?yDomainMax:yMin+10):yDomainMax;if(yTargets.length===0){return axisId==='y2'?$$.y2.domain():$$.y.domain();}
if(isNaN(yDomainMin)){yDomainMin=0;}
if(isNaN(yDomainMax)){yDomainMax=yDomainMin;}
if(yDomainMin===yDomainMax){yDomainMin<0?yDomainMax=0:yDomainMin=0;}
isAllPositive=yDomainMin>=0&&yDomainMax>=0;isAllNegative=yDomainMin<=0&&yDomainMax<=0;if((isValue(yMin)&&isAllPositive)||(isValue(yMax)&&isAllNegative)){isZeroBased=false;}
if(isZeroBased){if(isAllPositive){yDomainMin=0;}
if(isAllNegative){yDomainMax=0;}}
domainLength=Math.abs(yDomainMax-yDomainMin);padding=padding_top=padding_bottom=domainLength*0.1;if(typeof center!=='undefined'){yDomainAbs=Math.max(Math.abs(yDomainMin),Math.abs(yDomainMax));yDomainMax=center+yDomainAbs;yDomainMin=center-yDomainAbs;}
if(showHorizontalDataLabel){lengths=$$.getDataLabelLength(yDomainMin,yDomainMax,'width');diff=diffDomain($$.y.range());ratio=[lengths[0]/diff,lengths[1]/diff];padding_top+=domainLength*(ratio[1]/(1-ratio[0]-ratio[1]));padding_bottom+=domainLength*(ratio[0]/(1-ratio[0]-ratio[1]));}else if(showVerticalDataLabel){lengths=$$.getDataLabelLength(yDomainMin,yDomainMax,'height');padding_top+=$$.axis.convertPixelsToAxisPadding(lengths[1],domainLength);padding_bottom+=$$.axis.convertPixelsToAxisPadding(lengths[0],domainLength);}
if(axisId==='y'&&notEmpty(config.axis_y_padding)){padding_top=$$.axis.getPadding(config.axis_y_padding,'top',padding_top,domainLength);padding_bottom=$$.axis.getPadding(config.axis_y_padding,'bottom',padding_bottom,domainLength);}
if(axisId==='y2'&&notEmpty(config.axis_y2_padding)){padding_top=$$.axis.getPadding(config.axis_y2_padding,'top',padding_top,domainLength);padding_bottom=$$.axis.getPadding(config.axis_y2_padding,'bottom',padding_bottom,domainLength);}
if(isZeroBased){if(isAllPositive){padding_bottom=yDomainMin;}
if(isAllNegative){padding_top=-yDomainMax;}}
domain=[yDomainMin-padding_bottom,yDomainMax+padding_top];return isInverted?domain.reverse():domain;};c3_chart_internal_fn.getXDomainMin=function(targets){var $$=this,config=$$.config;return isDefined(config.axis_x_min)?($$.isTimeSeries()?this.parseDate(config.axis_x_min):config.axis_x_min):$$.d3.min(targets,function(t){return $$.d3.min(t.values,function(v){return v.x;});});};c3_chart_internal_fn.getXDomainMax=function(targets){var $$=this,config=$$.config;return isDefined(config.axis_x_max)?($$.isTimeSeries()?this.parseDate(config.axis_x_max):config.axis_x_max):$$.d3.max(targets,function(t){return $$.d3.max(t.values,function(v){return v.x;});});};c3_chart_internal_fn.getXDomainPadding=function(domain){var $$=this,config=$$.config,diff=domain[1]-domain[0],maxDataCount,padding,paddingLeft,paddingRight;if($$.isCategorized()){padding=0;}else if($$.hasType('bar')){maxDataCount=$$.getMaxDataCount();padding=maxDataCount>1?(diff/(maxDataCount-1))/2:0.5;}else{padding=diff*0.01;}
if(typeof config.axis_x_padding==='object'&&notEmpty(config.axis_x_padding)){paddingLeft=isValue(config.axis_x_padding.left)?config.axis_x_padding.left:padding;paddingRight=isValue(config.axis_x_padding.right)?config.axis_x_padding.right:padding;}else if(typeof config.axis_x_padding==='number'){paddingLeft=paddingRight=config.axis_x_padding;}else{paddingLeft=paddingRight=padding;}
return{left:paddingLeft,right:paddingRight};};c3_chart_internal_fn.getXDomain=function(targets){var $$=this,xDomain=[$$.getXDomainMin(targets),$$.getXDomainMax(targets)],firstX=xDomain[0],lastX=xDomain[1],padding=$$.getXDomainPadding(xDomain),min=0,max=0;if((firstX-lastX)===0&&!$$.isCategorized()){if($$.isTimeSeries()){firstX=new Date(firstX.getTime()*0.5);lastX=new Date(lastX.getTime()*1.5);}else{firstX=firstX===0?1:(firstX*0.5);lastX=lastX===0?-1:(lastX*1.5);}}
if(firstX||firstX===0){min=$$.isTimeSeries()?new Date(firstX.getTime()-padding.left):firstX-padding.left;}
if(lastX||lastX===0){max=$$.isTimeSeries()?new Date(lastX.getTime()+padding.right):lastX+padding.right;}
return[min,max];};c3_chart_internal_fn.updateXDomain=function(targets,withUpdateXDomain,withUpdateOrgXDomain,withTrim,domain){var $$=this,config=$$.config;if(withUpdateOrgXDomain){$$.x.domain(domain?domain:$$.d3.extent($$.getXDomain(targets)));$$.orgXDomain=$$.x.domain();if(config.zoom_enabled){$$.zoom.scale($$.x).updateScaleExtent();}
$$.subX.domain($$.x.domain());if($$.brush){$$.brush.scale($$.subX);}}
if(withUpdateXDomain){$$.x.domain(domain?domain:(!$$.brush||$$.brush.empty())?$$.orgXDomain:$$.brush.extent());if(config.zoom_enabled){$$.zoom.scale($$.x).updateScaleExtent();}}
if(withTrim){$$.x.domain($$.trimXDomain($$.x.orgDomain()));}
return $$.x.domain();};c3_chart_internal_fn.trimXDomain=function(domain){var $$=this;if(domain[0]<=$$.orgXDomain[0]){domain[1]=+domain[1]+($$.orgXDomain[0]-domain[0]);domain[0]=$$.orgXDomain[0];}
if($$.orgXDomain[1]<=domain[1]){domain[0]=+domain[0]-(domain[1]-$$.orgXDomain[1]);domain[1]=$$.orgXDomain[1];}
return domain;};c3_chart_internal_fn.isX=function(key){var $$=this,config=$$.config;return(config.data_x&&key===config.data_x)||(notEmpty(config.data_xs)&&hasValue(config.data_xs,key));};c3_chart_internal_fn.isNotX=function(key){return!this.isX(key);};c3_chart_internal_fn.getXKey=function(id){var $$=this,config=$$.config;return config.data_x?config.data_x:notEmpty(config.data_xs)?config.data_xs[id]:null;};c3_chart_internal_fn.getXValuesOfXKey=function(key,targets){var $$=this,xValues,ids=targets&&notEmpty(targets)?$$.mapToIds(targets):[];ids.forEach(function(id){if($$.getXKey(id)===key){xValues=$$.data.xs[id];}});return xValues;};c3_chart_internal_fn.getIndexByX=function(x){var $$=this,data=$$.filterByX($$.data.targets,x);return data.length?data[0].index:null;};c3_chart_internal_fn.getXValue=function(id,i){var $$=this;return id in $$.data.xs&&$$.data.xs[id]&&isValue($$.data.xs[id][i])?$$.data.xs[id][i]:i;};c3_chart_internal_fn.getOtherTargetXs=function(){var $$=this,idsForX=Object.keys($$.data.xs);return idsForX.length?$$.data.xs[idsForX[0]]:null;};c3_chart_internal_fn.getOtherTargetX=function(index){var xs=this.getOtherTargetXs();return xs&&index<xs.length?xs[index]:null;};c3_chart_internal_fn.addXs=function(xs){var $$=this;Object.keys(xs).forEach(function(id){$$.config.data_xs[id]=xs[id];});};c3_chart_internal_fn.hasMultipleX=function(xs){return this.d3.set(Object.keys(xs).map(function(id){return xs[id];})).size()>1;};c3_chart_internal_fn.isMultipleX=function(){return notEmpty(this.config.data_xs)||!this.config.data_xSort||this.hasType('scatter');};c3_chart_internal_fn.addName=function(data){var $$=this,name;if(data){name=$$.config.data_names[data.id];data.name=name?name:data.id;}
return data;};c3_chart_internal_fn.getValueOnIndex=function(values,index){var valueOnIndex=values.filter(function(v){return v.index===index;});return valueOnIndex.length?valueOnIndex[0]:null;};c3_chart_internal_fn.updateTargetX=function(targets,x){var $$=this;targets.forEach(function(t){t.values.forEach(function(v,i){v.x=$$.generateTargetX(x[i],t.id,i);});$$.data.xs[t.id]=x;});};c3_chart_internal_fn.updateTargetXs=function(targets,xs){var $$=this;targets.forEach(function(t){if(xs[t.id]){$$.updateTargetX([t],xs[t.id]);}});};c3_chart_internal_fn.generateTargetX=function(rawX,id,index){var $$=this,x;if($$.isTimeSeries()){x=rawX?$$.parseDate(rawX):$$.parseDate($$.getXValue(id,index));}
else if($$.isCustomX()&&!$$.isCategorized()){x=isValue(rawX)?+rawX:$$.getXValue(id,index);}
else{x=index;}
return x;};c3_chart_internal_fn.cloneTarget=function(target){return{id:target.id,id_org:target.id_org,values:target.values.map(function(d){return{x:d.x,value:d.value,id:d.id};})};};c3_chart_internal_fn.updateXs=function(){var $$=this;if($$.data.targets.length){$$.xs=[];$$.data.targets[0].values.forEach(function(v){$$.xs[v.index]=v.x;});}};c3_chart_internal_fn.getPrevX=function(i){var x=this.xs[i-1];return typeof x!=='undefined'?x:null;};c3_chart_internal_fn.getNextX=function(i){var x=this.xs[i+1];return typeof x!=='undefined'?x:null;};c3_chart_internal_fn.getMaxDataCount=function(){var $$=this;return $$.d3.max($$.data.targets,function(t){return t.values.length;});};c3_chart_internal_fn.getMaxDataCountTarget=function(targets){var length=targets.length,max=0,maxTarget;if(length>1){targets.forEach(function(t){if(t.values.length>max){maxTarget=t;max=t.values.length;}});}else{maxTarget=length?targets[0]:null;}
return maxTarget;};c3_chart_internal_fn.getEdgeX=function(targets){var $$=this;return!targets.length?[0,0]:[$$.d3.min(targets,function(t){return t.values[0].x;}),$$.d3.max(targets,function(t){return t.values[t.values.length-1].x;})];};c3_chart_internal_fn.mapToIds=function(targets){return targets.map(function(d){return d.id;});};c3_chart_internal_fn.mapToTargetIds=function(ids){var $$=this;return ids?(isString(ids)?[ids]:ids):$$.mapToIds($$.data.targets);};c3_chart_internal_fn.hasTarget=function(targets,id){var ids=this.mapToIds(targets),i;for(i=0;i<ids.length;i++){if(ids[i]===id){return true;}}
return false;};c3_chart_internal_fn.isTargetToShow=function(targetId){return this.hiddenTargetIds.indexOf(targetId)<0;};c3_chart_internal_fn.isLegendToShow=function(targetId){return this.hiddenLegendIds.indexOf(targetId)<0;};c3_chart_internal_fn.filterTargetsToShow=function(targets){var $$=this;return targets.filter(function(t){return $$.isTargetToShow(t.id);});};c3_chart_internal_fn.mapTargetsToUniqueXs=function(targets){var $$=this;var xs=$$.d3.set($$.d3.merge(targets.map(function(t){return t.values.map(function(v){return+v.x;});}))).values();return $$.isTimeSeries()?xs.map(function(x){return new Date(+x);}):xs.map(function(x){return+x;});};c3_chart_internal_fn.addHiddenTargetIds=function(targetIds){this.hiddenTargetIds=this.hiddenTargetIds.concat(targetIds);};c3_chart_internal_fn.removeHiddenTargetIds=function(targetIds){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(id){return targetIds.indexOf(id)<0;});};c3_chart_internal_fn.addHiddenLegendIds=function(targetIds){this.hiddenLegendIds=this.hiddenLegendIds.concat(targetIds);};c3_chart_internal_fn.removeHiddenLegendIds=function(targetIds){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(id){return targetIds.indexOf(id)<0;});};c3_chart_internal_fn.getValuesAsIdKeyed=function(targets){var ys={};targets.forEach(function(t){ys[t.id]=[];t.values.forEach(function(v){ys[t.id].push(v.value);});});return ys;};c3_chart_internal_fn.checkValueInTargets=function(targets,checker){var ids=Object.keys(targets),i,j,values;for(i=0;i<ids.length;i++){values=targets[ids[i]].values;for(j=0;j<values.length;j++){if(checker(values[j].value)){return true;}}}
return false;};c3_chart_internal_fn.hasNegativeValueInTargets=function(targets){return this.checkValueInTargets(targets,function(v){return v<0;});};c3_chart_internal_fn.hasPositiveValueInTargets=function(targets){return this.checkValueInTargets(targets,function(v){return v>0;});};c3_chart_internal_fn.isOrderDesc=function(){var config=this.config;return typeof(config.data_order)==='string'&&config.data_order.toLowerCase()==='desc';};c3_chart_internal_fn.isOrderAsc=function(){var config=this.config;return typeof(config.data_order)==='string'&&config.data_order.toLowerCase()==='asc';};c3_chart_internal_fn.orderTargets=function(targets){var $$=this,config=$$.config,orderAsc=$$.isOrderAsc(),orderDesc=$$.isOrderDesc();if(orderAsc||orderDesc){targets.sort(function(t1,t2){var reducer=function(p,c){return p+Math.abs(c.value);};var t1Sum=t1.values.reduce(reducer,0),t2Sum=t2.values.reduce(reducer,0);return orderAsc?t2Sum-t1Sum:t1Sum-t2Sum;});}else if(isFunction(config.data_order)){targets.sort(config.data_order);}
return targets;};c3_chart_internal_fn.filterByX=function(targets,x){return this.d3.merge(targets.map(function(t){return t.values;})).filter(function(v){return v.x-x===0;});};c3_chart_internal_fn.filterRemoveNull=function(data){return data.filter(function(d){return isValue(d.value);});};c3_chart_internal_fn.filterByXDomain=function(targets,xDomain){return targets.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(v){return xDomain[0]<=v.x&&v.x<=xDomain[1];})};});};c3_chart_internal_fn.hasDataLabel=function(){var config=this.config;if(typeof config.data_labels==='boolean'&&config.data_labels){return true;}else if(typeof config.data_labels==='object'&&notEmpty(config.data_labels)){return true;}
return false;};c3_chart_internal_fn.getDataLabelLength=function(min,max,key){var $$=this,lengths=[0,0],paddingCoef=1.3;$$.selectChart.select('svg').selectAll('.dummy').data([min,max]).enter().append('text').text(function(d){return $$.dataLabelFormat(d.id)(d);}).each(function(d,i){lengths[i]=this.getBoundingClientRect()[key]*paddingCoef;}).remove();return lengths;};c3_chart_internal_fn.isNoneArc=function(d){return this.hasTarget(this.data.targets,d.id);},c3_chart_internal_fn.isArc=function(d){return'data'in d&&this.hasTarget(this.data.targets,d.data.id);};c3_chart_internal_fn.findSameXOfValues=function(values,index){var i,targetX=values[index].x,sames=[];for(i=index-1;i>=0;i--){if(targetX!==values[i].x){break;}
sames.push(values[i]);}
for(i=index;i<values.length;i++){if(targetX!==values[i].x){break;}
sames.push(values[i]);}
return sames;};c3_chart_internal_fn.findClosestFromTargets=function(targets,pos){var $$=this,candidates;candidates=targets.map(function(target){return $$.findClosest(target.values,pos);});return $$.findClosest(candidates,pos);};c3_chart_internal_fn.findClosest=function(values,pos){var $$=this,minDist=100,closest;values.filter(function(v){return v&&$$.isBarType(v.id);}).forEach(function(v){var shape=$$.main.select('.'+CLASS.bars+$$.getTargetSelectorSuffix(v.id)+' .'+CLASS.bar+'-'+v.index).node();if(!closest&&$$.isWithinBar(shape)){closest=v;}});values.filter(function(v){return v&&!$$.isBarType(v.id);}).forEach(function(v){var d=$$.dist(v,pos);if(d<minDist){minDist=d;closest=v;}});return closest;};c3_chart_internal_fn.dist=function(data,pos){var $$=this,config=$$.config,xIndex=config.axis_rotated?1:0,yIndex=config.axis_rotated?0:1,y=$$.circleY(data,data.index),x=$$.x(data.x);return Math.pow(x-pos[xIndex],2)+Math.pow(y-pos[yIndex],2);};c3_chart_internal_fn.convertValuesToStep=function(values){var converted=[].concat(values),i;if(!this.isCategorized()){return values;}
for(i=values.length+1;0<i;i--){converted[i]=converted[i-1];}
converted[0]={x:converted[0].x-1,value:converted[0].value,id:converted[0].id};converted[values.length+1]={x:converted[values.length].x+1,value:converted[values.length].value,id:converted[values.length].id};return converted;};c3_chart_internal_fn.updateDataAttributes=function(name,attrs){var $$=this,config=$$.config,current=config['data_'+name];if(typeof attrs==='undefined'){return current;}
Object.keys(attrs).forEach(function(id){current[id]=attrs[id];});$$.redraw({withLegend:true});return current;};c3_chart_internal_fn.convertUrlToData=function(url,mimeType,keys,done){var $$=this,type=mimeType?mimeType:'csv';$$.d3.xhr(url,function(error,data){var d;if(!data){throw new Error(error.responseURL+' '+error.status+' ('+error.statusText+')');}
if(type==='json'){d=$$.convertJsonToData(JSON.parse(data.response),keys);}else if(type==='tsv'){d=$$.convertTsvToData(data.response);}else{d=$$.convertCsvToData(data.response);}
done.call($$,d);});};c3_chart_internal_fn.convertXsvToData=function(xsv,parser){var rows=parser.parseRows(xsv),d;if(rows.length===1){d=[{}];rows[0].forEach(function(id){d[0][id]=null;});}else{d=parser.parse(xsv);}
return d;};c3_chart_internal_fn.convertCsvToData=function(csv){return this.convertXsvToData(csv,this.d3.csv);};c3_chart_internal_fn.convertTsvToData=function(tsv){return this.convertXsvToData(tsv,this.d3.tsv);};c3_chart_internal_fn.convertJsonToData=function(json,keys){var $$=this,new_rows=[],targetKeys,data;if(keys){if(keys.x){targetKeys=keys.value.concat(keys.x);$$.config.data_x=keys.x;}else{targetKeys=keys.value;}
new_rows.push(targetKeys);json.forEach(function(o){var new_row=[];targetKeys.forEach(function(key){var v=isUndefined(o[key])?null:o[key];new_row.push(v);});new_rows.push(new_row);});data=$$.convertRowsToData(new_rows);}else{Object.keys(json).forEach(function(key){new_rows.push([key].concat(json[key]));});data=$$.convertColumnsToData(new_rows);}
return data;};c3_chart_internal_fn.convertRowsToData=function(rows){var keys=rows[0],new_row={},new_rows=[],i,j;for(i=1;i<rows.length;i++){new_row={};for(j=0;j<rows[i].length;j++){if(isUndefined(rows[i][j])){throw new Error("Source data is missing a component at ("+i+","+j+")!");}
new_row[keys[j]]=rows[i][j];}
new_rows.push(new_row);}
return new_rows;};c3_chart_internal_fn.convertColumnsToData=function(columns){var new_rows=[],i,j,key;for(i=0;i<columns.length;i++){key=columns[i][0];for(j=1;j<columns[i].length;j++){if(isUndefined(new_rows[j-1])){new_rows[j-1]={};}
if(isUndefined(columns[i][j])){throw new Error("Source data is missing a component at ("+i+","+j+")!");}
new_rows[j-1][key]=columns[i][j];}}
return new_rows;};c3_chart_internal_fn.convertDataToTargets=function(data,appendXs){var $$=this,config=$$.config,ids=$$.d3.keys(data[0]).filter($$.isNotX,$$),xs=$$.d3.keys(data[0]).filter($$.isX,$$),targets;ids.forEach(function(id){var xKey=$$.getXKey(id);if($$.isCustomX()||$$.isTimeSeries()){if(xs.indexOf(xKey)>=0){$$.data.xs[id]=(appendXs&&$$.data.xs[id]?$$.data.xs[id]:[]).concat(data.map(function(d){return d[xKey];}).filter(isValue).map(function(rawX,i){return $$.generateTargetX(rawX,id,i);}));}
else if(config.data_x){$$.data.xs[id]=$$.getOtherTargetXs();}
else if(notEmpty(config.data_xs)){$$.data.xs[id]=$$.getXValuesOfXKey(xKey,$$.data.targets);}}else{$$.data.xs[id]=data.map(function(d,i){return i;});}});ids.forEach(function(id){if(!$$.data.xs[id]){throw new Error('x is not defined for id = "'+id+'".');}});targets=ids.map(function(id,index){var convertedId=config.data_idConverter(id);return{id:convertedId,id_org:id,values:data.map(function(d,i){var xKey=$$.getXKey(id),rawX=d[xKey],x=$$.generateTargetX(rawX,id,i);if($$.isCustomX()&&$$.isCategorized()&&index===0&&rawX){if(i===0){config.axis_x_categories=[];}
config.axis_x_categories.push(rawX);}
if(isUndefined(d[id])||$$.data.xs[id].length<=i){x=undefined;}
return{x:x,value:d[id]!==null&&!isNaN(d[id])?+d[id]:null,id:convertedId};}).filter(function(v){return isDefined(v.x);})};});targets.forEach(function(t){var i;if(config.data_xSort){t.values=t.values.sort(function(v1,v2){var x1=v1.x||v1.x===0?v1.x:Infinity,x2=v2.x||v2.x===0?v2.x:Infinity;return x1-x2;});}
i=0;t.values.forEach(function(v){v.index=i++;});$$.data.xs[t.id].sort(function(v1,v2){return v1-v2;});});if(config.data_type){$$.setTargetType($$.mapToIds(targets).filter(function(id){return!(id in config.data_types);}),config.data_type);}
targets.forEach(function(d){$$.addCache(d.id_org,d);});return targets;};c3_chart_internal_fn.load=function(targets,args){var $$=this;if(targets){if(args.filter){targets=targets.filter(args.filter);}
if(args.type||args.types){targets.forEach(function(t){var type=args.types&&args.types[t.id]?args.types[t.id]:args.type;$$.setTargetType(t.id,type);});}
$$.data.targets.forEach(function(d){for(var i=0;i<targets.length;i++){if(d.id===targets[i].id){d.values=targets[i].values;targets.splice(i,1);break;}}});$$.data.targets=$$.data.targets.concat(targets);}
$$.updateTargets($$.data.targets);$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});if(args.done){args.done();}};c3_chart_internal_fn.loadFromArgs=function(args){var $$=this;if(args.data){$$.load($$.convertDataToTargets(args.data),args);}
else if(args.url){$$.convertUrlToData(args.url,args.mimeType,args.keys,function(data){$$.load($$.convertDataToTargets(data),args);});}
else if(args.json){$$.load($$.convertDataToTargets($$.convertJsonToData(args.json,args.keys)),args);}
else if(args.rows){$$.load($$.convertDataToTargets($$.convertRowsToData(args.rows)),args);}
else if(args.columns){$$.load($$.convertDataToTargets($$.convertColumnsToData(args.columns)),args);}
else{$$.load(null,args);}};c3_chart_internal_fn.unload=function(targetIds,done){var $$=this;if(!done){done=function(){};}
targetIds=targetIds.filter(function(id){return $$.hasTarget($$.data.targets,id);});if(!targetIds||targetIds.length===0){done();return;}
$$.svg.selectAll(targetIds.map(function(id){return $$.selectorTarget(id);})).transition().style('opacity',0).remove().call($$.endall,done);targetIds.forEach(function(id){$$.withoutFadeIn[id]=false;if($$.legend){$$.legend.selectAll('.'+CLASS.legendItem+$$.getTargetSelectorSuffix(id)).remove();}
$$.data.targets=$$.data.targets.filter(function(t){return t.id!==id;});});};c3_chart_internal_fn.categoryName=function(i){var config=this.config;return i<config.axis_x_categories.length?config.axis_x_categories[i]:i;};c3_chart_internal_fn.initEventRect=function(){var $$=this;$$.main.select('.'+CLASS.chart).append("g").attr("class",CLASS.eventRects).style('fill-opacity',0);};c3_chart_internal_fn.redrawEventRect=function(){var $$=this,config=$$.config,eventRectUpdate,maxDataCountTarget,isMultipleX=$$.isMultipleX();var eventRects=$$.main.select('.'+CLASS.eventRects).style('cursor',config.zoom_enabled?config.axis_rotated?'ns-resize':'ew-resize':null).classed(CLASS.eventRectsMultiple,isMultipleX).classed(CLASS.eventRectsSingle,!isMultipleX);eventRects.selectAll('.'+CLASS.eventRect).remove();$$.eventRect=eventRects.selectAll('.'+CLASS.eventRect);if(isMultipleX){eventRectUpdate=$$.eventRect.data([0]);$$.generateEventRectsForMultipleXs(eventRectUpdate.enter());$$.updateEventRect(eventRectUpdate);}
else{maxDataCountTarget=$$.getMaxDataCountTarget($$.data.targets);eventRects.datum(maxDataCountTarget?maxDataCountTarget.values:[]);$$.eventRect=eventRects.selectAll('.'+CLASS.eventRect);eventRectUpdate=$$.eventRect.data(function(d){return d;});$$.generateEventRectsForSingleX(eventRectUpdate.enter());$$.updateEventRect(eventRectUpdate);eventRectUpdate.exit().remove();}};c3_chart_internal_fn.updateEventRect=function(eventRectUpdate){var $$=this,config=$$.config,x,y,w,h,rectW,rectX;eventRectUpdate=eventRectUpdate||$$.eventRect.data(function(d){return d;});if($$.isMultipleX()){x=0;y=0;w=$$.width;h=$$.height;}
else{if(($$.isCustomX()||$$.isTimeSeries())&&!$$.isCategorized()){$$.updateXs();rectW=function(d){var prevX=$$.getPrevX(d.index),nextX=$$.getNextX(d.index);if(prevX===null&&nextX===null){return config.axis_rotated?$$.height:$$.width;}
if(prevX===null){prevX=$$.x.domain()[0];}
if(nextX===null){nextX=$$.x.domain()[1];}
return Math.max(0,($$.x(nextX)-$$.x(prevX))/2);};rectX=function(d){var prevX=$$.getPrevX(d.index),nextX=$$.getNextX(d.index),thisX=$$.data.xs[d.id][d.index];if(prevX===null&&nextX===null){return 0;}
if(prevX===null){prevX=$$.x.domain()[0];}
return($$.x(thisX)+$$.x(prevX))/2;};}else{rectW=$$.getEventRectWidth();rectX=function(d){return $$.x(d.x)-(rectW/2);};}
x=config.axis_rotated?0:rectX;y=config.axis_rotated?rectX:0;w=config.axis_rotated?$$.width:rectW;h=config.axis_rotated?rectW:$$.height;}
eventRectUpdate.attr('class',$$.classEvent.bind($$)).attr("x",x).attr("y",y).attr("width",w).attr("height",h);};c3_chart_internal_fn.generateEventRectsForSingleX=function(eventRectEnter){var $$=this,d3=$$.d3,config=$$.config;eventRectEnter.append("rect").attr("class",$$.classEvent.bind($$)).style("cursor",config.data_selection_enabled&&config.data_selection_grouped?"pointer":null).on('mouseover',function(d){var index=d.index;if($$.dragging||$$.flowing){return;}
if($$.hasArcType()){return;}
if(config.point_focus_expand_enabled){$$.expandCircles(index,null,true);}
$$.expandBars(index,null,true);$$.main.selectAll('.'+CLASS.shape+'-'+index).each(function(d){config.data_onmouseover.call($$.api,d);});}).on('mouseout',function(d){var index=d.index;if(!$$.config){return;}
if($$.hasArcType()){return;}
$$.hideXGridFocus();$$.hideTooltip();$$.unexpandCircles();$$.unexpandBars();$$.main.selectAll('.'+CLASS.shape+'-'+index).each(function(d){config.data_onmouseout.call($$.api,d);});}).on('mousemove',function(d){var selectedData,index=d.index,eventRect=$$.svg.select('.'+CLASS.eventRect+'-'+index);if($$.dragging||$$.flowing){return;}
if($$.hasArcType()){return;}
if($$.isStepType(d)&&$$.config.line_step_type==='step-after'&&d3.mouse(this)[0]<$$.x($$.getXValue(d.id,index))){index-=1;}
selectedData=$$.filterTargetsToShow($$.data.targets).map(function(t){return $$.addName($$.getValueOnIndex(t.values,index));});if(config.tooltip_grouped){$$.showTooltip(selectedData,this);$$.showXGridFocus(selectedData);}
if(config.tooltip_grouped&&(!config.data_selection_enabled||config.data_selection_grouped)){return;}
$$.main.selectAll('.'+CLASS.shape+'-'+index).each(function(){d3.select(this).classed(CLASS.EXPANDED,true);if(config.data_selection_enabled){eventRect.style('cursor',config.data_selection_grouped?'pointer':null);}
if(!config.tooltip_grouped){$$.hideXGridFocus();$$.hideTooltip();if(!config.data_selection_grouped){$$.unexpandCircles(index);$$.unexpandBars(index);}}}).filter(function(d){return $$.isWithinShape(this,d);}).each(function(d){if(config.data_selection_enabled&&(config.data_selection_grouped||config.data_selection_isselectable(d))){eventRect.style('cursor','pointer');}
if(!config.tooltip_grouped){$$.showTooltip([d],this);$$.showXGridFocus([d]);if(config.point_focus_expand_enabled){$$.expandCircles(index,d.id,true);}
$$.expandBars(index,d.id,true);}});}).on('click',function(d){var index=d.index;if($$.hasArcType()||!$$.toggleShape){return;}
if($$.cancelClick){$$.cancelClick=false;return;}
if($$.isStepType(d)&&config.line_step_type==='step-after'&&d3.mouse(this)[0]<$$.x($$.getXValue(d.id,index))){index-=1;}
$$.main.selectAll('.'+CLASS.shape+'-'+index).each(function(d){if(config.data_selection_grouped||$$.isWithinShape(this,d)){$$.toggleShape(this,d,index);$$.config.data_onclick.call($$.api,d,this);}});}).call(config.data_selection_draggable&&$$.drag?(d3.behavior.drag().origin(Object).on('drag',function(){$$.drag(d3.mouse(this));}).on('dragstart',function(){$$.dragstart(d3.mouse(this));}).on('dragend',function(){$$.dragend();})):function(){});};c3_chart_internal_fn.generateEventRectsForMultipleXs=function(eventRectEnter){var $$=this,d3=$$.d3,config=$$.config;function mouseout(){$$.svg.select('.'+CLASS.eventRect).style('cursor',null);$$.hideXGridFocus();$$.hideTooltip();$$.unexpandCircles();$$.unexpandBars();}
eventRectEnter.append('rect').attr('x',0).attr('y',0).attr('width',$$.width).attr('height',$$.height).attr('class',CLASS.eventRect).on('mouseout',function(){if(!$$.config){return;}
if($$.hasArcType()){return;}
mouseout();}).on('mousemove',function(){var targetsToShow=$$.filterTargetsToShow($$.data.targets);var mouse,closest,sameXData,selectedData;if($$.dragging){return;}
if($$.hasArcType(targetsToShow)){return;}
mouse=d3.mouse(this);closest=$$.findClosestFromTargets(targetsToShow,mouse);if($$.mouseover&&(!closest||closest.id!==$$.mouseover.id)){config.data_onmouseout.call($$.api,$$.mouseover);$$.mouseover=undefined;}
if(!closest){mouseout();return;}
if($$.isScatterType(closest)||!config.tooltip_grouped){sameXData=[closest];}else{sameXData=$$.filterByX(targetsToShow,closest.x);}
selectedData=sameXData.map(function(d){return $$.addName(d);});$$.showTooltip(selectedData,this);if(config.point_focus_expand_enabled){$$.expandCircles(closest.index,closest.id,true);}
$$.expandBars(closest.index,closest.id,true);$$.showXGridFocus(selectedData);if($$.isBarType(closest.id)||$$.dist(closest,mouse)<100){$$.svg.select('.'+CLASS.eventRect).style('cursor','pointer');if(!$$.mouseover){config.data_onmouseover.call($$.api,closest);$$.mouseover=closest;}}}).on('click',function(){var targetsToShow=$$.filterTargetsToShow($$.data.targets);var mouse,closest;if($$.hasArcType(targetsToShow)){return;}
mouse=d3.mouse(this);closest=$$.findClosestFromTargets(targetsToShow,mouse);if(!closest){return;}
if($$.isBarType(closest.id)||$$.dist(closest,mouse)<100){$$.main.selectAll('.'+CLASS.shapes+$$.getTargetSelectorSuffix(closest.id)).selectAll('.'+CLASS.shape+'-'+closest.index).each(function(){if(config.data_selection_grouped||$$.isWithinShape(this,closest)){$$.toggleShape(this,closest,closest.index);$$.config.data_onclick.call($$.api,closest,this);}});}}).call(config.data_selection_draggable&&$$.drag?(d3.behavior.drag().origin(Object).on('drag',function(){$$.drag(d3.mouse(this));}).on('dragstart',function(){$$.dragstart(d3.mouse(this));}).on('dragend',function(){$$.dragend();})):function(){});};c3_chart_internal_fn.dispatchEvent=function(type,index,mouse){var $$=this,selector='.'+CLASS.eventRect+(!$$.isMultipleX()?'-'+index:''),eventRect=$$.main.select(selector).node(),box=eventRect.getBoundingClientRect(),x=box.left+(mouse?mouse[0]:0),y=box.top+(mouse?mouse[1]:0),event=document.createEvent("MouseEvents");event.initMouseEvent(type,true,true,window,0,x,y,x,y,false,false,false,false,0,null);eventRect.dispatchEvent(event);};c3_chart_internal_fn.getCurrentWidth=function(){var $$=this,config=$$.config;return config.size_width?config.size_width:$$.getParentWidth();};c3_chart_internal_fn.getCurrentHeight=function(){var $$=this,config=$$.config,h=config.size_height?config.size_height:$$.getParentHeight();return h>0?h:320/($$.hasType('gauge')?2:1);};c3_chart_internal_fn.getCurrentPaddingTop=function(){var config=this.config;return isValue(config.padding_top)?config.padding_top:0;};c3_chart_internal_fn.getCurrentPaddingBottom=function(){var config=this.config;return isValue(config.padding_bottom)?config.padding_bottom:0;};c3_chart_internal_fn.getCurrentPaddingLeft=function(withoutRecompute){var $$=this,config=$$.config;if(isValue(config.padding_left)){return config.padding_left;}else if(config.axis_rotated){return!config.axis_x_show?1:Math.max(ceil10($$.getAxisWidthByAxisId('x',withoutRecompute)),40);}else if(!config.axis_y_show||config.axis_y_inner){return $$.axis.getYAxisLabelPosition().isOuter?30:1;}else{return ceil10($$.getAxisWidthByAxisId('y',withoutRecompute));}};c3_chart_internal_fn.getCurrentPaddingRight=function(){var $$=this,config=$$.config,defaultPadding=10,legendWidthOnRight=$$.isLegendRight?$$.getLegendWidth()+20:0;if(isValue(config.padding_right)){return config.padding_right+1;}else if(config.axis_rotated){return defaultPadding+legendWidthOnRight;}else if(!config.axis_y2_show||config.axis_y2_inner){return 2+legendWidthOnRight+($$.axis.getY2AxisLabelPosition().isOuter?20:0);}else{return ceil10($$.getAxisWidthByAxisId('y2'))+legendWidthOnRight;}};c3_chart_internal_fn.getParentRectValue=function(key){var parent=this.selectChart.node(),v;while(parent&&parent.tagName!=='BODY'){try{v=parent.getBoundingClientRect()[key];}catch(e){if(key==='width'){v=parent.offsetWidth;}}
if(v){break;}
parent=parent.parentNode;}
return v;};c3_chart_internal_fn.getParentWidth=function(){return this.getParentRectValue('width');};c3_chart_internal_fn.getParentHeight=function(){var h=this.selectChart.style('height');return h.indexOf('px')>0?+h.replace('px',''):0;};c3_chart_internal_fn.getSvgLeft=function(withoutRecompute){var $$=this,config=$$.config,hasLeftAxisRect=config.axis_rotated||(!config.axis_rotated&&!config.axis_y_inner),leftAxisClass=config.axis_rotated?CLASS.axisX:CLASS.axisY,leftAxis=$$.main.select('.'+leftAxisClass).node(),svgRect=leftAxis&&hasLeftAxisRect?leftAxis.getBoundingClientRect():{right:0},chartRect=$$.selectChart.node().getBoundingClientRect(),hasArc=$$.hasArcType(),svgLeft=svgRect.right-chartRect.left-(hasArc?0:$$.getCurrentPaddingLeft(withoutRecompute));return svgLeft>0?svgLeft:0;};c3_chart_internal_fn.getAxisWidthByAxisId=function(id,withoutRecompute){var $$=this,position=$$.axis.getLabelPositionById(id);return $$.axis.getMaxTickWidth(id,withoutRecompute)+(position.isInner?20:40);};c3_chart_internal_fn.getHorizontalAxisHeight=function(axisId){var $$=this,config=$$.config,h=30;if(axisId==='x'&&!config.axis_x_show){return 8;}
if(axisId==='x'&&config.axis_x_height){return config.axis_x_height;}
if(axisId==='y'&&!config.axis_y_show){return config.legend_show&&!$$.isLegendRight&&!$$.isLegendInset?10:1;}
if(axisId==='y2'&&!config.axis_y2_show){return $$.rotated_padding_top;}
if(axisId==='x'&&!config.axis_rotated&&config.axis_x_tick_rotate){h=30+$$.axis.getMaxTickWidth(axisId)*Math.cos(Math.PI*(90-config.axis_x_tick_rotate)/180);}
return h+($$.axis.getLabelPositionById(axisId).isInner?0:10)+(axisId==='y2'?-10:0);};c3_chart_internal_fn.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval());};c3_chart_internal_fn.getShapeIndices=function(typeFilter){var $$=this,config=$$.config,indices={},i=0,j,k;$$.filterTargetsToShow($$.data.targets.filter(typeFilter,$$)).forEach(function(d){for(j=0;j<config.data_groups.length;j++){if(config.data_groups[j].indexOf(d.id)<0){continue;}
for(k=0;k<config.data_groups[j].length;k++){if(config.data_groups[j][k]in indices){indices[d.id]=indices[config.data_groups[j][k]];break;}}}
if(isUndefined(indices[d.id])){indices[d.id]=i++;}});indices.__max__=i-1;return indices;};c3_chart_internal_fn.getShapeX=function(offset,targetsNum,indices,isSub){var $$=this,scale=isSub?$$.subX:$$.x;return function(d){var index=d.id in indices?indices[d.id]:0;return d.x||d.x===0?scale(d.x)-offset*(targetsNum/2-index):0;};};c3_chart_internal_fn.getShapeY=function(isSub){var $$=this;return function(d){var scale=isSub?$$.getSubYScale(d.id):$$.getYScale(d.id);return scale(d.value);};};c3_chart_internal_fn.getShapeOffset=function(typeFilter,indices,isSub){var $$=this,targets=$$.orderTargets($$.filterTargetsToShow($$.data.targets.filter(typeFilter,$$))),targetIds=targets.map(function(t){return t.id;});return function(d,i){var scale=isSub?$$.getSubYScale(d.id):$$.getYScale(d.id),y0=scale(0),offset=y0;targets.forEach(function(t){var values=$$.isStepType(d)?$$.convertValuesToStep(t.values):t.values;if(t.id===d.id||indices[t.id]!==indices[d.id]){return;}
if(targetIds.indexOf(t.id)<targetIds.indexOf(d.id)){if(values[i].value*d.value>=0){offset+=scale(values[i].value)-y0;}}});return offset;};};c3_chart_internal_fn.isWithinShape=function(that,d){var $$=this,shape=$$.d3.select(that),isWithin;if(!$$.isTargetToShow(d.id)){isWithin=false;}
else if(that.nodeName==='circle'){isWithin=$$.isStepType(d)?$$.isWithinStep(that,$$.getYScale(d.id)(d.value)):$$.isWithinCircle(that,$$.pointSelectR(d)*1.5);}
else if(that.nodeName==='path'){isWithin=shape.classed(CLASS.bar)?$$.isWithinBar(that):true;}
return isWithin;};c3_chart_internal_fn.getInterpolate=function(d){var $$=this;return $$.isSplineType(d)?"cardinal":$$.isStepType(d)?$$.config.line_step_type:"linear";};c3_chart_internal_fn.initLine=function(){var $$=this;$$.main.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartLines);};c3_chart_internal_fn.updateTargetsForLine=function(targets){var $$=this,config=$$.config,mainLineUpdate,mainLineEnter,classChartLine=$$.classChartLine.bind($$),classLines=$$.classLines.bind($$),classAreas=$$.classAreas.bind($$),classCircles=$$.classCircles.bind($$),classFocus=$$.classFocus.bind($$);mainLineUpdate=$$.main.select('.'+CLASS.chartLines).selectAll('.'+CLASS.chartLine).data(targets).attr('class',function(d){return classChartLine(d)+classFocus(d);});mainLineEnter=mainLineUpdate.enter().append('g').attr('class',classChartLine).style('opacity',0).style("pointer-events","none");mainLineEnter.append('g').attr("class",classLines);mainLineEnter.append('g').attr('class',classAreas);mainLineEnter.append('g').attr("class",function(d){return $$.generateClass(CLASS.selectedCircles,d.id);});mainLineEnter.append('g').attr("class",classCircles).style("cursor",function(d){return config.data_selection_isselectable(d)?"pointer":null;});targets.forEach(function(t){$$.main.selectAll('.'+CLASS.selectedCircles+$$.getTargetSelectorSuffix(t.id)).selectAll('.'+CLASS.selectedCircle).each(function(d){d.value=t.values[d.index].value;});});};c3_chart_internal_fn.updateLine=function(durationForExit){var $$=this;$$.mainLine=$$.main.selectAll('.'+CLASS.lines).selectAll('.'+CLASS.line).data($$.lineData.bind($$));$$.mainLine.enter().append('path').attr('class',$$.classLine.bind($$)).style("stroke",$$.color);$$.mainLine.style("opacity",$$.initialOpacity.bind($$)).style('shape-rendering',function(d){return $$.isStepType(d)?'crispEdges':'';}).attr('transform',null);$$.mainLine.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawLine=function(drawLine,withTransition){return[(withTransition?this.mainLine.transition():this.mainLine).attr("d",drawLine).style("stroke",this.color).style("opacity",1)];};c3_chart_internal_fn.generateDrawLine=function(lineIndices,isSub){var $$=this,config=$$.config,line=$$.d3.svg.line(),getPoints=$$.generateGetLinePoints(lineIndices,isSub),yScaleGetter=isSub?$$.getSubYScale:$$.getYScale,xValue=function(d){return(isSub?$$.subxx:$$.xx).call($$,d);},yValue=function(d,i){return config.data_groups.length>0?getPoints(d,i)[0][1]:yScaleGetter.call($$,d.id)(d.value);};line=config.axis_rotated?line.x(yValue).y(xValue):line.x(xValue).y(yValue);if(!config.line_connectNull){line=line.defined(function(d){return d.value!=null;});}
return function(d){var values=config.line_connectNull?$$.filterRemoveNull(d.values):d.values,x=isSub?$$.x:$$.subX,y=yScaleGetter.call($$,d.id),x0=0,y0=0,path;if($$.isLineType(d)){if(config.data_regions[d.id]){path=$$.lineWithRegions(values,x,y,config.data_regions[d.id]);}else{if($$.isStepType(d)){values=$$.convertValuesToStep(values);}
path=line.interpolate($$.getInterpolate(d))(values);}}else{if(values[0]){x0=x(values[0].x);y0=y(values[0].value);}
path=config.axis_rotated?"M "+y0+" "+x0:"M "+x0+" "+y0;}
return path?path:"M 0 0";};};c3_chart_internal_fn.generateGetLinePoints=function(lineIndices,isSub){var $$=this,config=$$.config,lineTargetsNum=lineIndices.__max__+1,x=$$.getShapeX(0,lineTargetsNum,lineIndices,!!isSub),y=$$.getShapeY(!!isSub),lineOffset=$$.getShapeOffset($$.isLineType,lineIndices,!!isSub),yScale=isSub?$$.getSubYScale:$$.getYScale;return function(d,i){var y0=yScale.call($$,d.id)(0),offset=lineOffset(d,i)||y0,posX=x(d),posY=y(d);if(config.axis_rotated){if((0<d.value&&posY<y0)||(d.value<0&&y0<posY)){posY=y0;}}
return[[posX,posY-(y0-offset)],[posX,posY-(y0-offset)],[posX,posY-(y0-offset)],[posX,posY-(y0-offset)]];};};c3_chart_internal_fn.lineWithRegions=function(d,x,y,_regions){var $$=this,config=$$.config,prev=-1,i,j,s="M",sWithRegion,xp,yp,dx,dy,dd,diff,diffx2,xOffset=$$.isCategorized()?0.5:0,xValue,yValue,regions=[];function isWithinRegions(x,regions){var i;for(i=0;i<regions.length;i++){if(regions[i].start<x&&x<=regions[i].end){return true;}}
return false;}
if(isDefined(_regions)){for(i=0;i<_regions.length;i++){regions[i]={};if(isUndefined(_regions[i].start)){regions[i].start=d[0].x;}else{regions[i].start=$$.isTimeSeries()?$$.parseDate(_regions[i].start):_regions[i].start;}
if(isUndefined(_regions[i].end)){regions[i].end=d[d.length-1].x;}else{regions[i].end=$$.isTimeSeries()?$$.parseDate(_regions[i].end):_regions[i].end;}}}
xValue=config.axis_rotated?function(d){return y(d.value);}:function(d){return x(d.x);};yValue=config.axis_rotated?function(d){return x(d.x);}:function(d){return y(d.value);};function generateM(points){return'M'+points[0][0]+' '+points[0][1]+' '+points[1][0]+' '+points[1][1];}
if($$.isTimeSeries()){sWithRegion=function(d0,d1,j,diff){var x0=d0.x.getTime(),x_diff=d1.x-d0.x,xv0=new Date(x0+x_diff*j),xv1=new Date(x0+x_diff*(j+diff)),points;if(config.axis_rotated){points=[[y(yp(j)),x(xv0)],[y(yp(j+diff)),x(xv1)]];}else{points=[[x(xv0),y(yp(j))],[x(xv1),y(yp(j+diff))]];}
return generateM(points);};}else{sWithRegion=function(d0,d1,j,diff){var points;if(config.axis_rotated){points=[[y(yp(j),true),x(xp(j))],[y(yp(j+diff),true),x(xp(j+diff))]];}else{points=[[x(xp(j),true),y(yp(j))],[x(xp(j+diff),true),y(yp(j+diff))]];}
return generateM(points);};}
for(i=0;i<d.length;i++){if(isUndefined(regions)||!isWithinRegions(d[i].x,regions)){s+=" "+xValue(d[i])+" "+yValue(d[i]);}
else{xp=$$.getScale(d[i-1].x+xOffset,d[i].x+xOffset,$$.isTimeSeries());yp=$$.getScale(d[i-1].value,d[i].value);dx=x(d[i].x)-x(d[i-1].x);dy=y(d[i].value)-y(d[i-1].value);dd=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2));diff=2/dd;diffx2=diff*2;for(j=diff;j<=1;j+=diffx2){s+=sWithRegion(d[i-1],d[i],j,diff);}}
prev=d[i].x;}
return s;};c3_chart_internal_fn.updateArea=function(durationForExit){var $$=this,d3=$$.d3;$$.mainArea=$$.main.selectAll('.'+CLASS.areas).selectAll('.'+CLASS.area).data($$.lineData.bind($$));$$.mainArea.enter().append('path').attr("class",$$.classArea.bind($$)).style("fill",$$.color).style("opacity",function(){$$.orgAreaOpacity=+d3.select(this).style('opacity');return 0;});$$.mainArea.style("opacity",$$.orgAreaOpacity);$$.mainArea.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawArea=function(drawArea,withTransition){return[(withTransition?this.mainArea.transition():this.mainArea).attr("d",drawArea).style("fill",this.color).style("opacity",this.orgAreaOpacity)];};c3_chart_internal_fn.generateDrawArea=function(areaIndices,isSub){var $$=this,config=$$.config,area=$$.d3.svg.area(),getPoints=$$.generateGetAreaPoints(areaIndices,isSub),yScaleGetter=isSub?$$.getSubYScale:$$.getYScale,xValue=function(d){return(isSub?$$.subxx:$$.xx).call($$,d);},value0=function(d,i){return config.data_groups.length>0?getPoints(d,i)[0][1]:yScaleGetter.call($$,d.id)($$.getAreaBaseValue(d.id));},value1=function(d,i){return config.data_groups.length>0?getPoints(d,i)[1][1]:yScaleGetter.call($$,d.id)(d.value);};area=config.axis_rotated?area.x0(value0).x1(value1).y(xValue):area.x(xValue).y0(value0).y1(value1);if(!config.line_connectNull){area=area.defined(function(d){return d.value!==null;});}
return function(d){var values=config.line_connectNull?$$.filterRemoveNull(d.values):d.values,x0=0,y0=0,path;if($$.isAreaType(d)){if($$.isStepType(d)){values=$$.convertValuesToStep(values);}
path=area.interpolate($$.getInterpolate(d))(values);}else{if(values[0]){x0=$$.x(values[0].x);y0=$$.getYScale(d.id)(values[0].value);}
path=config.axis_rotated?"M "+y0+" "+x0:"M "+x0+" "+y0;}
return path?path:"M 0 0";};};c3_chart_internal_fn.getAreaBaseValue=function(){return 0;};c3_chart_internal_fn.generateGetAreaPoints=function(areaIndices,isSub){var $$=this,config=$$.config,areaTargetsNum=areaIndices.__max__+1,x=$$.getShapeX(0,areaTargetsNum,areaIndices,!!isSub),y=$$.getShapeY(!!isSub),areaOffset=$$.getShapeOffset($$.isAreaType,areaIndices,!!isSub),yScale=isSub?$$.getSubYScale:$$.getYScale;return function(d,i){var y0=yScale.call($$,d.id)(0),offset=areaOffset(d,i)||y0,posX=x(d),posY=y(d);if(config.axis_rotated){if((0<d.value&&posY<y0)||(d.value<0&&y0<posY)){posY=y0;}}
return[[posX,offset],[posX,posY-(y0-offset)],[posX,posY-(y0-offset)],[posX,offset]];};};c3_chart_internal_fn.updateCircle=function(){var $$=this;$$.mainCircle=$$.main.selectAll('.'+CLASS.circles).selectAll('.'+CLASS.circle).data($$.lineOrScatterData.bind($$));$$.mainCircle.enter().append("circle").attr("class",$$.classCircle.bind($$)).attr("r",$$.pointR.bind($$)).style("fill",$$.color);$$.mainCircle.style("opacity",$$.initialOpacityForCircle.bind($$));$$.mainCircle.exit().remove();};c3_chart_internal_fn.redrawCircle=function(cx,cy,withTransition){var selectedCircles=this.main.selectAll('.'+CLASS.selectedCircle);return[(withTransition?this.mainCircle.transition():this.mainCircle).style('opacity',this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",cx).attr("cy",cy),(withTransition?selectedCircles.transition():selectedCircles).attr("cx",cx).attr("cy",cy)];};c3_chart_internal_fn.circleX=function(d){return d.x||d.x===0?this.x(d.x):null;};c3_chart_internal_fn.updateCircleY=function(){var $$=this,lineIndices,getPoints;if($$.config.data_groups.length>0){lineIndices=$$.getShapeIndices($$.isLineType),getPoints=$$.generateGetLinePoints(lineIndices);$$.circleY=function(d,i){return getPoints(d,i)[0][1];};}else{$$.circleY=function(d){return $$.getYScale(d.id)(d.value);};}};c3_chart_internal_fn.getCircles=function(i,id){var $$=this;return(id?$$.main.selectAll('.'+CLASS.circles+$$.getTargetSelectorSuffix(id)):$$.main).selectAll('.'+CLASS.circle+(isValue(i)?'-'+i:''));};c3_chart_internal_fn.expandCircles=function(i,id,reset){var $$=this,r=$$.pointExpandedR.bind($$);if(reset){$$.unexpandCircles();}
$$.getCircles(i,id).classed(CLASS.EXPANDED,true).attr('r',r);};c3_chart_internal_fn.unexpandCircles=function(i){var $$=this,r=$$.pointR.bind($$);$$.getCircles(i).filter(function(){return $$.d3.select(this).classed(CLASS.EXPANDED);}).classed(CLASS.EXPANDED,false).attr('r',r);};c3_chart_internal_fn.pointR=function(d){var $$=this,config=$$.config;return $$.isStepType(d)?0:(isFunction(config.point_r)?config.point_r(d):config.point_r);};c3_chart_internal_fn.pointExpandedR=function(d){var $$=this,config=$$.config;return config.point_focus_expand_enabled?(config.point_focus_expand_r?config.point_focus_expand_r:$$.pointR(d)*1.75):$$.pointR(d);};c3_chart_internal_fn.pointSelectR=function(d){var $$=this,config=$$.config;return config.point_select_r?config.point_select_r:$$.pointR(d)*4;};c3_chart_internal_fn.isWithinCircle=function(that,r){var d3=this.d3,mouse=d3.mouse(that),d3_this=d3.select(that),cx=+d3_this.attr("cx"),cy=+d3_this.attr("cy");return Math.sqrt(Math.pow(cx-mouse[0],2)+Math.pow(cy-mouse[1],2))<r;};c3_chart_internal_fn.isWithinStep=function(that,y){return Math.abs(y-this.d3.mouse(that)[1])<30;};c3_chart_internal_fn.initBar=function(){var $$=this;$$.main.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartBars);};c3_chart_internal_fn.updateTargetsForBar=function(targets){var $$=this,config=$$.config,mainBarUpdate,mainBarEnter,classChartBar=$$.classChartBar.bind($$),classBars=$$.classBars.bind($$),classFocus=$$.classFocus.bind($$);mainBarUpdate=$$.main.select('.'+CLASS.chartBars).selectAll('.'+CLASS.chartBar).data(targets).attr('class',function(d){return classChartBar(d)+classFocus(d);});mainBarEnter=mainBarUpdate.enter().append('g').attr('class',classChartBar).style('opacity',0).style("pointer-events","none");mainBarEnter.append('g').attr("class",classBars).style("cursor",function(d){return config.data_selection_isselectable(d)?"pointer":null;});};c3_chart_internal_fn.updateBar=function(durationForExit){var $$=this,barData=$$.barData.bind($$),classBar=$$.classBar.bind($$),initialOpacity=$$.initialOpacity.bind($$),color=function(d){return $$.color(d.id);};$$.mainBar=$$.main.selectAll('.'+CLASS.bars).selectAll('.'+CLASS.bar).data(barData);$$.mainBar.enter().append('path').attr("class",classBar).style("stroke",color).style("fill",color);$$.mainBar.style("opacity",initialOpacity);$$.mainBar.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawBar=function(drawBar,withTransition){return[(withTransition?this.mainBar.transition():this.mainBar).attr('d',drawBar).style("fill",this.color).style("opacity",1)];};c3_chart_internal_fn.getBarW=function(axis,barTargetsNum){var $$=this,config=$$.config,w=typeof config.bar_width==='number'?config.bar_width:barTargetsNum?(axis.tickInterval()*config.bar_width_ratio)/barTargetsNum:0;return config.bar_width_max&&w>config.bar_width_max?config.bar_width_max:w;};c3_chart_internal_fn.getBars=function(i,id){var $$=this;return(id?$$.main.selectAll('.'+CLASS.bars+$$.getTargetSelectorSuffix(id)):$$.main).selectAll('.'+CLASS.bar+(isValue(i)?'-'+i:''));};c3_chart_internal_fn.expandBars=function(i,id,reset){var $$=this;if(reset){$$.unexpandBars();}
$$.getBars(i,id).classed(CLASS.EXPANDED,true);};c3_chart_internal_fn.unexpandBars=function(i){var $$=this;$$.getBars(i).classed(CLASS.EXPANDED,false);};c3_chart_internal_fn.generateDrawBar=function(barIndices,isSub){var $$=this,config=$$.config,getPoints=$$.generateGetBarPoints(barIndices,isSub);return function(d,i){var points=getPoints(d,i);var indexX=config.axis_rotated?1:0;var indexY=config.axis_rotated?0:1;var path='M '+points[0][indexX]+','+points[0][indexY]+' '+'L'+points[1][indexX]+','+points[1][indexY]+' '+'L'+points[2][indexX]+','+points[2][indexY]+' '+'L'+points[3][indexX]+','+points[3][indexY]+' '+'z';return path;};};c3_chart_internal_fn.generateGetBarPoints=function(barIndices,isSub){var $$=this,axis=isSub?$$.subXAxis:$$.xAxis,barTargetsNum=barIndices.__max__+1,barW=$$.getBarW(axis,barTargetsNum),barX=$$.getShapeX(barW,barTargetsNum,barIndices,!!isSub),barY=$$.getShapeY(!!isSub),barOffset=$$.getShapeOffset($$.isBarType,barIndices,!!isSub),yScale=isSub?$$.getSubYScale:$$.getYScale;return function(d,i){var y0=yScale.call($$,d.id)(0),offset=barOffset(d,i)||y0,posX=barX(d),posY=barY(d);if($$.config.axis_rotated){if((0<d.value&&posY<y0)||(d.value<0&&y0<posY)){posY=y0;}}
return[[posX,offset],[posX,posY-(y0-offset)],[posX+barW,posY-(y0-offset)],[posX+barW,offset]];};};c3_chart_internal_fn.isWithinBar=function(that){var mouse=this.d3.mouse(that),box=that.getBoundingClientRect(),seg0=that.pathSegList.getItem(0),seg1=that.pathSegList.getItem(1),x=Math.min(seg0.x,seg1.x),y=Math.min(seg0.y,seg1.y),w=box.width,h=box.height,offset=2,sx=x-offset,ex=x+w+offset,sy=y+h+offset,ey=y-offset;return sx<mouse[0]&&mouse[0]<ex&&ey<mouse[1]&&mouse[1]<sy;};c3_chart_internal_fn.initText=function(){var $$=this;$$.main.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartTexts);$$.mainText=$$.d3.selectAll([]);};c3_chart_internal_fn.updateTargetsForText=function(targets){var $$=this,mainTextUpdate,mainTextEnter,classChartText=$$.classChartText.bind($$),classTexts=$$.classTexts.bind($$),classFocus=$$.classFocus.bind($$);mainTextUpdate=$$.main.select('.'+CLASS.chartTexts).selectAll('.'+CLASS.chartText).data(targets).attr('class',function(d){return classChartText(d)+classFocus(d);});mainTextEnter=mainTextUpdate.enter().append('g').attr('class',classChartText).style('opacity',0).style("pointer-events","none");mainTextEnter.append('g').attr('class',classTexts);};c3_chart_internal_fn.updateText=function(durationForExit){var $$=this,config=$$.config,barOrLineData=$$.barOrLineData.bind($$),classText=$$.classText.bind($$);$$.mainText=$$.main.selectAll('.'+CLASS.texts).selectAll('.'+CLASS.text).data(barOrLineData);$$.mainText.enter().append('text').attr("class",classText).attr('text-anchor',function(d){return config.axis_rotated?(d.value<0?'end':'start'):'middle';}).style("stroke",'none').style("fill",function(d){return $$.color(d);}).style("fill-opacity",0);$$.mainText.text(function(d,i,j){return $$.dataLabelFormat(d.id)(d.value,d.id,i,j);});$$.mainText.exit().transition().duration(durationForExit).style('fill-opacity',0).remove();};c3_chart_internal_fn.redrawText=function(xForText,yForText,forFlow,withTransition){return[(withTransition?this.mainText.transition():this.mainText).attr('x',xForText).attr('y',yForText).style("fill",this.color).style("fill-opacity",forFlow?0:this.opacityForText.bind(this))];};c3_chart_internal_fn.getTextRect=function(text,cls){var dummy=this.d3.select('body').append('div').classed('c3',true),svg=dummy.append("svg").style('visibility','hidden').style('position','fixed').style('top',0).style('left',0),rect;svg.selectAll('.dummy').data([text]).enter().append('text').classed(cls?cls:"",true).text(text).each(function(){rect=this.getBoundingClientRect();});dummy.remove();return rect;};c3_chart_internal_fn.generateXYForText=function(areaIndices,barIndices,lineIndices,forX){var $$=this,getAreaPoints=$$.generateGetAreaPoints(areaIndices,false),getBarPoints=$$.generateGetBarPoints(barIndices,false),getLinePoints=$$.generateGetLinePoints(lineIndices,false),getter=forX?$$.getXForText:$$.getYForText;return function(d,i){var getPoints=$$.isAreaType(d)?getAreaPoints:$$.isBarType(d)?getBarPoints:getLinePoints;return getter.call($$,getPoints(d,i),d,this);};};c3_chart_internal_fn.getXForText=function(points,d,textElement){var $$=this,box=textElement.getBoundingClientRect(),xPos,padding;if($$.config.axis_rotated){padding=$$.isBarType(d)?4:6;xPos=points[2][1]+padding*(d.value<0?-1:1);}else{xPos=$$.hasType('bar')?(points[2][0]+points[0][0])/2:points[0][0];}
if(d.value===null){if(xPos>$$.width){xPos=$$.width-box.width;}else if(xPos<0){xPos=4;}}
return xPos;};c3_chart_internal_fn.getYForText=function(points,d,textElement){var $$=this,box=textElement.getBoundingClientRect(),yPos;if($$.config.axis_rotated){yPos=(points[0][0]+points[2][0]+box.height*0.6)/2;}else{yPos=points[2][1];if(d.value<0){yPos+=box.height;if($$.isBarType(d)&&$$.isSafari()){yPos-=3;}
else if(!$$.isBarType(d)&&$$.isChrome()){yPos+=3;}}else{yPos+=$$.isBarType(d)?-3:-6;}}
if(d.value===null&&!$$.config.axis_rotated){if(yPos<box.height){yPos=box.height;}else if(yPos>this.height){yPos=this.height-4;}}
return yPos;};c3_chart_internal_fn.setTargetType=function(targetIds,type){var $$=this,config=$$.config;$$.mapToTargetIds(targetIds).forEach(function(id){$$.withoutFadeIn[id]=(type===config.data_types[id]);config.data_types[id]=type;});if(!targetIds){config.data_type=type;}};c3_chart_internal_fn.hasType=function(type,targets){var $$=this,types=$$.config.data_types,has=false;targets=targets||$$.data.targets;if(targets&&targets.length){targets.forEach(function(target){var t=types[target.id];if((t&&t.indexOf(type)>=0)||(!t&&type==='line')){has=true;}});}else if(Object.keys(types).length){Object.keys(types).forEach(function(id){if(types[id]===type){has=true;}});}else{has=$$.config.data_type===type;}
return has;};c3_chart_internal_fn.hasArcType=function(targets){return this.hasType('pie',targets)||this.hasType('donut',targets)||this.hasType('gauge',targets);};c3_chart_internal_fn.isLineType=function(d){var config=this.config,id=isString(d)?d:d.id;return!config.data_types[id]||['line','spline','area','area-spline','step','area-step'].indexOf(config.data_types[id])>=0;};c3_chart_internal_fn.isStepType=function(d){var id=isString(d)?d:d.id;return['step','area-step'].indexOf(this.config.data_types[id])>=0;};c3_chart_internal_fn.isSplineType=function(d){var id=isString(d)?d:d.id;return['spline','area-spline'].indexOf(this.config.data_types[id])>=0;};c3_chart_internal_fn.isAreaType=function(d){var id=isString(d)?d:d.id;return['area','area-spline','area-step'].indexOf(this.config.data_types[id])>=0;};c3_chart_internal_fn.isBarType=function(d){var id=isString(d)?d:d.id;return this.config.data_types[id]==='bar';};c3_chart_internal_fn.isScatterType=function(d){var id=isString(d)?d:d.id;return this.config.data_types[id]==='scatter';};c3_chart_internal_fn.isPieType=function(d){var id=isString(d)?d:d.id;return this.config.data_types[id]==='pie';};c3_chart_internal_fn.isGaugeType=function(d){var id=isString(d)?d:d.id;return this.config.data_types[id]==='gauge';};c3_chart_internal_fn.isDonutType=function(d){var id=isString(d)?d:d.id;return this.config.data_types[id]==='donut';};c3_chart_internal_fn.isArcType=function(d){return this.isPieType(d)||this.isDonutType(d)||this.isGaugeType(d);};c3_chart_internal_fn.lineData=function(d){return this.isLineType(d)?[d]:[];};c3_chart_internal_fn.arcData=function(d){return this.isArcType(d.data)?[d]:[];};c3_chart_internal_fn.barData=function(d){return this.isBarType(d)?d.values:[];};c3_chart_internal_fn.lineOrScatterData=function(d){return this.isLineType(d)||this.isScatterType(d)?d.values:[];};c3_chart_internal_fn.barOrLineData=function(d){return this.isBarType(d)||this.isLineType(d)?d.values:[];};c3_chart_internal_fn.initGrid=function(){var $$=this,config=$$.config,d3=$$.d3;$$.grid=$$.main.append('g').attr("clip-path",$$.clipPathForGrid).attr('class',CLASS.grid);if(config.grid_x_show){$$.grid.append("g").attr("class",CLASS.xgrids);}
if(config.grid_y_show){$$.grid.append('g').attr('class',CLASS.ygrids);}
if(config.grid_focus_show){$$.grid.append('g').attr("class",CLASS.xgridFocus).append('line').attr('class',CLASS.xgridFocus);}
$$.xgrid=d3.selectAll([]);if(!config.grid_lines_front){$$.initGridLines();}};c3_chart_internal_fn.initGridLines=function(){var $$=this,d3=$$.d3;$$.gridLines=$$.main.append('g').attr("clip-path",$$.clipPathForGrid).attr('class',CLASS.grid+' '+CLASS.gridLines);$$.gridLines.append('g').attr("class",CLASS.xgridLines);$$.gridLines.append('g').attr('class',CLASS.ygridLines);$$.xgridLines=d3.selectAll([]);};c3_chart_internal_fn.updateXGrid=function(withoutUpdate){var $$=this,config=$$.config,d3=$$.d3,xgridData=$$.generateGridData(config.grid_x_type,$$.x),tickOffset=$$.isCategorized()?$$.xAxis.tickOffset():0;$$.xgridAttr=config.axis_rotated?{'x1':0,'x2':$$.width,'y1':function(d){return $$.x(d)-tickOffset;},'y2':function(d){return $$.x(d)-tickOffset;}}:{'x1':function(d){return $$.x(d)+tickOffset;},'x2':function(d){return $$.x(d)+tickOffset;},'y1':0,'y2':$$.height};$$.xgrid=$$.main.select('.'+CLASS.xgrids).selectAll('.'+CLASS.xgrid).data(xgridData);$$.xgrid.enter().append('line').attr("class",CLASS.xgrid);if(!withoutUpdate){$$.xgrid.attr($$.xgridAttr).style("opacity",function(){return+d3.select(this).attr(config.axis_rotated?'y1':'x1')===(config.axis_rotated?$$.height:0)?0:1;});}
$$.xgrid.exit().remove();};c3_chart_internal_fn.updateYGrid=function(){var $$=this,config=$$.config,gridValues=$$.yAxis.tickValues()||$$.y.ticks(config.grid_y_ticks);$$.ygrid=$$.main.select('.'+CLASS.ygrids).selectAll('.'+CLASS.ygrid).data(gridValues);$$.ygrid.enter().append('line').attr('class',CLASS.ygrid);$$.ygrid.attr("x1",config.axis_rotated?$$.y:0).attr("x2",config.axis_rotated?$$.y:$$.width).attr("y1",config.axis_rotated?0:$$.y).attr("y2",config.axis_rotated?$$.height:$$.y);$$.ygrid.exit().remove();$$.smoothLines($$.ygrid,'grid');};c3_chart_internal_fn.gridTextAnchor=function(d){return d.position?d.position:"end";};c3_chart_internal_fn.gridTextDx=function(d){return d.position==='start'?4:d.position==='middle'?0:-4;};c3_chart_internal_fn.xGridTextX=function(d){return d.position==='start'?-this.height:d.position==='middle'?-this.height/2:0;};c3_chart_internal_fn.yGridTextX=function(d){return d.position==='start'?0:d.position==='middle'?this.width/2:this.width;};c3_chart_internal_fn.updateGrid=function(duration){var $$=this,main=$$.main,config=$$.config,xgridLine,ygridLine,yv;$$.grid.style('visibility',$$.hasArcType()?'hidden':'visible');main.select('line.'+CLASS.xgridFocus).style("visibility","hidden");if(config.grid_x_show){$$.updateXGrid();}
$$.xgridLines=main.select('.'+CLASS.xgridLines).selectAll('.'+CLASS.xgridLine).data(config.grid_x_lines);xgridLine=$$.xgridLines.enter().append('g').attr("class",function(d){return CLASS.xgridLine+(d['class']?' '+d['class']:'');});xgridLine.append('line').style("opacity",0);xgridLine.append('text').attr("text-anchor",$$.gridTextAnchor).attr("transform",config.axis_rotated?"":"rotate(-90)").attr('dx',$$.gridTextDx).attr('dy',-5).style("opacity",0);$$.xgridLines.exit().transition().duration(duration).style("opacity",0).remove();if(config.grid_y_show){$$.updateYGrid();}
$$.ygridLines=main.select('.'+CLASS.ygridLines).selectAll('.'+CLASS.ygridLine).data(config.grid_y_lines);ygridLine=$$.ygridLines.enter().append('g').attr("class",function(d){return CLASS.ygridLine+(d['class']?' '+d['class']:'');});ygridLine.append('line').style("opacity",0);ygridLine.append('text').attr("text-anchor",$$.gridTextAnchor).attr("transform",config.axis_rotated?"rotate(-90)":"").attr('dx',$$.gridTextDx).attr('dy',-5).style("opacity",0);yv=$$.yv.bind($$);$$.ygridLines.select('line').transition().duration(duration).attr("x1",config.axis_rotated?yv:0).attr("x2",config.axis_rotated?yv:$$.width).attr("y1",config.axis_rotated?0:yv).attr("y2",config.axis_rotated?$$.height:yv).style("opacity",1);$$.ygridLines.select('text').transition().duration(duration).attr("x",config.axis_rotated?$$.xGridTextX.bind($$):$$.yGridTextX.bind($$)).attr("y",yv).text(function(d){return d.text;}).style("opacity",1);$$.ygridLines.exit().transition().duration(duration).style("opacity",0).remove();};c3_chart_internal_fn.redrawGrid=function(withTransition){var $$=this,config=$$.config,xv=$$.xv.bind($$),lines=$$.xgridLines.select('line'),texts=$$.xgridLines.select('text');return[(withTransition?lines.transition():lines).attr("x1",config.axis_rotated?0:xv).attr("x2",config.axis_rotated?$$.width:xv).attr("y1",config.axis_rotated?xv:0).attr("y2",config.axis_rotated?xv:$$.height).style("opacity",1),(withTransition?texts.transition():texts).attr("x",config.axis_rotated?$$.yGridTextX.bind($$):$$.xGridTextX.bind($$)).attr("y",xv).text(function(d){return d.text;}).style("opacity",1)];};c3_chart_internal_fn.showXGridFocus=function(selectedData){var $$=this,config=$$.config,dataToShow=selectedData.filter(function(d){return d&&isValue(d.value);}),focusEl=$$.main.selectAll('line.'+CLASS.xgridFocus),xx=$$.xx.bind($$);if(!config.tooltip_show){return;}
if($$.hasType('scatter')||$$.hasArcType()){return;}
focusEl.style("visibility","visible").data([dataToShow[0]]).attr(config.axis_rotated?'y1':'x1',xx).attr(config.axis_rotated?'y2':'x2',xx);$$.smoothLines(focusEl,'grid');};c3_chart_internal_fn.hideXGridFocus=function(){this.main.select('line.'+CLASS.xgridFocus).style("visibility","hidden");};c3_chart_internal_fn.updateXgridFocus=function(){var $$=this,config=$$.config;$$.main.select('line.'+CLASS.xgridFocus).attr("x1",config.axis_rotated?0:-10).attr("x2",config.axis_rotated?$$.width:-10).attr("y1",config.axis_rotated?-10:0).attr("y2",config.axis_rotated?-10:$$.height);};c3_chart_internal_fn.generateGridData=function(type,scale){var $$=this,gridData=[],xDomain,firstYear,lastYear,i,tickNum=$$.main.select("."+CLASS.axisX).selectAll('.tick').size();if(type==='year'){xDomain=$$.getXDomain();firstYear=xDomain[0].getFullYear();lastYear=xDomain[1].getFullYear();for(i=firstYear;i<=lastYear;i++){gridData.push(new Date(i+'-01-01 00:00:00'));}}else{gridData=scale.ticks(10);if(gridData.length>tickNum){gridData=gridData.filter(function(d){return(""+d).indexOf('.')<0;});}}
return gridData;};c3_chart_internal_fn.getGridFilterToRemove=function(params){return params?function(line){var found=false;[].concat(params).forEach(function(param){if((('value'in param&&line.value===param.value)||('class'in param&&line['class']===param['class']))){found=true;}});return found;}:function(){return true;};};c3_chart_internal_fn.removeGridLines=function(params,forX){var $$=this,config=$$.config,toRemove=$$.getGridFilterToRemove(params),toShow=function(line){return!toRemove(line);},classLines=forX?CLASS.xgridLines:CLASS.ygridLines,classLine=forX?CLASS.xgridLine:CLASS.ygridLine;$$.main.select('.'+classLines).selectAll('.'+classLine).filter(toRemove).transition().duration(config.transition_duration).style('opacity',0).remove();if(forX){config.grid_x_lines=config.grid_x_lines.filter(toShow);}else{config.grid_y_lines=config.grid_y_lines.filter(toShow);}};c3_chart_internal_fn.initTooltip=function(){var $$=this,config=$$.config,i;$$.tooltip=$$.selectChart.style("position","relative").append("div").attr('class',CLASS.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none");if(config.tooltip_init_show){if($$.isTimeSeries()&&isString(config.tooltip_init_x)){config.tooltip_init_x=$$.parseDate(config.tooltip_init_x);for(i=0;i<$$.data.targets[0].values.length;i++){if(($$.data.targets[0].values[i].x-config.tooltip_init_x)===0){break;}}
config.tooltip_init_x=i;}
$$.tooltip.html(config.tooltip_contents.call($$,$$.data.targets.map(function(d){return $$.addName(d.values[config.tooltip_init_x]);}),$$.axis.getXAxisTickFormat(),$$.getYFormat($$.hasArcType()),$$.color));$$.tooltip.style("top",config.tooltip_init_position.top).style("left",config.tooltip_init_position.left).style("display","block");}};c3_chart_internal_fn.getTooltipContent=function(d,defaultTitleFormat,defaultValueFormat,color){var $$=this,config=$$.config,titleFormat=config.tooltip_format_title||defaultTitleFormat,nameFormat=config.tooltip_format_name||function(name){return name;},valueFormat=config.tooltip_format_value||defaultValueFormat,text,i,title,value,name,bgcolor;for(i=0;i<d.length;i++){if(!(d[i]&&(d[i].value||d[i].value===0))){continue;}
if(!text){title=titleFormat?titleFormat(d[i].x):d[i].x;text="<table class='"+CLASS.tooltip+"'>"+(title||title===0?"<tr><th colspan='2'>"+title+"</th></tr>":"");}
value=valueFormat(d[i].value,d[i].ratio,d[i].id,d[i].index);if(value!==undefined){name=nameFormat(d[i].name,d[i].ratio,d[i].id,d[i].index);bgcolor=$$.levelColor?$$.levelColor(d[i].value):color(d[i].id);text+="<tr class='"+CLASS.tooltipName+"-"+d[i].id+"'>";text+="<td class='name'><span style='background-color:"+bgcolor+"'></span>"+name+"</td>";text+="<td class='value'>"+value+"</td>";text+="</tr>";}}
return text+"</table>";};c3_chart_internal_fn.tooltipPosition=function(dataToShow,tWidth,tHeight,element){var $$=this,config=$$.config,d3=$$.d3;var svgLeft,tooltipLeft,tooltipRight,tooltipTop,chartRight;var forArc=$$.hasArcType(),mouse=d3.mouse(element);if(forArc){tooltipLeft=(($$.width-($$.isLegendRight?$$.getLegendWidth():0))/2)+mouse[0];tooltipTop=($$.height/2)+mouse[1]+20;}else{svgLeft=$$.getSvgLeft(true);if(config.axis_rotated){tooltipLeft=svgLeft+mouse[0]+100;tooltipRight=tooltipLeft+tWidth;chartRight=$$.currentWidth-$$.getCurrentPaddingRight();tooltipTop=$$.x(dataToShow[0].x)+20;}else{tooltipLeft=svgLeft+$$.getCurrentPaddingLeft(true)+$$.x(dataToShow[0].x)+20;tooltipRight=tooltipLeft+tWidth;chartRight=svgLeft+$$.currentWidth-$$.getCurrentPaddingRight();tooltipTop=mouse[1]+15;}
if(tooltipRight>chartRight){tooltipLeft-=tooltipRight-chartRight+20;}
if(tooltipTop+tHeight>$$.currentHeight){tooltipTop-=tHeight+30;}}
if(tooltipTop<0){tooltipTop=0;}
return{top:tooltipTop,left:tooltipLeft};};c3_chart_internal_fn.showTooltip=function(selectedData,element){var $$=this,config=$$.config;var tWidth,tHeight,position;var forArc=$$.hasArcType(),dataToShow=selectedData.filter(function(d){return d&&isValue(d.value);}),positionFunction=config.tooltip_position||c3_chart_internal_fn.tooltipPosition;if(dataToShow.length===0||!config.tooltip_show){return;}
$$.tooltip.html(config.tooltip_contents.call($$,selectedData,$$.axis.getXAxisTickFormat(),$$.getYFormat(forArc),$$.color)).style("display","block");tWidth=$$.tooltip.property('offsetWidth');tHeight=$$.tooltip.property('offsetHeight');position=positionFunction.call(this,dataToShow,tWidth,tHeight,element);$$.tooltip.style("top",position.top+"px").style("left",position.left+'px');};c3_chart_internal_fn.hideTooltip=function(){this.tooltip.style("display","none");};c3_chart_internal_fn.initLegend=function(){var $$=this;$$.legendItemTextBox={};$$.legendHasRendered=false;$$.legend=$$.svg.append("g").attr("transform",$$.getTranslate('legend'));if(!$$.config.legend_show){$$.legend.style('visibility','hidden');$$.hiddenLegendIds=$$.mapToIds($$.data.targets);return;}
$$.updateLegendWithDefaults();};c3_chart_internal_fn.updateLegendWithDefaults=function(){var $$=this;$$.updateLegend($$.mapToIds($$.data.targets),{withTransform:false,withTransitionForTransform:false,withTransition:false});};c3_chart_internal_fn.updateSizeForLegend=function(legendHeight,legendWidth){var $$=this,config=$$.config,insetLegendPosition={top:$$.isLegendTop?$$.getCurrentPaddingTop()+config.legend_inset_y+5.5:$$.currentHeight-legendHeight-$$.getCurrentPaddingBottom()-config.legend_inset_y,left:$$.isLegendLeft?$$.getCurrentPaddingLeft()+config.legend_inset_x+0.5:$$.currentWidth-legendWidth-$$.getCurrentPaddingRight()-config.legend_inset_x+0.5};$$.margin3={top:$$.isLegendRight?0:$$.isLegendInset?insetLegendPosition.top:$$.currentHeight-legendHeight,right:NaN,bottom:0,left:$$.isLegendRight?$$.currentWidth-legendWidth:$$.isLegendInset?insetLegendPosition.left:0};};c3_chart_internal_fn.transformLegend=function(withTransition){var $$=this;(withTransition?$$.legend.transition():$$.legend).attr("transform",$$.getTranslate('legend'));};c3_chart_internal_fn.updateLegendStep=function(step){this.legendStep=step;};c3_chart_internal_fn.updateLegendItemWidth=function(w){this.legendItemWidth=w;};c3_chart_internal_fn.updateLegendItemHeight=function(h){this.legendItemHeight=h;};c3_chart_internal_fn.getLegendWidth=function(){var $$=this;return $$.config.legend_show?$$.isLegendRight||$$.isLegendInset?$$.legendItemWidth*($$.legendStep+1):$$.currentWidth:0;};c3_chart_internal_fn.getLegendHeight=function(){var $$=this,h=0;if($$.config.legend_show){if($$.isLegendRight){h=$$.currentHeight;}else{h=Math.max(20,$$.legendItemHeight)*($$.legendStep+1);}}
return h;};c3_chart_internal_fn.opacityForLegend=function(legendItem){return legendItem.classed(CLASS.legendItemHidden)?null:1;};c3_chart_internal_fn.opacityForUnfocusedLegend=function(legendItem){return legendItem.classed(CLASS.legendItemHidden)?null:0.3;};c3_chart_internal_fn.toggleFocusLegend=function(targetIds,focus){var $$=this;targetIds=$$.mapToTargetIds(targetIds);$$.legend.selectAll('.'+CLASS.legendItem).filter(function(id){return targetIds.indexOf(id)>=0;}).classed(CLASS.legendItemFocused,focus).transition().duration(100).style('opacity',function(){var opacity=focus?$$.opacityForLegend:$$.opacityForUnfocusedLegend;return opacity.call($$,$$.d3.select(this));});};c3_chart_internal_fn.revertLegend=function(){var $$=this,d3=$$.d3;$$.legend.selectAll('.'+CLASS.legendItem).classed(CLASS.legendItemFocused,false).transition().duration(100).style('opacity',function(){return $$.opacityForLegend(d3.select(this));});};c3_chart_internal_fn.showLegend=function(targetIds){var $$=this,config=$$.config;if(!config.legend_show){config.legend_show=true;$$.legend.style('visibility','visible');if(!$$.legendHasRendered){$$.updateLegendWithDefaults();}}
$$.removeHiddenLegendIds(targetIds);$$.legend.selectAll($$.selectorLegends(targetIds)).style('visibility','visible').transition().style('opacity',function(){return $$.opacityForLegend($$.d3.select(this));});};c3_chart_internal_fn.hideLegend=function(targetIds){var $$=this,config=$$.config;if(config.legend_show&&isEmpty(targetIds)){config.legend_show=false;$$.legend.style('visibility','hidden');}
$$.addHiddenLegendIds(targetIds);$$.legend.selectAll($$.selectorLegends(targetIds)).style('opacity',0).style('visibility','hidden');};c3_chart_internal_fn.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={};};c3_chart_internal_fn.updateLegend=function(targetIds,options,transitions){var $$=this,config=$$.config;var xForLegend,xForLegendText,xForLegendRect,yForLegend,yForLegendText,yForLegendRect;var paddingTop=4,paddingRight=10,maxWidth=0,maxHeight=0,posMin=10,tileWidth=15;var l,totalLength=0,offsets={},widths={},heights={},margins=[0],steps={},step=0;var withTransition,withTransitionForTransform;var texts,rects,tiles,background;options=options||{};withTransition=getOption(options,"withTransition",true);withTransitionForTransform=getOption(options,"withTransitionForTransform",true);function getTextBox(textElement,id){if(!$$.legendItemTextBox[id]){$$.legendItemTextBox[id]=$$.getTextRect(textElement.textContent,CLASS.legendItem);}
return $$.legendItemTextBox[id];}
function updatePositions(textElement,id,index){var reset=index===0,isLast=index===targetIds.length-1,box=getTextBox(textElement,id),itemWidth=box.width+tileWidth+(isLast&&!($$.isLegendRight||$$.isLegendInset)?0:paddingRight),itemHeight=box.height+paddingTop,itemLength=$$.isLegendRight||$$.isLegendInset?itemHeight:itemWidth,areaLength=$$.isLegendRight||$$.isLegendInset?$$.getLegendHeight():$$.getLegendWidth(),margin,maxLength;function updateValues(id,withoutStep){if(!withoutStep){margin=(areaLength-totalLength-itemLength)/2;if(margin<posMin){margin=(areaLength-itemLength)/2;totalLength=0;step++;}}
steps[id]=step;margins[step]=$$.isLegendInset?10:margin;offsets[id]=totalLength;totalLength+=itemLength;}
if(reset){totalLength=0;step=0;maxWidth=0;maxHeight=0;}
if(config.legend_show&&!$$.isLegendToShow(id)){widths[id]=heights[id]=steps[id]=offsets[id]=0;return;}
widths[id]=itemWidth;heights[id]=itemHeight;if(!maxWidth||itemWidth>=maxWidth){maxWidth=itemWidth;}
if(!maxHeight||itemHeight>=maxHeight){maxHeight=itemHeight;}
maxLength=$$.isLegendRight||$$.isLegendInset?maxHeight:maxWidth;if(config.legend_equally){Object.keys(widths).forEach(function(id){widths[id]=maxWidth;});Object.keys(heights).forEach(function(id){heights[id]=maxHeight;});margin=(areaLength-maxLength*targetIds.length)/2;if(margin<posMin){totalLength=0;step=0;targetIds.forEach(function(id){updateValues(id);});}
else{updateValues(id,true);}}else{updateValues(id);}}
if($$.isLegendInset){step=config.legend_inset_step?config.legend_inset_step:targetIds.length;$$.updateLegendStep(step);}
if($$.isLegendRight){xForLegend=function(id){return maxWidth*steps[id];};yForLegend=function(id){return margins[steps[id]]+offsets[id];};}else if($$.isLegendInset){xForLegend=function(id){return maxWidth*steps[id]+10;};yForLegend=function(id){return margins[steps[id]]+offsets[id];};}else{xForLegend=function(id){return margins[steps[id]]+offsets[id];};yForLegend=function(id){return maxHeight*steps[id];};}
xForLegendText=function(id,i){return xForLegend(id,i)+14;};yForLegendText=function(id,i){return yForLegend(id,i)+9;};xForLegendRect=function(id,i){return xForLegend(id,i);};yForLegendRect=function(id,i){return yForLegend(id,i)-5;};l=$$.legend.selectAll('.'+CLASS.legendItem).data(targetIds).enter().append('g').attr('class',function(id){return $$.generateClass(CLASS.legendItem,id);}).style('visibility',function(id){return $$.isLegendToShow(id)?'visible':'hidden';}).style('cursor','pointer').on('click',function(id){if(config.legend_item_onclick){config.legend_item_onclick.call($$,id);}else{if($$.d3.event.altKey){$$.api.hide();$$.api.show(id);}else{$$.api.toggle(id);$$.isTargetToShow(id)?$$.api.focus(id):$$.api.revert();}}}).on('mouseover',function(id){$$.d3.select(this).classed(CLASS.legendItemFocused,true);if(!$$.transiting&&$$.isTargetToShow(id)){$$.api.focus(id);}
if(config.legend_item_onmouseover){config.legend_item_onmouseover.call($$,id);}}).on('mouseout',function(id){$$.d3.select(this).classed(CLASS.legendItemFocused,false);$$.api.revert();if(config.legend_item_onmouseout){config.legend_item_onmouseout.call($$,id);}});l.append('text').text(function(id){return isDefined(config.data_names[id])?config.data_names[id]:id;}).each(function(id,i){updatePositions(this,id,i);}).style("pointer-events","none").attr('x',$$.isLegendRight||$$.isLegendInset?xForLegendText:-200).attr('y',$$.isLegendRight||$$.isLegendInset?-200:yForLegendText);l.append('rect').attr("class",CLASS.legendItemEvent).style('fill-opacity',0).attr('x',$$.isLegendRight||$$.isLegendInset?xForLegendRect:-200).attr('y',$$.isLegendRight||$$.isLegendInset?-200:yForLegendRect);l.append('rect').attr("class",CLASS.legendItemTile).style("pointer-events","none").style('fill',$$.color).attr('x',$$.isLegendRight||$$.isLegendInset?xForLegendText:-200).attr('y',$$.isLegendRight||$$.isLegendInset?-200:yForLegend).attr('width',10).attr('height',10);background=$$.legend.select('.'+CLASS.legendBackground+' rect');if($$.isLegendInset&&maxWidth>0&&background.size()===0){background=$$.legend.insert('g','.'+CLASS.legendItem).attr("class",CLASS.legendBackground).append('rect');}
texts=$$.legend.selectAll('text').data(targetIds).text(function(id){return isDefined(config.data_names[id])?config.data_names[id]:id;}).each(function(id,i){updatePositions(this,id,i);});(withTransition?texts.transition():texts).attr('x',xForLegendText).attr('y',yForLegendText);rects=$$.legend.selectAll('rect.'+CLASS.legendItemEvent).data(targetIds);(withTransition?rects.transition():rects).attr('width',function(id){return widths[id];}).attr('height',function(id){return heights[id];}).attr('x',xForLegendRect).attr('y',yForLegendRect);tiles=$$.legend.selectAll('rect.'+CLASS.legendItemTile).data(targetIds);(withTransition?tiles.transition():tiles).style('fill',$$.color).attr('x',xForLegend).attr('y',yForLegend);if(background){(withTransition?background.transition():background).attr('height',$$.getLegendHeight()-12).attr('width',maxWidth*(step+1)+10);}
$$.legend.selectAll('.'+CLASS.legendItem).classed(CLASS.legendItemHidden,function(id){return!$$.isTargetToShow(id);});$$.updateLegendItemWidth(maxWidth);$$.updateLegendItemHeight(maxHeight);$$.updateLegendStep(step);$$.updateSizes();$$.updateScales();$$.updateSvgSize();$$.transformAll(withTransitionForTransform,transitions);$$.legendHasRendered=true;};function Axis(owner){API.call(this,owner);}
inherit(API,Axis);Axis.prototype.init=function init(){var $$=this.owner,config=$$.config,main=$$.main;$$.axes.x=main.append("g").attr("class",CLASS.axis+' '+CLASS.axisX).attr("clip-path",$$.clipPathForXAxis).attr("transform",$$.getTranslate('x')).style("visibility",config.axis_x_show?'visible':'hidden');$$.axes.x.append("text").attr("class",CLASS.axisXLabel).attr("transform",config.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this));$$.axes.y=main.append("g").attr("class",CLASS.axis+' '+CLASS.axisY).attr("clip-path",config.axis_y_inner?"":$$.clipPathForYAxis).attr("transform",$$.getTranslate('y')).style("visibility",config.axis_y_show?'visible':'hidden');$$.axes.y.append("text").attr("class",CLASS.axisYLabel).attr("transform",config.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this));$$.axes.y2=main.append("g").attr("class",CLASS.axis+' '+CLASS.axisY2).attr("transform",$$.getTranslate('y2')).style("visibility",config.axis_y2_show?'visible':'hidden');$$.axes.y2.append("text").attr("class",CLASS.axisY2Label).attr("transform",config.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this));};Axis.prototype.getXAxis=function getXAxis(scale,orient,tickFormat,tickValues,withOuterTick,withoutTransition,withoutRotateTickText){var $$=this.owner,config=$$.config,axisParams={isCategory:$$.isCategorized(),withOuterTick:withOuterTick,tickMultiline:config.axis_x_tick_multiline,tickWidth:config.axis_x_tick_width,tickTextRotate:withoutRotateTickText?0:config.axis_x_tick_rotate,withoutTransition:withoutTransition,},axis=c3_axis($$.d3,axisParams).scale(scale).orient(orient);if($$.isTimeSeries()&&tickValues){tickValues=tickValues.map(function(v){return $$.parseDate(v);});}
axis.tickFormat(tickFormat).tickValues(tickValues);if($$.isCategorized()){axis.tickCentered(config.axis_x_tick_centered);if(isEmpty(config.axis_x_tick_culling)){config.axis_x_tick_culling=false;}}
return axis;};Axis.prototype.updateXAxisTickValues=function updateXAxisTickValues(targets,axis){var $$=this.owner,config=$$.config,tickValues;if(config.axis_x_tick_fit||config.axis_x_tick_count){tickValues=this.generateTickValues($$.mapTargetsToUniqueXs(targets),config.axis_x_tick_count,$$.isTimeSeries());}
if(axis){axis.tickValues(tickValues);}else{$$.xAxis.tickValues(tickValues);$$.subXAxis.tickValues(tickValues);}
return tickValues;};Axis.prototype.getYAxis=function getYAxis(scale,orient,tickFormat,tickValues,withOuterTick,withoutTransition){var axisParams={withOuterTick:withOuterTick,withoutTransition:withoutTransition,},$$=this.owner,d3=$$.d3,config=$$.config,axis=c3_axis(d3,axisParams).scale(scale).orient(orient).tickFormat(tickFormat);if($$.isTimeSeriesY()){axis.ticks(d3.time[config.axis_y_tick_time_value],config.axis_y_tick_time_interval);}else{axis.tickValues(tickValues);}
return axis;};Axis.prototype.getId=function getId(id){var config=this.owner.config;return id in config.data_axes?config.data_axes[id]:'y';};Axis.prototype.getXAxisTickFormat=function getXAxisTickFormat(){var $$=this.owner,config=$$.config,format=$$.isTimeSeries()?$$.defaultAxisTimeFormat:$$.isCategorized()?$$.categoryName:function(v){return v<0?v.toFixed(0):v;};if(config.axis_x_tick_format){if(isFunction(config.axis_x_tick_format)){format=config.axis_x_tick_format;}else if($$.isTimeSeries()){format=function(date){return date?$$.axisTimeFormat(config.axis_x_tick_format)(date):"";};}}
return isFunction(format)?function(v){return format.call($$,v);}:format;};Axis.prototype.getTickValues=function getTickValues(tickValues,axis){return tickValues?tickValues:axis?axis.tickValues():undefined;};Axis.prototype.getXAxisTickValues=function getXAxisTickValues(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis);};Axis.prototype.getYAxisTickValues=function getYAxisTickValues(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis);};Axis.prototype.getY2AxisTickValues=function getY2AxisTickValues(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis);};Axis.prototype.getLabelOptionByAxisId=function getLabelOptionByAxisId(axisId){var $$=this.owner,config=$$.config,option;if(axisId==='y'){option=config.axis_y_label;}else if(axisId==='y2'){option=config.axis_y2_label;}else if(axisId==='x'){option=config.axis_x_label;}
return option;};Axis.prototype.getLabelText=function getLabelText(axisId){var option=this.getLabelOptionByAxisId(axisId);return isString(option)?option:option?option.text:null;};Axis.prototype.setLabelText=function setLabelText(axisId,text){var $$=this.owner,config=$$.config,option=this.getLabelOptionByAxisId(axisId);if(isString(option)){if(axisId==='y'){config.axis_y_label=text;}else if(axisId==='y2'){config.axis_y2_label=text;}else if(axisId==='x'){config.axis_x_label=text;}}else if(option){option.text=text;}};Axis.prototype.getLabelPosition=function getLabelPosition(axisId,defaultPosition){var option=this.getLabelOptionByAxisId(axisId),position=(option&&typeof option==='object'&&option.position)?option.position:defaultPosition;return{isInner:position.indexOf('inner')>=0,isOuter:position.indexOf('outer')>=0,isLeft:position.indexOf('left')>=0,isCenter:position.indexOf('center')>=0,isRight:position.indexOf('right')>=0,isTop:position.indexOf('top')>=0,isMiddle:position.indexOf('middle')>=0,isBottom:position.indexOf('bottom')>=0};};Axis.prototype.getXAxisLabelPosition=function getXAxisLabelPosition(){return this.getLabelPosition('x',this.owner.config.axis_rotated?'inner-top':'inner-right');};Axis.prototype.getYAxisLabelPosition=function getYAxisLabelPosition(){return this.getLabelPosition('y',this.owner.config.axis_rotated?'inner-right':'inner-top');};Axis.prototype.getY2AxisLabelPosition=function getY2AxisLabelPosition(){return this.getLabelPosition('y2',this.owner.config.axis_rotated?'inner-right':'inner-top');};Axis.prototype.getLabelPositionById=function getLabelPositionById(id){return id==='y2'?this.getY2AxisLabelPosition():id==='y'?this.getYAxisLabelPosition():this.getXAxisLabelPosition();};Axis.prototype.textForXAxisLabel=function textForXAxisLabel(){return this.getLabelText('x');};Axis.prototype.textForYAxisLabel=function textForYAxisLabel(){return this.getLabelText('y');};Axis.prototype.textForY2AxisLabel=function textForY2AxisLabel(){return this.getLabelText('y2');};Axis.prototype.xForAxisLabel=function xForAxisLabel(forHorizontal,position){var $$=this.owner;if(forHorizontal){return position.isLeft?0:position.isCenter?$$.width/2:$$.width;}else{return position.isBottom?-$$.height:position.isMiddle?-$$.height/2:0;}};Axis.prototype.dxForAxisLabel=function dxForAxisLabel(forHorizontal,position){if(forHorizontal){return position.isLeft?"0.5em":position.isRight?"-0.5em":"0";}else{return position.isTop?"-0.5em":position.isBottom?"0.5em":"0";}};Axis.prototype.textAnchorForAxisLabel=function textAnchorForAxisLabel(forHorizontal,position){if(forHorizontal){return position.isLeft?'start':position.isCenter?'middle':'end';}else{return position.isBottom?'start':position.isMiddle?'middle':'end';}};Axis.prototype.xForXAxisLabel=function xForXAxisLabel(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition());};Axis.prototype.xForYAxisLabel=function xForYAxisLabel(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition());};Axis.prototype.xForY2AxisLabel=function xForY2AxisLabel(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition());};Axis.prototype.dxForXAxisLabel=function dxForXAxisLabel(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition());};Axis.prototype.dxForYAxisLabel=function dxForYAxisLabel(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition());};Axis.prototype.dxForY2AxisLabel=function dxForY2AxisLabel(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition());};Axis.prototype.dyForXAxisLabel=function dyForXAxisLabel(){var $$=this.owner,config=$$.config,position=this.getXAxisLabelPosition();if(config.axis_rotated){return position.isInner?"1.2em":-25-this.getMaxTickWidth('x');}else{return position.isInner?"-0.5em":config.axis_x_height?config.axis_x_height-10:"3em";}};Axis.prototype.dyForYAxisLabel=function dyForYAxisLabel(){var $$=this.owner,position=this.getYAxisLabelPosition();if($$.config.axis_rotated){return position.isInner?"-0.5em":"3em";}else{return position.isInner?"1.2em":-10-($$.config.axis_y_inner?0:(this.getMaxTickWidth('y')+10));}};Axis.prototype.dyForY2AxisLabel=function dyForY2AxisLabel(){var $$=this.owner,position=this.getY2AxisLabelPosition();if($$.config.axis_rotated){return position.isInner?"1.2em":"-2.2em";}else{return position.isInner?"-0.5em":15+($$.config.axis_y2_inner?0:(this.getMaxTickWidth('y2')+15));}};Axis.prototype.textAnchorForXAxisLabel=function textAnchorForXAxisLabel(){var $$=this.owner;return this.textAnchorForAxisLabel(!$$.config.axis_rotated,this.getXAxisLabelPosition());};Axis.prototype.textAnchorForYAxisLabel=function textAnchorForYAxisLabel(){var $$=this.owner;return this.textAnchorForAxisLabel($$.config.axis_rotated,this.getYAxisLabelPosition());};Axis.prototype.textAnchorForY2AxisLabel=function textAnchorForY2AxisLabel(){var $$=this.owner;return this.textAnchorForAxisLabel($$.config.axis_rotated,this.getY2AxisLabelPosition());};Axis.prototype.getMaxTickWidth=function getMaxTickWidth(id,withoutRecompute){var $$=this.owner,config=$$.config,maxWidth=0,targetsToShow,scale,axis,dummy,svg;if(withoutRecompute&&$$.currentMaxTickWidths[id]){return $$.currentMaxTickWidths[id];}
if($$.svg){targetsToShow=$$.filterTargetsToShow($$.data.targets);if(id==='y'){scale=$$.y.copy().domain($$.getYDomain(targetsToShow,'y'));axis=this.getYAxis(scale,$$.yOrient,config.axis_y_tick_format,$$.yAxisTickValues,false,true);}else if(id==='y2'){scale=$$.y2.copy().domain($$.getYDomain(targetsToShow,'y2'));axis=this.getYAxis(scale,$$.y2Orient,config.axis_y2_tick_format,$$.y2AxisTickValues,false,true);}else{scale=$$.x.copy().domain($$.getXDomain(targetsToShow));axis=this.getXAxis(scale,$$.xOrient,$$.xAxisTickFormat,$$.xAxisTickValues,false,true,true);this.updateXAxisTickValues(targetsToShow,axis);}
dummy=$$.d3.select('body').append('div').classed('c3',true);svg=dummy.append("svg").style('visibility','hidden').style('position','fixed').style('top',0).style('left',0),svg.append('g').call(axis).each(function(){$$.d3.select(this).selectAll('text').each(function(){var box=this.getBoundingClientRect();if(maxWidth<box.width){maxWidth=box.width;}});dummy.remove();});}
$$.currentMaxTickWidths[id]=maxWidth<=0?$$.currentMaxTickWidths[id]:maxWidth;return $$.currentMaxTickWidths[id];};Axis.prototype.updateLabels=function updateLabels(withTransition){var $$=this.owner;var axisXLabel=$$.main.select('.'+CLASS.axisX+' .'+CLASS.axisXLabel),axisYLabel=$$.main.select('.'+CLASS.axisY+' .'+CLASS.axisYLabel),axisY2Label=$$.main.select('.'+CLASS.axisY2+' .'+CLASS.axisY2Label);(withTransition?axisXLabel.transition():axisXLabel).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this));(withTransition?axisYLabel.transition():axisYLabel).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this));(withTransition?axisY2Label.transition():axisY2Label).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this));};Axis.prototype.getPadding=function getPadding(padding,key,defaultValue,domainLength){if(!isValue(padding[key])){return defaultValue;}
if(padding.unit==='ratio'){return padding[key]*domainLength;}
return this.convertPixelsToAxisPadding(padding[key],domainLength);};Axis.prototype.convertPixelsToAxisPadding=function convertPixelsToAxisPadding(pixels,domainLength){var $$=this.owner,length=$$.config.axis_rotated?$$.width:$$.height;return domainLength*(pixels/length);};Axis.prototype.generateTickValues=function generateTickValues(values,tickCount,forTimeSeries){var tickValues=values,targetCount,start,end,count,interval,i,tickValue;if(tickCount){targetCount=isFunction(tickCount)?tickCount():tickCount;if(targetCount===1){tickValues=[values[0]];}else if(targetCount===2){tickValues=[values[0],values[values.length-1]];}else if(targetCount>2){count=targetCount-2;start=values[0];end=values[values.length-1];interval=(end-start)/(count+1);tickValues=[start];for(i=0;i<count;i++){tickValue=+start+interval*(i+1);tickValues.push(forTimeSeries?new Date(tickValue):tickValue);}
tickValues.push(end);}}
if(!forTimeSeries){tickValues=tickValues.sort(function(a,b){return a-b;});}
return tickValues;};Axis.prototype.generateTransitions=function generateTransitions(duration){var $$=this.owner,axes=$$.axes;return{axisX:duration?axes.x.transition().duration(duration):axes.x,axisY:duration?axes.y.transition().duration(duration):axes.y,axisY2:duration?axes.y2.transition().duration(duration):axes.y2,axisSubX:duration?axes.subx.transition().duration(duration):axes.subx};};Axis.prototype.redraw=function redraw(transitions,isHidden){var $$=this.owner;$$.axes.x.style("opacity",isHidden?0:1);$$.axes.y.style("opacity",isHidden?0:1);$$.axes.y2.style("opacity",isHidden?0:1);$$.axes.subx.style("opacity",isHidden?0:1);transitions.axisX.call($$.xAxis);transitions.axisY.call($$.yAxis);transitions.axisY2.call($$.y2Axis);transitions.axisSubX.call($$.subXAxis);};c3_chart_internal_fn.getClipPath=function(id){var isIE9=window.navigator.appVersion.toLowerCase().indexOf("msie 9.")>=0;return"url("+(isIE9?"":document.URL.split('#')[0])+"#"+id+")";};c3_chart_internal_fn.appendClip=function(parent,id){return parent.append("clipPath").attr("id",id).append("rect");};c3_chart_internal_fn.getAxisClipX=function(forHorizontal){var left=Math.max(30,this.margin.left);return forHorizontal?-(1+left):-(left-1);};c3_chart_internal_fn.getAxisClipY=function(forHorizontal){return forHorizontal?-20:-this.margin.top;};c3_chart_internal_fn.getXAxisClipX=function(){var $$=this;return $$.getAxisClipX(!$$.config.axis_rotated);};c3_chart_internal_fn.getXAxisClipY=function(){var $$=this;return $$.getAxisClipY(!$$.config.axis_rotated);};c3_chart_internal_fn.getYAxisClipX=function(){var $$=this;return $$.config.axis_y_inner?-1:$$.getAxisClipX($$.config.axis_rotated);};c3_chart_internal_fn.getYAxisClipY=function(){var $$=this;return $$.getAxisClipY($$.config.axis_rotated);};c3_chart_internal_fn.getAxisClipWidth=function(forHorizontal){var $$=this,left=Math.max(30,$$.margin.left),right=Math.max(30,$$.margin.right);return forHorizontal?$$.width+2+left+right:$$.margin.left+20;};c3_chart_internal_fn.getAxisClipHeight=function(forHorizontal){return(forHorizontal?this.margin.bottom:(this.margin.top+this.height))+20;};c3_chart_internal_fn.getXAxisClipWidth=function(){var $$=this;return $$.getAxisClipWidth(!$$.config.axis_rotated);};c3_chart_internal_fn.getXAxisClipHeight=function(){var $$=this;return $$.getAxisClipHeight(!$$.config.axis_rotated);};c3_chart_internal_fn.getYAxisClipWidth=function(){var $$=this;return $$.getAxisClipWidth($$.config.axis_rotated)+($$.config.axis_y_inner?20:0);};c3_chart_internal_fn.getYAxisClipHeight=function(){var $$=this;return $$.getAxisClipHeight($$.config.axis_rotated);};c3_chart_internal_fn.initPie=function(){var $$=this,d3=$$.d3,config=$$.config;$$.pie=d3.layout.pie().value(function(d){return d.values.reduce(function(a,b){return a+b.value;},0);});if(!config.data_order){$$.pie.sort(null);}};c3_chart_internal_fn.updateRadius=function(){var $$=this,config=$$.config,w=config.gauge_width||config.donut_width;$$.radiusExpanded=Math.min($$.arcWidth,$$.arcHeight)/2;$$.radius=$$.radiusExpanded*0.95;$$.innerRadiusRatio=w?($$.radius-w)/$$.radius:0.6;$$.innerRadius=$$.hasType('donut')||$$.hasType('gauge')?$$.radius*$$.innerRadiusRatio:0;};c3_chart_internal_fn.updateArc=function(){var $$=this;$$.svgArc=$$.getSvgArc();$$.svgArcExpanded=$$.getSvgArcExpanded();$$.svgArcExpandedSub=$$.getSvgArcExpanded(0.98);};c3_chart_internal_fn.updateAngle=function(d){var $$=this,config=$$.config,found=false,index=0,gMin=config.gauge_min,gMax=config.gauge_max,gTic,gValue;$$.pie($$.filterTargetsToShow($$.data.targets)).forEach(function(t){if(!found&&t.data.id===d.data.id){found=true;d=t;d.index=index;}
index++;});if(isNaN(d.startAngle)){d.startAngle=0;}
if(isNaN(d.endAngle)){d.endAngle=d.startAngle;}
if($$.isGaugeType(d.data)){gTic=(Math.PI)/(gMax-gMin);gValue=d.value<gMin?0:d.value<gMax?d.value-gMin:(gMax-gMin);d.startAngle=-1*(Math.PI/2);d.endAngle=d.startAngle+gTic*gValue;}
return found?d:null;};c3_chart_internal_fn.getSvgArc=function(){var $$=this,arc=$$.d3.svg.arc().outerRadius($$.radius).innerRadius($$.innerRadius),newArc=function(d,withoutUpdate){var updated;if(withoutUpdate){return arc(d);}
updated=$$.updateAngle(d);return updated?arc(updated):"M 0 0";};newArc.centroid=arc.centroid;return newArc;};c3_chart_internal_fn.getSvgArcExpanded=function(rate){var $$=this,arc=$$.d3.svg.arc().outerRadius($$.radiusExpanded*(rate?rate:1)).innerRadius($$.innerRadius);return function(d){var updated=$$.updateAngle(d);return updated?arc(updated):"M 0 0";};};c3_chart_internal_fn.getArc=function(d,withoutUpdate,force){return force||this.isArcType(d.data)?this.svgArc(d,withoutUpdate):"M 0 0";};c3_chart_internal_fn.transformForArcLabel=function(d){var $$=this,updated=$$.updateAngle(d),c,x,y,h,ratio,translate="";if(updated&&!$$.hasType('gauge')){c=this.svgArc.centroid(updated);x=isNaN(c[0])?0:c[0];y=isNaN(c[1])?0:c[1];h=Math.sqrt(x*x+y*y);ratio=$$.radius&&h?(36/$$.radius>0.375?1.175-36/$$.radius:0.8)*$$.radius/h:0;translate="translate("+(x*ratio)+','+(y*ratio)+")";}
return translate;};c3_chart_internal_fn.getArcRatio=function(d){var $$=this,whole=$$.hasType('gauge')?Math.PI:(Math.PI*2);return d?(d.endAngle-d.startAngle)/whole:null;};c3_chart_internal_fn.convertToArcData=function(d){return this.addName({id:d.data.id,value:d.value,ratio:this.getArcRatio(d),index:d.index});};c3_chart_internal_fn.textForArcLabel=function(d){var $$=this,updated,value,ratio,id,format;if(!$$.shouldShowArcLabel()){return"";}
updated=$$.updateAngle(d);value=updated?updated.value:null;ratio=$$.getArcRatio(updated);id=d.data.id;if(!$$.hasType('gauge')&&!$$.meetsArcLabelThreshold(ratio)){return"";}
format=$$.getArcLabelFormat();return format?format(value,ratio,id):$$.defaultArcValueFormat(value,ratio);};c3_chart_internal_fn.expandArc=function(targetIds){var $$=this,interval;if($$.transiting){interval=window.setInterval(function(){if(!$$.transiting){window.clearInterval(interval);if($$.legend.selectAll('.c3-legend-item-focused').size()>0){$$.expandArc(targetIds);}}},10);return;}
targetIds=$$.mapToTargetIds(targetIds);$$.svg.selectAll($$.selectorTargets(targetIds,'.'+CLASS.chartArc)).each(function(d){if(!$$.shouldExpand(d.data.id)){return;}
$$.d3.select(this).selectAll('path').transition().duration(50).attr("d",$$.svgArcExpanded).transition().duration(100).attr("d",$$.svgArcExpandedSub).each(function(d){if($$.isDonutType(d.data)){}});});};c3_chart_internal_fn.unexpandArc=function(targetIds){var $$=this;if($$.transiting){return;}
targetIds=$$.mapToTargetIds(targetIds);$$.svg.selectAll($$.selectorTargets(targetIds,'.'+CLASS.chartArc)).selectAll('path').transition().duration(50).attr("d",$$.svgArc);$$.svg.selectAll('.'+CLASS.arc).style("opacity",1);};c3_chart_internal_fn.shouldExpand=function(id){var $$=this,config=$$.config;return($$.isDonutType(id)&&config.donut_expand)||($$.isGaugeType(id)&&config.gauge_expand)||($$.isPieType(id)&&config.pie_expand);};c3_chart_internal_fn.shouldShowArcLabel=function(){var $$=this,config=$$.config,shouldShow=true;if($$.hasType('donut')){shouldShow=config.donut_label_show;}else if($$.hasType('pie')){shouldShow=config.pie_label_show;}
return shouldShow;};c3_chart_internal_fn.meetsArcLabelThreshold=function(ratio){var $$=this,config=$$.config,threshold=$$.hasType('donut')?config.donut_label_threshold:config.pie_label_threshold;return ratio>=threshold;};c3_chart_internal_fn.getArcLabelFormat=function(){var $$=this,config=$$.config,format=config.pie_label_format;if($$.hasType('gauge')){format=config.gauge_label_format;}else if($$.hasType('donut')){format=config.donut_label_format;}
return format;};c3_chart_internal_fn.getArcTitle=function(){var $$=this;return $$.hasType('donut')?$$.config.donut_title:"";};c3_chart_internal_fn.updateTargetsForArc=function(targets){var $$=this,main=$$.main,mainPieUpdate,mainPieEnter,classChartArc=$$.classChartArc.bind($$),classArcs=$$.classArcs.bind($$),classFocus=$$.classFocus.bind($$);mainPieUpdate=main.select('.'+CLASS.chartArcs).selectAll('.'+CLASS.chartArc).data($$.pie(targets)).attr("class",function(d){return classChartArc(d)+classFocus(d.data);});mainPieEnter=mainPieUpdate.enter().append("g").attr("class",classChartArc);mainPieEnter.append('g').attr('class',classArcs);mainPieEnter.append("text").attr("dy",$$.hasType('gauge')?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none");};c3_chart_internal_fn.initArc=function(){var $$=this;$$.arcs=$$.main.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartArcs).attr("transform",$$.getTranslate('arc'));$$.arcs.append('text').attr('class',CLASS.chartArcsTitle).style("text-anchor","middle").text($$.getArcTitle());};c3_chart_internal_fn.redrawArc=function(duration,durationForExit,withTransform){var $$=this,d3=$$.d3,config=$$.config,main=$$.main,mainArc;mainArc=main.selectAll('.'+CLASS.arcs).selectAll('.'+CLASS.arc).data($$.arcData.bind($$));mainArc.enter().append('path').attr("class",$$.classArc.bind($$)).style("fill",function(d){return $$.color(d.data);}).style("cursor",function(d){return config.interaction_enabled&&config.data_selection_isselectable(d)?"pointer":null;}).style("opacity",0).each(function(d){if($$.isGaugeType(d.data)){d.startAngle=d.endAngle=-1*(Math.PI/2);}
this._current=d;});mainArc.attr("transform",function(d){return!$$.isGaugeType(d.data)&&withTransform?"scale(0)":"";}).style("opacity",function(d){return d===this._current?0:1;}).on('mouseover',config.interaction_enabled?function(d){var updated,arcData;if($$.transiting){return;}
updated=$$.updateAngle(d);arcData=$$.convertToArcData(updated);$$.expandArc(updated.data.id);$$.api.focus(updated.data.id);$$.toggleFocusLegend(updated.data.id,true);$$.config.data_onmouseover(arcData,this);}:null).on('mousemove',config.interaction_enabled?function(d){var updated=$$.updateAngle(d),arcData=$$.convertToArcData(updated),selectedData=[arcData];$$.showTooltip(selectedData,this);}:null).on('mouseout',config.interaction_enabled?function(d){var updated,arcData;if($$.transiting){return;}
updated=$$.updateAngle(d);arcData=$$.convertToArcData(updated);$$.unexpandArc(updated.data.id);$$.api.revert();$$.revertLegend();$$.hideTooltip();$$.config.data_onmouseout(arcData,this);}:null).on('click',config.interaction_enabled?function(d,i){var updated=$$.updateAngle(d),arcData=$$.convertToArcData(updated);if($$.toggleShape){$$.toggleShape(this,arcData,i);}
$$.config.data_onclick.call($$.api,arcData,this);}:null).each(function(){$$.transiting=true;}).transition().duration(duration).attrTween("d",function(d){var updated=$$.updateAngle(d),interpolate;if(!updated){return function(){return"M 0 0";};}
if(isNaN(this._current.startAngle)){this._current.startAngle=0;}
if(isNaN(this._current.endAngle)){this._current.endAngle=this._current.startAngle;}
interpolate=d3.interpolate(this._current,updated);this._current=interpolate(0);return function(t){var interpolated=interpolate(t);interpolated.data=d.data;return $$.getArc(interpolated,true);};}).attr("transform",withTransform?"scale(1)":"").style("fill",function(d){return $$.levelColor?$$.levelColor(d.data.values[0].value):$$.color(d.data.id);}).style("opacity",1).call($$.endall,function(){$$.transiting=false;});mainArc.exit().transition().duration(durationForExit).style('opacity',0).remove();main.selectAll('.'+CLASS.chartArc).select('text').style("opacity",0).attr('class',function(d){return $$.isGaugeType(d.data)?CLASS.gaugeValue:'';}).text($$.textForArcLabel.bind($$)).attr("transform",$$.transformForArcLabel.bind($$)).style('font-size',function(d){return $$.isGaugeType(d.data)?Math.round($$.radius/5)+'px':'';}).transition().duration(duration).style("opacity",function(d){return $$.isTargetToShow(d.data.id)&&$$.isArcType(d.data)?1:0;});main.select('.'+CLASS.chartArcsTitle).style("opacity",$$.hasType('donut')||$$.hasType('gauge')?1:0);if($$.hasType('gauge')){$$.arcs.select('.'+CLASS.chartArcsBackground).attr("d",function(){var d={data:[{value:config.gauge_max}],startAngle:-1*(Math.PI/2),endAngle:Math.PI/2};return $$.getArc(d,true,true);});$$.arcs.select('.'+CLASS.chartArcsGaugeUnit).attr("dy",".75em").text(config.gauge_label_show?config.gauge_units:'');$$.arcs.select('.'+CLASS.chartArcsGaugeMin).attr("dx",-1*($$.innerRadius+(($$.radius-$$.innerRadius)/2))+"px").attr("dy","1.2em").text(config.gauge_label_show?config.gauge_min:'');$$.arcs.select('.'+CLASS.chartArcsGaugeMax).attr("dx",$$.innerRadius+(($$.radius-$$.innerRadius)/2)+"px").attr("dy","1.2em").text(config.gauge_label_show?config.gauge_max:'');}};c3_chart_internal_fn.initGauge=function(){var arcs=this.arcs;if(this.hasType('gauge')){arcs.append('path').attr("class",CLASS.chartArcsBackground);arcs.append("text").attr("class",CLASS.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none");arcs.append("text").attr("class",CLASS.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none");arcs.append("text").attr("class",CLASS.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none");}};c3_chart_internal_fn.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0;};c3_chart_internal_fn.initRegion=function(){var $$=this;$$.region=$$.main.append('g').attr("clip-path",$$.clipPath).attr("class",CLASS.regions);};c3_chart_internal_fn.updateRegion=function(duration){var $$=this,config=$$.config;$$.region.style('visibility',$$.hasArcType()?'hidden':'visible');$$.mainRegion=$$.main.select('.'+CLASS.regions).selectAll('.'+CLASS.region).data(config.regions);$$.mainRegion.enter().append('g').attr('class',$$.classRegion.bind($$)).append('rect').style("fill-opacity",0);$$.mainRegion.exit().transition().duration(duration).style("opacity",0).remove();};c3_chart_internal_fn.redrawRegion=function(withTransition){var $$=this,regions=$$.mainRegion.selectAll('rect'),x=$$.regionX.bind($$),y=$$.regionY.bind($$),w=$$.regionWidth.bind($$),h=$$.regionHeight.bind($$);return[(withTransition?regions.transition():regions).attr("x",x).attr("y",y).attr("width",w).attr("height",h).style("fill-opacity",function(d){return isValue(d.opacity)?d.opacity:0.1;})];};c3_chart_internal_fn.regionX=function(d){var $$=this,config=$$.config,xPos,yScale=d.axis==='y'?$$.y:$$.y2;if(d.axis==='y'||d.axis==='y2'){xPos=config.axis_rotated?('start'in d?yScale(d.start):0):0;}else{xPos=config.axis_rotated?0:('start'in d?$$.x($$.isTimeSeries()?$$.parseDate(d.start):d.start):0);}
return xPos;};c3_chart_internal_fn.regionY=function(d){var $$=this,config=$$.config,yPos,yScale=d.axis==='y'?$$.y:$$.y2;if(d.axis==='y'||d.axis==='y2'){yPos=config.axis_rotated?0:('end'in d?yScale(d.end):0);}else{yPos=config.axis_rotated?('start'in d?$$.x($$.isTimeSeries()?$$.parseDate(d.start):d.start):0):0;}
return yPos;};c3_chart_internal_fn.regionWidth=function(d){var $$=this,config=$$.config,start=$$.regionX(d),end,yScale=d.axis==='y'?$$.y:$$.y2;if(d.axis==='y'||d.axis==='y2'){end=config.axis_rotated?('end'in d?yScale(d.end):$$.width):$$.width;}else{end=config.axis_rotated?$$.width:('end'in d?$$.x($$.isTimeSeries()?$$.parseDate(d.end):d.end):$$.width);}
return end<start?0:end-start;};c3_chart_internal_fn.regionHeight=function(d){var $$=this,config=$$.config,start=this.regionY(d),end,yScale=d.axis==='y'?$$.y:$$.y2;if(d.axis==='y'||d.axis==='y2'){end=config.axis_rotated?$$.height:('start'in d?yScale(d.start):$$.height);}else{end=config.axis_rotated?('end'in d?$$.x($$.isTimeSeries()?$$.parseDate(d.end):d.end):$$.height):$$.height;}
return end<start?0:end-start;};c3_chart_internal_fn.isRegionOnX=function(d){return!d.axis||d.axis==='x';};c3_chart_internal_fn.drag=function(mouse){var $$=this,config=$$.config,main=$$.main,d3=$$.d3;var sx,sy,mx,my,minX,maxX,minY,maxY;if($$.hasArcType()){return;}
if(!config.data_selection_enabled){return;}
if(config.zoom_enabled&&!$$.zoom.altDomain){return;}
if(!config.data_selection_multiple){return;}
sx=$$.dragStart[0];sy=$$.dragStart[1];mx=mouse[0];my=mouse[1];minX=Math.min(sx,mx);maxX=Math.max(sx,mx);minY=(config.data_selection_grouped)?$$.margin.top:Math.min(sy,my);maxY=(config.data_selection_grouped)?$$.height:Math.max(sy,my);main.select('.'+CLASS.dragarea).attr('x',minX).attr('y',minY).attr('width',maxX-minX).attr('height',maxY-minY);main.selectAll('.'+CLASS.shapes).selectAll('.'+CLASS.shape).filter(function(d){return config.data_selection_isselectable(d);}).each(function(d,i){var shape=d3.select(this),isSelected=shape.classed(CLASS.SELECTED),isIncluded=shape.classed(CLASS.INCLUDED),_x,_y,_w,_h,toggle,isWithin=false,box;if(shape.classed(CLASS.circle)){_x=shape.attr("cx")*1;_y=shape.attr("cy")*1;toggle=$$.togglePoint;isWithin=minX<_x&&_x<maxX&&minY<_y&&_y<maxY;}
else if(shape.classed(CLASS.bar)){box=getPathBox(this);_x=box.x;_y=box.y;_w=box.width;_h=box.height;toggle=$$.togglePath;isWithin=!(maxX<_x||_x+_w<minX)&&!(maxY<_y||_y+_h<minY);}else{return;}
if(isWithin^isIncluded){shape.classed(CLASS.INCLUDED,!isIncluded);shape.classed(CLASS.SELECTED,!isSelected);toggle.call($$,!isSelected,shape,d,i);}});};c3_chart_internal_fn.dragstart=function(mouse){var $$=this,config=$$.config;if($$.hasArcType()){return;}
if(!config.data_selection_enabled){return;}
$$.dragStart=mouse;$$.main.select('.'+CLASS.chart).append('rect').attr('class',CLASS.dragarea).style('opacity',0.1);$$.dragging=true;};c3_chart_internal_fn.dragend=function(){var $$=this,config=$$.config;if($$.hasArcType()){return;}
if(!config.data_selection_enabled){return;}
$$.main.select('.'+CLASS.dragarea).transition().duration(100).style('opacity',0).remove();$$.main.selectAll('.'+CLASS.shape).classed(CLASS.INCLUDED,false);$$.dragging=false;};c3_chart_internal_fn.selectPoint=function(target,d,i){var $$=this,config=$$.config,cx=(config.axis_rotated?$$.circleY:$$.circleX).bind($$),cy=(config.axis_rotated?$$.circleX:$$.circleY).bind($$),r=$$.pointSelectR.bind($$);config.data_onselected.call($$.api,d,target.node());$$.main.select('.'+CLASS.selectedCircles+$$.getTargetSelectorSuffix(d.id)).selectAll('.'+CLASS.selectedCircle+'-'+i).data([d]).enter().append('circle').attr("class",function(){return $$.generateClass(CLASS.selectedCircle,i);}).attr("cx",cx).attr("cy",cy).attr("stroke",function(){return $$.color(d);}).attr("r",function(d){return $$.pointSelectR(d)*1.4;}).transition().duration(100).attr("r",r);};c3_chart_internal_fn.unselectPoint=function(target,d,i){var $$=this;$$.config.data_onunselected(d,target.node());$$.main.select('.'+CLASS.selectedCircles+$$.getTargetSelectorSuffix(d.id)).selectAll('.'+CLASS.selectedCircle+'-'+i).transition().duration(100).attr('r',0).remove();};c3_chart_internal_fn.togglePoint=function(selected,target,d,i){selected?this.selectPoint(target,d,i):this.unselectPoint(target,d,i);};c3_chart_internal_fn.selectPath=function(target,d){var $$=this;$$.config.data_onselected.call($$,d,target.node());target.transition().duration(100).style("fill",function(){return $$.d3.rgb($$.color(d)).brighter(0.75);});};c3_chart_internal_fn.unselectPath=function(target,d){var $$=this;$$.config.data_onunselected.call($$,d,target.node());target.transition().duration(100).style("fill",function(){return $$.color(d);});};c3_chart_internal_fn.togglePath=function(selected,target,d,i){selected?this.selectPath(target,d,i):this.unselectPath(target,d,i);};c3_chart_internal_fn.getToggle=function(that,d){var $$=this,toggle;if(that.nodeName==='circle'){if($$.isStepType(d)){toggle=function(){};}else{toggle=$$.togglePoint;}}
else if(that.nodeName==='path'){toggle=$$.togglePath;}
return toggle;};c3_chart_internal_fn.toggleShape=function(that,d,i){var $$=this,d3=$$.d3,config=$$.config,shape=d3.select(that),isSelected=shape.classed(CLASS.SELECTED),toggle=$$.getToggle(that,d).bind($$);if(config.data_selection_enabled&&config.data_selection_isselectable(d)){if(!config.data_selection_multiple){$$.main.selectAll('.'+CLASS.shapes+(config.data_selection_grouped?$$.getTargetSelectorSuffix(d.id):"")).selectAll('.'+CLASS.shape).each(function(d,i){var shape=d3.select(this);if(shape.classed(CLASS.SELECTED)){toggle(false,shape.classed(CLASS.SELECTED,false),d,i);}});}
shape.classed(CLASS.SELECTED,!isSelected);toggle(!isSelected,shape,d,i);}};c3_chart_internal_fn.initBrush=function(){var $$=this,d3=$$.d3;$$.brush=d3.svg.brush().on("brush",function(){$$.redrawForBrush();});$$.brush.update=function(){if($$.context){$$.context.select('.'+CLASS.brush).call(this);}
return this;};$$.brush.scale=function(scale){return $$.config.axis_rotated?this.y(scale):this.x(scale);};};c3_chart_internal_fn.initSubchart=function(){var $$=this,config=$$.config,context=$$.context=$$.svg.append("g").attr("transform",$$.getTranslate('context'));context.style('visibility',config.subchart_show?'visible':'hidden');context.append('g').attr("clip-path",$$.clipPathForSubchart).attr('class',CLASS.chart);context.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartBars);context.select('.'+CLASS.chart).append("g").attr("class",CLASS.chartLines);context.append("g").attr("clip-path",$$.clipPath).attr("class",CLASS.brush).call($$.brush);$$.axes.subx=context.append("g").attr("class",CLASS.axisX).attr("transform",$$.getTranslate('subx')).attr("clip-path",config.axis_rotated?"":$$.clipPathForXAxis);};c3_chart_internal_fn.updateTargetsForSubchart=function(targets){var $$=this,context=$$.context,config=$$.config,contextLineEnter,contextLineUpdate,contextBarEnter,contextBarUpdate,classChartBar=$$.classChartBar.bind($$),classBars=$$.classBars.bind($$),classChartLine=$$.classChartLine.bind($$),classLines=$$.classLines.bind($$),classAreas=$$.classAreas.bind($$);if(config.subchart_show){contextBarUpdate=context.select('.'+CLASS.chartBars).selectAll('.'+CLASS.chartBar).data(targets).attr('class',classChartBar);contextBarEnter=contextBarUpdate.enter().append('g').style('opacity',0).attr('class',classChartBar);contextBarEnter.append('g').attr("class",classBars);contextLineUpdate=context.select('.'+CLASS.chartLines).selectAll('.'+CLASS.chartLine).data(targets).attr('class',classChartLine);contextLineEnter=contextLineUpdate.enter().append('g').style('opacity',0).attr('class',classChartLine);contextLineEnter.append("g").attr("class",classLines);contextLineEnter.append("g").attr("class",classAreas);context.selectAll('.'+CLASS.brush+' rect').attr(config.axis_rotated?"width":"height",config.axis_rotated?$$.width2:$$.height2);}};c3_chart_internal_fn.updateBarForSubchart=function(durationForExit){var $$=this;$$.contextBar=$$.context.selectAll('.'+CLASS.bars).selectAll('.'+CLASS.bar).data($$.barData.bind($$));$$.contextBar.enter().append('path').attr("class",$$.classBar.bind($$)).style("stroke",'none').style("fill",$$.color);$$.contextBar.style("opacity",$$.initialOpacity.bind($$));$$.contextBar.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawBarForSubchart=function(drawBarOnSub,withTransition,duration){(withTransition?this.contextBar.transition().duration(duration):this.contextBar).attr('d',drawBarOnSub).style('opacity',1);};c3_chart_internal_fn.updateLineForSubchart=function(durationForExit){var $$=this;$$.contextLine=$$.context.selectAll('.'+CLASS.lines).selectAll('.'+CLASS.line).data($$.lineData.bind($$));$$.contextLine.enter().append('path').attr('class',$$.classLine.bind($$)).style('stroke',$$.color);$$.contextLine.style("opacity",$$.initialOpacity.bind($$));$$.contextLine.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawLineForSubchart=function(drawLineOnSub,withTransition,duration){(withTransition?this.contextLine.transition().duration(duration):this.contextLine).attr("d",drawLineOnSub).style('opacity',1);};c3_chart_internal_fn.updateAreaForSubchart=function(durationForExit){var $$=this,d3=$$.d3;$$.contextArea=$$.context.selectAll('.'+CLASS.areas).selectAll('.'+CLASS.area).data($$.lineData.bind($$));$$.contextArea.enter().append('path').attr("class",$$.classArea.bind($$)).style("fill",$$.color).style("opacity",function(){$$.orgAreaOpacity=+d3.select(this).style('opacity');return 0;});$$.contextArea.style("opacity",0);$$.contextArea.exit().transition().duration(durationForExit).style('opacity',0).remove();};c3_chart_internal_fn.redrawAreaForSubchart=function(drawAreaOnSub,withTransition,duration){(withTransition?this.contextArea.transition().duration(duration):this.contextArea).attr("d",drawAreaOnSub).style("fill",this.color).style("opacity",this.orgAreaOpacity);};c3_chart_internal_fn.redrawSubchart=function(withSubchart,transitions,duration,durationForExit,areaIndices,barIndices,lineIndices){var $$=this,d3=$$.d3,config=$$.config,drawAreaOnSub,drawBarOnSub,drawLineOnSub;$$.context.style('visibility',config.subchart_show?'visible':'hidden');if(config.subchart_show){if(d3.event&&d3.event.type==='zoom'){$$.brush.extent($$.x.orgDomain()).update();}
if(withSubchart){if(!$$.brush.empty()){$$.brush.extent($$.x.orgDomain()).update();}
drawAreaOnSub=$$.generateDrawArea(areaIndices,true);drawBarOnSub=$$.generateDrawBar(barIndices,true);drawLineOnSub=$$.generateDrawLine(lineIndices,true);$$.updateBarForSubchart(duration);$$.updateLineForSubchart(duration);$$.updateAreaForSubchart(duration);$$.redrawBarForSubchart(drawBarOnSub,duration,duration);$$.redrawLineForSubchart(drawLineOnSub,duration,duration);$$.redrawAreaForSubchart(drawAreaOnSub,duration,duration);}}};c3_chart_internal_fn.redrawForBrush=function(){var $$=this,x=$$.x;$$.redraw({withTransition:false,withY:$$.config.zoom_rescale,withSubchart:false,withUpdateXDomain:true,withDimension:false});$$.config.subchart_onbrush.call($$.api,x.orgDomain());};c3_chart_internal_fn.transformContext=function(withTransition,transitions){var $$=this,subXAxis;if(transitions&&transitions.axisSubX){subXAxis=transitions.axisSubX;}else{subXAxis=$$.context.select('.'+CLASS.axisX);if(withTransition){subXAxis=subXAxis.transition();}}
$$.context.attr("transform",$$.getTranslate('context'));subXAxis.attr("transform",$$.getTranslate('subx'));};c3_chart_internal_fn.getDefaultExtent=function(){var $$=this,config=$$.config,extent=isFunction(config.axis_x_extent)?config.axis_x_extent($$.getXDomain($$.data.targets)):config.axis_x_extent;if($$.isTimeSeries()){extent=[$$.parseDate(extent[0]),$$.parseDate(extent[1])];}
return extent;};c3_chart_internal_fn.initZoom=function(){var $$=this,d3=$$.d3,config=$$.config,startEvent;$$.zoom=d3.behavior.zoom().on("zoomstart",function(){startEvent=d3.event.sourceEvent;$$.zoom.altDomain=d3.event.sourceEvent.altKey?$$.x.orgDomain():null;config.zoom_onzoomstart.call($$.api,d3.event.sourceEvent);}).on("zoom",function(){$$.redrawForZoom.call($$);}).on('zoomend',function(){var event=d3.event.sourceEvent;if(event&&startEvent.clientX===event.clientX&&startEvent.clientY===event.clientY){return;}
$$.redrawEventRect();$$.updateZoom();config.zoom_onzoomend.call($$.api,$$.x.orgDomain());});$$.zoom.scale=function(scale){return config.axis_rotated?this.y(scale):this.x(scale);};$$.zoom.orgScaleExtent=function(){var extent=config.zoom_extent?config.zoom_extent:[1,10];return[extent[0],Math.max($$.getMaxDataCount()/extent[1],extent[1])];};$$.zoom.updateScaleExtent=function(){var ratio=diffDomain($$.x.orgDomain())/diffDomain($$.orgXDomain),extent=this.orgScaleExtent();this.scaleExtent([extent[0]*ratio,extent[1]*ratio]);return this;};};c3_chart_internal_fn.updateZoom=function(){var $$=this,z=$$.config.zoom_enabled?$$.zoom:function(){};$$.main.select('.'+CLASS.zoomRect).call(z).on("dblclick.zoom",null);$$.main.selectAll('.'+CLASS.eventRect).call(z).on("dblclick.zoom",null);};c3_chart_internal_fn.redrawForZoom=function(){var $$=this,d3=$$.d3,config=$$.config,zoom=$$.zoom,x=$$.x;if(!config.zoom_enabled){return;}
if($$.filterTargetsToShow($$.data.targets).length===0){return;}
if(d3.event.sourceEvent.type==='mousemove'&&zoom.altDomain){x.domain(zoom.altDomain);zoom.scale(x).updateScaleExtent();return;}
if($$.isCategorized()&&x.orgDomain()[0]===$$.orgXDomain[0]){x.domain([$$.orgXDomain[0]-1e-10,x.orgDomain()[1]]);}
$$.redraw({withTransition:false,withY:config.zoom_rescale,withSubchart:false,withEventRect:false,withDimension:false});if(d3.event.sourceEvent.type==='mousemove'){$$.cancelClick=true;}
config.zoom_onzoom.call($$.api,x.orgDomain());};c3_chart_internal_fn.generateColor=function(){var $$=this,config=$$.config,d3=$$.d3,colors=config.data_colors,pattern=notEmpty(config.color_pattern)?config.color_pattern:d3.scale.category10().range(),callback=config.data_color,ids=[];return function(d){var id=d.id||(d.data&&d.data.id)||d,color;if(colors[id]instanceof Function){color=colors[id](d);}
else if(colors[id]){color=colors[id];}
else{if(ids.indexOf(id)<0){ids.push(id);}
color=pattern[ids.indexOf(id)%pattern.length];colors[id]=color;}
return callback instanceof Function?callback(color,d):color;};};c3_chart_internal_fn.generateLevelColor=function(){var $$=this,config=$$.config,colors=config.color_pattern,threshold=config.color_threshold,asValue=threshold.unit==='value',values=threshold.values&&threshold.values.length?threshold.values:[],max=threshold.max||100;return notEmpty(config.color_threshold)?function(value){var i,v,color=colors[colors.length-1];for(i=0;i<values.length;i++){v=asValue?value:(value*100/max);if(v<values[i]){color=colors[i];break;}}
return color;}:null;};c3_chart_internal_fn.getYFormat=function(forArc){var $$=this,formatForY=forArc&&!$$.hasType('gauge')?$$.defaultArcValueFormat:$$.yFormat,formatForY2=forArc&&!$$.hasType('gauge')?$$.defaultArcValueFormat:$$.y2Format;return function(v,ratio,id){var format=$$.axis.getId(id)==='y2'?formatForY2:formatForY;return format.call($$,v,ratio);};};c3_chart_internal_fn.yFormat=function(v){var $$=this,config=$$.config,format=config.axis_y_tick_format?config.axis_y_tick_format:$$.defaultValueFormat;return format(v);};c3_chart_internal_fn.y2Format=function(v){var $$=this,config=$$.config,format=config.axis_y2_tick_format?config.axis_y2_tick_format:$$.defaultValueFormat;return format(v);};c3_chart_internal_fn.defaultValueFormat=function(v){return isValue(v)?+v:"";};c3_chart_internal_fn.defaultArcValueFormat=function(v,ratio){return(ratio*100).toFixed(1)+'%';};c3_chart_internal_fn.dataLabelFormat=function(targetId){var $$=this,data_labels=$$.config.data_labels,format,defaultFormat=function(v){return isValue(v)?+v:"";};if(typeof data_labels.format==='function'){format=data_labels.format;}else if(typeof data_labels.format==='object'){if(data_labels.format[targetId]){format=data_labels.format[targetId]===true?defaultFormat:data_labels.format[targetId];}else{format=function(){return'';};}}else{format=defaultFormat;}
return format;};c3_chart_internal_fn.hasCaches=function(ids){for(var i=0;i<ids.length;i++){if(!(ids[i]in this.cache)){return false;}}
return true;};c3_chart_internal_fn.addCache=function(id,target){this.cache[id]=this.cloneTarget(target);};c3_chart_internal_fn.getCaches=function(ids){var targets=[],i;for(i=0;i<ids.length;i++){if(ids[i]in this.cache){targets.push(this.cloneTarget(this.cache[ids[i]]));}}
return targets;};var CLASS=c3_chart_internal_fn.CLASS={target:'c3-target',chart:'c3-chart',chartLine:'c3-chart-line',chartLines:'c3-chart-lines',chartBar:'c3-chart-bar',chartBars:'c3-chart-bars',chartText:'c3-chart-text',chartTexts:'c3-chart-texts',chartArc:'c3-chart-arc',chartArcs:'c3-chart-arcs',chartArcsTitle:'c3-chart-arcs-title',chartArcsBackground:'c3-chart-arcs-background',chartArcsGaugeUnit:'c3-chart-arcs-gauge-unit',chartArcsGaugeMax:'c3-chart-arcs-gauge-max',chartArcsGaugeMin:'c3-chart-arcs-gauge-min',selectedCircle:'c3-selected-circle',selectedCircles:'c3-selected-circles',eventRect:'c3-event-rect',eventRects:'c3-event-rects',eventRectsSingle:'c3-event-rects-single',eventRectsMultiple:'c3-event-rects-multiple',zoomRect:'c3-zoom-rect',brush:'c3-brush',focused:'c3-focused',defocused:'c3-defocused',region:'c3-region',regions:'c3-regions',tooltipContainer:'c3-tooltip-container',tooltip:'c3-tooltip',tooltipName:'c3-tooltip-name',shape:'c3-shape',shapes:'c3-shapes',line:'c3-line',lines:'c3-lines',bar:'c3-bar',bars:'c3-bars',circle:'c3-circle',circles:'c3-circles',arc:'c3-arc',arcs:'c3-arcs',area:'c3-area',areas:'c3-areas',empty:'c3-empty',text:'c3-text',texts:'c3-texts',gaugeValue:'c3-gauge-value',grid:'c3-grid',gridLines:'c3-grid-lines',xgrid:'c3-xgrid',xgrids:'c3-xgrids',xgridLine:'c3-xgrid-line',xgridLines:'c3-xgrid-lines',xgridFocus:'c3-xgrid-focus',ygrid:'c3-ygrid',ygrids:'c3-ygrids',ygridLine:'c3-ygrid-line',ygridLines:'c3-ygrid-lines',axis:'c3-axis',axisX:'c3-axis-x',axisXLabel:'c3-axis-x-label',axisY:'c3-axis-y',axisYLabel:'c3-axis-y-label',axisY2:'c3-axis-y2',axisY2Label:'c3-axis-y2-label',legendBackground:'c3-legend-background',legendItem:'c3-legend-item',legendItemEvent:'c3-legend-item-event',legendItemTile:'c3-legend-item-tile',legendItemHidden:'c3-legend-item-hidden',legendItemFocused:'c3-legend-item-focused',dragarea:'c3-dragarea',EXPANDED:'_expanded_',SELECTED:'_selected_',INCLUDED:'_included_'};c3_chart_internal_fn.generateClass=function(prefix,targetId){return" "+prefix+" "+prefix+this.getTargetSelectorSuffix(targetId);};c3_chart_internal_fn.classText=function(d){return this.generateClass(CLASS.text,d.index);};c3_chart_internal_fn.classTexts=function(d){return this.generateClass(CLASS.texts,d.id);};c3_chart_internal_fn.classShape=function(d){return this.generateClass(CLASS.shape,d.index);};c3_chart_internal_fn.classShapes=function(d){return this.generateClass(CLASS.shapes,d.id);};c3_chart_internal_fn.classLine=function(d){return this.classShape(d)+this.generateClass(CLASS.line,d.id);};c3_chart_internal_fn.classLines=function(d){return this.classShapes(d)+this.generateClass(CLASS.lines,d.id);};c3_chart_internal_fn.classCircle=function(d){return this.classShape(d)+this.generateClass(CLASS.circle,d.index);};c3_chart_internal_fn.classCircles=function(d){return this.classShapes(d)+this.generateClass(CLASS.circles,d.id);};c3_chart_internal_fn.classBar=function(d){return this.classShape(d)+this.generateClass(CLASS.bar,d.index);};c3_chart_internal_fn.classBars=function(d){return this.classShapes(d)+this.generateClass(CLASS.bars,d.id);};c3_chart_internal_fn.classArc=function(d){return this.classShape(d.data)+this.generateClass(CLASS.arc,d.data.id);};c3_chart_internal_fn.classArcs=function(d){return this.classShapes(d.data)+this.generateClass(CLASS.arcs,d.data.id);};c3_chart_internal_fn.classArea=function(d){return this.classShape(d)+this.generateClass(CLASS.area,d.id);};c3_chart_internal_fn.classAreas=function(d){return this.classShapes(d)+this.generateClass(CLASS.areas,d.id);};c3_chart_internal_fn.classRegion=function(d,i){return this.generateClass(CLASS.region,i)+' '+('class'in d?d['class']:'');};c3_chart_internal_fn.classEvent=function(d){return this.generateClass(CLASS.eventRect,d.index);};c3_chart_internal_fn.classTarget=function(id){var $$=this;var additionalClassSuffix=$$.config.data_classes[id],additionalClass='';if(additionalClassSuffix){additionalClass=' '+CLASS.target+'-'+additionalClassSuffix;}
return $$.generateClass(CLASS.target,id)+additionalClass;};c3_chart_internal_fn.classFocus=function(d){return this.classFocused(d)+this.classDefocused(d);};c3_chart_internal_fn.classFocused=function(d){return' '+(this.focusedTargetIds.indexOf(d.id)>=0?CLASS.focused:'');};c3_chart_internal_fn.classDefocused=function(d){return' '+(this.defocusedTargetIds.indexOf(d.id)>=0?CLASS.defocused:'');};c3_chart_internal_fn.classChartText=function(d){return CLASS.chartText+this.classTarget(d.id);};c3_chart_internal_fn.classChartLine=function(d){return CLASS.chartLine+this.classTarget(d.id);};c3_chart_internal_fn.classChartBar=function(d){return CLASS.chartBar+this.classTarget(d.id);};c3_chart_internal_fn.classChartArc=function(d){return CLASS.chartArc+this.classTarget(d.data.id);};c3_chart_internal_fn.getTargetSelectorSuffix=function(targetId){return targetId||targetId===0?('-'+targetId).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,'-'):'';};c3_chart_internal_fn.selectorTarget=function(id,prefix){return(prefix||'')+'.'+CLASS.target+this.getTargetSelectorSuffix(id);};c3_chart_internal_fn.selectorTargets=function(ids,prefix){var $$=this;ids=ids||[];return ids.length?ids.map(function(id){return $$.selectorTarget(id,prefix);}):null;};c3_chart_internal_fn.selectorLegend=function(id){return'.'+CLASS.legendItem+this.getTargetSelectorSuffix(id);};c3_chart_internal_fn.selectorLegends=function(ids){var $$=this;return ids&&ids.length?ids.map(function(id){return $$.selectorLegend(id);}):null;};var isValue=c3_chart_internal_fn.isValue=function(v){return v||v===0;},isFunction=c3_chart_internal_fn.isFunction=function(o){return typeof o==='function';},isString=c3_chart_internal_fn.isString=function(o){return typeof o==='string';},isUndefined=c3_chart_internal_fn.isUndefined=function(v){return typeof v==='undefined';},isDefined=c3_chart_internal_fn.isDefined=function(v){return typeof v!=='undefined';},ceil10=c3_chart_internal_fn.ceil10=function(v){return Math.ceil(v/10)*10;},asHalfPixel=c3_chart_internal_fn.asHalfPixel=function(n){return Math.ceil(n)+0.5;},diffDomain=c3_chart_internal_fn.diffDomain=function(d){return d[1]-d[0];},isEmpty=c3_chart_internal_fn.isEmpty=function(o){return!o||(isString(o)&&o.length===0)||(typeof o==='object'&&Object.keys(o).length===0);},notEmpty=c3_chart_internal_fn.notEmpty=function(o){return Object.keys(o).length>0;},getOption=c3_chart_internal_fn.getOption=function(options,key,defaultValue){return isDefined(options[key])?options[key]:defaultValue;},hasValue=c3_chart_internal_fn.hasValue=function(dict,value){var found=false;Object.keys(dict).forEach(function(key){if(dict[key]===value){found=true;}});return found;},getPathBox=c3_chart_internal_fn.getPathBox=function(path){var box=path.getBoundingClientRect(),items=[path.pathSegList.getItem(0),path.pathSegList.getItem(1)],minX=items[0].x,minY=Math.min(items[0].y,items[1].y);return{x:minX,y:minY,width:box.width,height:box.height};};c3_chart_fn.focus=function(targetIds){var $$=this.internal,candidates;targetIds=$$.mapToTargetIds(targetIds);candidates=$$.svg.selectAll($$.selectorTargets(targetIds.filter($$.isTargetToShow,$$))),this.revert();this.defocus();candidates.classed(CLASS.focused,true).classed(CLASS.defocused,false);if($$.hasArcType()){$$.expandArc(targetIds);}
$$.toggleFocusLegend(targetIds,true);$$.focusedTargetIds=targetIds;$$.defocusedTargetIds=$$.defocusedTargetIds.filter(function(id){return targetIds.indexOf(id)<0;});};c3_chart_fn.defocus=function(targetIds){var $$=this.internal,candidates;targetIds=$$.mapToTargetIds(targetIds);candidates=$$.svg.selectAll($$.selectorTargets(targetIds.filter($$.isTargetToShow,$$))),candidates.classed(CLASS.focused,false).classed(CLASS.defocused,true);if($$.hasArcType()){$$.unexpandArc(targetIds);}
$$.toggleFocusLegend(targetIds,false);$$.focusedTargetIds=$$.focusedTargetIds.filter(function(id){return targetIds.indexOf(id)<0;});$$.defocusedTargetIds=targetIds;};c3_chart_fn.revert=function(targetIds){var $$=this.internal,candidates;targetIds=$$.mapToTargetIds(targetIds);candidates=$$.svg.selectAll($$.selectorTargets(targetIds));candidates.classed(CLASS.focused,false).classed(CLASS.defocused,false);if($$.hasArcType()){$$.unexpandArc(targetIds);}
if($$.config.legend_show){$$.showLegend(targetIds.filter($$.isLegendToShow.bind($$)));$$.legend.selectAll($$.selectorLegends(targetIds)).filter(function(){return $$.d3.select(this).classed(CLASS.legendItemFocused);}).classed(CLASS.legendItemFocused,false);}
$$.focusedTargetIds=[];$$.defocusedTargetIds=[];};c3_chart_fn.show=function(targetIds,options){var $$=this.internal,targets;targetIds=$$.mapToTargetIds(targetIds);options=options||{};$$.removeHiddenTargetIds(targetIds);targets=$$.svg.selectAll($$.selectorTargets(targetIds));targets.transition().style('opacity',1,'important').call($$.endall,function(){targets.style('opacity',null).style('opacity',1);});if(options.withLegend){$$.showLegend(targetIds);}
$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});};c3_chart_fn.hide=function(targetIds,options){var $$=this.internal,targets;targetIds=$$.mapToTargetIds(targetIds);options=options||{};$$.addHiddenTargetIds(targetIds);targets=$$.svg.selectAll($$.selectorTargets(targetIds));targets.transition().style('opacity',0,'important').call($$.endall,function(){targets.style('opacity',null).style('opacity',0);});if(options.withLegend){$$.hideLegend(targetIds);}
$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});};c3_chart_fn.toggle=function(targetIds,options){var that=this,$$=this.internal;$$.mapToTargetIds(targetIds).forEach(function(targetId){$$.isTargetToShow(targetId)?that.hide(targetId,options):that.show(targetId,options);});};c3_chart_fn.zoom=function(domain){var $$=this.internal;if(domain){if($$.isTimeSeries()){domain=domain.map(function(x){return $$.parseDate(x);});}
$$.brush.extent(domain);$$.redraw({withUpdateXDomain:true,withY:$$.config.zoom_rescale});$$.config.zoom_onzoom.call(this,$$.x.orgDomain());}
return $$.brush.extent();};c3_chart_fn.zoom.enable=function(enabled){var $$=this.internal;$$.config.zoom_enabled=enabled;$$.updateAndRedraw();};c3_chart_fn.unzoom=function(){var $$=this.internal;$$.brush.clear().update();$$.redraw({withUpdateXDomain:true});};c3_chart_fn.load=function(args){var $$=this.internal,config=$$.config;if(args.xs){$$.addXs(args.xs);}
if('classes'in args){Object.keys(args.classes).forEach(function(id){config.data_classes[id]=args.classes[id];});}
if('categories'in args&&$$.isCategorized()){config.axis_x_categories=args.categories;}
if('axes'in args){Object.keys(args.axes).forEach(function(id){config.data_axes[id]=args.axes[id];});}
if('colors'in args){Object.keys(args.colors).forEach(function(id){config.data_colors[id]=args.colors[id];});}
if('cacheIds'in args&&$$.hasCaches(args.cacheIds)){$$.load($$.getCaches(args.cacheIds),args.done);return;}
if('unload'in args){$$.unload($$.mapToTargetIds((typeof args.unload==='boolean'&&args.unload)?null:args.unload),function(){$$.loadFromArgs(args);});}else{$$.loadFromArgs(args);}};c3_chart_fn.unload=function(args){var $$=this.internal;args=args||{};if(args instanceof Array){args={ids:args};}else if(typeof args==='string'){args={ids:[args]};}
$$.unload($$.mapToTargetIds(args.ids),function(){$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true,withLegend:true});if(args.done){args.done();}});};c3_chart_fn.flow=function(args){var $$=this.internal,targets,data,notfoundIds=[],orgDataCount=$$.getMaxDataCount(),dataCount,domain,baseTarget,baseValue,length=0,tail=0,diff,to;if(args.json){data=$$.convertJsonToData(args.json,args.keys);}
else if(args.rows){data=$$.convertRowsToData(args.rows);}
else if(args.columns){data=$$.convertColumnsToData(args.columns);}
else{return;}
targets=$$.convertDataToTargets(data,true);$$.data.targets.forEach(function(t){var found=false,i,j;for(i=0;i<targets.length;i++){if(t.id===targets[i].id){found=true;if(t.values[t.values.length-1]){tail=t.values[t.values.length-1].index+1;}
length=targets[i].values.length;for(j=0;j<length;j++){targets[i].values[j].index=tail+j;if(!$$.isTimeSeries()){targets[i].values[j].x=tail+j;}}
t.values=t.values.concat(targets[i].values);targets.splice(i,1);break;}}
if(!found){notfoundIds.push(t.id);}});$$.data.targets.forEach(function(t){var i,j;for(i=0;i<notfoundIds.length;i++){if(t.id===notfoundIds[i]){tail=t.values[t.values.length-1].index+1;for(j=0;j<length;j++){t.values.push({id:t.id,index:tail+j,x:$$.isTimeSeries()?$$.getOtherTargetX(tail+j):tail+j,value:null});}}}});if($$.data.targets.length){targets.forEach(function(t){var i,missing=[];for(i=$$.data.targets[0].values[0].index;i<tail;i++){missing.push({id:t.id,index:i,x:$$.isTimeSeries()?$$.getOtherTargetX(i):i,value:null});}
t.values.forEach(function(v){v.index+=tail;if(!$$.isTimeSeries()){v.x+=tail;}});t.values=missing.concat(t.values);});}
$$.data.targets=$$.data.targets.concat(targets);dataCount=$$.getMaxDataCount();baseTarget=$$.data.targets[0];baseValue=baseTarget.values[0];if(isDefined(args.to)){length=0;to=$$.isTimeSeries()?$$.parseDate(args.to):args.to;baseTarget.values.forEach(function(v){if(v.x<to){length++;}});}else if(isDefined(args.length)){length=args.length;}
if(!orgDataCount){if($$.isTimeSeries()){if(baseTarget.values.length>1){diff=baseTarget.values[baseTarget.values.length-1].x-baseValue.x;}else{diff=baseValue.x-$$.getXDomain($$.data.targets)[0];}}else{diff=1;}
domain=[baseValue.x-diff,baseValue.x];$$.updateXDomain(null,true,true,false,domain);}else if(orgDataCount===1){if($$.isTimeSeries()){diff=(baseTarget.values[baseTarget.values.length-1].x-baseValue.x)/2;domain=[new Date(+baseValue.x-diff),new Date(+baseValue.x+diff)];$$.updateXDomain(null,true,true,false,domain);}}
$$.updateTargets($$.data.targets);$$.redraw({flow:{index:baseValue.index,length:length,duration:isValue(args.duration)?args.duration:$$.config.transition_duration,done:args.done,orgDataCount:orgDataCount,},withLegend:true,withTransition:orgDataCount>1,withTrimXDomain:false,withUpdateXAxis:true,});};c3_chart_internal_fn.generateFlow=function(args){var $$=this,config=$$.config,d3=$$.d3;return function(){var targets=args.targets,flow=args.flow,drawBar=args.drawBar,drawLine=args.drawLine,drawArea=args.drawArea,cx=args.cx,cy=args.cy,xv=args.xv,xForText=args.xForText,yForText=args.yForText,duration=args.duration;var translateX,scaleX=1,transform,flowIndex=flow.index,flowLength=flow.length,flowStart=$$.getValueOnIndex($$.data.targets[0].values,flowIndex),flowEnd=$$.getValueOnIndex($$.data.targets[0].values,flowIndex+flowLength),orgDomain=$$.x.domain(),domain,durationForFlow=flow.duration||duration,done=flow.done||function(){},wait=$$.generateWait();var xgrid=$$.xgrid||d3.selectAll([]),xgridLines=$$.xgridLines||d3.selectAll([]),mainRegion=$$.mainRegion||d3.selectAll([]),mainText=$$.mainText||d3.selectAll([]),mainBar=$$.mainBar||d3.selectAll([]),mainLine=$$.mainLine||d3.selectAll([]),mainArea=$$.mainArea||d3.selectAll([]),mainCircle=$$.mainCircle||d3.selectAll([]);$$.flowing=true;$$.data.targets.forEach(function(d){d.values.splice(0,flowLength);});domain=$$.updateXDomain(targets,true,true);if($$.updateXGrid){$$.updateXGrid(true);}
if(!flow.orgDataCount){if($$.data.targets[0].values.length!==1){translateX=$$.x(orgDomain[0])-$$.x(domain[0]);}else{if($$.isTimeSeries()){flowStart=$$.getValueOnIndex($$.data.targets[0].values,0);flowEnd=$$.getValueOnIndex($$.data.targets[0].values,$$.data.targets[0].values.length-1);translateX=$$.x(flowStart.x)-$$.x(flowEnd.x);}else{translateX=diffDomain(domain)/2;}}}else if(flow.orgDataCount===1||flowStart.x===flowEnd.x){translateX=$$.x(orgDomain[0])-$$.x(domain[0]);}else{if($$.isTimeSeries()){translateX=($$.x(orgDomain[0])-$$.x(domain[0]));}else{translateX=($$.x(flowStart.x)-$$.x(flowEnd.x));}}
scaleX=(diffDomain(orgDomain)/diffDomain(domain));transform='translate('+translateX+',0) scale('+scaleX+',1)';$$.hideXGridFocus();$$.hideTooltip();d3.transition().ease('linear').duration(durationForFlow).each(function(){wait.add($$.axes.x.transition().call($$.xAxis));wait.add(mainBar.transition().attr('transform',transform));wait.add(mainLine.transition().attr('transform',transform));wait.add(mainArea.transition().attr('transform',transform));wait.add(mainCircle.transition().attr('transform',transform));wait.add(mainText.transition().attr('transform',transform));wait.add(mainRegion.filter($$.isRegionOnX).transition().attr('transform',transform));wait.add(xgrid.transition().attr('transform',transform));wait.add(xgridLines.transition().attr('transform',transform));}).call(wait,function(){var i,shapes=[],texts=[],eventRects=[];if(flowLength){for(i=0;i<flowLength;i++){shapes.push('.'+CLASS.shape+'-'+(flowIndex+i));texts.push('.'+CLASS.text+'-'+(flowIndex+i));eventRects.push('.'+CLASS.eventRect+'-'+(flowIndex+i));}
$$.svg.selectAll('.'+CLASS.shapes).selectAll(shapes).remove();$$.svg.selectAll('.'+CLASS.texts).selectAll(texts).remove();$$.svg.selectAll('.'+CLASS.eventRects).selectAll(eventRects).remove();$$.svg.select('.'+CLASS.xgrid).remove();}
xgrid.attr('transform',null).attr($$.xgridAttr);xgridLines.attr('transform',null);xgridLines.select('line').attr("x1",config.axis_rotated?0:xv).attr("x2",config.axis_rotated?$$.width:xv);xgridLines.select('text').attr("x",config.axis_rotated?$$.width:0).attr("y",xv);mainBar.attr('transform',null).attr("d",drawBar);mainLine.attr('transform',null).attr("d",drawLine);mainArea.attr('transform',null).attr("d",drawArea);mainCircle.attr('transform',null).attr("cx",cx).attr("cy",cy);mainText.attr('transform',null).attr('x',xForText).attr('y',yForText).style('fill-opacity',$$.opacityForText.bind($$));mainRegion.attr('transform',null);mainRegion.select('rect').filter($$.isRegionOnX).attr("x",$$.regionX.bind($$)).attr("width",$$.regionWidth.bind($$));if(config.interaction_enabled){$$.redrawEventRect();}
done();$$.flowing=false;});};};c3_chart_fn.selected=function(targetId){var $$=this.internal,d3=$$.d3;return d3.merge($$.main.selectAll('.'+CLASS.shapes+$$.getTargetSelectorSuffix(targetId)).selectAll('.'+CLASS.shape).filter(function(){return d3.select(this).classed(CLASS.SELECTED);}).map(function(d){return d.map(function(d){var data=d.__data__;return data.data?data.data:data;});}));};c3_chart_fn.select=function(ids,indices,resetOther){var $$=this.internal,d3=$$.d3,config=$$.config;if(!config.data_selection_enabled){return;}
$$.main.selectAll('.'+CLASS.shapes).selectAll('.'+CLASS.shape).each(function(d,i){var shape=d3.select(this),id=d.data?d.data.id:d.id,toggle=$$.getToggle(this,d).bind($$),isTargetId=config.data_selection_grouped||!ids||ids.indexOf(id)>=0,isTargetIndex=!indices||indices.indexOf(i)>=0,isSelected=shape.classed(CLASS.SELECTED);if(shape.classed(CLASS.line)||shape.classed(CLASS.area)){return;}
if(isTargetId&&isTargetIndex){if(config.data_selection_isselectable(d)&&!isSelected){toggle(true,shape.classed(CLASS.SELECTED,true),d,i);}}else if(isDefined(resetOther)&&resetOther){if(isSelected){toggle(false,shape.classed(CLASS.SELECTED,false),d,i);}}});};c3_chart_fn.unselect=function(ids,indices){var $$=this.internal,d3=$$.d3,config=$$.config;if(!config.data_selection_enabled){return;}
$$.main.selectAll('.'+CLASS.shapes).selectAll('.'+CLASS.shape).each(function(d,i){var shape=d3.select(this),id=d.data?d.data.id:d.id,toggle=$$.getToggle(this,d).bind($$),isTargetId=config.data_selection_grouped||!ids||ids.indexOf(id)>=0,isTargetIndex=!indices||indices.indexOf(i)>=0,isSelected=shape.classed(CLASS.SELECTED);if(shape.classed(CLASS.line)||shape.classed(CLASS.area)){return;}
if(isTargetId&&isTargetIndex){if(config.data_selection_isselectable(d)){if(isSelected){toggle(false,shape.classed(CLASS.SELECTED,false),d,i);}}}});};c3_chart_fn.transform=function(type,targetIds){var $$=this.internal,options=['pie','donut'].indexOf(type)>=0?{withTransform:true}:null;$$.transformTo(targetIds,type,options);};c3_chart_internal_fn.transformTo=function(targetIds,type,optionsForRedraw){var $$=this,withTransitionForAxis=!$$.hasArcType(),options=optionsForRedraw||{withTransitionForAxis:withTransitionForAxis};options.withTransitionForTransform=false;$$.transiting=false;$$.setTargetType(targetIds,type);$$.updateTargets($$.data.targets);$$.updateAndRedraw(options);};c3_chart_fn.groups=function(groups){var $$=this.internal,config=$$.config;if(isUndefined(groups)){return config.data_groups;}
config.data_groups=groups;$$.redraw();return config.data_groups;};c3_chart_fn.xgrids=function(grids){var $$=this.internal,config=$$.config;if(!grids){return config.grid_x_lines;}
config.grid_x_lines=grids;$$.redrawWithoutRescale();return config.grid_x_lines;};c3_chart_fn.xgrids.add=function(grids){var $$=this.internal;return this.xgrids($$.config.grid_x_lines.concat(grids?grids:[]));};c3_chart_fn.xgrids.remove=function(params){var $$=this.internal;$$.removeGridLines(params,true);};c3_chart_fn.ygrids=function(grids){var $$=this.internal,config=$$.config;if(!grids){return config.grid_y_lines;}
config.grid_y_lines=grids;$$.redrawWithoutRescale();return config.grid_y_lines;};c3_chart_fn.ygrids.add=function(grids){var $$=this.internal;return this.ygrids($$.config.grid_y_lines.concat(grids?grids:[]));};c3_chart_fn.ygrids.remove=function(params){var $$=this.internal;$$.removeGridLines(params,false);};c3_chart_fn.regions=function(regions){var $$=this.internal,config=$$.config;if(!regions){return config.regions;}
config.regions=regions;$$.redrawWithoutRescale();return config.regions;};c3_chart_fn.regions.add=function(regions){var $$=this.internal,config=$$.config;if(!regions){return config.regions;}
config.regions=config.regions.concat(regions);$$.redrawWithoutRescale();return config.regions;};c3_chart_fn.regions.remove=function(options){var $$=this.internal,config=$$.config,duration,classes,regions;options=options||{};duration=$$.getOption(options,"duration",config.transition_duration);classes=$$.getOption(options,"classes",[CLASS.region]);regions=$$.main.select('.'+CLASS.regions).selectAll(classes.map(function(c){return'.'+c;}));(duration?regions.transition().duration(duration):regions).style('opacity',0).remove();config.regions=config.regions.filter(function(region){var found=false;if(!region['class']){return true;}
region['class'].split(' ').forEach(function(c){if(classes.indexOf(c)>=0){found=true;}});return!found;});return config.regions;};c3_chart_fn.data=function(targetIds){var targets=this.internal.data.targets;return typeof targetIds==='undefined'?targets:targets.filter(function(t){return[].concat(targetIds).indexOf(t.id)>=0;});};c3_chart_fn.data.shown=function(targetIds){return this.internal.filterTargetsToShow(this.data(targetIds));};c3_chart_fn.data.values=function(targetId){var targets,values=null;if(targetId){targets=this.data(targetId);values=targets[0]?targets[0].values.map(function(d){return d.value;}):null;}
return values;};c3_chart_fn.data.names=function(names){this.internal.clearLegendItemTextBoxCache();return this.internal.updateDataAttributes('names',names);};c3_chart_fn.data.colors=function(colors){return this.internal.updateDataAttributes('colors',colors);};c3_chart_fn.data.axes=function(axes){return this.internal.updateDataAttributes('axes',axes);};c3_chart_fn.category=function(i,category){var $$=this.internal,config=$$.config;if(arguments.length>1){config.axis_x_categories[i]=category;$$.redraw();}
return config.axis_x_categories[i];};c3_chart_fn.categories=function(categories){var $$=this.internal,config=$$.config;if(!arguments.length){return config.axis_x_categories;}
config.axis_x_categories=categories;$$.redraw();return config.axis_x_categories;};c3_chart_fn.color=function(id){var $$=this.internal;return $$.color(id);};c3_chart_fn.x=function(x){var $$=this.internal;if(arguments.length){$$.updateTargetX($$.data.targets,x);$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true});}
return $$.data.xs;};c3_chart_fn.xs=function(xs){var $$=this.internal;if(arguments.length){$$.updateTargetXs($$.data.targets,xs);$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true});}
return $$.data.xs;};c3_chart_fn.axis=function(){};c3_chart_fn.axis.labels=function(labels){var $$=this.internal;if(arguments.length){Object.keys(labels).forEach(function(axisId){$$.axis.setLabelText(axisId,labels[axisId]);});$$.axis.updateLabels();}};c3_chart_fn.axis.max=function(max){var $$=this.internal,config=$$.config;if(arguments.length){if(typeof max==='object'){if(isValue(max.x)){config.axis_x_max=max.x;}
if(isValue(max.y)){config.axis_y_max=max.y;}
if(isValue(max.y2)){config.axis_y2_max=max.y2;}}else{config.axis_y_max=config.axis_y2_max=max;}
$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true});}else{return{x:config.axis_x_max,y:config.axis_y_max,y2:config.axis_y2_max};}};c3_chart_fn.axis.min=function(min){var $$=this.internal,config=$$.config;if(arguments.length){if(typeof min==='object'){if(isValue(min.x)){config.axis_x_min=min.x;}
if(isValue(min.y)){config.axis_y_min=min.y;}
if(isValue(min.y2)){config.axis_y2_min=min.y2;}}else{config.axis_y_min=config.axis_y2_min=min;}
$$.redraw({withUpdateOrgXDomain:true,withUpdateXDomain:true});}else{return{x:config.axis_x_min,y:config.axis_y_min,y2:config.axis_y2_min};}};c3_chart_fn.axis.range=function(range){if(arguments.length){if(isDefined(range.max)){this.axis.max(range.max);}
if(isDefined(range.min)){this.axis.min(range.min);}}else{return{max:this.axis.max(),min:this.axis.min()};}};c3_chart_fn.legend=function(){};c3_chart_fn.legend.show=function(targetIds){var $$=this.internal;$$.showLegend($$.mapToTargetIds(targetIds));$$.updateAndRedraw({withLegend:true});};c3_chart_fn.legend.hide=function(targetIds){var $$=this.internal;$$.hideLegend($$.mapToTargetIds(targetIds));$$.updateAndRedraw({withLegend:true});};c3_chart_fn.resize=function(size){var $$=this.internal,config=$$.config;config.size_width=size?size.width:null;config.size_height=size?size.height:null;this.flush();};c3_chart_fn.flush=function(){var $$=this.internal;$$.updateAndRedraw({withLegend:true,withTransition:false,withTransitionForTransform:false});};c3_chart_fn.destroy=function(){var $$=this.internal;window.clearInterval($$.intervalForObserveInserted);window.onresize=null;$$.selectChart.classed('c3',false).html("");Object.keys($$).forEach(function(key){$$[key]=null;});return null;};c3_chart_fn.tooltip=function(){};c3_chart_fn.tooltip.show=function(args){var $$=this.internal,index,mouse;if(args.mouse){mouse=args.mouse;}
if(args.data){if($$.isMultipleX()){mouse=[$$.x(args.data.x),$$.getYScale(args.data.id)(args.data.value)];index=null;}else{index=isValue(args.data.index)?args.data.index:$$.getIndexByX(args.data.x);}}
else if(typeof args.x!=='undefined'){index=$$.getIndexByX(args.x);}
else if(typeof args.index!=='undefined'){index=args.index;}
$$.dispatchEvent('mouseover',index,mouse);$$.dispatchEvent('mousemove',index,mouse);};c3_chart_fn.tooltip.hide=function(){this.internal.dispatchEvent('mouseout',0);};var tickTextCharSize;function c3_axis(d3,params){var scale=d3.scale.linear(),orient="bottom",innerTickSize=6,outerTickSize,tickPadding=3,tickValues=null,tickFormat,tickArguments;var tickOffset=0,tickCulling=true,tickCentered;params=params||{};outerTickSize=params.withOuterTick?6:0;function axisX(selection,x){selection.attr("transform",function(d){return"translate("+Math.ceil(x(d)+tickOffset)+", 0)";});}
function axisY(selection,y){selection.attr("transform",function(d){return"translate(0,"+Math.ceil(y(d))+")";});}
function scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start];}
function generateTicks(scale){var i,domain,ticks=[];if(scale.ticks){return scale.ticks.apply(scale,tickArguments);}
domain=scale.domain();for(i=Math.ceil(domain[0]);i<domain[1];i++){ticks.push(i);}
if(ticks.length>0&&ticks[0]>0){ticks.unshift(ticks[0]-(ticks[1]-ticks[0]));}
return ticks;}
function copyScale(){var newScale=scale.copy(),domain;if(params.isCategory){domain=scale.domain();newScale.domain([domain[0],domain[1]-1]);}
return newScale;}
function textFormatted(v){var formatted=tickFormat?tickFormat(v):v;return typeof formatted!=='undefined'?formatted:'';}
function getSizeFor1Char(tick){if(tickTextCharSize){return tickTextCharSize;}
var size={h:11.5,w:5.5};tick.select('text').text(textFormatted).each(function(d){var box=this.getBoundingClientRect(),text=textFormatted(d),h=box.height,w=text?(box.width/text.length):undefined;if(h&&w){size.h=h;size.w=w;}}).text('');tickTextCharSize=size;return size;}
function transitionise(selection){return params.withoutTransition?selection:d3.transition(selection);}
function axis(g){g.each(function(){var g=axis.g=d3.select(this);var scale0=this.__chart__||scale,scale1=this.__chart__=copyScale();var ticks=tickValues?tickValues:generateTicks(scale1),tick=g.selectAll(".tick").data(ticks,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),tickExit=tick.exit().remove(),tickUpdate=transitionise(tick).style("opacity",1),tickTransform,tickX,tickY;var range=scale.rangeExtent?scale.rangeExtent():scaleExtent(scale.range()),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),transitionise(path));tickEnter.append("line");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text");if(params.isCategory){tickOffset=Math.ceil((scale1(1)-scale1(0))/2);tickX=tickCentered?0:tickOffset;tickY=tickCentered?tickOffset:0;}else{tickOffset=tickX=0;}
var text,tspan,sizeFor1Char=getSizeFor1Char(g.select('.tick')),counts=[];var tickLength=Math.max(innerTickSize,0)+tickPadding,isVertical=orient==='left'||orient==='right';function splitTickText(d,maxWidth){var tickText=textFormatted(d),subtext,spaceIndex,textWidth,splitted=[];if(Object.prototype.toString.call(tickText)==="[object Array]"){return tickText;}
if(!maxWidth||maxWidth<=0){maxWidth=isVertical?95:params.isCategory?(Math.ceil(scale1(ticks[1])-scale1(ticks[0]))-12):110;}
function split(splitted,text){spaceIndex=undefined;for(var i=1;i<text.length;i++){if(text.charAt(i)===' '){spaceIndex=i;}
subtext=text.substr(0,i+1);textWidth=sizeFor1Char.w*subtext.length;if(maxWidth<textWidth){return split(splitted.concat(text.substr(0,spaceIndex?spaceIndex:i)),text.slice(spaceIndex?spaceIndex+1:i));}}
return splitted.concat(text);}
return split(splitted,tickText+"");}
function tspanDy(d,i){var dy=sizeFor1Char.h;if(i===0){if(orient==='left'||orient==='right'){dy=-((counts[d.index]-1)*(sizeFor1Char.h/2)-3);}else{dy=".71em";}}
return dy;}
function tickSize(d){var tickPosition=scale(d)+(tickCentered?0:tickOffset);return range[0]<tickPosition&&tickPosition<range[1]?innerTickSize:0;}
text=tick.select("text");tspan=text.selectAll('tspan').data(function(d,i){var splitted=params.tickMultiline?splitTickText(d,params.tickWidth):[].concat(textFormatted(d));counts[i]=splitted.length;return splitted.map(function(s){return{index:i,splitted:s};});});tspan.enter().append('tspan');tspan.exit().remove();tspan.text(function(d){return d.splitted;});var rotate=params.tickTextRotate;function textAnchorForText(rotate){if(!rotate){return'middle';}
return rotate>0?"start":"end";}
function textTransform(rotate){if(!rotate){return'';}
return"rotate("+rotate+")";}
function dxForText(rotate){if(!rotate){return 0;}
return 8*Math.sin(Math.PI*(rotate/180));}
function yForText(rotate){if(!rotate){return tickLength;}
return 11.5-2.5*(rotate/15)*(rotate>0?1:-1);}
switch(orient){case"bottom":{tickTransform=axisX;lineEnter.attr("y2",innerTickSize);textEnter.attr("y",tickLength);lineUpdate.attr("x1",tickX).attr("x2",tickX).attr("y2",tickSize);textUpdate.attr("x",0).attr("y",yForText(rotate)).style("text-anchor",textAnchorForText(rotate)).attr("transform",textTransform(rotate));tspan.attr('x',0).attr("dy",tspanDy).attr('dx',dxForText(rotate));pathUpdate.attr("d","M"+range[0]+","+outerTickSize+"V0H"+range[1]+"V"+outerTickSize);break;}
case"top":{tickTransform=axisX;lineEnter.attr("y2",-innerTickSize);textEnter.attr("y",-tickLength);lineUpdate.attr("x2",0).attr("y2",-innerTickSize);textUpdate.attr("x",0).attr("y",-tickLength);text.style("text-anchor","middle");tspan.attr('x',0).attr("dy","0em");pathUpdate.attr("d","M"+range[0]+","+-outerTickSize+"V0H"+range[1]+"V"+-outerTickSize);break;}
case"left":{tickTransform=axisY;lineEnter.attr("x2",-innerTickSize);textEnter.attr("x",-tickLength);lineUpdate.attr("x2",-innerTickSize).attr("y1",tickY).attr("y2",tickY);textUpdate.attr("x",-tickLength).attr("y",tickOffset);text.style("text-anchor","end");tspan.attr('x',-tickLength).attr("dy",tspanDy);pathUpdate.attr("d","M"+-outerTickSize+","+range[0]+"H0V"+range[1]+"H"+-outerTickSize);break;}
case"right":{tickTransform=axisY;lineEnter.attr("x2",innerTickSize);textEnter.attr("x",tickLength);lineUpdate.attr("x2",innerTickSize).attr("y2",0);textUpdate.attr("x",tickLength).attr("y",0);text.style("text-anchor","start");tspan.attr('x',tickLength).attr("dy",tspanDy);pathUpdate.attr("d","M"+outerTickSize+","+range[0]+"H0V"+range[1]+"H"+outerTickSize);break;}}
if(scale1.rangeBand){var x=scale1,dx=x.rangeBand()/2;scale0=scale1=function(d){return x(d)+dx;};}else if(scale0.rangeBand){scale0=scale1;}else{tickExit.call(tickTransform,scale1);}
tickEnter.call(tickTransform,scale0);tickUpdate.call(tickTransform,scale1);});}
axis.scale=function(x){if(!arguments.length){return scale;}
scale=x;return axis;};axis.orient=function(x){if(!arguments.length){return orient;}
orient=x in{top:1,right:1,bottom:1,left:1}?x+"":"bottom";return axis;};axis.tickFormat=function(format){if(!arguments.length){return tickFormat;}
tickFormat=format;return axis;};axis.tickCentered=function(isCentered){if(!arguments.length){return tickCentered;}
tickCentered=isCentered;return axis;};axis.tickOffset=function(){return tickOffset;};axis.tickInterval=function(){var interval,length;if(params.isCategory){interval=tickOffset*2;}
else{length=axis.g.select('path.domain').node().getTotalLength()-outerTickSize*2;interval=length/axis.g.selectAll('line').size();}
return interval===Infinity?0:interval;};axis.ticks=function(){if(!arguments.length){return tickArguments;}
tickArguments=arguments;return axis;};axis.tickCulling=function(culling){if(!arguments.length){return tickCulling;}
tickCulling=culling;return axis;};axis.tickValues=function(x){if(typeof x==='function'){tickValues=function(){return x(scale.domain());};}
else{if(!arguments.length){return tickValues;}
tickValues=x;}
return axis;};return axis;}
c3_chart_internal_fn.isSafari=function(){var ua=window.navigator.userAgent;return ua.indexOf('Safari')>=0&&ua.indexOf('Chrome')<0;};c3_chart_internal_fn.isChrome=function(){var ua=window.navigator.userAgent;return ua.indexOf('Chrome')>=0;};if(!Function.prototype.bind){Function.prototype.bind=function(oThis){if(typeof this!=='function'){throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;};}
if(typeof define==='function'&&define.amd){define("c3",["d3"],c3);}else if('undefined'!==typeof exports&&'undefined'!==typeof module){module.exports=c3;}else{window.c3=c3;}})(window);
;!function(e,t,n){"use strict";!function o(e,t,n){function a(s,l){if(!t[s]){if(!e[s]){var i="function"==typeof require&&require;if(!l&&i)return i(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=t[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return a(n?n:t)},c,c.exports,o,e,t,n)}return t[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(o,a,r){function s(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var l,i,u,c,d=o("./modules/handle-dom"),f=o("./modules/utils"),p=o("./modules/handle-swal-dom"),m=o("./modules/handle-click"),v=o("./modules/handle-key"),y=s(v),b=o("./modules/default-params"),h=s(b),g=o("./modules/set-params"),w=s(g);r["default"]=u=c=function(){function o(e){var t=a;return t[e]===n?h["default"][e]:t[e]}var a=arguments[0];if((0,d.addClass)(t.body,"stop-scrolling"),(0,p.resetInput)(),a===n)return(0,f.logStr)("SweetAlert expects at least 1 attribute!"),!1;var r=(0,f.extend)({},h["default"]);switch(typeof a){case"string":r.title=a,r.text=arguments[1]||"",r.type=arguments[2]||"";break;case"object":if(a.title===n)return(0,f.logStr)('Missing "title" argument!'),!1;r.title=a.title;for(var s in h["default"])r[s]=o(s);r.confirmButtonText=r.showCancelButton?"Confirm":h["default"].confirmButtonText,r.confirmButtonText=o("confirmButtonText"),r.doneFunction=arguments[1]||null;break;default:return(0,f.logStr)('Unexpected type of argument! Expected "string" or "object", got '+typeof a),!1}(0,w["default"])(r),(0,p.fixVerticalPosition)(),(0,p.openModal)(arguments[1]);for(var u=(0,p.getModal)(),v=u.querySelectorAll("button"),b=["onclick","onmouseover","onmouseout","onmousedown","onmouseup","onfocus"],g=function(e){return(0,m.handleButton)(e,r,u)},C=0;C<v.length;C++)for(var S=0;S<b.length;S++){var x=b[S];v[C][x]=g}(0,p.getOverlay)().onclick=g,l=e.onkeydown;var k=function(e){return(0,y["default"])(e,r,u)};e.onkeydown=k,e.onfocus=function(){setTimeout(function(){i!==n&&(i.focus(),i=n)},0)},c.enableButtons()},u.setDefaults=c.setDefaults=function(e){if(!e)throw new Error("userParams is required");if("object"!=typeof e)throw new Error("userParams has to be a object");(0,f.extend)(h["default"],e)},u.close=c.close=function(){var o=(0,p.getModal)();(0,d.fadeOut)((0,p.getOverlay)(),5),(0,d.fadeOut)(o,5),(0,d.removeClass)(o,"showSweetAlert"),(0,d.addClass)(o,"hideSweetAlert"),(0,d.removeClass)(o,"visible");var a=o.querySelector(".sa-icon.sa-success");(0,d.removeClass)(a,"animate"),(0,d.removeClass)(a.querySelector(".sa-tip"),"animateSuccessTip"),(0,d.removeClass)(a.querySelector(".sa-long"),"animateSuccessLong");var r=o.querySelector(".sa-icon.sa-error");(0,d.removeClass)(r,"animateErrorIcon"),(0,d.removeClass)(r.querySelector(".sa-x-mark"),"animateXMark");var s=o.querySelector(".sa-icon.sa-warning");return(0,d.removeClass)(s,"pulseWarning"),(0,d.removeClass)(s.querySelector(".sa-body"),"pulseWarningIns"),(0,d.removeClass)(s.querySelector(".sa-dot"),"pulseWarningIns"),setTimeout(function(){var e=o.getAttribute("data-custom-class");(0,d.removeClass)(o,e)},300),(0,d.removeClass)(t.body,"stop-scrolling"),e.onkeydown=l,e.previousActiveElement&&e.previousActiveElement.focus(),i=n,clearTimeout(o.timeout),!0},u.showInputError=c.showInputError=function(e){var t=(0,p.getModal)(),n=t.querySelector(".sa-input-error");(0,d.addClass)(n,"show");var o=t.querySelector(".sa-error-container");(0,d.addClass)(o,"show"),o.querySelector("p").innerHTML=e,setTimeout(function(){u.enableButtons()},1),t.querySelector("input").focus()},u.resetInputError=c.resetInputError=function(e){if(e&&13===e.keyCode)return!1;var t=(0,p.getModal)(),n=t.querySelector(".sa-input-error");(0,d.removeClass)(n,"show");var o=t.querySelector(".sa-error-container");(0,d.removeClass)(o,"show")},u.disableButtons=c.disableButtons=function(e){var t=(0,p.getModal)(),n=t.querySelector("button.confirm"),o=t.querySelector("button.cancel");n.disabled=!0,o.disabled=!0},u.enableButtons=c.enableButtons=function(e){var t=(0,p.getModal)(),n=t.querySelector("button.confirm"),o=t.querySelector("button.cancel");n.disabled=!1,o.disabled=!1},"undefined"!=typeof e?e.sweetAlert=e.swal=u:(0,f.logStr)("SweetAlert is a frontend module!"),a.exports=r["default"]},{"./modules/default-params":2,"./modules/handle-click":3,"./modules/handle-dom":4,"./modules/handle-key":5,"./modules/handle-swal-dom":6,"./modules/set-params":8,"./modules/utils":9}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o={title:"",text:"",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#8CD4F5",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null,customClass:"",html:!1,animation:!0,allowEscapeKey:!0,inputType:"text",inputPlaceholder:"",inputValue:"",showLoaderOnConfirm:!1};n["default"]=o,t.exports=n["default"]},{}],3:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=t("./utils"),r=(t("./handle-swal-dom"),t("./handle-dom")),s=function(t,n,o){function s(e){m&&n.confirmButtonColor&&(p.style.backgroundColor=e)}var u,c,d,f=t||e.event,p=f.target||f.srcElement,m=-1!==p.className.indexOf("confirm"),v=-1!==p.className.indexOf("sweet-overlay"),y=(0,r.hasClass)(o,"visible"),b=n.doneFunction&&"true"===o.getAttribute("data-has-done-function");switch(m&&n.confirmButtonColor&&(u=n.confirmButtonColor,c=(0,a.colorLuminance)(u,-.04),d=(0,a.colorLuminance)(u,-.14)),f.type){case"mouseover":s(c);break;case"mouseout":s(u);break;case"mousedown":s(d);break;case"mouseup":s(c);break;case"focus":var h=o.querySelector("button.confirm"),g=o.querySelector("button.cancel");m?g.style.boxShadow="none":h.style.boxShadow="none";break;case"click":var w=o===p,C=(0,r.isDescendant)(o,p);if(!w&&!C&&y&&!n.allowOutsideClick)break;m&&b&&y?l(o,n):b&&y||v?i(o,n):(0,r.isDescendant)(o,p)&&"BUTTON"===p.tagName&&sweetAlert.close()}},l=function(e,t){var n=!0;(0,r.hasClass)(e,"show-input")&&(n=e.querySelector("input").value,n||(n="")),t.doneFunction(n),t.closeOnConfirm&&sweetAlert.close(),t.showLoaderOnConfirm&&sweetAlert.disableButtons()},i=function(e,t){var n=String(t.doneFunction).replace(/\s/g,""),o="function("===n.substring(0,9)&&")"!==n.substring(9,10);o&&t.doneFunction(!1),t.closeOnCancel&&sweetAlert.close()};o["default"]={handleButton:s,handleConfirm:l,handleCancel:i},n.exports=o["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],4:[function(n,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=function(e,t){return new RegExp(" "+t+" ").test(" "+e.className+" ")},s=function(e,t){r(e,t)||(e.className+=" "+t)},l=function(e,t){var n=" "+e.className.replace(/[\t\r\n]/g," ")+" ";if(r(e,t)){for(;n.indexOf(" "+t+" ")>=0;)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}},i=function(e){var n=t.createElement("div");return n.appendChild(t.createTextNode(e)),n.innerHTML},u=function(e){e.style.opacity="",e.style.display="block"},c=function(e){if(e&&!e.length)return u(e);for(var t=0;t<e.length;++t)u(e[t])},d=function(e){e.style.opacity="",e.style.display="none"},f=function(e){if(e&&!e.length)return d(e);for(var t=0;t<e.length;++t)d(e[t])},p=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},m=function(e){e.style.left="-9999px",e.style.display="block";var t,n=e.clientHeight;return t="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(e).getPropertyValue("padding-top"),10):parseInt(e.currentStyle.padding),e.style.left="",e.style.display="none","-"+parseInt((n+t)/2)+"px"},v=function(e,t){if(+e.style.opacity<1){t=t||16,e.style.opacity=0,e.style.display="block";var n=+new Date,o=function a(){e.style.opacity=+e.style.opacity+(new Date-n)/100,n=+new Date,+e.style.opacity<1&&setTimeout(a,t)};o()}e.style.display="block"},y=function(e,t){t=t||16,e.style.opacity=1;var n=+new Date,o=function a(){e.style.opacity=+e.style.opacity-(new Date-n)/100,n=+new Date,+e.style.opacity>0?setTimeout(a,t):e.style.display="none"};o()},b=function(n){if("function"==typeof MouseEvent){var o=new MouseEvent("click",{view:e,bubbles:!1,cancelable:!0});n.dispatchEvent(o)}else if(t.createEvent){var a=t.createEvent("MouseEvents");a.initEvent("click",!1,!1),n.dispatchEvent(a)}else t.createEventObject?n.fireEvent("onclick"):"function"==typeof n.onclick&&n.onclick()},h=function(t){"function"==typeof t.stopPropagation?(t.stopPropagation(),t.preventDefault()):e.event&&e.event.hasOwnProperty("cancelBubble")&&(e.event.cancelBubble=!0)};a.hasClass=r,a.addClass=s,a.removeClass=l,a.escapeHtml=i,a._show=u,a.show=c,a._hide=d,a.hide=f,a.isDescendant=p,a.getTopMargin=m,a.fadeIn=v,a.fadeOut=y,a.fireClick=b,a.stopEventPropagation=h},{}],5:[function(t,o,a){Object.defineProperty(a,"__esModule",{value:!0});var r=t("./handle-dom"),s=t("./handle-swal-dom"),l=function(t,o,a){var l=t||e.event,i=l.keyCode||l.which,u=a.querySelector("button.confirm"),c=a.querySelector("button.cancel"),d=a.querySelectorAll("button[tabindex]");if(-1!==[9,13,32,27].indexOf(i)){for(var f=l.target||l.srcElement,p=-1,m=0;m<d.length;m++)if(f===d[m]){p=m;break}9===i?(f=-1===p?u:p===d.length-1?d[0]:d[p+1],(0,r.stopEventPropagation)(l),f.focus(),o.confirmButtonColor&&(0,s.setFocusStyle)(f,o.confirmButtonColor)):13===i?("INPUT"===f.tagName&&(f=u,u.focus()),f=-1===p?u:n):27===i&&o.allowEscapeKey===!0?(f=c,(0,r.fireClick)(f,l)):f=n}};a["default"]=l,o.exports=a["default"]},{"./handle-dom":4,"./handle-swal-dom":6}],6:[function(n,o,a){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(a,"__esModule",{value:!0});var s=n("./utils"),l=n("./handle-dom"),i=n("./default-params"),u=r(i),c=n("./injected-html"),d=r(c),f=".sweet-alert",p=".sweet-overlay",m=function(){var e=t.createElement("div");for(e.innerHTML=d["default"];e.firstChild;)t.body.appendChild(e.firstChild)},v=function x(){var e=t.querySelector(f);return e||(m(),e=x()),e},y=function(){var e=v();return e?e.querySelector("input"):void 0},b=function(){return t.querySelector(p)},h=function(e,t){var n=(0,s.hexToRgb)(t);e.style.boxShadow="0 0 2px rgba("+n+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"},g=function(n){var o=v();(0,l.fadeIn)(b(),10),(0,l.show)(o),(0,l.addClass)(o,"showSweetAlert"),(0,l.removeClass)(o,"hideSweetAlert"),e.previousActiveElement=t.activeElement;var a=o.querySelector("button.confirm");a.focus(),setTimeout(function(){(0,l.addClass)(o,"visible")},500);var r=o.getAttribute("data-timer");if("null"!==r&&""!==r){var s=n;o.timeout=setTimeout(function(){var e=(s||null)&&"true"===o.getAttribute("data-has-done-function");e?s(null):sweetAlert.close()},r)}},w=function(){var e=v(),t=y();(0,l.removeClass)(e,"show-input"),t.value=u["default"].inputValue,t.setAttribute("type",u["default"].inputType),t.setAttribute("placeholder",u["default"].inputPlaceholder),C()},C=function(e){if(e&&13===e.keyCode)return!1;var t=v(),n=t.querySelector(".sa-input-error");(0,l.removeClass)(n,"show");var o=t.querySelector(".sa-error-container");(0,l.removeClass)(o,"show")},S=function(){var e=v();e.style.marginTop=(0,l.getTopMargin)(v())};a.sweetAlertInitialize=m,a.getModal=v,a.getOverlay=b,a.getInput=y,a.setFocusStyle=h,a.openModal=g,a.resetInput=w,a.resetInputError=C,a.fixVerticalPosition=S},{"./default-params":2,"./handle-dom":4,"./injected-html":7,"./utils":9}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var o='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert"><div class="sa-icon sa-error">\n      <span class="sa-x-mark">\n        <span class="sa-line sa-left"></span>\n        <span class="sa-line sa-right"></span>\n      </span>\n    </div><div class="sa-icon sa-warning">\n      <span class="sa-body"></span>\n      <span class="sa-dot"></span>\n    </div><div class="sa-icon sa-info"></div><div class="sa-icon sa-success">\n      <span class="sa-line sa-tip"></span>\n      <span class="sa-line sa-long"></span>\n\n      <div class="sa-placeholder"></div>\n      <div class="sa-fix"></div>\n    </div><div class="sa-icon sa-custom"></div><h2>Title</h2>\n    <p>Text</p>\n    <fieldset>\n      <input type="text" tabIndex="3" />\n      <div class="sa-input-error"></div>\n    </fieldset><div class="sa-error-container">\n      <div class="icon">!</div>\n      <p>Not valid!</p>\n    </div><div class="sa-button-container">\n      <button class="cancel" tabIndex="2">Cancel</button>\n      <div class="sa-confirm-button-container">\n        <button class="confirm" tabIndex="1">OK</button><div class="la-ball-fall">\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      </div>\n    </div></div>';n["default"]=o,t.exports=n["default"]},{}],8:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var a=e("./utils"),r=e("./handle-swal-dom"),s=e("./handle-dom"),l=["error","warning","info","success","input","prompt"],i=function(e){var t=(0,r.getModal)(),o=t.querySelector("h2"),i=t.querySelector("p"),u=t.querySelector("button.cancel"),c=t.querySelector("button.confirm");if(o.innerHTML=e.html?e.title:(0,s.escapeHtml)(e.title).split("\n").join("<br>"),i.innerHTML=e.html?e.text:(0,s.escapeHtml)(e.text||"").split("\n").join("<br>"),e.text&&(0,s.show)(i),e.customClass)(0,s.addClass)(t,e.customClass),t.setAttribute("data-custom-class",e.customClass);else{var d=t.getAttribute("data-custom-class");(0,s.removeClass)(t,d),t.setAttribute("data-custom-class","")}if((0,s.hide)(t.querySelectorAll(".sa-icon")),e.type&&!(0,a.isIE8)()){var f=function(){for(var o=!1,a=0;a<l.length;a++)if(e.type===l[a]){o=!0;break}if(!o)return logStr("Unknown alert type: "+e.type),{v:!1};var i=["success","error","warning","info"],u=n;-1!==i.indexOf(e.type)&&(u=t.querySelector(".sa-icon.sa-"+e.type),(0,s.show)(u));var c=(0,r.getInput)();switch(e.type){case"success":(0,s.addClass)(u,"animate"),(0,s.addClass)(u.querySelector(".sa-tip"),"animateSuccessTip"),(0,s.addClass)(u.querySelector(".sa-long"),"animateSuccessLong");break;case"error":(0,s.addClass)(u,"animateErrorIcon"),(0,s.addClass)(u.querySelector(".sa-x-mark"),"animateXMark");break;case"warning":(0,s.addClass)(u,"pulseWarning"),(0,s.addClass)(u.querySelector(".sa-body"),"pulseWarningIns"),(0,s.addClass)(u.querySelector(".sa-dot"),"pulseWarningIns");break;case"input":case"prompt":c.setAttribute("type",e.inputType),c.value=e.inputValue,c.setAttribute("placeholder",e.inputPlaceholder),(0,s.addClass)(t,"show-input"),setTimeout(function(){c.focus(),c.addEventListener("keyup",swal.resetInputError)},400)}}();if("object"==typeof f)return f.v}if(e.imageUrl){var p=t.querySelector(".sa-icon.sa-custom");p.style.backgroundImage="url("+e.imageUrl+")",(0,s.show)(p);var m=80,v=80;if(e.imageSize){var y=e.imageSize.toString().split("x"),b=y[0],h=y[1];b&&h?(m=b,v=h):logStr("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+e.imageSize)}p.setAttribute("style",p.getAttribute("style")+"width:"+m+"px; height:"+v+"px")}t.setAttribute("data-has-cancel-button",e.showCancelButton),e.showCancelButton?u.style.display="inline-block":(0,s.hide)(u),t.setAttribute("data-has-confirm-button",e.showConfirmButton),e.showConfirmButton?c.style.display="inline-block":(0,s.hide)(c),e.cancelButtonText&&(u.innerHTML=(0,s.escapeHtml)(e.cancelButtonText)),e.confirmButtonText&&(c.innerHTML=(0,s.escapeHtml)(e.confirmButtonText)),e.confirmButtonColor&&(c.style.backgroundColor=e.confirmButtonColor,c.style.borderLeftColor=e.confirmLoadingButtonColor,c.style.borderRightColor=e.confirmLoadingButtonColor,(0,r.setFocusStyle)(c,e.confirmButtonColor)),t.setAttribute("data-allow-outside-click",e.allowOutsideClick);var g=!!e.doneFunction;t.setAttribute("data-has-done-function",g),e.animation?"string"==typeof e.animation?t.setAttribute("data-animation",e.animation):t.setAttribute("data-animation","pop"):t.setAttribute("data-animation","none"),t.setAttribute("data-timer",e.timer)};o["default"]=i,t.exports=o["default"]},{"./handle-dom":4,"./handle-swal-dom":6,"./utils":9}],9:[function(t,n,o){Object.defineProperty(o,"__esModule",{value:!0});var a=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?parseInt(t[1],16)+", "+parseInt(t[2],16)+", "+parseInt(t[3],16):null},s=function(){return e.attachEvent&&!e.addEventListener},l=function(t){"undefined"!=typeof e&&e.console&&e.console.log("SweetAlert: "+t)},i=function(e,t){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,a="#";for(o=0;3>o;o++)n=parseInt(e.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16),a+=("00"+n).substr(n.length);return a};o.extend=a,o.hexToRgb=r,o.isIE8=s,o.logStr=l,o.colorLuminance=i},{}]},{},[1]),"function"==typeof define&&define.amd?define(function(){return sweetAlert}):"undefined"!=typeof module&&module.exports&&(module.exports=sweetAlert)}(window,document);
;/*!
    localForage -- Offline Storage, Improved
    Version 1.5.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.localforage=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||void 0===a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(b){return p.reject(a,b)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;if(a&&"object"==typeof a&&"function"==typeof b)return function(){b.apply(a,arguments)}}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a(1),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=c=e,e.prototype.catch=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){g(c,this.state===r?a:b,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},c.resolve=k,c.reject=l,c.all=m,c.race=n},{1:1}],3:[function(a,b,c){(function(b){"use strict";"function"!=typeof b.Promise&&(b.Promise=a(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(a){return}}function f(){try{if(!ja)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(a){return!1}}function g(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(f){if("TypeError"!==f.name)throw f;for(var c="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,d=new c,e=0;e<a.length;e+=1)d.append(a[e]);return d.getBlob(b.type)}}function h(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function i(a,b,c){"function"==typeof b&&a.then(b),"function"==typeof c&&a.catch(c)}function j(a){return"string"!=typeof a&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function k(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;e<b;e++)d[e]=a.charCodeAt(e);return c}function l(a){return new ma(function(b){var c=a.transaction(na,qa),d=g([""]);c.objectStore(na).put(d,"key"),c.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)},c.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);b(c||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function m(a){return"boolean"==typeof ka?ma.resolve(ka):l(a).then(function(a){return ka=a})}function n(a){var b=la[a.name],c={};c.promise=new ma(function(a){c.resolve=a}),b.deferredOperations.push(c),b.dbReady?b.dbReady=b.dbReady.then(function(){return c.promise}):b.dbReady=c.promise}function o(a){var b=la[a.name],c=b.deferredOperations.pop();c&&c.resolve()}function p(a,b){var c=la[a.name],d=c.deferredOperations.pop();d&&d.reject(b)}function q(a,b){return new ma(function(c,d){if(a.db){if(!b)return c(a.db);n(a),a.db.close()}var e=[a.name];b&&e.push(a.version);var f=ja.open.apply(ja,e);b&&(f.onupgradeneeded=function(b){var c=f.result;try{c.createObjectStore(a.storeName),b.oldVersion<=1&&c.createObjectStore(na)}catch(c){if("ConstraintError"!==c.name)throw c;console.warn('The database "'+a.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+a.storeName+'" already exists.')}}),f.onerror=function(a){a.preventDefault(),d(f.error)},f.onsuccess=function(){c(f.result),o(a)}})}function r(a){return q(a,!1)}function s(a){return q(a,!0)}function t(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),d=a.version<a.db.version,e=a.version>a.db.version;if(d&&(a.version!==b&&console.warn('The database "'+a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),e||c){if(c){var f=a.db.version+1;f>a.version&&(a.version=f)}return!0}return!1}function u(a){return new ma(function(b,c){var d=new FileReader;d.onerror=c,d.onloadend=function(c){var d=btoa(c.target.result||"");b({__local_forage_encoded_blob:!0,data:d,type:a.type})},d.readAsBinaryString(a)})}function v(a){return g([k(atob(a.data))],{type:a.type})}function w(a){return a&&a.__local_forage_encoded_blob}function x(a){var b=this,c=b._initReady().then(function(){var a=la[b._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return i(c,a,a),c}function y(a){n(a);for(var b=la[a.name],c=b.forages,d=0;d<c.length;d++)c[d]._dbInfo.db&&(c[d]._dbInfo.db.close(),c[d]._dbInfo.db=null);return q(a,!1).then(function(a){for(var b=0;b<c.length;b++)c[b]._dbInfo.db=a}).catch(function(b){throw p(a,b),b})}function z(a,b,c){try{var d=a.db.transaction(a.storeName,b);c(null,d)}catch(d){if(!a.db||"InvalidStateError"===d.name)return y(a).then(function(){var d=a.db.transaction(a.storeName,b);c(null,d)});c(d)}}function A(a){function b(){return ma.resolve()}var c=this,d={db:null};if(a)for(var e in a)d[e]=a[e];la||(la={});var f=la[d.name];f||(f={forages:[],db:null,dbReady:null,deferredOperations:[]},la[d.name]=f),f.forages.push(c),c._initReady||(c._initReady=c.ready,c.ready=x);for(var g=[],h=0;h<f.forages.length;h++){var i=f.forages[h];i!==c&&g.push(i._initReady().catch(b))}var j=f.forages.slice(0);return ma.all(g).then(function(){return d.db=f.db,r(d)}).then(function(a){return d.db=a,t(d,c._defaultConfig.version)?s(d):a}).then(function(a){d.db=f.db=a,c._dbInfo=d;for(var b=0;b<j.length;b++){var e=j[b];e!==c&&(e._dbInfo.db=d.db,e._dbInfo.version=d.version)}})}function B(a,b){var c=this;a=j(a);var d=new ma(function(b,d){c.ready().then(function(){z(c._dbInfo,pa,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.get(a);h.onsuccess=function(){var a=h.result;void 0===a&&(a=null),w(a)&&(a=v(a)),b(a)},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function C(a,b){var c=this,d=new ma(function(b,d){c.ready().then(function(){z(c._dbInfo,pa,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.openCursor(),i=1;h.onsuccess=function(){var c=h.result;if(c){var d=c.value;w(d)&&(d=v(d));var e=a(d,c.key,i++);void 0!==e?b(e):c.continue()}else b()},h.onerror=function(){d(h.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function D(a,b,c){var d=this;a=j(a);var e=new ma(function(c,e){var f;d.ready().then(function(){return f=d._dbInfo,"[object Blob]"===oa.call(b)?m(f.db).then(function(a){return a?b:u(b)}):b}).then(function(b){z(d._dbInfo,qa,function(f,g){if(f)return e(f);try{var h=g.objectStore(d._dbInfo.storeName),i=h.put(b,a);null===b&&(b=void 0),g.oncomplete=function(){void 0===b&&(b=null),c(b)},g.onabort=g.onerror=function(){var a=i.error?i.error:i.transaction.error;e(a)}}catch(a){e(a)}})}).catch(e)});return h(e,c),e}function E(a,b){var c=this;a=j(a);var d=new ma(function(b,d){c.ready().then(function(){z(c._dbInfo,qa,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=g.delete(a);f.oncomplete=function(){b()},f.onerror=function(){d(h.error)},f.onabort=function(){var a=h.error?h.error:h.transaction.error;d(a)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function F(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){z(b._dbInfo,qa,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.clear();e.oncomplete=function(){a()},e.onabort=e.onerror=function(){var a=g.error?g.error:g.transaction.error;c(a)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function G(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){z(b._dbInfo,pa,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.count();g.onsuccess=function(){a(g.result)},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function H(a,b){var c=this,d=new ma(function(b,d){if(a<0)return void b(null);c.ready().then(function(){z(c._dbInfo,pa,function(e,f){if(e)return d(e);try{var g=f.objectStore(c._dbInfo.storeName),h=!1,i=g.openCursor();i.onsuccess=function(){var c=i.result;if(!c)return void b(null);0===a?b(c.key):h?b(c.key):(h=!0,c.advance(a))},i.onerror=function(){d(i.error)}}catch(a){d(a)}})}).catch(d)});return h(d,b),d}function I(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){z(b._dbInfo,pa,function(d,e){if(d)return c(d);try{var f=e.objectStore(b._dbInfo.storeName),g=f.openCursor(),h=[];g.onsuccess=function(){var b=g.result;if(!b)return void a(h);h.push(b.key),b.continue()},g.onerror=function(){c(g.error)}}catch(a){c(a)}})}).catch(c)});return h(c,a),c}function J(){return"function"==typeof openDatabase}function K(a){var b,c,d,e,f,g=.75*a.length,h=a.length,i=0;"="===a[a.length-1]&&(g--,"="===a[a.length-2]&&g--);var j=new ArrayBuffer(g),k=new Uint8Array(j);for(b=0;b<h;b+=4)c=sa.indexOf(a[b]),d=sa.indexOf(a[b+1]),e=sa.indexOf(a[b+2]),f=sa.indexOf(a[b+3]),k[i++]=c<<2|d>>4,k[i++]=(15&d)<<4|e>>2,k[i++]=(3&e)<<6|63&f;return j}function L(a){var b,c=new Uint8Array(a),d="";for(b=0;b<c.length;b+=3)d+=sa[c[b]>>2],d+=sa[(3&c[b])<<4|c[b+1]>>4],d+=sa[(15&c[b+1])<<2|c[b+2]>>6],d+=sa[63&c[b+2]];return c.length%3==2?d=d.substring(0,d.length-1)+"=":c.length%3==1&&(d=d.substring(0,d.length-2)+"=="),d}function M(a,b){var c="";if(a&&(c=Ja.call(a)),a&&("[object ArrayBuffer]"===c||a.buffer&&"[object ArrayBuffer]"===Ja.call(a.buffer))){var d,e=va;a instanceof ArrayBuffer?(d=a,e+=xa):(d=a.buffer,"[object Int8Array]"===c?e+=za:"[object Uint8Array]"===c?e+=Aa:"[object Uint8ClampedArray]"===c?e+=Ba:"[object Int16Array]"===c?e+=Ca:"[object Uint16Array]"===c?e+=Ea:"[object Int32Array]"===c?e+=Da:"[object Uint32Array]"===c?e+=Fa:"[object Float32Array]"===c?e+=Ga:"[object Float64Array]"===c?e+=Ha:b(new Error("Failed to get type for BinaryArray"))),b(e+L(d))}else if("[object Blob]"===c){var f=new FileReader;f.onload=function(){var c=ta+a.type+"~"+L(this.result);b(va+ya+c)},f.readAsArrayBuffer(a)}else try{b(JSON.stringify(a))}catch(c){console.error("Couldn't convert value into a JSON string: ",a),b(null,c)}}function N(a){if(a.substring(0,wa)!==va)return JSON.parse(a);var b,c=a.substring(Ia),d=a.substring(wa,Ia);if(d===ya&&ua.test(c)){var e=c.match(ua);b=e[1],c=c.substring(e[0].length)}var f=K(c);switch(d){case xa:return f;case ya:return g([f],{type:b});case za:return new Int8Array(f);case Aa:return new Uint8Array(f);case Ba:return new Uint8ClampedArray(f);case Ca:return new Int16Array(f);case Ea:return new Uint16Array(f);case Da:return new Int32Array(f);case Fa:return new Uint32Array(f);case Ga:return new Float32Array(f);case Ha:return new Float64Array(f);default:throw new Error("Unkown type: "+d)}}function O(a){var b=this,c={db:null};if(a)for(var d in a)c[d]="string"!=typeof a[d]?a[d].toString():a[d];var e=new ma(function(a,d){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(a){return d(a)}c.db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+c.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){b._dbInfo=c,a()},function(a,b){d(b)})})});return c.serializer=Ka,e}function P(a,b){var c=this;a=j(a);var d=new ma(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName+" WHERE key = ? LIMIT 1",[a],function(a,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=e.serializer.deserialize(d)),b(d)},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function Q(a,b){var c=this,d=new ma(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT * FROM "+e.storeName,[],function(c,d){for(var f=d.rows,g=f.length,h=0;h<g;h++){var i=f.item(h),j=i.value;if(j&&(j=e.serializer.deserialize(j)),void 0!==(j=a(j,i.key,h+1)))return void b(j)}b()},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function R(a,b,c,d){var e=this;a=j(a);var f=new ma(function(f,g){e.ready().then(function(){void 0===b&&(b=null);var h=b,i=e._dbInfo;i.serializer.serialize(b,function(b,j){j?g(j):i.db.transaction(function(c){c.executeSql("INSERT OR REPLACE INTO "+i.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){f(h)},function(a,b){g(b)})},function(b){if(b.code===b.QUOTA_ERR){if(d>0)return void f(R.apply(e,[a,h,c,d-1]));g(b)}})})}).catch(g)});return h(f,c),f}function S(a,b,c){return R.apply(this,[a,b,c,1])}function T(a,b){var c=this;a=j(a);var d=new ma(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("DELETE FROM "+e.storeName+" WHERE key = ?",[a],function(){b()},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function U(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("DELETE FROM "+d.storeName,[],function(){a()},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function V(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function W(a,b){var c=this,d=new ma(function(b,d){c.ready().then(function(){var e=c._dbInfo;e.db.transaction(function(c){c.executeSql("SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[a+1],function(a,c){var d=c.rows.length?c.rows.item(0).key:null;b(d)},function(a,b){d(b)})})}).catch(d)});return h(d,b),d}function X(a){var b=this,c=new ma(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT key FROM "+d.storeName,[],function(b,c){for(var d=[],e=0;e<c.rows.length;e++)d.push(c.rows.item(e).key);a(d)},function(a,b){c(b)})})}).catch(c)});return h(c,a),c}function Y(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&"function"==typeof localStorage.setItem}catch(a){return!1}}function Z(a){var b=this,c={};if(a)for(var d in a)c[d]=a[d];return c.keyPrefix=c.name+"/",c.storeName!==b._defaultConfig.storeName&&(c.keyPrefix+=c.storeName+"/"),b._dbInfo=c,c.serializer=Ka,ma.resolve()}function $(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=localStorage.length-1;c>=0;c--){var d=localStorage.key(c);0===d.indexOf(a)&&localStorage.removeItem(d)}});return h(c,a),c}function _(a,b){var c=this;a=j(a);var d=c.ready().then(function(){var b=c._dbInfo,d=localStorage.getItem(b.keyPrefix+a);return d&&(d=b.serializer.deserialize(d)),d});return h(d,b),d}function aa(a,b){var c=this,d=c.ready().then(function(){for(var b=c._dbInfo,d=b.keyPrefix,e=d.length,f=localStorage.length,g=1,h=0;h<f;h++){var i=localStorage.key(h);if(0===i.indexOf(d)){var j=localStorage.getItem(i);if(j&&(j=b.serializer.deserialize(j)),void 0!==(j=a(j,i.substring(e),g++)))return j}}});return h(d,b),d}function ba(a,b){var c=this,d=c.ready().then(function(){var b,d=c._dbInfo;try{b=localStorage.key(a)}catch(a){b=null}return b&&(b=b.substring(d.keyPrefix.length)),b});return h(d,b),d}function ca(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,d=[],e=0;e<c;e++)0===localStorage.key(e).indexOf(a.keyPrefix)&&d.push(localStorage.key(e).substring(a.keyPrefix.length));return d});return h(c,a),c}function da(a){var b=this,c=b.keys().then(function(a){return a.length});return h(c,a),c}function ea(a,b){var c=this;a=j(a);var d=c.ready().then(function(){var b=c._dbInfo;localStorage.removeItem(b.keyPrefix+a)});return h(d,b),d}function fa(a,b,c){var d=this;a=j(a);var e=d.ready().then(function(){void 0===b&&(b=null);var c=b;return new ma(function(e,f){var g=d._dbInfo;g.serializer.serialize(b,function(b,d){if(d)f(d);else try{localStorage.setItem(g.keyPrefix+a,b),e(c)}catch(a){"QuotaExceededError"!==a.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==a.name||f(a),f(a)}})})});return h(e,c),e}function ga(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function ha(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(Na(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=b[c])}return arguments[0]}var ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ja=e();"undefined"==typeof Promise&&a(3);var ka,la,ma=Promise,na="local-forage-detect-blob-support",oa=Object.prototype.toString,pa="readonly",qa="readwrite",ra={_driver:"asyncStorage",_initStorage:A,_support:f(),iterate:C,getItem:B,setItem:D,removeItem:E,clear:F,length:G,key:H,keys:I},sa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ta="~~local_forage_type~",ua=/^~~local_forage_type~([^~]+)~/,va="__lfsc__:",wa=va.length,xa="arbf",ya="blob",za="si08",Aa="ui08",Ba="uic8",Ca="si16",Da="si32",Ea="ur16",Fa="ui32",Ga="fl32",Ha="fl64",Ia=wa+xa.length,Ja=Object.prototype.toString,Ka={serialize:M,deserialize:N,stringToBuffer:K,bufferToString:L},La={_driver:"webSQLStorage",_initStorage:O,_support:J(),iterate:Q,getItem:P,setItem:S,removeItem:T,clear:U,length:V,key:W,keys:X},Ma={_driver:"localStorageWrapper",_initStorage:Z,_support:Y(),iterate:aa,getItem:_,setItem:fa,removeItem:ea,clear:$,length:da,key:ba,keys:ca},Na=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},Oa={},Pa={},Qa={INDEXEDDB:ra,WEBSQL:La,LOCALSTORAGE:Ma},Ra={INDEXEDDB:ra._driver,WEBSQL:La._driver,LOCALSTORAGE:Ma._driver},Sa=[Ra.INDEXEDDB,Ra.WEBSQL,Ra.LOCALSTORAGE],Ta=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],Ua={description:"",driver:Sa.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Va=function(){function a(b){d(this,a);for(var c in Ra)Ra.hasOwnProperty(c)&&(this[c]=Ra[c],Oa[c]||this.defineDriver(Qa[c]));this._defaultConfig=ha({},Ua),this._config=ha({},this._defaultConfig,b),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(a){if("object"===(void 0===a?"undefined":ia(a))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in a){if("storeName"===b&&(a[b]=a[b].replace(/\W/g,"_")),"version"===b&&"number"!=typeof a[b])return new Error("Database version must be a number.");this._config[b]=a[b]}return!("driver"in a&&a.driver)||this.setDriver(this._config.driver)}return"string"==typeof a?this._config[a]:this._config},a.prototype.defineDriver=function(a,b,c){var d=new ma(function(b,c){try{var d=a._driver,e=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!a._driver)return void c(e);for(var f=Ta.concat("_initStorage"),g=0,h=f.length;g<h;g++){var i=f[g];if(!i||!a[i]||"function"!=typeof a[i])return void c(e)}var j=function(c){Oa[d]&&console.info("Redefining LocalForage driver: "+d),Oa[d]=a,Pa[d]=c,b()};"_support"in a?a._support&&"function"==typeof a._support?a._support().then(j,c):j(!!a._support):j(!0)}catch(a){c(a)}});return i(d,b,c),d},a.prototype.driver=function(){return this._driver||null},a.prototype.getDriver=function(a,b,c){var d=Oa[a]?ma.resolve(Oa[a]):ma.reject(new Error("Driver not found."));return i(d,b,c),d},a.prototype.getSerializer=function(a){var b=ma.resolve(Ka);return i(b,a),b},a.prototype.ready=function(a){var b=this,c=b._driverSet.then(function(){return null===b._ready&&(b._ready=b._initDriver()),b._ready});return i(c,a,a),c},a.prototype.setDriver=function(a,b,c){function d(){g._config.driver=g.driver()}function e(a){return g._extend(a),d(),g._ready=g._initStorage(g._config),g._ready}function f(a){return function(){function b(){for(;c<a.length;){var f=a[c];return c++,g._dbInfo=null,g._ready=null,g.getDriver(f).then(e).catch(b)}d();var h=new Error("No available storage method found.");return g._driverSet=ma.reject(h),g._driverSet}var c=0;return b()}}var g=this;Na(a)||(a=[a]);var h=this._getSupportedDrivers(a),j=null!==this._driverSet?this._driverSet.catch(function(){return ma.resolve()}):ma.resolve();return this._driverSet=j.then(function(){var a=h[0];return g._dbInfo=null,g._ready=null,g.getDriver(a).then(function(a){g._driver=a._driver,d(),g._wrapLibraryMethodsWithReady(),g._initDriver=f(h)})}).catch(function(){d();var a=new Error("No available storage method found.");return g._driverSet=ma.reject(a),g._driverSet}),i(this._driverSet,b,c),this._driverSet},a.prototype.supports=function(a){return!!Pa[a]},a.prototype._extend=function(a){ha(this,a)},a.prototype._getSupportedDrivers=function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];this.supports(e)&&b.push(e)}return b},a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,b=Ta.length;a<b;a++)ga(this,Ta[a])},a.prototype.createInstance=function(b){return new a(b)},a}(),Wa=new Va;b.exports=Wa},{3:3}]},{},[4])(4)});;(function(window){var _userMedia;function FlashError(){var temp=Error.apply(this,arguments);temp.name=this.name="FlashError";this.stack=temp.stack;this.message=temp.message;}
function WebcamError(){var temp=Error.apply(this,arguments);temp.name=this.name="WebcamError";this.stack=temp.stack;this.message=temp.message;}
IntermediateInheritor=function(){};IntermediateInheritor.prototype=Error.prototype;FlashError.prototype=new IntermediateInheritor();WebcamError.prototype=new IntermediateInheritor();var Webcam={version:'1.0.16',protocol:location.protocol.match(/https/i)?'https':'http',loaded:false,live:false,userMedia:true,params:{preserveScale:false,width:0,height:0,dest_width:0,dest_height:0,image_format:'jpeg',jpeg_quality:90,enable_flash:true,force_flash:false,flip_horiz:false,fps:30,upload_name:'webcam',upload_file_name:null,constraints:null,swfURL:'',flashNotDetectedText:'ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).',noInterfaceFoundText:'No supported webcam interface found.',pluginNotLoadedText:'Webcam is not loaded yet',unfreeze_snap:true},errors:{FlashError:FlashError,WebcamError:WebcamError},hooks:{},init:function(){var self=this;this.mediaDevices=(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)?navigator.mediaDevices:((navigator.mozGetUserMedia||navigator.webkitGetUserMedia)?{getUserMedia:function(c){return new Promise(function(y,n){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,c,y,n);});}}:null);window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;this.userMedia=this.userMedia&&!!this.mediaDevices&&!!window.URL;if(navigator.userAgent.match(/Firefox\D+(\d+)/)){if(parseInt(RegExp.$1,10)<21)this.userMedia=null;}
if(this.userMedia){window.addEventListener('beforeunload',function(event){self.reset();});}},attach:function(elem){if(typeof(elem)=='string'){elem=document.getElementById(elem)||document.querySelector(elem);}
if(!elem){return this.dispatch('error',new WebcamError("Could not locate DOM element to attach to."));}
this.container=elem;elem.innerHTML='';var peg=document.createElement('div');elem.appendChild(peg);this.peg=peg;if(!this.params.width)this.params.width=elem.offsetWidth;if(!this.params.height)this.params.height=elem.offsetHeight;if(!this.params.width||!this.params.height){return this.dispatch('error',new WebcamError("No width and/or height for webcam.  Please call set() first, or attach to a visible element."));}
if(!this.params.dest_width)this.params.dest_width=this.params.width;if(!this.params.dest_height)this.params.dest_height=this.params.height;this.userMedia=_userMedia===undefined?this.userMedia:_userMedia;if(this.params.force_flash){_userMedia=this.userMedia;this.userMedia=null;}
if(typeof this.params.fps!=="number")this.params.fps=30;var scaleX=this.params.width/this.params.dest_width;var scaleY=this.params.height/this.params.dest_height;if(this.params.preserveScale){scaleX=scaleY=1.0;}
if(this.userMedia){var video=document.createElement('video');video.setAttribute('autoplay','autoplay');video.style.width=''+this.params.dest_width+'px';video.style.height=''+this.params.dest_height+'px';if((scaleX!=1.0)||(scaleY!=1.0)){elem.style.overflow='hidden';video.style.webkitTransformOrigin='0px 0px';video.style.mozTransformOrigin='0px 0px';video.style.msTransformOrigin='0px 0px';video.style.oTransformOrigin='0px 0px';video.style.transformOrigin='0px 0px';video.style.webkitTransform='scaleX('+scaleX+') scaleY('+scaleY+')';video.style.mozTransform='scaleX('+scaleX+') scaleY('+scaleY+')';video.style.msTransform='scaleX('+scaleX+') scaleY('+scaleY+')';video.style.oTransform='scaleX('+scaleX+') scaleY('+scaleY+')';video.style.transform='scaleX('+scaleX+') scaleY('+scaleY+')';}
elem.appendChild(video);this.video=video;var self=this;this.mediaDevices.getUserMedia({"audio":false,"video":this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then(function(stream){video.onloadedmetadata=function(e){self.stream=stream;self.loaded=true;self.live=true;self.dispatch('load');self.dispatch('live');self.flip();};video.src=window.URL.createObjectURL(stream)||stream;}).catch(function(err){if(self.params.enable_flash&&self.detectFlash()){setTimeout(function(){self.params.force_flash=1;self.attach(elem);},1);}else{self.dispatch('error',err);}});}else if(this.params.enable_flash&&this.detectFlash()){window.Webcam=Webcam;var div=document.createElement('div');div.innerHTML=this.getSWFHTML();elem.appendChild(div);}else{this.dispatch('error',new WebcamError(this.params.noInterfaceFoundText));}
if(this.params.crop_width&&this.params.crop_height){var scaled_crop_width=Math.floor(this.params.crop_width*scaleX);var scaled_crop_height=Math.floor(this.params.crop_height*scaleY);elem.style.width=''+scaled_crop_width+'px';elem.style.height=''+scaled_crop_height+'px';elem.style.overflow='hidden';elem.scrollLeft=Math.floor((this.params.width/2)-(scaled_crop_width/2));elem.scrollTop=Math.floor((this.params.height/2)-(scaled_crop_height/2));}else{elem.style.width=''+this.params.width+'px';elem.style.height=''+this.params.height+'px';}},reset:function(){if(this.preview_active)this.unfreeze();this.unflip();if(this.userMedia){if(this.stream){if(this.stream.getVideoTracks){var tracks=this.stream.getVideoTracks();if(tracks&&tracks[0]&&tracks[0].stop)tracks[0].stop();}else if(this.stream.stop){this.stream.stop();}}
delete this.stream;delete this.video;}
if(this.userMedia!==true){var movie=this.getMovie();if(movie&&movie._releaseCamera)movie._releaseCamera();}
if(this.container){this.container.innerHTML='';delete this.container;}
this.loaded=false;this.live=false;},set:function(){if(arguments.length==1){for(var key in arguments[0]){this.params[key]=arguments[0][key];}}else{this.params[arguments[0]]=arguments[1];}},on:function(name,callback){name=name.replace(/^on/i,'').toLowerCase();if(!this.hooks[name])this.hooks[name]=[];this.hooks[name].push(callback);},off:function(name,callback){name=name.replace(/^on/i,'').toLowerCase();if(this.hooks[name]){if(callback){var idx=this.hooks[name].indexOf(callback);if(idx>-1)this.hooks[name].splice(idx,1);}else{this.hooks[name]=[];}}},dispatch:function(){var name=arguments[0].replace(/^on/i,'').toLowerCase();var args=Array.prototype.slice.call(arguments,1);if(this.hooks[name]&&this.hooks[name].length){for(var idx=0,len=this.hooks[name].length;idx<len;idx++){var hook=this.hooks[name][idx];if(typeof(hook)=='function'){hook.apply(this,args);}else if((typeof(hook)=='object')&&(hook.length==2)){hook[0][hook[1]].apply(hook[0],args);}else if(window[hook]){window[hook].apply(window,args);}}
return true;}else if(name=='error'){if((args[0]instanceof FlashError)||(args[0]instanceof WebcamError)){message=args[0].message;}else{message="Could not access webcam: "+args[0].name+": "+
args[0].message+" "+args[0].toString();}
alert("Error: "+message);}
return false;},setSWFLocation:function(value){this.set('swfURL',value);},detectFlash:function(){var SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",win=window,nav=navigator,hasFlash=false;if(typeof nav.plugins!=="undefined"&&typeof nav.plugins[SHOCKWAVE_FLASH]==="object"){var desc=nav.plugins[SHOCKWAVE_FLASH].description;if(desc&&(typeof nav.mimeTypes!=="undefined"&&nav.mimeTypes[FLASH_MIME_TYPE]&&nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){hasFlash=true;}}else if(typeof win.ActiveXObject!=="undefined"){try{var ax=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(ax){var ver=ax.GetVariable("$version");if(ver)hasFlash=true;}}
catch(e){;}}
return hasFlash;},getSWFHTML:function(){var html='',swfURL=this.params.swfURL;if(location.protocol.match(/file/)){this.dispatch('error',new FlashError("Flash does not work from local disk.  Please run from a web server."));return'<h3 style="color:red">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>';}
if(!this.detectFlash()){this.dispatch('error',new FlashError("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again."));return'<h3 style="color:red">'+this.params.flashNotDetectedText+'</h3>';}
if(!swfURL){var base_url='';var scpts=document.getElementsByTagName('script');for(var idx=0,len=scpts.length;idx<len;idx++){var src=scpts[idx].getAttribute('src');if(src&&src.match(/\/webcam(\.min)?\.js/)){base_url=src.replace(/\/webcam(\.min)?\.js.*$/,'');idx=len;}}
if(base_url){swfURL=base_url+'/webcam.swf';}else{swfURL='webcam.swf';}}
if(window.localStorage&&!localStorage.getItem('visited')){this.params.new_user=1;localStorage.setItem('visited',1);}
var flashvars='';for(var key in this.params){if(flashvars)flashvars+='&';flashvars+=key+'='+escape(this.params[key]);}
html+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" type="application/x-shockwave-flash" codebase="'+this.protocol+'://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+this.params.width+'" height="'+this.params.height+'" id="webcam_movie_obj" align="middle"><param name="wmode" value="opaque" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+swfURL+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+flashvars+'"/><embed id="webcam_movie_embed" src="'+swfURL+'" wmode="opaque" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+this.params.width+'" height="'+this.params.height+'" name="webcam_movie_embed" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+flashvars+'"></embed></object>';return html;},getMovie:function(){if(!this.loaded)return this.dispatch('error',new FlashError("Flash Movie is not loaded yet"));var movie=document.getElementById('webcam_movie_obj');if(!movie||!movie._snap)movie=document.getElementById('webcam_movie_embed');if(!movie)this.dispatch('error',new FlashError("Cannot locate Flash movie in DOM"));return movie;},freeze:function(){var self=this;var params=this.params;if(this.preview_active)this.unfreeze();var scaleX=this.params.width/this.params.dest_width;var scaleY=this.params.height/this.params.dest_height;if(this.params.preserveScale){scaleX=scaleY=1.0;}
this.unflip();var final_width=params.crop_width||params.dest_width;var final_height=params.crop_height||params.dest_height;var preview_canvas=document.createElement('canvas');preview_canvas.width=final_width;preview_canvas.height=final_height;var preview_context=preview_canvas.getContext('2d');this.preview_canvas=preview_canvas;this.preview_context=preview_context;if((scaleX!=1.0)||(scaleY!=1.0)){preview_canvas.style.webkitTransformOrigin='0px 0px';preview_canvas.style.mozTransformOrigin='0px 0px';preview_canvas.style.msTransformOrigin='0px 0px';preview_canvas.style.oTransformOrigin='0px 0px';preview_canvas.style.transformOrigin='0px 0px';preview_canvas.style.webkitTransform='scaleX('+scaleX+') scaleY('+scaleY+')';preview_canvas.style.mozTransform='scaleX('+scaleX+') scaleY('+scaleY+')';preview_canvas.style.msTransform='scaleX('+scaleX+') scaleY('+scaleY+')';preview_canvas.style.oTransform='scaleX('+scaleX+') scaleY('+scaleY+')';preview_canvas.style.transform='scaleX('+scaleX+') scaleY('+scaleY+')';}
this.snap(function(){preview_canvas.style.position='relative';preview_canvas.style.left=''+self.container.scrollLeft+'px';preview_canvas.style.top=''+self.container.scrollTop+'px';self.container.insertBefore(preview_canvas,self.peg);self.container.style.overflow='hidden';self.preview_active=true;},preview_canvas);},unfreeze:function(){if(this.preview_active){this.container.removeChild(this.preview_canvas);delete this.preview_context;delete this.preview_canvas;this.preview_active=false;this.flip();}},flip:function(){if(this.params.flip_horiz){var sty=this.container.style;sty.webkitTransform='scaleX(-1)';sty.mozTransform='scaleX(-1)';sty.msTransform='scaleX(-1)';sty.oTransform='scaleX(-1)';sty.transform='scaleX(-1)';sty.filter='FlipH';sty.msFilter='FlipH';}},unflip:function(){if(this.params.flip_horiz){var sty=this.container.style;sty.webkitTransform='scaleX(1)';sty.mozTransform='scaleX(1)';sty.msTransform='scaleX(1)';sty.oTransform='scaleX(1)';sty.transform='scaleX(1)';sty.filter='';sty.msFilter='';}},savePreview:function(user_callback,user_canvas){var params=this.params;var canvas=this.preview_canvas;var context=this.preview_context;if(user_canvas){var user_context=user_canvas.getContext('2d');user_context.drawImage(canvas,0,0);}
user_callback(user_canvas?null:canvas.toDataURL('image/'+params.image_format,params.jpeg_quality/100),canvas,context);if(this.params.unfreeze_snap)this.unfreeze();},snap:function(user_callback,user_canvas){var self=this;var params=this.params;if(!this.loaded)return this.dispatch('error',new WebcamError(this.params.pluginNotLoadedText));if(!user_callback)return this.dispatch('error',new WebcamError("Please provide a callback function or canvas to snap()"));if(this.preview_active){this.savePreview(user_callback,user_canvas);return null;}
var canvas=document.createElement('canvas');canvas.width=this.params.dest_width;canvas.height=this.params.dest_height;var context=canvas.getContext('2d');if(this.params.flip_horiz){context.translate(params.dest_width,0);context.scale(-1,1);}
var func=function(){if(this.src&&this.width&&this.height){context.drawImage(this,0,0,params.dest_width,params.dest_height);}
if(params.crop_width&&params.crop_height){var crop_canvas=document.createElement('canvas');crop_canvas.width=params.crop_width;crop_canvas.height=params.crop_height;var crop_context=crop_canvas.getContext('2d');crop_context.drawImage(canvas,Math.floor((params.dest_width/2)-(params.crop_width/2)),Math.floor((params.dest_height/2)-(params.crop_height/2)),params.crop_width,params.crop_height,0,0,params.crop_width,params.crop_height);context=crop_context;canvas=crop_canvas;}
if(user_canvas){var user_context=user_canvas.getContext('2d');user_context.drawImage(canvas,0,0);}
user_callback(user_canvas?null:canvas.toDataURL('image/'+params.image_format,params.jpeg_quality/100),canvas,context);};if(this.userMedia){context.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height);func();}else{var raw_data=this.getMovie()._snap();var img=new Image();img.onload=func;img.src='data:image/'+this.params.image_format+';base64,'+raw_data;}
return null;},configure:function(panel){if(!panel)panel="camera";this.getMovie()._configure(panel);},flashNotify:function(type,msg){switch(type){case'flashLoadComplete':this.loaded=true;this.dispatch('load');break;case'cameraLive':this.live=true;this.dispatch('live');break;case'error':this.dispatch('error',new FlashError(msg));break;default:break;}},b64ToUint6:function(nChr){return nChr>64&&nChr<91?nChr-65:nChr>96&&nChr<123?nChr-71:nChr>47&&nChr<58?nChr+4:nChr===43?62:nChr===47?63:0;},base64DecToArr:function(sBase64,nBlocksSize){var sB64Enc=sBase64.replace(/[^A-Za-z0-9\+\/]/g,""),nInLen=sB64Enc.length,nOutLen=nBlocksSize?Math.ceil((nInLen*3+1>>2)/nBlocksSize)*nBlocksSize:nInLen*3+1>>2,taBytes=new Uint8Array(nOutLen);for(var nMod3,nMod4,nUint24=0,nOutIdx=0,nInIdx=0;nInIdx<nInLen;nInIdx++){nMod4=nInIdx&3;nUint24|=this.b64ToUint6(sB64Enc.charCodeAt(nInIdx))<<18-6*nMod4;if(nMod4===3||nInLen-nInIdx===1){for(nMod3=0;nMod3<3&&nOutIdx<nOutLen;nMod3++,nOutIdx++){taBytes[nOutIdx]=nUint24>>>(16>>>nMod3&24)&255;}
nUint24=0;}}
return taBytes;},upload:function(image_data_uri,target_url,callback){var form_elem_name=this.params.upload_name||'webcam';var file_name=this.params.upload_file_name||'webcam_'+Math.round(Date.now()/1000);var image_fmt='';if(image_data_uri.match(/^data\:image\/(\w+)/)){image_fmt=RegExp.$1;}else{throw"Cannot locate image format in Data URI";}
var raw_image_data=image_data_uri.replace(/^data\:image\/\w+\;base64\,/,'');var http=new XMLHttpRequest();http.open("POST",target_url,true);if(http.upload&&http.upload.addEventListener){http.upload.addEventListener('progress',function(e){if(e.lengthComputable){var progress=e.loaded/e.total;Webcam.dispatch('uploadProgress',progress,e);}},false);}
var self=this;http.onload=function(){if(callback)callback.apply(self,[http.status,http.responseText,http.statusText]);Webcam.dispatch('uploadComplete',http.status,http.responseText,http.statusText);};var blob=new Blob([this.base64DecToArr(raw_image_data)],{type:'image/'+image_fmt});var form=new FormData();form.append(form_elem_name,blob,file_name+"."+image_fmt.replace(/e/,''));http.send(form);}};Webcam.init();if(typeof define==='function'&&define.amd){define(function(){return Webcam;});}else if(typeof module==='object'&&module.exports){module.exports=Webcam;}else{window.Webcam=Webcam;}}(window));;$.fn.setCursorPosition=function(pos){this.each(function(index,elem){setTimeout(function(){if(elem.createTextRange){var range=elem.createTextRange();range.collapse(true);range.moveEnd('character',pos);range.moveStart('character',pos);range.select();}else if(elem.setSelectionRange){elem.setSelectionRange(pos,pos);}},1);});return this;};function removeAllErrorMarkers($form){$form.find('.field_input.error').removeClass('error');}
function removeAllWarningMarkers($form){$form.find('.field_input.warning').removeClass('warning');}
function removeAllValidMarkers($form){$form.find('.field_input.valid').removeClass('valid');}
function markInputInvalid($form,input_name,error_message){var $input=getInputByName($form,input_name),$input_wrp=getInputContainerByName($form,input_name),$error_wrp=$input_wrp.find('.error_message');$input_wrp.removeClass('valid');if($input.val()&&$input.val()!==''){if(!$input.is('select')||($input.is('select')&&$input.val()!=='wrong')){$input_wrp.addClass('error');$error_wrp.html(error_message);}}}
function markInputWarning($form,input_name,warning_message){var $input=getInputByName($form,input_name),$input_wrp=getInputContainerByName($form,input_name),$warning_wrp=$input_wrp.find('.error_message');if(!$input_wrp.hasClass('error')&&$input.val()&&$input.val()!==''){$input_wrp.addClass('warning');$warning_wrp.html(warning_message);}}
function markInputVerified($form,input_name){var $input_wrp=getInputContainerByName($form,input_name);$input_wrp.removeClass('error').addClass('valid');}
function getInputByName($form,input_name){return $form.find('.field_input [name="'+input_name+'"]');}
function getInputContainerByName($form,input_name){return getInputByName($form,input_name).parents('.field_input');}
function disableSubmitButton($form,error_occurred){console.log('Disabling submit button');var $form_button=$form.find('.form_gen_button');error_occurred=(error_occurred!==undefined?error_occurred:true);$form_button.attr('disabled','disabled').prop('disabled',true).addClass('disabled_ie');if(error_occurred){$form_button.trigger('btn_error',true);}}
function enableSubmitButton($form){if(isFormSubmiting($form)){console.log('Skip enabling submit button. Still waiting for submit complete');return false;}else{console.log('Enabling submit button');}
$form.find('.form_gen_button').removeAttr('disabled').prop('disabled',false).removeClass('disabled_ie').trigger('btn_error',false);}
function disableSubmit($form){console.log('Form now waiting for submit complete');$form.data('submit-in-progress',true);}
function enableSubmit($form){console.log('Form submit complete');setTimeout(function(){$form.data('submit-in-progress',false);},1000);}
function isFormSubmiting($form){return!!$form.data('submit-in-progress');}
function findInvalidFieldsInFieldset($form){var $set_wrap=$form.find('.form_row_group .group_row_container');var $errors=$set_wrap.find('.field_input.error');return $errors;}
function expandFieldsetWithInvalidFields($form){var $errors=findInvalidFieldsInFieldset($form);if($errors.length){$errors.closest('.form_row_group').trigger('open');}}
function markInputsAsValid($form){removeAllValidMarkers($form);$form.find('.field_input input[type!="hidden"], .field_input textarea, .field_input select').each(function(){var $input=$(this),$input_wrp=$input.parents('.field_input');if($input.val()!==''&&!$input.prop('disabled')&&!$input.is('[type="radio"]')&&!$input_wrp.hasClass('error')){if((!$input.is('select')||($input.is('select')&&$input.val()!=='wrong'))){$input_wrp.addClass('valid');}}});}
function handleErrorAnswer(error_object,$form){console.log('Started form error handle');if(!$form){$form=$('.form_gen_wrapper form').first();}
disableSubmitButton($form);removeAllWarningMarkers($form);removeAllErrorMarkers($form);for(var field_name in error_object){markInputInvalid($form,field_name,error_object[field_name]);}
expandFieldsetWithInvalidFields($form);}
function genFormInit($obj){function ajaxFormSubmitDeffer(e){clearTimeout(form_submit_timer);form_submit_timer=setTimeout(function(){ajaxFormSubmit(e);},400);}
function ajaxFormSubmit(e,is_saving){function ucFirst(str){return(str?str[0].toUpperCase()+str.slice(1):str);}
function commaToDot(str){return str.replace(/\,/ig,".");}
var callback_submit_before=$form.data('callback-submit-before'),callback_submit_after=$form.data('callback-submit-after'),callback_check_before=$form.data('callback-check-before'),callback_check_after=$form.data('callback-check-after'),callback_error_before=$form.data('callback-error-before'),callback_error_after=$form.data('callback-error-after');var callback_result;var callback_ajax_before,callback_ajax_after;var ajax_error_reporting;$form.find('.field_input input[data-todot="1"]').each(function(){var fixed_val=commaToDot($(this).val());if($(this).val()!==fixed_val){$(this).val(commaToDot($(this).val()));}});$form.find('.field_input input[data-ucfirst="1"]').each(function(){var fixed_val=ucFirst($(this).val());if($(this).val()!==fixed_val){$(this).val(ucFirst($(this).val()));}});if(!is_saving&&$form.data('no-check-errors')=='1'){return true;}
if(isFormSubmiting($form)){console.log('Skip form inputs check or submit. Still waiting for submit complete');return false;}
if(is_saving){disableSubmit($form);clearTimeout(form_submit_timer);callback_ajax_before=callback_submit_before;callback_ajax_after=callback_submit_after;ajax_error_reporting=alert;}else{callback_ajax_before=callback_check_before;callback_ajax_after=callback_check_after;ajax_error_reporting=console.log;}
if(callback_ajax_before){callback_result=executeCustomCallback(callback_ajax_before,$form,e);if(callback_result===false){if(is_saving){$form.find('.ajax_loader').remove();}
return false;}}
var sending_data=(is_saving?$form.serialize()+'&act=submit':$form.serialize());$.ajax({type:'POST',url:$form.attr('action'),dataType:'json',cache:false,data:sending_data,complete:function(){if(is_saving){$form.trigger('complete_submit');$form.find('.ajax_loader').remove();}},success:function(result){if(is_saving){enableSubmit($form);}
if(callback_ajax_after){callback_result=executeCustomCallback(callback_ajax_after,result,$form);if(callback_result===false){return false;}}
if(result&&Object.prototype.toString.call(result)==='[object Object]'){if(callback_error_before){callback_result=executeCustomCallback(callback_error_before,result,$form);if(callback_result===false){return false;}}
if(result.errors){if(Object.prototype.toString.call(result.errors)==='[object Object]'){handleErrorAnswer(result.errors,$form);}else if(Object.prototype.toString.call(result.errors)==='[object Array]'){removeAllErrorMarkers($form);removeAllWarningMarkers($form);markInputsAsValid($form);enableSubmitButton($form);}
if(result.warnings&&Object.prototype.toString.call(result.warnings)==='[object Object]'){for(var field_name in result.warnings){markInputWarning($form,field_name,result.warnings[field_name]);}}}else{handleErrorAnswer(result,$form);}
markInputsAsValid($form);if(callback_error_after){callback_result=executeCustomCallback(callback_error_after,result,$form);if(callback_result===false){return false;}}}else if(Object.prototype.toString.call(result)=='[object Array]'){if(result.length){markInputsAsValid($form);eval(result[0]);}else{removeAllErrorMarkers($form);removeAllWarningMarkers($form);markInputsAsValid($form);enableSubmitButton($form);}}else if(is_saving){var success_msg=$form.find('.success_msg').text();switch(result){case'edited':enableSubmitButton($form);swal(success_msg,null,"success");break;case'error':swal('.   .',null,"error");break
default:disableSubmitButton($form);swal(' :',result,"error");break;}}},error:function(xhr,str){disableSubmitButton($form);if(is_saving){enableSubmit($form);}
$form.find('.ajax_loader').remove();ajax_error_reporting(' : '+xhr.responseCode+';  : '+str);}});}
if($obj.is('form')){var $form=$obj;$obj=$form.closest('.form_gen_wrapper');}else{var $form=$obj.find('form');}
if($obj.data('noforminit')=='1'){return false;}
var form_submit_timer;$form.on('validate',function(){ajaxFormSubmitDeffer('validate');});$obj.find('.field_input').each(function(){var $input_wrap=$(this),inputSelector=':input:visible:not(:hidden,:disabled,button,[type="file"])',inputEvents='focus.generatorForms blur.generatorForms keydown.generatorForms keyup.generatorForms change.generatorForms input.generatorForms';$input_wrap.on(inputEvents,inputSelector,function(e){var event_name=(e.handleObj?e.handleObj.origType:e.type);console.log('Input event: '+event_name);switch(e.type){case'focusin':case'focus':$('.field_input.focused').removeClass('focused');$input_wrap.addClass('focused');ajaxFormSubmitDeffer(e);$(this).setCursorPosition($(this).val().length);break;case'focusout':case'blur':if(!e.relatedTarget||(e.relatedTarget.nodeName!=="A"||e.relatedTarget.tagName!=="A")||((e.relatedTarget.nodeName==="A"||e.relatedTarget.tagName==="A")&&!$(e.relatedTarget).parents('.message_box').length)){$input_wrap.removeClass('focused');}
ajaxFormSubmitDeffer(e);break;case'keydown':if(!$input_wrap.hasClass('focused')){$input_wrap.addClass('focused');}
if((e.keyCode==13&&!e.shiftKey)||e.keyCode==9){e.preventDefault();}
break;case'keyup':if((e.keyCode==13&&!e.shiftKey)||e.keyCode==9){var $input_collect=$obj.find(inputSelector),input_count=$input_collect.length,index=$input_collect.index($(this));index++;if(index>=input_count){index=0;}
$input_collect.eq(index).focus();}
ajaxFormSubmitDeffer(e);break;case'input':disableSubmitButton($form,false);case'change':ajaxFormSubmitDeffer(e);break;}});});$obj.find('form').on('submit.generatorForms',function(e){console.log('Submiting form');e.preventDefault();disableSubmitButton($form,false);var $button=$form.find('.form_gen_button');$button.after('<img class="ajax_loader" src="/img/ajax_loader.gif" alt="Loading" title="   " width="20" />');ajaxFormSubmit(e,true);});var $focus_input=$form.find('.field_input [autofocus]');if($focus_input.length){$focus_input.focus();}else{$focus_input=$form.find('.field_input :input:visible:enabled').first();$focus_input.focus();}
if(getCookie('client_extra_fields')==='on'){$form.find('.form_row_group[data-remember="1"]').trigger('open');}
$form.find('.date_input_mask').inputmask('99.99.9999');$form.find('.date_operation_new').inputmask('99.99.9999, 99:99');}
$(document).ready(function(){$(document).on('open','.form_row_group',function(event,callback){var $parent_container=$(this);var $set_wrap=$(this).children('.group_row_container');const after_open_callback=function(){$parent_container.addClass('open');if(typeof callback==="function"){callback();}
if($parent_container.data('remember')===1){setCookie('client_extra_fields','on',(new Date).getTime()+(9999*9999*999),'/');}};if($parent_container.data('noanimate')){after_open_callback();}else{$set_wrap.slideDown('fast',after_open_callback);}});$(document).on('close','.form_row_group',function(event,callback){var $parent_container=$(this);var $set_wrap=$(this).children('.group_row_container');var $errors=$parent_container.find('.field_input.error');const after_close_callback=function(){$parent_container.removeClass('open');if(typeof callback==="function"){callback();}
if($parent_container.data('remember')===1){setCookie('client_extra_fields','off',(new Date).getTime()+(9999*9999*999),'/');}};if(!$errors.length){if($parent_container.data('noanimate')){after_close_callback();}else{$set_wrap.slideUp('fast',after_close_callback);}}});$(document).on('click','.form_row_group .group_row_header',function(){var $parent_container=$(this).parent();if($parent_container.hasClass('open')){$parent_container.trigger('close');}else{$parent_container.trigger('open');}});$('.form_gen_wrapper').each(function(){genFormInit($(this));});});;function colResize($table_obj,table_id){$table_obj.colResizable({rememberColumnsSize:true,minWidth:40,liveDrag:true,draggingClass:"dragging",dragCursor:'col-resize',hoverCursor:'col-resize',headerOnly:true,onResize:function(){$table_obj.prev('.JCLRgrips').find('.JCLRgrip').each(function(){var el_num=$(this).index()+1;$("#"+table_id+' tr th:nth-child('+el_num+')').add("#"+table_id+' tr td:nth-child('+el_num+')').css({'backgroundColor':'inherit'});})},onGripCreated:function(){var $JCLRgrips=$table_obj.prev().find('.JCLRgrip');$JCLRgrips.mousedown(function(){var el_num=$JCLRgrips.index($('.dragging'))+1;$("#"+table_id+' tr th:nth-child('+el_num+')').add("#"+table_id+' tr td:nth-child('+el_num+')').css({'backgroundColor':'#E3DED2'});}).mouseup(function(){$JCLRgrips.each(function(){var el_num=$(this).index()+1;$("#"+table_id+' tr th:nth-child('+el_num+')').add("#"+table_id+' tr td:nth-child('+el_num+')').css({'backgroundColor':'inherit'});});});}});}
function MainTableInit(){$('.MainTable').each(function(){var table_id=$(this).attr('id');var $table_obj=$("#"+table_id);var $table_result_box_obj=$table_obj.parent();var table_size=$(this).data('column-size');if(table_size){localforage.getItem(table_id,function(err,value){if(value==null){localforage.setItem(table_id,table_size,function(err){colResize($table_obj,table_id);});}else{colResize($table_obj,table_id);}});}else{colResize($table_obj,table_id);}
$table_result_box_obj.find(".items_on_page").change(function(){location.href=$(this).find(':selected').data('uri');setCookie('items_on_page',$(this).find(':selected').val(),(new Date).getTime()+(99999*999999),'/');});$.keyboard('ctrl+aright',function(){if($table_result_box_obj.find('.nav_last a[href]').length){location.href=$table_result_box_obj.find('.nav_last a').attr('href');}});$.keyboard('ctrl+aleft',function(){if($table_result_box_obj.find('.nav_first a[href]').length){location.href=$table_result_box_obj.find('.nav_first a').attr('href');}});})}
$(document).ready(function(){$(".all_checkbox").closest("th").toggleClass("checkboxs");$(".check_id").closest("td").toggleClass("checkboxs");MainTableInit();var blink_row_id=getCookie('blink_row_id');if(blink_row_id){deleteCookie('blink_row_id');var $new_tr=$('#table_result tr[data-row-id="'+blink_row_id+'"]');var scrollHeight=$new_tr.offset().top;$('html, body').animate({scrollTop:1000},100);$new_tr.animate({backgroundColor:"#f3eee2"},300).animate({backgroundColor:"#ffffff"},300).animate({backgroundColor:"#f3eee2"},300).animate({backgroundColor:"#ffffff"},300).animate({backgroundColor:"#f3eee2"},300).animate({backgroundColor:"#ffffff"},600);}
$(".check_id, #check_all, .check_all_tables_class").prop("checked",false);$("#check_all, .check_all_tables_class").live("click",function(){const $this_table=$(this).closest("table");if(!$("#check_all, .check_all_tables_class").is(":checked")){$this_table.find(".check_id").prop("checked",false).each(function(){$(this).triggerHandler('unchecked');});$(".operation_row").removeClass("operation_row_hover");}else{$this_table.find(".check_id").prop("checked",true).each(function(){$(this).triggerHandler('checked');});$(".operation_row").addClass("operation_row_hover");}});$(".check_id").live("click",function(){$(this).closest(".operation_row").toggleClass("operation_row_hover");$("#check_all, .check_all_tables_class").prop("checked",false);});$('.nav_select').live('change',function(){location.href=$('option:selected',$(this)).data('url');});$('.sort_item').on('contextmenu',function(e){console.log('activate multi-sort function');e.stopPropagation();e.preventDefault();location.href=$(this).data('multi-sort');});});;function tableGenerator(table_id,$container){if(typeof table_id==='undefined'){throw new Error('  ID ');}else if(typeof $container==='undefined'&&typeof tableGenerator.initialized[table_id]==='undefined'){$container=$('#'+table_id);if(!$container.length){throw new Error('  ');}}else if(typeof tableGenerator.initialized[table_id]!=='undefined'&&typeof $container==='undefined'){return tableGenerator.initialized[table_id];}
this.url=$container.data('url');this.identifier=$container.attr('id');this.table_identifier_prefix=null;this.$container=$container;this.$filters=null;this.$tableContainer=null;this.$table=null;this.$footer=null;this.config=null;this.radio_checked_row=null;this.checked_rows={};this.exportTableFiltersLink=function(){return local.getShareLink();};this.on=function(event_name,callback){if(typeof local.events[event_name]!=='undefined'){if(typeof callback==='function'){local.events[event_name].push(callback);}else{throw new Error('  callback');}}else{throw new Error(' : '+event_name);}};this.reload=function(){local.loadData();};this.setCustomFilters=function(custom_filters){local.custom_filters=custom_filters;};this.checkCheckboxInput=function(id){local.checkCheckboxInput(id);};this.uncheckCheckboxInput=function(id){local.uncheckCheckboxInput(id);};this.checkCheckboxInputAll=function(){local.checkCheckboxInputAll();};this.uncheckCheckboxInputAll=function(){local.uncheckCheckboxInputAll();};var instance=this;var local={custom_filters:null,events:{init:[],beforeSaveSettings:[],afterSaveSettings:[],onFilterChange:[],onNavigation:[],beforeLoad:[],afterLoad:[],onRowChecked:[],onRowUnchecked:[],onCheckedChanges:[]},getId:function(){return instance.identifier;},getCurrentPageNumber:function(){return(instance.config?instance.config.current_page:null);},getPagesCount:function(){return(instance.config?instance.config.total_pages:null);},goToPage:function(page_number){instance.config.current_page=page_number;local.loadData();},goNextPage:function(){if(local.getCurrentPageNumber()<local.getPagesCount()){local.goToPage(local.getCurrentPageNumber()+1);return true;}else{return false;}},goPrevPage:function(){if(local.getCurrentPageNumber()>1){local.goToPage(local.getCurrentPageNumber()-1);return true;}else{return false;}},getTablePrefix:function(){return(instance.config?instance.config.table_identifier_prefix:'_tconf_');},getTableFullName:function(){return local.getTablePrefix()+local.getId();},getFilterValues:function(){var formdata=(instance.$filters?instance.$filters.children('form').serializeJSON():{});if(local.custom_filters){console.log('     '+local.getId());$.extend(formdata,local.custom_filters);}
return formdata;},getShareLink:function(){var result={};result[local.getId()]={filters:local.getFilterValues()};return location.href.replace(location.hash,"")+'#'+JSON.stringify(result);},updateUrlHash:function(){var result={};var filters=local.getFilterValues();if(Object.keys(filters).length){result[local.getId()]={filters:filters};location.hash=JSON.stringify(result);}},getConfig:function(){return(instance.config?instance.config:{});},getPreparedData:function(include_columns){include_columns=(typeof include_columns!=='undefined'?include_columns:true);var data={},table_name=local.getTableFullName(),config=local.getConfig();if(!include_columns){delete config['columns'];}
data[table_name]={filters:local.getFilterValues(),config:config};return data;},event:function(event_name,param){if(typeof local.events[event_name]!=='undefined'){instance.$container.triggerHandler(event_name,{table:instance,param:param});for(var item in local.events[event_name]){var event=local.events[event_name][item];if(typeof event==='function'){event(instance,param);}}}else{throw new Error(' ');}},saveSettings:function(){console.log('   '+local.getId());var data=local.getPreparedData();data['action']='save_settings';$.ajax({type:'POST',url:instance.url,data:data,dataType:'json',success:function(result){if(!result.status){alert(result.message);}
local.event('afterSaveSettings',result);},error:function(xhr,str){alert('     .   . ');console.log(' : '+xhr.responseCode+';  : '+str);}});},getPreconfiguredData:function(){var result={};if(location.hash!==''){var preconf_string=location.hash.replace(/^#/,""),table_name=local.getId(),full_table_name=local.getTableFullName(),preconf_json;try{preconf_json=JSON.parse(decodeURIComponent(preconf_string));}catch(e){preconf_json={};}
if(typeof preconf_json[table_name]==='object'){result[full_table_name]=preconf_json[table_name];}}
return result;},loadData:function(){var data;local.event('beforeLoad');if(!local.isLoaded()){data=$.extend(local.getPreparedData(),local.getPreconfiguredData());}else{data=local.getPreparedData();}
$.ajax({type:'POST',url:instance.url,data:data,dataType:'json',beforeSend:function(){if(local.isLoaded()){console.log('    '+local.getId());instance.$tableContainer.addClass('reloading');}else{console.log('     '+local.getId());}},success:function(result,textStatus,jqXHR){if(result.config.table_identifier!==instance.identifier){console.error(': ID    ID   AJAX  ');return this.error(jqXHR,textStatus);}
if(!local.isLoaded()){local.createBaseStructure();local.initEvents();}else{instance.$tableContainer.removeClass('reloading');}
instance.$container.removeClass('failed');local.redrawUI(result);local.event('afterLoad',result);if(instance.config.url_hash){local.updateUrlHash();}},error:function(xhr,str){instance.$container.text('  ').addClass('failed').addClass('loading');alert('     .   . ');console.log(' : '+xhr.responseCode+';  : '+str);}});},changeColumnSortBy:function(column_name,append){if(typeof instance.config!=='undefined'){for(var index in instance.config.columns){var column=instance.config.columns[index];if(column_name===index){if(column.sort_order_type){column.sort_order_type=0;}else if(column.sort_order_type===0){column.sort_order_type=null;}else if(!column.sort_order_type){column.sort_order_type=1;}}else if(!append){column.sort_order_type=null;}}
return true;}else{throw new Error('   ');}},changeColumnWidth:function(column_name,new_width){if(typeof instance.config!=='undefined'){instance.config.columns[column_name].width=new_width;}else{throw new Error('   ');}},showColumn:function(column_name){if(typeof instance.config!=='undefined'){instance.config.columns[column_name].visible=1;}else{throw new Error('   ');}},hideColumn:function(column_name){if(typeof instance.config!=='undefined'){instance.config.columns[column_name].visible=0;}else{throw new Error('   ');}},preserveSelected:function(){if(instance.checked_rows){for(var value_index in instance.checked_rows){local.checkCheckboxInput(value_index);}}
if(instance.radio_checked_row!==null){local.checkRadioInput(instance.radio_checked_row);}},initEvents:function(){var namespace='.table-gen-'+local.getId();$(window).off(namespace);$(instance.$container).off(namespace);$(instance.$tableContainer).off(namespace);$(instance.$container).on('change'+namespace,'.table-generator-filters form input, .table-generator-filters form select',function(e){local.loadData();});$(instance.$container).on('submit'+namespace,'.table-generator-filters form',function(e){e.preventDefault();local.loadData();});$(instance.$container).on('event-custom-changed'+namespace,'.table-generator-filters',function(e){local.loadData();});$(instance.$container).on('click'+namespace,'.fake-headers-container .header.sortable',function(e){if(e.ctrlKey){local.changeColumnSortBy($(this).data('name'),true);}else{local.changeColumnSortBy($(this).data('name'));}
local.loadData();});$(instance.$container).on('click'+namespace,'.fake-headers-container .header .system-check-all',function(e){if($(this).is(":checked")){local.checkCheckboxInputAll();}else{local.uncheckCheckboxInputAll();}});$(window).on('scroll'+namespace,local.updateStickyHeaders);$(instance.$tableContainer).on('scroll'+namespace,local.updateStickyHeaders);$(instance.$container).on('mousedown'+namespace,'.resizers-container .resizer',function(e){$('body').addClass('dragging');var resizer,elemNum,startDragPos=e.pageX;var $currentCol,$currentHeader,$nextCol,$nextHeader,last_column;resizer=$(e.target);elemNum=resizer.data('num');$currentCol=instance.$tableContainer.find('col[data-num="'+parseInt(elemNum)+'"]');$currentCol.css('background-color','#F3EEE2');$currentHeader=instance.$tableContainer.find('.fake-headers-container .header[data-num="'+parseInt(elemNum)+'"]');$nextCol=instance.$tableContainer.find('col[data-num="'+(parseInt(elemNum)+1)+'"]');$nextHeader=instance.$tableContainer.find('.fake-headers-container .header[data-num="'+(parseInt(elemNum)+1)+'"]');last_column=!$nextHeader.length;var curHeaderWidthBeforeResize,nextHeaderWidthBeforeResize,curHeaderWidthAfterResize,nextHeaderWidthAfterResize,resizerPositionBeforeMove,resizerPositionAfterMove;var resizerDiff,minimum_column_size=45,resize_cur_column,resize_next_column,header_width_sum=local.getHeadersWidthSum(),header_min_width_sum=local.getMinimalHeadersWidth();curHeaderWidthBeforeResize=$currentHeader.outerWidth();nextHeaderWidthBeforeResize=$nextHeader.outerWidth();resizerPositionBeforeMove=parseInt(resizer.css('left'));$(window).on('mousemove'+namespace,function(e){resizerDiff=parseInt(e.pageX-startDragPos);resize_cur_column=resize_next_column=false;curHeaderWidthAfterResize=curHeaderWidthBeforeResize+resizerDiff;nextHeaderWidthAfterResize=nextHeaderWidthBeforeResize-resizerDiff;resizerPositionAfterMove=resizerPositionBeforeMove+resizerDiff;if(resizerDiff>=0){resize_cur_column=true;}else if(resizerDiff<0){if(curHeaderWidthAfterResize>=minimum_column_size&&(!last_column||(last_column&&((header_width_sum+resizerDiff)>=header_min_width_sum)))){resize_cur_column=true;if(!last_column&&((header_width_sum+resizerDiff)<header_min_width_sum)){resize_next_column=true;nextHeaderWidthAfterResize=nextHeaderWidthBeforeResize-(resizerDiff+header_width_sum-header_min_width_sum);}}else if(last_column&&((header_width_sum+resizerDiff)<header_min_width_sum)){var fixedCurColWidth=header_min_width_sum-(header_width_sum-curHeaderWidthBeforeResize);curHeaderWidthAfterResize=(fixedCurColWidth>minimum_column_size?fixedCurColWidth:minimum_column_size);resize_cur_column=true;}}
if(resize_cur_column||resize_next_column){if(resize_cur_column){$currentHeader.outerWidth(curHeaderWidthAfterResize);$currentCol.width(curHeaderWidthAfterResize);var current_column_name=$currentHeader.data('name');local.changeColumnWidth(current_column_name,curHeaderWidthAfterResize);}
if(resize_next_column){$nextHeader.outerWidth(nextHeaderWidthAfterResize);$nextCol.width(nextHeaderWidthAfterResize);var next_column_name=$nextHeader.data('name');local.changeColumnWidth(next_column_name,nextHeaderWidthAfterResize);}
resizer.css('left',resizerPositionAfterMove+'px');local.updateStickyHeaders();}});$(window).on('mouseup'+namespace,function(e){$currentCol.css('background-color','');$('body').removeClass('dragging');$(window).off('mousemove'+namespace);$(window).off('mouseup'+namespace);local.saveSettings();});});$(instance.$container).on('change'+namespace,'.table-generator-footer .pagination select[name="_page"]',function(e){local.goToPage(parseInt($(this).val())+1);});$(instance.$container).on('change'+namespace,'.table-generator-footer .pagination select[name="_limit"]',function(e){setCookie('items_on_page',$(this).val(),0,'/');local.loadData();});$(instance.$container).on('click'+namespace,'.table-generator-footer .pagination .table-generator-f-prev',function(e){local.goPrevPage();});$(instance.$container).on('click'+namespace,'.table-generator-footer .pagination .table-generator-f-next',function(e){local.goNextPage();});$(window).on('keydown'+namespace,function(e){var keyCode=e.keyCode,left_arrow=37,right_arrow=39;if(e.ctrlKey&&keyCode===left_arrow){e.preventDefault();local.goPrevPage();}else if(e.ctrlKey&&keyCode===right_arrow){e.preventDefault();local.goNextPage();}});$(instance.$container).on('click'+namespace,'.download-table',function(e){var url=instance.url,table_name=local.getTableFullName(),data={action:'download_current'};data[table_name]={filters:local.getFilterValues(),config:{current_page:instance.config.current_page}};url+=(url.indexOf('?')>=0?'&':'?')+$.param(data);window.open(url,'_blank');});$(instance.$container).on('click'+namespace,'.table-settings-show',function(e){local.showSettingsPopup();});$(instance.$container).on('click'+namespace,'.generator-table-container table tbody td',function(e){var $radio_input=$(this).parent().find('input.system[type="radio"]');if($radio_input.length){local.checkRadioInput($radio_input.val());}});$(instance.$container).on('click'+namespace,'.generator-table-container table tbody td input.system[type="radio"]',function(e){e.stopPropagation();local.checkRadioInput($(this).val());});$(instance.$container).on('click'+namespace,'.generator-table-container table tbody td input.system[type="checkbox"]',function(e){e.stopPropagation();var value=$(this).val();if($(this).is(':checked')){local.checkCheckboxInput(value);}else{local.uncheckCheckboxInput(value);}});},toggleCheckboxInput:function(id_value){if(typeof instance.checked_rows[id_value]==='undefined'){local.checkCheckboxInput(id_value);}else{local.uncheckCheckboxInput(id_value);}},checkCheckboxInput:function(id_value){var $input=$(instance.$table).find('tbody td input.system[type="checkbox"][value="'+id_value+'"]'),$tr=$input.closest('tr');if($tr.length){$input.prop('checked',true);$tr.addClass('c_selected');instance.checked_rows[id_value]=id_value;local.event('onRowChecked',$input);local.event('onCheckedChanges',$input);}else{return false;}},uncheckCheckboxInput:function(id_value){var $input=$(instance.$table).find('tbody td input.system[type="checkbox"][value="'+id_value+'"]'),$tr=$input.closest('tr');if($tr.length){$input.prop('checked',false);$tr.removeClass('c_selected');delete instance.checked_rows[id_value];local.event('onRowUnchecked',$input);local.event('onCheckedChanges',$input);}else{return false;}},checkCheckboxInputAll:function(){var $input=$(instance.$table).find('tbody td input.system[type="checkbox"]');$input.each(function(){local.checkCheckboxInput($(this).val());});},uncheckCheckboxInputAll:function(){var $input=$(instance.$table).find('tbody td input.system[type="checkbox"]');$input.each(function(){local.uncheckCheckboxInput($(this).val());});},checkRadioInput:function(id_value){var $input=$(instance.$table).find('tbody td input.system[type="radio"][value="'+id_value+'"]'),$tr=$input.closest('tr');if($tr.length){$(instance.$table).find('tbody tr.r_selected').removeClass('r_selected');$(instance.$table).find('tbody td input.system[type="radio"]:checked').prop('checked',false);$input.prop('checked',true).change();$tr.addClass('r_selected');instance.radio_checked_row=id_value;local.event('onRowChecked',$input);local.event('onCheckedChanges',$input);}else{return false;}},redrawResizers:function(){var $resizer,$fake_headers,new_position=0;$fake_headers=instance.$tableContainer.find('.fake-headers-container .header');$fake_headers.each(function(){new_position+=$(this).outerWidth();$resizer=instance.$tableContainer.find('.resizers-container .resizer[data-num="'+parseInt($(this).data('num'))+'"]').css('left',new_position+'px');});},updateStickyHeaders:function(){var axis_x_scroll=instance.$tableContainer.scrollLeft()*-1;var $fake_headers_container=instance.$tableContainer.find('.fake-headers-container');var $fake_headers=$fake_headers_container.children('.header');var $resizers_container=instance.$tableContainer.find('.resizers-container');var $resizers=$resizers_container.children('.resizer');if(!instance.config.sticky_header||window.pageYOffset<(instance.$tableContainer.offset()['top'])){if($fake_headers_container.css('position')==="fixed"){$fake_headers.css('transform','');$resizers.css('transform','');$fake_headers_container.css({position:"absolute",zIndex:0});$resizers_container.css({position:"absolute",zIndex:1});$fake_headers_container.css('width','');$resizers_container.css('width','');}}else if(instance.config.sticky_header){$fake_headers.css('transform','translate('+axis_x_scroll+'px,0)');$resizers.css('transform','translate('+axis_x_scroll+'px,0)');if($fake_headers_container.css('position')!=="fixed"){$fake_headers_container.css({position:"fixed",zIndex:1000});$resizers_container.css({zIndex:1001,position:"fixed"});$fake_headers_container.width(instance.$tableContainer.width());$resizers_container.width(instance.$tableContainer.width());}}
local.redrawResizers();},isLoaded:function(){return instance.$container.hasClass('loaded');},createBaseStructure:function(){if(local.isLoaded()){return;}else{instance.$container.html('<div class="table-generator-filters cf"></div><div class="generator-table-container"><table></table></div><div id="mainpage_footer" class="table-generator-footer cf"></div>');instance.$container.removeClass('loading').addClass('loaded');instance.$filters=instance.$container.children('.table-generator-filters');instance.$tableContainer=instance.$container.children('.generator-table-container');instance.$table=instance.$tableContainer.children('table');instance.$footer=instance.$container.children('.table-generator-footer');}},redrawUI:function(data){instance.config=data.config;local.updateFilters(data.filters);local.updateFakeHeader(data.fake_header);local.updateHeader(data.header);local.updateFooter(data.footer);local.updateBody(data.body);if(typeof instance.config.preserve_selected_on_resync!=='undefined'&&instance.config.preserve_selected_on_resync){local.preserveSelected();}
local.fixMinimalHeaderWidth();local.updateStickyHeaders();instance.$container.find('.datepicker').datepicker({dateFormat:'dd.mm.yy'});},updateFilters:function(filters){instance.$filters.html(filters);},updateFakeHeader:function(fake_header){instance.$tableContainer.children('.fake-headers-container,.resizers-container').remove();instance.$tableContainer.append(fake_header);},getMinimalHeadersWidth:function(){return instance.$tableContainer.width();},getHeadersWidthSum:function(){var headers_total_width_sum=0;var $headers=instance.$tableContainer.find('.fake-headers-container .header');$headers.each(function(){headers_total_width_sum+=$(this).outerWidth();});return headers_total_width_sum;},getColElementByNumber:function(number){return instance.$table.find('col[data-num="'+parseInt(number)+'"]');},getColElementByName:function(col_name){return instance.$table.find('col[data-name="'+col_name+'"]');},getHeaderElementByNumber:function(number){return instance.$tableContainer.find('.fake-headers-container .header[data-num="'+parseInt(number)+'"]');},getHeaderElementByName:function(col_name){return instance.$tableContainer.find('.fake-headers-container .header[data-name="'+col_name+'"]');},fixMinimalHeaderWidth:function(){var minimum_headers_width_sum=local.getMinimalHeadersWidth();var headers_total_width_sum=local.getHeadersWidthSum();var $headers=instance.$tableContainer.find('.fake-headers-container .header');if(minimum_headers_width_sum>headers_total_width_sum){var diff=minimum_headers_width_sum-headers_total_width_sum;var per=parseInt(diff/$headers.length);var remain=diff%$headers.length;$headers.each(function(){var new_size=$(this).outerWidth()+per;var $col=instance.$tableContainer.find('col[data-num="'+parseInt($(this).data('num'))+'"]');if(remain>0){new_size+=remain;remain=0;}
$col.width(new_size);$(this).outerWidth(new_size);var current_column_name=$(this).data('name');local.changeColumnWidth(current_column_name,new_size);});local.saveSettings();}},updateHeader:function(header){instance.$table.children('thead').remove();instance.$table.children('colgroup').remove();instance.$table.prepend(header);},updateFooter:function(footer){instance.$footer.html(footer);},updateBody:function(body){instance.$table.children('tbody').remove();instance.$table.append(body);},showSettingsPopup:function(){var namespace='.table-gen-'+local.getId(),html,columns=[],table_opts,buttons;for(var column_name in instance.config.columns){var current_column=instance.config.columns[column_name];if(current_column.row_number_column!=='1'&&current_column.row_number_column!==1){var column_html_el='<div class="table-column"><label>'
+'<input type="checkbox" data-index="'+current_column.index_number+'" name="'+column_name+'" value="show" '
+(current_column.always_visible?'disabled="disabled" title="  "':'')+' '
+(current_column.always_visible||current_column.visible?'checked':'')+' /> '
+(current_column.title!==''?current_column.title:'< >')
+'</label></div>';columns.push(column_html_el);}}
table_opts=['<div class="table-option"><label>'
+'<input type="checkbox" name="sticky_header" value="on" '+(instance.config.sticky_header?'checked':'')+' /> '
+' </label></div>','<div class="table-option">'
+'<label><input type="checkbox" name="row_number" value="on" '+(instance.config.row_number?'checked':'')+' /> '
+'  </label></div>','<div class="table-option">'
+'<label><input type="checkbox" name="squashed_rows" value="off" '+(instance.config.squashed_rows?'':'checked')+' /> '
+'   </label></div>'];buttons=['<div class="button save-button button_green"></div>'];html='<div class="gen-table-settings" data-id="'+local.getId()+'">'
+'<div class="columns">'
+'<h2 class="header">  </h2>'
+'<div class="notice-container">     ( ) .   ( ). !     .         ,       .</div>'
+columns.join('')
+'</div>'
+'<div class="options">'+'<h2 class="header"> </h2>'+table_opts.join('')+'</div>'
+'<div class="buttons">'+buttons.join('')+'</div>'
+'</div>';$.fancybox({content:html,onComplete:function(){$('.gen-table-settings .columns').sortable({items:"> .table-column",delay:150,cursor:"move"});$('.gen-table-settings .columns').disableSelection();$('.gen-table-settings .save-button').on('click'+namespace,function(){var column_position=1,$columns=$('.gen-table-settings .columns .table-column input');var $options=$('.gen-table-settings .options');$columns.each(function(){var column_name=$(this).attr('name');var visible=$(this).is(':checked');if(typeof instance.config.columns[column_name]!=='undefined'){var current_column=instance.config.columns[column_name];current_column.visible=(visible?1:0);current_column.index_number=column_position;column_position++;}});instance.config.sticky_header=($options.find('input[name="sticky_header"]').is(':checked')?1:0);instance.config.row_number=($options.find('input[name="row_number"]').is(':checked')?1:0);instance.config.squashed_rows=($options.find('input[name="squashed_rows"]').is(':checked')?0:1);$.fancybox.close();local.loadData();});}});}};setTimeout(function(){local.loadData();});}
tableGenerator.initialized={};tableGenerator.init=function(){var $table_containers=$('.table-generator-ajax');console.log(' ');if($table_containers.length){$table_containers.each(function(){if($(this).hasClass('loaded')){return;}
$(this).text(' ').addClass('loading');instance=new tableGenerator($(this).attr('id'),$(this));tableGenerator.initialized[$(this).attr('id')]=instance;});return tableGenerator.initialized;}else{console.log('    ');}};;
/*!
* jquery.inputmask.bundle.js
* https://github.com/RobinHerbots/jquery.inputmask
* Copyright (c) 2010 - 2016 Robin Herbots
* Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
* Version: 3.3.3
*/
!function($){function Inputmask(alias,options){return this instanceof Inputmask?($.isPlainObject(alias)?options=alias:(options=options||{},options.alias=alias),this.el=void 0,this.opts=$.extend(!0,{},this.defaults,options),this.noMasksCache=options&&void 0!==options.definitions,this.userOptions=options||{},this.events={},void resolveAlias(this.opts.alias,options,this.opts)):new Inputmask(alias,options);}
function isInputEventSupported(eventName){var el=document.createElement("input"),evName="on"+eventName,isSupported=evName in el;return isSupported||(el.setAttribute(evName,"return;"),isSupported="function"==typeof el[evName]),el=null,isSupported;}
function isElementTypeSupported(input,opts){var elementType=input.getAttribute("type"),isSupported="INPUT"===input.tagName&&$.inArray(elementType,opts.supportsInputType)!==-1||input.isContentEditable||"TEXTAREA"===input.tagName;if(!isSupported&&"INPUT"===input.tagName){var el=document.createElement("input");el.setAttribute("type",elementType),isSupported="text"===el.type,el=null;}
return isSupported;}
function resolveAlias(aliasStr,options,opts){var aliasDefinition=opts.aliases[aliasStr];return aliasDefinition?(aliasDefinition.alias&&resolveAlias(aliasDefinition.alias,void 0,opts),$.extend(!0,opts,aliasDefinition),$.extend(!0,opts,options),!0):(null===opts.mask&&(opts.mask=aliasStr),!1);}
function importAttributeOptions(npt,opts,userOptions){function importOption(option,optionData){optionData=void 0!==optionData?optionData:npt.getAttribute("data-inputmask-"+option),null!==optionData&&("string"==typeof optionData&&(0===option.indexOf("on")?optionData=window[optionData]:"false"===optionData?optionData=!1:"true"===optionData&&(optionData=!0)),userOptions[option]=optionData);}
var option,dataoptions,optionData,p,attrOptions=npt.getAttribute("data-inputmask");if(attrOptions&&""!==attrOptions&&(attrOptions=attrOptions.replace(new RegExp("'","g"),'"'),dataoptions=JSON.parse("{"+attrOptions+"}")),dataoptions){optionData=void 0;for(p in dataoptions)if("alias"===p.toLowerCase()){optionData=dataoptions[p];break;}}
importOption("alias",optionData),userOptions.alias&&resolveAlias(userOptions.alias,userOptions,opts);for(option in opts){if(dataoptions){optionData=void 0;for(p in dataoptions)if(p.toLowerCase()===option.toLowerCase()){optionData=dataoptions[p];break;}}
importOption(option,optionData);}
return $.extend(!0,opts,userOptions),opts;}
function generateMaskSet(opts,nocache){function analyseMask(mask){function MaskToken(isGroup,isOptional,isQuantifier,isAlternator){this.matches=[],this.isGroup=isGroup||!1,this.isOptional=isOptional||!1,this.isQuantifier=isQuantifier||!1,this.isAlternator=isAlternator||!1,this.quantifier={min:1,max:1};}
function insertTestDefinition(mtoken,element,position){var maskdef=opts.definitions[element];position=void 0!==position?position:mtoken.matches.length;var prevMatch=mtoken.matches[position-1];if(maskdef&&!escaped){maskdef.placeholder=$.isFunction(maskdef.placeholder)?maskdef.placeholder(opts):maskdef.placeholder;for(var prevalidators=maskdef.prevalidator,prevalidatorsL=prevalidators?prevalidators.length:0,i=1;i<maskdef.cardinality;i++){var prevalidator=prevalidatorsL>=i?prevalidators[i-1]:[],validator=prevalidator.validator,cardinality=prevalidator.cardinality;mtoken.matches.splice(position++,0,{fn:validator?"string"==typeof validator?new RegExp(validator):new function(){this.test=validator;}():new RegExp("."),cardinality:cardinality?cardinality:1,optionality:mtoken.isOptional,newBlockMarker:void 0===prevMatch||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element}),prevMatch=mtoken.matches[position-1];}
mtoken.matches.splice(position++,0,{fn:maskdef.validator?"string"==typeof maskdef.validator?new RegExp(maskdef.validator):new function(){this.test=maskdef.validator;}():new RegExp("."),cardinality:maskdef.cardinality,optionality:mtoken.isOptional,newBlockMarker:void 0===prevMatch||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element});}else mtoken.matches.splice(position++,0,{fn:null,cardinality:0,optionality:mtoken.isOptional,newBlockMarker:void 0===prevMatch||prevMatch.def!==element,casing:null,def:opts.staticDefinitionSymbol||element,placeholder:void 0!==opts.staticDefinitionSymbol?element:void 0,mask:element}),escaped=!1;}
function verifyGroupMarker(lastMatch,isOpenGroup){lastMatch.isGroup&&(lastMatch.isGroup=!1,insertTestDefinition(lastMatch,opts.groupmarker.start,0),isOpenGroup!==!0&&insertTestDefinition(lastMatch,opts.groupmarker.end));}
function maskCurrentToken(m,currentToken,lastMatch,extraCondition){currentToken.matches.length>0&&(void 0===extraCondition||extraCondition)&&(lastMatch=currentToken.matches[currentToken.matches.length-1],verifyGroupMarker(lastMatch)),insertTestDefinition(currentToken,m);}
function defaultCase(){if(openenings.length>0){if(currentOpeningToken=openenings[openenings.length-1],maskCurrentToken(m,currentOpeningToken,lastMatch,!currentOpeningToken.isAlternator),currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++)alternator.matches[mndx].isGroup=!1;openenings.length>0?(currentOpeningToken=openenings[openenings.length-1],currentOpeningToken.matches.push(alternator)):currentToken.matches.push(alternator);}}else maskCurrentToken(m,currentToken,lastMatch);}
function reverseTokens(maskToken){function reverseStatic(st){return st===opts.optionalmarker.start?st=opts.optionalmarker.end:st===opts.optionalmarker.end?st=opts.optionalmarker.start:st===opts.groupmarker.start?st=opts.groupmarker.end:st===opts.groupmarker.end&&(st=opts.groupmarker.start),st;}
maskToken.matches=maskToken.matches.reverse();for(var match in maskToken.matches){var intMatch=parseInt(match);if(maskToken.matches[match].isQuantifier&&maskToken.matches[intMatch+1]&&maskToken.matches[intMatch+1].isGroup){var qt=maskToken.matches[match];maskToken.matches.splice(match,1),maskToken.matches.splice(intMatch+1,0,qt);}
void 0!==maskToken.matches[match].matches?maskToken.matches[match]=reverseTokens(maskToken.matches[match]):maskToken.matches[match]=reverseStatic(maskToken.matches[match]);}
return maskToken;}
for(var match,m,openingToken,currentOpeningToken,alternator,lastMatch,groupToken,tokenizer=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,escaped=!1,currentToken=new MaskToken(),openenings=[],maskTokens=[];match=tokenizer.exec(mask);)if(m=match[0],escaped)defaultCase();else switch(m.charAt(0)){case opts.escapeChar:escaped=!0;break;case opts.optionalmarker.end:case opts.groupmarker.end:if(openingToken=openenings.pop(),void 0!==openingToken)if(openenings.length>0){if(currentOpeningToken=openenings[openenings.length-1],currentOpeningToken.matches.push(openingToken),currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++)alternator.matches[mndx].isGroup=!1;openenings.length>0?(currentOpeningToken=openenings[openenings.length-1],currentOpeningToken.matches.push(alternator)):currentToken.matches.push(alternator);}}else currentToken.matches.push(openingToken);else defaultCase();break;case opts.optionalmarker.start:openenings.push(new MaskToken((!1),(!0)));break;case opts.groupmarker.start:openenings.push(new MaskToken((!0)));break;case opts.quantifiermarker.start:var quantifier=new MaskToken((!1),(!1),(!0));m=m.replace(/[{}]/g,"");var mq=m.split(","),mq0=isNaN(mq[0])?mq[0]:parseInt(mq[0]),mq1=1===mq.length?mq0:isNaN(mq[1])?mq[1]:parseInt(mq[1]);if("*"!==mq1&&"+"!==mq1||(mq0="*"===mq1?0:1),quantifier.quantifier={min:mq0,max:mq1},openenings.length>0){var matches=openenings[openenings.length-1].matches;match=matches.pop(),match.isGroup||(groupToken=new MaskToken((!0)),groupToken.matches.push(match),match=groupToken),matches.push(match),matches.push(quantifier);}else match=currentToken.matches.pop(),match.isGroup||(groupToken=new MaskToken((!0)),groupToken.matches.push(match),match=groupToken),currentToken.matches.push(match),currentToken.matches.push(quantifier);break;case opts.alternatormarker:openenings.length>0?(currentOpeningToken=openenings[openenings.length-1],lastMatch=currentOpeningToken.matches.pop()):lastMatch=currentToken.matches.pop(),lastMatch.isAlternator?openenings.push(lastMatch):(alternator=new MaskToken((!1),(!1),(!1),(!0)),alternator.matches.push(lastMatch),openenings.push(alternator));break;default:defaultCase();}
for(;openenings.length>0;)openingToken=openenings.pop(),verifyGroupMarker(openingToken,!0),currentToken.matches.push(openingToken);return currentToken.matches.length>0&&(lastMatch=currentToken.matches[currentToken.matches.length-1],verifyGroupMarker(lastMatch),maskTokens.push(currentToken)),opts.numericInput&&reverseTokens(maskTokens[0]),maskTokens;}
function generateMask(mask,metadata){if(null!==mask&&""!==mask){if(1===mask.length&&opts.greedy===!1&&0!==opts.repeat&&(opts.placeholder=""),opts.repeat>0||"*"===opts.repeat||"+"===opts.repeat){var repeatStart="*"===opts.repeat?0:"+"===opts.repeat?1:opts.repeat;mask=opts.groupmarker.start+mask+opts.groupmarker.end+opts.quantifiermarker.start+repeatStart+","+opts.repeat+opts.quantifiermarker.end;}
var masksetDefinition;return void 0===Inputmask.prototype.masksCache[mask]||nocache===!0?(masksetDefinition={mask:mask,maskToken:analyseMask(mask),validPositions:{},_buffer:void 0,buffer:void 0,tests:{},metadata:metadata,maskLength:void 0},nocache!==!0&&(Inputmask.prototype.masksCache[opts.numericInput?mask.split("").reverse().join(""):mask]=masksetDefinition,masksetDefinition=$.extend(!0,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split("").reverse().join(""):mask]))):masksetDefinition=$.extend(!0,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split("").reverse().join(""):mask]),masksetDefinition;}}
function preProcessMask(mask){return mask=mask.toString();}
var ms;if($.isFunction(opts.mask)&&(opts.mask=opts.mask(opts)),$.isArray(opts.mask)){if(opts.mask.length>1){opts.keepStatic=null===opts.keepStatic||opts.keepStatic;var altMask="(";return $.each(opts.numericInput?opts.mask.reverse():opts.mask,function(ndx,msk){altMask.length>1&&(altMask+=")|("),altMask+=preProcessMask(void 0===msk.mask||$.isFunction(msk.mask)?msk:msk.mask);}),altMask+=")",generateMask(altMask,opts.mask);}
opts.mask=opts.mask.pop();}
return opts.mask&&(ms=void 0===opts.mask.mask||$.isFunction(opts.mask.mask)?generateMask(preProcessMask(opts.mask),opts.mask):generateMask(preProcessMask(opts.mask.mask),opts.mask)),ms;}
function maskScope(actionObj,maskset,opts){function getMaskTemplate(baseOnInput,minimalPos,includeInput){minimalPos=minimalPos||0;var ndxIntlzr,test,testPos,maskTemplate=[],pos=0,lvp=getLastValidPosition();maxLength=void 0!==el?el.maxLength:void 0,maxLength===-1&&(maxLength=void 0);do{if(baseOnInput===!0&&getMaskSet().validPositions[pos]){var validPos=getMaskSet().validPositions[pos];test=validPos.match,ndxIntlzr=validPos.locator.slice(),maskTemplate.push(includeInput===!0?validPos.input:getPlaceholder(pos,test));}else testPos=getTestTemplate(pos,ndxIntlzr,pos-1),test=testPos.match,ndxIntlzr=testPos.locator.slice(),(opts.jitMasking===!1||pos<lvp||isFinite(opts.jitMasking)&&opts.jitMasking>pos)&&maskTemplate.push(getPlaceholder(pos,test));pos++;}while((void 0===maxLength||pos<maxLength)&&(null!==test.fn||""!==test.def)||minimalPos>pos);return""===maskTemplate[maskTemplate.length-1]&&maskTemplate.pop(),getMaskSet().maskLength=pos+1,maskTemplate;}
function getMaskSet(){return maskset;}
function resetMaskSet(soft){var maskset=getMaskSet();maskset.buffer=void 0,soft!==!0&&(maskset._buffer=void 0,maskset.validPositions={},maskset.p=0);}
function getLastValidPosition(closestTo,strict,validPositions){var before=-1,after=-1,valids=validPositions||getMaskSet().validPositions;void 0===closestTo&&(closestTo=-1);for(var posNdx in valids){var psNdx=parseInt(posNdx);valids[psNdx]&&(strict||null!==valids[psNdx].match.fn)&&(psNdx<=closestTo&&(before=psNdx),psNdx>=closestTo&&(after=psNdx));}
return before!==-1&&closestTo-before>1||after<closestTo?before:after;}
function stripValidPositions(start,end,nocheck,strict){function IsEnclosedStatic(pos){var posMatch=getMaskSet().validPositions[pos];if(void 0!==posMatch&&null===posMatch.match.fn){var prevMatch=getMaskSet().validPositions[pos-1],nextMatch=getMaskSet().validPositions[pos+1];return void 0!==prevMatch&&void 0!==nextMatch;}
return!1;}
var i,startPos=start,positionsClone=$.extend(!0,{},getMaskSet().validPositions),needsValidation=!1;for(getMaskSet().p=start,i=end-1;i>=startPos;i--)void 0!==getMaskSet().validPositions[i]&&(nocheck===!0||!IsEnclosedStatic(i)&&opts.canClearPosition(getMaskSet(),i,getLastValidPosition(),strict,opts)!==!1)&&delete getMaskSet().validPositions[i];for(resetMaskSet(!0),i=startPos+1;i<=getLastValidPosition();){for(;void 0!==getMaskSet().validPositions[startPos];)startPos++;var s=getMaskSet().validPositions[startPos];if(i<startPos&&(i=startPos+1),void 0===getMaskSet().validPositions[i]&&isMask(i)||void 0!==s)i++;else{var t=getTestTemplate(i);needsValidation===!1&&positionsClone[startPos]&&positionsClone[startPos].match.def===t.match.def?(getMaskSet().validPositions[startPos]=$.extend(!0,{},positionsClone[startPos]),getMaskSet().validPositions[startPos].input=t.input,delete getMaskSet().validPositions[i],i++):positionCanMatchDefinition(startPos,t.match.def)?isValid(startPos,t.input||getPlaceholder(i),!0)!==!1&&(delete getMaskSet().validPositions[i],i++,needsValidation=!0):isMask(i)||(i++,startPos--),startPos++;}}
resetMaskSet(!0);}
function determineTestTemplate(tests,guessNextBest){for(var testPos,testPositions=tests,lvp=getLastValidPosition(),lvTest=getMaskSet().validPositions[lvp]||getTests(0)[0],lvTestAltArr=void 0!==lvTest.alternation?lvTest.locator[lvTest.alternation].toString().split(","):[],ndx=0;ndx<testPositions.length&&(testPos=testPositions[ndx],!(testPos.match&&(opts.greedy&&testPos.match.optionalQuantifier!==!0||(testPos.match.optionality===!1||testPos.match.newBlockMarker===!1)&&testPos.match.optionalQuantifier!==!0)&&(void 0===lvTest.alternation||lvTest.alternation!==testPos.alternation||void 0!==testPos.locator[lvTest.alternation]&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(","),lvTestAltArr)))||guessNextBest===!0&&(null!==testPos.match.fn||/[0-9a-bA-Z]/.test(testPos.match.def)));ndx++);return testPos;}
function getTestTemplate(pos,ndxIntlzr,tstPs){return getMaskSet().validPositions[pos]||determineTestTemplate(getTests(pos,ndxIntlzr?ndxIntlzr.slice():ndxIntlzr,tstPs));}
function getTest(pos){return getMaskSet().validPositions[pos]?getMaskSet().validPositions[pos]:getTests(pos)[0];}
function positionCanMatchDefinition(pos,def){for(var valid=!1,tests=getTests(pos),tndx=0;tndx<tests.length;tndx++)if(tests[tndx].match&&tests[tndx].match.def===def){valid=!0;break;}
return valid;}
function selectBestMatch(pos,alternateNdx){var bestMatch,indexPos;return(getMaskSet().tests[pos]||getMaskSet().validPositions[pos])&&$.each(getMaskSet().tests[pos]||[getMaskSet().validPositions[pos]],function(ndx,lmnt){var ndxPos=lmnt.alternation?lmnt.locator[lmnt.alternation].toString().indexOf(alternateNdx):-1;(void 0===indexPos||ndxPos<indexPos)&&ndxPos!==-1&&(bestMatch=lmnt,indexPos=ndxPos);}),bestMatch;}
function getTests(pos,ndxIntlzr,tstPs){function resolveTestFromToken(maskToken,ndxInitializer,loopNdx,quantifierRecurse){function handleMatch(match,loopNdx,quantifierRecurse){function isFirstMatch(latestMatch,tokenGroup){var firstMatch=0===$.inArray(latestMatch,tokenGroup.matches);return firstMatch||$.each(tokenGroup.matches,function(ndx,match){if(match.isQuantifier===!0&&(firstMatch=isFirstMatch(latestMatch,tokenGroup.matches[ndx-1])))return!1;}),firstMatch;}
function resolveNdxInitializer(pos,alternateNdx){var bestMatch=selectBestMatch(pos,alternateNdx);return bestMatch?bestMatch.locator.slice(bestMatch.alternation+1):void 0;}
function staticCanMatchDefinition(source,target){return null===source.match.fn&&null!==target.match.fn&&target.match.fn.test(source.match.def,getMaskSet(),pos,!1,opts,!1);}
if(testPos>1e4)throw"Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. "+getMaskSet().mask;if(testPos===pos&&void 0===match.matches)return matches.push({match:match,locator:loopNdx.reverse(),cd:cacheDependency}),!0;if(void 0!==match.matches){if(match.isGroup&&quantifierRecurse!==match){if(match=handleMatch(maskToken.matches[$.inArray(match,maskToken.matches)+1],loopNdx))return!0;}else if(match.isOptional){var optionalToken=match;if(match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse)){if(latestMatch=matches[matches.length-1].match,!isFirstMatch(latestMatch,optionalToken))return!0;insertStop=!0,testPos=pos;}}else if(match.isAlternator){var maltMatches,alternateToken=match,malternateMatches=[],currentMatches=matches.slice(),loopNdxCnt=loopNdx.length,altIndex=ndxInitializer.length>0?ndxInitializer.shift():-1;if(altIndex===-1||"string"==typeof altIndex){var amndx,currentPos=testPos,ndxInitializerClone=ndxInitializer.slice(),altIndexArr=[];if("string"==typeof altIndex)altIndexArr=altIndex.split(",");else for(amndx=0;amndx<alternateToken.matches.length;amndx++)altIndexArr.push(amndx);for(var ndx=0;ndx<altIndexArr.length;ndx++){if(amndx=parseInt(altIndexArr[ndx]),matches=[],ndxInitializer=resolveNdxInitializer(testPos,amndx)||ndxInitializerClone.slice(),match=handleMatch(alternateToken.matches[amndx]||maskToken.matches[amndx],[amndx].concat(loopNdx),quantifierRecurse)||match,match!==!0&&void 0!==match&&altIndexArr[altIndexArr.length-1]<alternateToken.matches.length){var ntndx=$.inArray(match,maskToken.matches)+1;maskToken.matches.length>ntndx&&(match=handleMatch(maskToken.matches[ntndx],[ntndx].concat(loopNdx.slice(1,loopNdx.length)),quantifierRecurse),match&&(altIndexArr.push(ntndx.toString()),$.each(matches,function(ndx,lmnt){lmnt.alternation=loopNdx.length-1;})));}
maltMatches=matches.slice(),testPos=currentPos,matches=[];for(var ndx1=0;ndx1<maltMatches.length;ndx1++){var altMatch=maltMatches[ndx1],hasMatch=!1;altMatch.alternation=altMatch.alternation||loopNdxCnt;for(var ndx2=0;ndx2<malternateMatches.length;ndx2++){var altMatch2=malternateMatches[ndx2];if(("string"!=typeof altIndex||$.inArray(altMatch.locator[altMatch.alternation].toString(),altIndexArr)!==-1)&&(altMatch.match.def===altMatch2.match.def||staticCanMatchDefinition(altMatch,altMatch2))){hasMatch=altMatch.match.mask===altMatch2.match.mask,altMatch2.locator[altMatch.alternation].toString().indexOf(altMatch.locator[altMatch.alternation])===-1&&(altMatch2.locator[altMatch.alternation]=altMatch2.locator[altMatch.alternation]+","+altMatch.locator[altMatch.alternation],altMatch2.alternation=altMatch.alternation,null==altMatch.match.fn&&(altMatch2.na=altMatch2.na||altMatch.locator[altMatch.alternation].toString(),altMatch2.na.indexOf(altMatch.locator[altMatch.alternation])===-1&&(altMatch2.na=altMatch2.na+","+altMatch.locator[altMatch.alternation])));break;}}
hasMatch||malternateMatches.push(altMatch);}}"string"==typeof altIndex&&(malternateMatches=$.map(malternateMatches,function(lmnt,ndx){if(isFinite(ndx)){var mamatch,alternation=lmnt.alternation,altLocArr=lmnt.locator[alternation].toString().split(",");lmnt.locator[alternation]=void 0,lmnt.alternation=void 0;for(var alndx=0;alndx<altLocArr.length;alndx++)mamatch=$.inArray(altLocArr[alndx],altIndexArr)!==-1,mamatch&&(void 0!==lmnt.locator[alternation]?(lmnt.locator[alternation]+=",",lmnt.locator[alternation]+=altLocArr[alndx]):lmnt.locator[alternation]=parseInt(altLocArr[alndx]),lmnt.alternation=alternation);if(void 0!==lmnt.locator[alternation])return lmnt;}})),matches=currentMatches.concat(malternateMatches),testPos=pos,insertStop=matches.length>0,ndxInitializer=ndxInitializerClone.slice();}else match=handleMatch(alternateToken.matches[altIndex]||maskToken.matches[altIndex],[altIndex].concat(loopNdx),quantifierRecurse);if(match)return!0;}else if(match.isQuantifier&&quantifierRecurse!==maskToken.matches[$.inArray(match,maskToken.matches)-1])for(var qt=match,qndx=ndxInitializer.length>0?ndxInitializer.shift():0;qndx<(isNaN(qt.quantifier.max)?qndx+1:qt.quantifier.max)&&testPos<=pos;qndx++){var tokenGroup=maskToken.matches[$.inArray(qt,maskToken.matches)-1];if(match=handleMatch(tokenGroup,[qndx].concat(loopNdx),tokenGroup)){if(latestMatch=matches[matches.length-1].match,latestMatch.optionalQuantifier=qndx>qt.quantifier.min-1,isFirstMatch(latestMatch,tokenGroup)){if(qndx>qt.quantifier.min-1){insertStop=!0,testPos=pos;break;}
return!0;}
return!0;}}else if(match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse))return!0;}else testPos++;}
for(var tndx=ndxInitializer.length>0?ndxInitializer.shift():0;tndx<maskToken.matches.length;tndx++)if(maskToken.matches[tndx].isQuantifier!==!0){var match=handleMatch(maskToken.matches[tndx],[tndx].concat(loopNdx),quantifierRecurse);if(match&&testPos===pos)return match;if(testPos>pos)break;}}
function mergeLocators(tests){var locator=[];return $.isArray(tests)||(tests=[tests]),tests.length>0&&(void 0===tests[0].alternation?(locator=determineTestTemplate(tests.slice()).locator.slice(),0===locator.length&&(locator=tests[0].locator.slice())):$.each(tests,function(ndx,tst){if(""!==tst.def)if(0===locator.length)locator=tst.locator.slice();else for(var i=0;i<locator.length;i++)tst.locator[i]&&locator[i].toString().indexOf(tst.locator[i])===-1&&(locator[i]+=","+tst.locator[i]);})),locator;}
function filterTests(tests){return opts.keepStatic&&pos>0&&tests.length>1+(""===tests[tests.length-1].match.def?1:0)&&tests[0].match.optionality!==!0&&tests[0].match.optionalQuantifier!==!0&&null===tests[0].match.fn&&!/[0-9a-bA-Z]/.test(tests[0].match.def)?[determineTestTemplate(tests)]:tests;}
var latestMatch,maskTokens=getMaskSet().maskToken,testPos=ndxIntlzr?tstPs:0,ndxInitializer=ndxIntlzr?ndxIntlzr.slice():[0],matches=[],insertStop=!1,cacheDependency=ndxIntlzr?ndxIntlzr.join(""):"";if(pos>-1){if(void 0===ndxIntlzr){for(var test,previousPos=pos-1;void 0===(test=getMaskSet().validPositions[previousPos]||getMaskSet().tests[previousPos])&&previousPos>-1;)previousPos--;void 0!==test&&previousPos>-1&&(ndxInitializer=mergeLocators(test),cacheDependency=ndxInitializer.join(""),testPos=previousPos);}
if(getMaskSet().tests[pos]&&getMaskSet().tests[pos][0].cd===cacheDependency)return filterTests(getMaskSet().tests[pos]);for(var mtndx=ndxInitializer.shift();mtndx<maskTokens.length;mtndx++){var match=resolveTestFromToken(maskTokens[mtndx],ndxInitializer,[mtndx]);if(match&&testPos===pos||testPos>pos)break;}}
return(0===matches.length||insertStop)&&matches.push({match:{fn:null,cardinality:0,optionality:!0,casing:null,def:"",placeholder:""},locator:[],cd:cacheDependency}),void 0!==ndxIntlzr&&getMaskSet().tests[pos]?filterTests($.extend(!0,[],matches)):(getMaskSet().tests[pos]=$.extend(!0,[],matches),filterTests(getMaskSet().tests[pos]));}
function getBufferTemplate(){return void 0===getMaskSet()._buffer&&(getMaskSet()._buffer=getMaskTemplate(!1,1),void 0===getMaskSet().buffer&&getMaskSet()._buffer.slice()),getMaskSet()._buffer;}
function getBuffer(noCache){return void 0!==getMaskSet().buffer&&noCache!==!0||(getMaskSet().buffer=getMaskTemplate(!0,getLastValidPosition(),!0)),getMaskSet().buffer;}
function refreshFromBuffer(start,end,buffer){var i;if(start===!0)resetMaskSet(),start=0,end=buffer.length;else for(i=start;i<end;i++)delete getMaskSet().validPositions[i];for(i=start;i<end;i++)resetMaskSet(!0),buffer[i]!==opts.skipOptionalPartCharacter&&isValid(i,buffer[i],!0,!0);}
function casing(elem,test,pos){switch(opts.casing||test.casing){case"upper":elem=elem.toUpperCase();break;case"lower":elem=elem.toLowerCase();break;case"title":var posBefore=getMaskSet().validPositions[pos-1];elem=0===pos||posBefore&&posBefore.input===String.fromCharCode(Inputmask.keyCode.SPACE)?elem.toUpperCase():elem.toLowerCase();}
return elem;}
function checkAlternationMatch(altArr1,altArr2){for(var altArrC=opts.greedy?altArr2:altArr2.slice(0,1),isMatch=!1,alndx=0;alndx<altArr1.length;alndx++)if($.inArray(altArr1[alndx],altArrC)!==-1){isMatch=!0;break;}
return isMatch;}
function isValid(pos,c,strict,fromSetValid,fromAlternate){function isSelection(posObj){return isRTL?posObj.begin-posObj.end>1||posObj.begin-posObj.end===1&&opts.insertMode:posObj.end-posObj.begin>1||posObj.end-posObj.begin===1&&opts.insertMode;}
function _isValid(position,c,strict){var rslt=!1;return $.each(getTests(position),function(ndx,tst){for(var test=tst.match,loopend=c?1:0,chrs="",i=test.cardinality;i>loopend;i--)chrs+=getBufferElement(position-(i-1));if(c&&(chrs+=c),getBuffer(!0),rslt=null!=test.fn?test.fn.test(chrs,getMaskSet(),position,strict,opts,isSelection(pos)):(c===test.def||c===opts.skipOptionalPartCharacter)&&""!==test.def&&{c:test.placeholder||test.def,pos:position},rslt!==!1){var elem=void 0!==rslt.c?rslt.c:c;elem=elem===opts.skipOptionalPartCharacter&&null===test.fn?test.placeholder||test.def:elem;var validatedPos=position,possibleModifiedBuffer=getBuffer();if(void 0!==rslt.remove&&($.isArray(rslt.remove)||(rslt.remove=[rslt.remove]),$.each(rslt.remove.sort(function(a,b){return b-a;}),function(ndx,lmnt){stripValidPositions(lmnt,lmnt+1,!0);})),void 0!==rslt.insert&&($.isArray(rslt.insert)||(rslt.insert=[rslt.insert]),$.each(rslt.insert.sort(function(a,b){return a-b;}),function(ndx,lmnt){isValid(lmnt.pos,lmnt.c,!1,fromSetValid);})),rslt.refreshFromBuffer){var refresh=rslt.refreshFromBuffer;if(strict=!0,refreshFromBuffer(refresh===!0?refresh:refresh.start,refresh.end,possibleModifiedBuffer),void 0===rslt.pos&&void 0===rslt.c)return rslt.pos=getLastValidPosition(),!1;if(validatedPos=void 0!==rslt.pos?rslt.pos:position,validatedPos!==position)return rslt=$.extend(rslt,isValid(validatedPos,elem,!0,fromSetValid)),!1;}else if(rslt!==!0&&void 0!==rslt.pos&&rslt.pos!==position&&(validatedPos=rslt.pos,refreshFromBuffer(position,validatedPos,getBuffer().slice()),validatedPos!==position))return rslt=$.extend(rslt,isValid(validatedPos,elem,!0)),!1;return(rslt===!0||void 0!==rslt.pos||void 0!==rslt.c)&&(ndx>0&&resetMaskSet(!0),setValidPosition(validatedPos,$.extend({},tst,{input:casing(elem,test,validatedPos)}),fromSetValid,isSelection(pos))||(rslt=!1),!1);}}),rslt;}
function alternate(pos,c,strict){var lastAlt,alternation,altPos,prevAltPos,i,validPos,altNdxs,decisionPos,validPsClone=$.extend(!0,{},getMaskSet().validPositions),isValidRslt=!1,lAltPos=getLastValidPosition();for(prevAltPos=getMaskSet().validPositions[lAltPos];lAltPos>=0;lAltPos--)if(altPos=getMaskSet().validPositions[lAltPos],altPos&&void 0!==altPos.alternation){if(lastAlt=lAltPos,alternation=getMaskSet().validPositions[lastAlt].alternation,prevAltPos.locator[altPos.alternation]!==altPos.locator[altPos.alternation])break;prevAltPos=altPos;}
if(void 0!==alternation){decisionPos=parseInt(lastAlt);var decisionTaker=void 0!==prevAltPos.locator[prevAltPos.alternation||alternation]?prevAltPos.locator[prevAltPos.alternation||alternation]:altNdxs[0];decisionTaker.length>0&&(decisionTaker=decisionTaker.split(",")[0]);var possibilityPos=getMaskSet().validPositions[decisionPos],prevPos=getMaskSet().validPositions[decisionPos-1];$.each(getTests(decisionPos,prevPos?prevPos.locator:void 0,decisionPos-1),function(ndx,test){altNdxs=test.locator[alternation]?test.locator[alternation].toString().split(","):[];for(var mndx=0;mndx<altNdxs.length;mndx++){var validInputs=[],staticInputsBeforePos=0,staticInputsBeforePosAlternate=0,verifyValidInput=!1;if(decisionTaker<altNdxs[mndx]&&(void 0===test.na||$.inArray(altNdxs[mndx],test.na.split(","))===-1)){getMaskSet().validPositions[decisionPos]=$.extend(!0,{},test);var possibilities=getMaskSet().validPositions[decisionPos].locator;for(getMaskSet().validPositions[decisionPos].locator[alternation]=parseInt(altNdxs[mndx]),null==test.match.fn?(possibilityPos.input!==test.match.def&&(verifyValidInput=!0,possibilityPos.generatedInput!==!0&&validInputs.push(possibilityPos.input)),staticInputsBeforePosAlternate++,getMaskSet().validPositions[decisionPos].generatedInput=!/[0-9a-bA-Z]/.test(test.match.def),getMaskSet().validPositions[decisionPos].input=test.match.def):getMaskSet().validPositions[decisionPos].input=possibilityPos.input,i=decisionPos+1;i<getLastValidPosition(void 0,!0)+1;i++)validPos=getMaskSet().validPositions[i],validPos&&validPos.generatedInput!==!0&&/[0-9a-bA-Z]/.test(validPos.input)?validInputs.push(validPos.input):i<pos&&staticInputsBeforePos++,delete getMaskSet().validPositions[i];for(verifyValidInput&&validInputs[0]===test.match.def&&validInputs.shift(),resetMaskSet(!0),isValidRslt=!0;validInputs.length>0;){var input=validInputs.shift();if(input!==opts.skipOptionalPartCharacter&&!(isValidRslt=isValid(getLastValidPosition(void 0,!0)+1,input,!1,fromSetValid,!0)))break;}
if(isValidRslt){getMaskSet().validPositions[decisionPos].locator=possibilities;var targetLvp=getLastValidPosition(pos)+1;for(i=decisionPos+1;i<getLastValidPosition()+1;i++)validPos=getMaskSet().validPositions[i],(void 0===validPos||null==validPos.match.fn)&&i<pos+(staticInputsBeforePosAlternate-staticInputsBeforePos)&&staticInputsBeforePosAlternate++;pos+=staticInputsBeforePosAlternate-staticInputsBeforePos,isValidRslt=isValid(pos>targetLvp?targetLvp:pos,c,strict,fromSetValid,!0);}
if(isValidRslt)return!1;resetMaskSet(),getMaskSet().validPositions=$.extend(!0,{},validPsClone);}}});}
return isValidRslt;}
function trackbackAlternations(originalPos,newPos){for(var vp=getMaskSet().validPositions[newPos],targetLocator=vp.locator,tll=targetLocator.length,ps=originalPos;ps<newPos;ps++)if(void 0===getMaskSet().validPositions[ps]&&!isMask(ps,!0)){var tests=getTests(ps),bestMatch=tests[0],equality=-1;$.each(tests,function(ndx,tst){for(var i=0;i<tll&&(void 0!==tst.locator[i]&&checkAlternationMatch(tst.locator[i].toString().split(","),targetLocator[i].toString().split(",")));i++)equality<i&&(equality=i,bestMatch=tst);}),setValidPosition(ps,$.extend({},bestMatch,{input:bestMatch.match.placeholder||bestMatch.match.def}),!0);}}
function setValidPosition(pos,validTest,fromSetValid,isSelection){if(isSelection||opts.insertMode&&void 0!==getMaskSet().validPositions[pos]&&void 0===fromSetValid){var i,positionsClone=$.extend(!0,{},getMaskSet().validPositions),lvp=getLastValidPosition();for(i=pos;i<=lvp;i++)delete getMaskSet().validPositions[i];getMaskSet().validPositions[pos]=$.extend(!0,{},validTest);var j,valid=!0,vps=getMaskSet().validPositions,needsValidation=!1,initialLength=getMaskSet().maskLength;for(i=j=pos;i<=lvp;i++){var t=positionsClone[i];if(void 0!==t)for(var posMatch=j;posMatch<getMaskSet().maskLength&&(null==t.match.fn&&vps[i]&&(vps[i].match.optionalQuantifier===!0||vps[i].match.optionality===!0)||null!=t.match.fn);){if(posMatch++,needsValidation===!1&&positionsClone[posMatch]&&positionsClone[posMatch].match.def===t.match.def)getMaskSet().validPositions[posMatch]=$.extend(!0,{},positionsClone[posMatch]),getMaskSet().validPositions[posMatch].input=t.input,fillMissingNonMask(posMatch),j=posMatch,valid=!0;else if(positionCanMatchDefinition(posMatch,t.match.def)){var result=isValid(posMatch,t.input,!0,!0);valid=result!==!1,j=result.caret||result.insert?getLastValidPosition():posMatch,needsValidation=!0;}else valid=t.generatedInput===!0;if(getMaskSet().maskLength<initialLength&&(getMaskSet().maskLength=initialLength),valid)break;}
if(!valid)break;}
if(!valid)return getMaskSet().validPositions=$.extend(!0,{},positionsClone),resetMaskSet(!0),!1;}else getMaskSet().validPositions[pos]=$.extend(!0,{},validTest);return resetMaskSet(!0),!0;}
function fillMissingNonMask(maskPos){for(var pndx=maskPos-1;pndx>-1&&!getMaskSet().validPositions[pndx];pndx--);var testTemplate,testsFromPos;for(pndx++;pndx<maskPos;pndx++)void 0===getMaskSet().validPositions[pndx]&&(opts.jitMasking===!1||opts.jitMasking>pndx)&&(testsFromPos=getTests(pndx,getTestTemplate(pndx-1).locator,pndx-1).slice(),""===testsFromPos[testsFromPos.length-1].match.def&&testsFromPos.pop(),testTemplate=determineTestTemplate(testsFromPos),testTemplate&&(testTemplate.match.def===opts.radixPointDefinitionSymbol||!isMask(pndx,!0)||$.inArray(opts.radixPoint,getBuffer())<pndx&&testTemplate.match.fn&&testTemplate.match.fn.test(getPlaceholder(pndx),getMaskSet(),pndx,!1,opts))&&(result=_isValid(pndx,testTemplate.match.placeholder||(null==testTemplate.match.fn?testTemplate.match.def:""!==getPlaceholder(pndx)?getPlaceholder(pndx):getBuffer()[pndx]),!0),result!==!1&&(getMaskSet().validPositions[result.pos||pndx].generatedInput=!0)));}
strict=strict===!0;var maskPos=pos;void 0!==pos.begin&&(maskPos=isRTL&&!isSelection(pos)?pos.end:pos.begin);var result=!1,positionsClone=$.extend(!0,{},getMaskSet().validPositions);if(fillMissingNonMask(maskPos),isSelection(pos)&&(handleRemove(void 0,Inputmask.keyCode.DELETE,pos),maskPos=getMaskSet().p),maskPos<getMaskSet().maskLength&&(result=_isValid(maskPos,c,strict),(!strict||fromSetValid===!0)&&result===!1)){var currentPosValid=getMaskSet().validPositions[maskPos];if(!currentPosValid||null!==currentPosValid.match.fn||currentPosValid.match.def!==c&&c!==opts.skipOptionalPartCharacter){if((opts.insertMode||void 0===getMaskSet().validPositions[seekNext(maskPos)])&&!isMask(maskPos,!0)){var testsFromPos=getTests(maskPos).slice();""===testsFromPos[testsFromPos.length-1].match.def&&testsFromPos.pop();var staticChar=determineTestTemplate(testsFromPos,!0);staticChar&&(staticChar=staticChar.match.placeholder||staticChar.match.def,_isValid(maskPos,staticChar,strict),getMaskSet().validPositions[maskPos].generatedInput=!0);for(var nPos=maskPos+1,snPos=seekNext(maskPos);nPos<=snPos;nPos++)if(result=_isValid(nPos,c,strict),result!==!1){trackbackAlternations(maskPos,nPos),maskPos=nPos;break;}}}else result={caret:seekNext(maskPos)};}
return result===!1&&opts.keepStatic&&!strict&&fromAlternate!==!0&&(result=alternate(maskPos,c,strict)),result===!0&&(result={pos:maskPos}),$.isFunction(opts.postValidation)&&result!==!1&&!strict&&fromSetValid!==!0&&(result=!!opts.postValidation(getBuffer(!0),result,opts)&&result),void 0===result.pos&&(result.pos=maskPos),result===!1&&(resetMaskSet(!0),getMaskSet().validPositions=$.extend(!0,{},positionsClone)),result;}
function isMask(pos,strict){var test;if(strict?(test=getTestTemplate(pos).match,""===test.def&&(test=getTest(pos).match)):test=getTest(pos).match,null!=test.fn)return test.fn;if(strict!==!0&&pos>-1){var tests=getTests(pos);return tests.length>1+(""===tests[tests.length-1].match.def?1:0);}
return!1;}
function seekNext(pos,newBlock){var maskL=getMaskSet().maskLength;if(pos>=maskL)return maskL;for(var position=pos;++position<maskL&&(newBlock===!0&&(getTest(position).match.newBlockMarker!==!0||!isMask(position))||newBlock!==!0&&!isMask(position)););return position;}
function seekPrevious(pos,newBlock){var tests,position=pos;if(position<=0)return 0;for(;--position>0&&(newBlock===!0&&getTest(position).match.newBlockMarker!==!0||newBlock!==!0&&!isMask(position)&&(tests=getTests(position),tests.length<2||2===tests.length&&""===tests[1].match.def)););return position;}
function getBufferElement(position){return void 0===getMaskSet().validPositions[position]?getPlaceholder(position):getMaskSet().validPositions[position].input;}
function writeBuffer(input,buffer,caretPos,event,triggerInputEvent){if(event&&$.isFunction(opts.onBeforeWrite)){var result=opts.onBeforeWrite(event,buffer,caretPos,opts);if(result){if(result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===!0?refresh:refresh.start,refresh.end,result.buffer||buffer),buffer=getBuffer(!0);}
void 0!==caretPos&&(caretPos=void 0!==result.caret?result.caret:caretPos);}}
input.inputmask._valueSet(buffer.join("")),void 0===caretPos||void 0!==event&&"blur"===event.type||caret(input,caretPos),triggerInputEvent===!0&&(skipInputEvent=!0,$(input).trigger("input"));}
function getPlaceholder(pos,test){if(test=test||getTest(pos).match,void 0!==test.placeholder)return test.placeholder;if(null===test.fn){if(pos>-1&&void 0===getMaskSet().validPositions[pos]){var prevTest,tests=getTests(pos),staticAlternations=[];if(tests.length>1+(""===tests[tests.length-1].match.def?1:0))for(var i=0;i<tests.length;i++)if(tests[i].match.optionality!==!0&&tests[i].match.optionalQuantifier!==!0&&(null===tests[i].match.fn||void 0===prevTest||tests[i].match.fn.test(prevTest.match.def,getMaskSet(),pos,!0,opts)!==!1)&&(staticAlternations.push(tests[i]),null===tests[i].match.fn&&(prevTest=tests[i]),staticAlternations.length>1&&/[0-9a-bA-Z]/.test(staticAlternations[0].match.def)))return opts.placeholder.charAt(pos%opts.placeholder.length);}
return test.def;}
return opts.placeholder.charAt(pos%opts.placeholder.length);}
function checkVal(input,writeOut,strict,nptvl,initiatingEvent,stickyCaret){function isTemplateMatch(){var isMatch=!1,charCodeNdx=getBufferTemplate().slice(initialNdx,seekNext(initialNdx)).join("").indexOf(charCodes);if(charCodeNdx!==-1&&!isMask(initialNdx)){isMatch=!0;for(var bufferTemplateArr=getBufferTemplate().slice(initialNdx,initialNdx+charCodeNdx),i=0;i<bufferTemplateArr.length;i++)if(" "!==bufferTemplateArr[i]){isMatch=!1;break;}}
return isMatch;}
var inputValue=nptvl.slice(),charCodes="",initialNdx=0,result=void 0;if(resetMaskSet(),getMaskSet().p=seekNext(-1),!strict)if(opts.autoUnmask!==!0){var staticInput=getBufferTemplate().slice(0,seekNext(-1)).join(""),matches=inputValue.join("").match(new RegExp("^"+Inputmask.escapeRegex(staticInput),"g"));matches&&matches.length>0&&(inputValue.splice(0,matches.length*staticInput.length),initialNdx=seekNext(initialNdx));}else initialNdx=seekNext(initialNdx);if($.each(inputValue,function(ndx,charCode){if(void 0!==charCode){var keypress=new $.Event("keypress");keypress.which=charCode.charCodeAt(0),charCodes+=charCode;var lvp=getLastValidPosition(void 0,!0),lvTest=getMaskSet().validPositions[lvp],nextTest=getTestTemplate(lvp+1,lvTest?lvTest.locator.slice():void 0,lvp);if(!isTemplateMatch()||strict||opts.autoUnmask){var pos=strict?ndx:null==nextTest.match.fn&&nextTest.match.optionality&&lvp+1<getMaskSet().p?lvp+1:getMaskSet().p;result=keypressEvent.call(input,keypress,!0,!1,strict,pos),initialNdx=pos+1,charCodes="";}else result=keypressEvent.call(input,keypress,!0,!1,!0,lvp+1);if(!strict&&$.isFunction(opts.onBeforeWrite)&&(result=opts.onBeforeWrite(keypress,getBuffer(),result.forwardPosition,opts),result&&result.refreshFromBuffer)){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===!0?refresh:refresh.start,refresh.end,result.buffer),resetMaskSet(!0),result.caret&&(getMaskSet().p=result.caret);}}}),writeOut){var caretPos=void 0,lvp=getLastValidPosition();document.activeElement===input&&(initiatingEvent||result)&&(caretPos=caret(input).begin-(stickyCaret===!0?1:0),result&&stickyCaret!==!0&&(caretPos<lvp+1||lvp===-1)&&(caretPos=opts.numericInput&&void 0===result.caret?seekPrevious(result.forwardPosition):result.forwardPosition)),writeBuffer(input,getBuffer(),caretPos,initiatingEvent||new $.Event("checkval"));}}
function unmaskedvalue(input){if(input&&void 0===input.inputmask)return input.value;var umValue=[],vps=getMaskSet().validPositions;for(var pndx in vps)vps[pndx].match&&null!=vps[pndx].match.fn&&umValue.push(vps[pndx].input);var unmaskedValue=0===umValue.length?"":(isRTL?umValue.reverse():umValue).join("");if($.isFunction(opts.onUnMask)){var bufferValue=(isRTL?getBuffer().slice().reverse():getBuffer()).join("");unmaskedValue=opts.onUnMask(bufferValue,unmaskedValue,opts)||unmaskedValue;}
return unmaskedValue;}
function caret(input,begin,end,notranslate){function translatePosition(pos){if(notranslate!==!0&&isRTL&&"number"==typeof pos&&(!opts.greedy||""!==opts.placeholder)){var bffrLght=getBuffer().join("").length;pos=bffrLght-pos;}
return pos;}
var range;if("number"!=typeof begin)return input.setSelectionRange?(begin=input.selectionStart,end=input.selectionEnd):window.getSelection?(range=window.getSelection().getRangeAt(0),range.commonAncestorContainer.parentNode!==input&&range.commonAncestorContainer!==input||(begin=range.startOffset,end=range.endOffset)):document.selection&&document.selection.createRange&&(range=document.selection.createRange(),begin=0-range.duplicate().moveStart("character",-input.inputmask._valueGet().length),end=begin+range.text.length),{begin:translatePosition(begin),end:translatePosition(end)};begin=translatePosition(begin),end=translatePosition(end),end="number"==typeof end?end:begin;var scrollCalc=parseInt(((input.ownerDocument.defaultView||window).getComputedStyle?(input.ownerDocument.defaultView||window).getComputedStyle(input,null):input.currentStyle).fontSize)*end;if(input.scrollLeft=scrollCalc>input.scrollWidth?scrollCalc:0,mobile||opts.insertMode!==!1||begin!==end||end++,input.setSelectionRange)input.selectionStart=begin,input.selectionEnd=end;else if(window.getSelection){if(range=document.createRange(),void 0===input.firstChild||null===input.firstChild){var textNode=document.createTextNode("");input.appendChild(textNode);}
range.setStart(input.firstChild,begin<input.inputmask._valueGet().length?begin:input.inputmask._valueGet().length),range.setEnd(input.firstChild,end<input.inputmask._valueGet().length?end:input.inputmask._valueGet().length),range.collapse(!0);var sel=window.getSelection();sel.removeAllRanges(),sel.addRange(range);}else input.createTextRange&&(range=input.createTextRange(),range.collapse(!0),range.moveEnd("character",end),range.moveStart("character",begin),range.select());}
function determineLastRequiredPosition(returnDefinition){var pos,testPos,buffer=getBuffer(),bl=buffer.length,lvp=getLastValidPosition(),positions={},lvTest=getMaskSet().validPositions[lvp],ndxIntlzr=void 0!==lvTest?lvTest.locator.slice():void 0;for(pos=lvp+1;pos<buffer.length;pos++)testPos=getTestTemplate(pos,ndxIntlzr,pos-1),ndxIntlzr=testPos.locator.slice(),positions[pos]=$.extend(!0,{},testPos);var lvTestAlt=lvTest&&void 0!==lvTest.alternation?lvTest.locator[lvTest.alternation]:void 0;for(pos=bl-1;pos>lvp&&(testPos=positions[pos],(testPos.match.optionality||testPos.match.optionalQuantifier||lvTestAlt&&(lvTestAlt!==positions[pos].locator[lvTest.alternation]&&null!=testPos.match.fn||null===testPos.match.fn&&testPos.locator[lvTest.alternation]&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(","),lvTestAlt.toString().split(","))&&""!==getTests(pos)[0].def))&&buffer[pos]===getPlaceholder(pos,testPos.match));pos--)bl--;return returnDefinition?{l:bl,def:positions[bl]?positions[bl].match:void 0}:bl;}
function clearOptionalTail(buffer){for(var rl=determineLastRequiredPosition(),lmib=buffer.length-1;lmib>rl&&!isMask(lmib);lmib--);return buffer.splice(rl,lmib+1-rl),buffer;}
function isComplete(buffer){if($.isFunction(opts.isComplete))return opts.isComplete(buffer,opts);if("*"!==opts.repeat){var complete=!1,lrp=determineLastRequiredPosition(!0),aml=seekPrevious(lrp.l);if(void 0===lrp.def||lrp.def.newBlockMarker||lrp.def.optionality||lrp.def.optionalQuantifier){complete=!0;for(var i=0;i<=aml;i++){var test=getTestTemplate(i).match;if(null!==test.fn&&void 0===getMaskSet().validPositions[i]&&test.optionality!==!0&&test.optionalQuantifier!==!0||null===test.fn&&buffer[i]!==getPlaceholder(i,test)){complete=!1;break;}}}
return complete;}}
function patchValueProperty(npt){function patchValhook(type){if($.valHooks&&(void 0===$.valHooks[type]||$.valHooks[type].inputmaskpatch!==!0)){var valhookGet=$.valHooks[type]&&$.valHooks[type].get?$.valHooks[type].get:function(elem){return elem.value;},valhookSet=$.valHooks[type]&&$.valHooks[type].set?$.valHooks[type].set:function(elem,value){return elem.value=value,elem;};$.valHooks[type]={get:function(elem){if(elem.inputmask){if(elem.inputmask.opts.autoUnmask)return elem.inputmask.unmaskedvalue();var result=valhookGet(elem);return getLastValidPosition(void 0,void 0,elem.inputmask.maskset.validPositions)!==-1||opts.nullable!==!0?result:"";}
return valhookGet(elem);},set:function(elem,value){var result,$elem=$(elem);return result=valhookSet(elem,value),elem.inputmask&&$elem.trigger("setvalue"),result;},inputmaskpatch:!0};}}
function getter(){return this.inputmask?this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():getLastValidPosition()!==-1||opts.nullable!==!0?document.activeElement===this&&opts.clearMaskOnLostFocus?(isRTL?clearOptionalTail(getBuffer().slice()).reverse():clearOptionalTail(getBuffer().slice())).join(""):valueGet.call(this):"":valueGet.call(this);}
function setter(value){valueSet.call(this,value),this.inputmask&&$(this).trigger("setvalue");}
function installNativeValueSetFallback(npt){EventRuler.on(npt,"mouseenter",function(event){var $input=$(this),input=this,value=input.inputmask._valueGet();value!==getBuffer().join("")&&$input.trigger("setvalue");});}
var valueGet,valueSet;if(!npt.inputmask.__valueGet){if(Object.getOwnPropertyDescriptor){"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(object){return object.__proto__;}:function(object){return object.constructor.prototype;});var valueProperty=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(npt),"value"):void 0;valueProperty&&valueProperty.get&&valueProperty.set?(valueGet=valueProperty.get,valueSet=valueProperty.set,Object.defineProperty(npt,"value",{get:getter,set:setter,configurable:!0})):"INPUT"!==npt.tagName&&(valueGet=function(){return this.textContent;},valueSet=function(value){this.textContent=value;},Object.defineProperty(npt,"value",{get:getter,set:setter,configurable:!0}));}else document.__lookupGetter__&&npt.__lookupGetter__("value")&&(valueGet=npt.__lookupGetter__("value"),valueSet=npt.__lookupSetter__("value"),npt.__defineGetter__("value",getter),npt.__defineSetter__("value",setter));npt.inputmask.__valueGet=valueGet,npt.inputmask._valueGet=function(overruleRTL){return isRTL&&overruleRTL!==!0?valueGet.call(this.el).split("").reverse().join(""):valueGet.call(this.el);},npt.inputmask.__valueSet=valueSet,npt.inputmask._valueSet=function(value,overruleRTL){valueSet.call(this.el,null===value||void 0===value?"":overruleRTL!==!0&&isRTL?value.split("").reverse().join(""):value);},void 0===valueGet&&(valueGet=function(){return this.value;},valueSet=function(value){this.value=value;},patchValhook(npt.type),installNativeValueSetFallback(npt));}}
function handleRemove(input,k,pos,strict){function generalize(){if(opts.keepStatic){for(var validInputs=[],lastAlt=getLastValidPosition(-1,!0),positionsClone=$.extend(!0,{},getMaskSet().validPositions),prevAltPos=getMaskSet().validPositions[lastAlt];lastAlt>=0;lastAlt--){var altPos=getMaskSet().validPositions[lastAlt];if(altPos){if(altPos.generatedInput!==!0&&/[0-9a-bA-Z]/.test(altPos.input)&&validInputs.push(altPos.input),delete getMaskSet().validPositions[lastAlt],void 0!==altPos.alternation&&altPos.locator[altPos.alternation]!==prevAltPos.locator[altPos.alternation])break;prevAltPos=altPos;}}
if(lastAlt>-1)for(getMaskSet().p=seekNext(getLastValidPosition(-1,!0));validInputs.length>0;){var keypress=new $.Event("keypress");keypress.which=validInputs.pop().charCodeAt(0),keypressEvent.call(input,keypress,!0,!1,!1,getMaskSet().p);}else getMaskSet().validPositions=$.extend(!0,{},positionsClone);}}
if((opts.numericInput||isRTL)&&(k===Inputmask.keyCode.BACKSPACE?k=Inputmask.keyCode.DELETE:k===Inputmask.keyCode.DELETE&&(k=Inputmask.keyCode.BACKSPACE),isRTL)){var pend=pos.end;pos.end=pos.begin,pos.begin=pend;}
k===Inputmask.keyCode.BACKSPACE&&(pos.end-pos.begin<1||opts.insertMode===!1)?(pos.begin=seekPrevious(pos.begin),void 0===getMaskSet().validPositions[pos.begin]||getMaskSet().validPositions[pos.begin].input!==opts.groupSeparator&&getMaskSet().validPositions[pos.begin].input!==opts.radixPoint||pos.begin--):k===Inputmask.keyCode.DELETE&&pos.begin===pos.end&&(pos.end=isMask(pos.end,!0)?pos.end+1:seekNext(pos.end)+1,void 0===getMaskSet().validPositions[pos.begin]||getMaskSet().validPositions[pos.begin].input!==opts.groupSeparator&&getMaskSet().validPositions[pos.begin].input!==opts.radixPoint||pos.end++),stripValidPositions(pos.begin,pos.end,!1,strict),strict!==!0&&generalize();var lvp=getLastValidPosition(pos.begin,!0);lvp<pos.begin?getMaskSet().p=seekNext(lvp):strict!==!0&&(getMaskSet().p=pos.begin);}
function keydownEvent(e){var input=this,$input=$(input),k=e.keyCode,pos=caret(input);if(k===Inputmask.keyCode.BACKSPACE||k===Inputmask.keyCode.DELETE||iphone&&k===Inputmask.keyCode.BACKSPACE_SAFARI||e.ctrlKey&&k===Inputmask.keyCode.X&&!isInputEventSupported("cut"))e.preventDefault(),handleRemove(input,k,pos),writeBuffer(input,getBuffer(!0),getMaskSet().p,e,input.inputmask._valueGet()!==getBuffer().join("")),input.inputmask._valueGet()===getBufferTemplate().join("")?$input.trigger("cleared"):isComplete(getBuffer())===!0&&$input.trigger("complete"),opts.showTooltip&&(input.title=opts.tooltip||getMaskSet().mask);else if(k===Inputmask.keyCode.END||k===Inputmask.keyCode.PAGE_DOWN){e.preventDefault();var caretPos=seekNext(getLastValidPosition());opts.insertMode||caretPos!==getMaskSet().maskLength||e.shiftKey||caretPos--,caret(input,e.shiftKey?pos.begin:caretPos,caretPos,!0);}else k===Inputmask.keyCode.HOME&&!e.shiftKey||k===Inputmask.keyCode.PAGE_UP?(e.preventDefault(),caret(input,0,e.shiftKey?pos.begin:0,!0)):(opts.undoOnEscape&&k===Inputmask.keyCode.ESCAPE||90===k&&e.ctrlKey)&&e.altKey!==!0?(checkVal(input,!0,!1,undoValue.split("")),$input.trigger("click")):k!==Inputmask.keyCode.INSERT||e.shiftKey||e.ctrlKey?opts.tabThrough===!0&&k===Inputmask.keyCode.TAB?(e.shiftKey===!0?(null===getTest(pos.begin).match.fn&&(pos.begin=seekNext(pos.begin)),pos.end=seekPrevious(pos.begin,!0),pos.begin=seekPrevious(pos.end,!0)):(pos.begin=seekNext(pos.begin,!0),pos.end=seekNext(pos.begin,!0),pos.end<getMaskSet().maskLength&&pos.end--),pos.begin<getMaskSet().maskLength&&(e.preventDefault(),caret(input,pos.begin,pos.end))):opts.insertMode!==!1||e.shiftKey||(k===Inputmask.keyCode.RIGHT?setTimeout(function(){var caretPos=caret(input);caret(input,caretPos.begin);},0):k===Inputmask.keyCode.LEFT&&setTimeout(function(){var caretPos=caret(input);caret(input,isRTL?caretPos.begin+1:caretPos.begin-1);},0)):(opts.insertMode=!opts.insertMode,caret(input,opts.insertMode||pos.begin!==getMaskSet().maskLength?pos.begin:pos.begin-1));opts.onKeyDown.call(this,e,getBuffer(),caret(input).begin,opts),ignorable=$.inArray(k,opts.ignorables)!==-1;}
function keypressEvent(e,checkval,writeOut,strict,ndx){var input=this,$input=$(input),k=e.which||e.charCode||e.keyCode;if(!(checkval===!0||e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||ignorable))return k===Inputmask.keyCode.ENTER&&undoValue!==getBuffer().join("")&&(undoValue=getBuffer().join(""),setTimeout(function(){$input.trigger("change");},0)),!0;if(k){46===k&&e.shiftKey===!1&&","===opts.radixPoint&&(k=44);var forwardPosition,pos=checkval?{begin:ndx,end:ndx}:caret(input),c=String.fromCharCode(k);getMaskSet().writeOutBuffer=!0;var valResult=isValid(pos,c,strict);if(valResult!==!1&&(resetMaskSet(!0),forwardPosition=void 0!==valResult.caret?valResult.caret:checkval?valResult.pos+1:seekNext(valResult.pos),getMaskSet().p=forwardPosition),writeOut!==!1){var self=this;if(setTimeout(function(){opts.onKeyValidation.call(self,k,valResult,opts);},0),getMaskSet().writeOutBuffer&&valResult!==!1){var buffer=getBuffer();writeBuffer(input,buffer,opts.numericInput&&void 0===valResult.caret?seekPrevious(forwardPosition):forwardPosition,e,checkval!==!0),checkval!==!0&&setTimeout(function(){isComplete(buffer)===!0&&$input.trigger("complete");},0);}}
if(opts.showTooltip&&(input.title=opts.tooltip||getMaskSet().mask),e.preventDefault(),checkval)return valResult.forwardPosition=forwardPosition,valResult;}}
function pasteEvent(e){var tempValue,input=this,ev=e.originalEvent||e,$input=$(input),inputValue=input.inputmask._valueGet(!0),caretPos=caret(input);isRTL&&(tempValue=caretPos.end,caretPos.end=caretPos.begin,caretPos.begin=tempValue);var valueBeforeCaret=inputValue.substr(0,caretPos.begin),valueAfterCaret=inputValue.substr(caretPos.end,inputValue.length);if(valueBeforeCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(0,caretPos.begin).join("")&&(valueBeforeCaret=""),valueAfterCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(caretPos.end).join("")&&(valueAfterCaret=""),isRTL&&(tempValue=valueBeforeCaret,valueBeforeCaret=valueAfterCaret,valueAfterCaret=tempValue),window.clipboardData&&window.clipboardData.getData)inputValue=valueBeforeCaret+window.clipboardData.getData("Text")+valueAfterCaret;else{if(!ev.clipboardData||!ev.clipboardData.getData)return!0;inputValue=valueBeforeCaret+ev.clipboardData.getData("text/plain")+valueAfterCaret;}
var pasteValue=inputValue;if($.isFunction(opts.onBeforePaste)){if(pasteValue=opts.onBeforePaste(inputValue,opts),pasteValue===!1)return e.preventDefault();pasteValue||(pasteValue=inputValue);}
return checkVal(input,!1,!1,isRTL?pasteValue.split("").reverse():pasteValue.toString().split("")),writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()),e,undoValue!==getBuffer().join("")),isComplete(getBuffer())===!0&&$input.trigger("complete"),e.preventDefault();}
function inputFallBackEvent(e){var input=this,inputValue=input.inputmask._valueGet();if(getBuffer().join("")!==inputValue){var caretPos=caret(input);if(inputValue=inputValue.replace(new RegExp("("+Inputmask.escapeRegex(getBufferTemplate().join(""))+")*"),""),iemobile){var inputChar=inputValue.replace(getBuffer().join(""),"");if(1===inputChar.length){var keypress=new $.Event("keypress");return keypress.which=inputChar.charCodeAt(0),keypressEvent.call(input,keypress,!0,!0,!1,getMaskSet().validPositions[caretPos.begin-1]?caretPos.begin:caretPos.begin-1),!1;}}
if(caretPos.begin>inputValue.length&&(caret(input,inputValue.length),caretPos=caret(input)),getBuffer().length-inputValue.length!==1||inputValue.charAt(caretPos.begin)===getBuffer()[caretPos.begin]||inputValue.charAt(caretPos.begin+1)===getBuffer()[caretPos.begin]||isMask(caretPos.begin)){for(var lvp=getLastValidPosition()+1,bufferTemplate=getBuffer().slice(lvp).join("");null===inputValue.match(Inputmask.escapeRegex(bufferTemplate)+"$");)bufferTemplate=bufferTemplate.slice(1);inputValue=inputValue.replace(bufferTemplate,""),inputValue=inputValue.split(""),checkVal(input,!0,!1,inputValue,e,caretPos.begin<lvp),isComplete(getBuffer())===!0&&$(input).trigger("complete");}else e.keyCode=Inputmask.keyCode.BACKSPACE,keydownEvent.call(input,e);e.preventDefault();}}
function setValueEvent(e){var input=this,value=input.inputmask._valueGet();checkVal(input,!0,!1,($.isFunction(opts.onBeforeMask)?opts.onBeforeMask(value,opts)||value:value).split("")),undoValue=getBuffer().join(""),(opts.clearMaskOnLostFocus||opts.clearIncomplete)&&input.inputmask._valueGet()===getBufferTemplate().join("")&&input.inputmask._valueSet("");}
function focusEvent(e){var input=this,nptValue=input.inputmask._valueGet();opts.showMaskOnFocus&&(!opts.showMaskOnHover||opts.showMaskOnHover&&""===nptValue)?input.inputmask._valueGet()!==getBuffer().join("")&&writeBuffer(input,getBuffer(),seekNext(getLastValidPosition())):mouseEnter===!1&&caret(input,seekNext(getLastValidPosition())),opts.positionCaretOnTab===!0&&setTimeout(function(){clickEvent.apply(this,[e]);},0),undoValue=getBuffer().join("");}
function mouseleaveEvent(e){var input=this;if(mouseEnter=!1,opts.clearMaskOnLostFocus&&document.activeElement!==input){var buffer=getBuffer().slice(),nptValue=input.inputmask._valueGet();nptValue!==input.getAttribute("placeholder")&&""!==nptValue&&(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join("")?buffer=[]:clearOptionalTail(buffer),writeBuffer(input,buffer));}}
function clickEvent(e){function doRadixFocus(clickPos){if(""!==opts.radixPoint){var vps=getMaskSet().validPositions;if(void 0===vps[clickPos]||vps[clickPos].input===getPlaceholder(clickPos)){if(clickPos<seekNext(-1))return!0;var radixPos=$.inArray(opts.radixPoint,getBuffer());if(radixPos!==-1){for(var vp in vps)if(radixPos<vp&&vps[vp].input!==getPlaceholder(vp))return!1;return!0;}}}
return!1;}
var input=this;setTimeout(function(){if(document.activeElement===input){var selectedCaret=caret(input);if(selectedCaret.begin===selectedCaret.end)switch(opts.positionCaretOnClick){case"none":break;case"radixFocus":if(doRadixFocus(selectedCaret.begin)){var radixPos=$.inArray(opts.radixPoint,getBuffer().join(""));caret(input,opts.numericInput?seekNext(radixPos):radixPos);break;}
default:var clickPosition=selectedCaret.begin,lvclickPosition=getLastValidPosition(clickPosition,!0),lastPosition=seekNext(lvclickPosition);if(clickPosition<lastPosition)caret(input,isMask(clickPosition)||isMask(clickPosition-1)?clickPosition:seekNext(clickPosition));else{var placeholder=getPlaceholder(lastPosition);(""!==placeholder&&getBuffer()[lastPosition]!==placeholder&&getTest(lastPosition).match.optionalQuantifier!==!0||!isMask(lastPosition,!0)&&getTest(lastPosition).match.def===placeholder)&&(lastPosition=seekNext(lastPosition)),caret(input,lastPosition);}}}},0);}
function dblclickEvent(e){var input=this;setTimeout(function(){caret(input,0,seekNext(getLastValidPosition()));},0);}
function cutEvent(e){var input=this,$input=$(input),pos=caret(input),ev=e.originalEvent||e,clipboardData=window.clipboardData||ev.clipboardData,clipData=isRTL?getBuffer().slice(pos.end,pos.begin):getBuffer().slice(pos.begin,pos.end);clipboardData.setData("text",isRTL?clipData.reverse().join(""):clipData.join("")),document.execCommand&&document.execCommand("copy"),handleRemove(input,Inputmask.keyCode.DELETE,pos),writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join("")),input.inputmask._valueGet()===getBufferTemplate().join("")&&$input.trigger("cleared"),opts.showTooltip&&(input.title=opts.tooltip||getMaskSet().mask);}
function blurEvent(e){var $input=$(this),input=this;if(input.inputmask){var nptValue=input.inputmask._valueGet(),buffer=getBuffer().slice();undoValue!==buffer.join("")&&setTimeout(function(){$input.trigger("change"),undoValue=buffer.join("");},0),""!==nptValue&&(opts.clearMaskOnLostFocus&&(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join("")?buffer=[]:clearOptionalTail(buffer)),isComplete(buffer)===!1&&(setTimeout(function(){$input.trigger("incomplete");},0),opts.clearIncomplete&&(resetMaskSet(),buffer=opts.clearMaskOnLostFocus?[]:getBufferTemplate().slice())),writeBuffer(input,buffer,void 0,e));}}
function mouseenterEvent(e){var input=this;mouseEnter=!0,document.activeElement!==input&&opts.showMaskOnHover&&input.inputmask._valueGet()!==getBuffer().join("")&&writeBuffer(input,getBuffer());}
function submitEvent(e){undoValue!==getBuffer().join("")&&$el.trigger("change"),opts.clearMaskOnLostFocus&&getLastValidPosition()===-1&&el.inputmask._valueGet&&el.inputmask._valueGet()===getBufferTemplate().join("")&&el.inputmask._valueSet(""),opts.removeMaskOnSubmit&&(el.inputmask._valueSet(el.inputmask.unmaskedvalue(),!0),setTimeout(function(){writeBuffer(el,getBuffer());},0));}
function resetEvent(e){setTimeout(function(){$el.trigger("setvalue");},0);}
function mask(elem){if(el=elem,$el=$(el),opts.showTooltip&&(el.title=opts.tooltip||getMaskSet().mask),("rtl"===el.dir||opts.rightAlign)&&(el.style.textAlign="right"),("rtl"===el.dir||opts.numericInput)&&(el.dir="ltr",el.removeAttribute("dir"),el.inputmask.isRTL=!0,isRTL=!0),EventRuler.off(el),patchValueProperty(el),isElementTypeSupported(el,opts)&&(EventRuler.on(el,"submit",submitEvent),EventRuler.on(el,"reset",resetEvent),EventRuler.on(el,"mouseenter",mouseenterEvent),EventRuler.on(el,"blur",blurEvent),EventRuler.on(el,"focus",focusEvent),EventRuler.on(el,"mouseleave",mouseleaveEvent),EventRuler.on(el,"click",clickEvent),EventRuler.on(el,"dblclick",dblclickEvent),EventRuler.on(el,"paste",pasteEvent),EventRuler.on(el,"dragdrop",pasteEvent),EventRuler.on(el,"drop",pasteEvent),EventRuler.on(el,"cut",cutEvent),EventRuler.on(el,"complete",opts.oncomplete),EventRuler.on(el,"incomplete",opts.onincomplete),EventRuler.on(el,"cleared",opts.oncleared),opts.inputEventOnly!==!0&&(EventRuler.on(el,"keydown",keydownEvent),EventRuler.on(el,"keypress",keypressEvent)),EventRuler.on(el,"input",inputFallBackEvent)),EventRuler.on(el,"setvalue",setValueEvent),getBufferTemplate(),""!==el.inputmask._valueGet()||opts.clearMaskOnLostFocus===!1||document.activeElement===el){var initialValue=$.isFunction(opts.onBeforeMask)?opts.onBeforeMask(el.inputmask._valueGet(),opts)||el.inputmask._valueGet():el.inputmask._valueGet();checkVal(el,!0,!1,initialValue.split(""));var buffer=getBuffer().slice();undoValue=buffer.join(""),isComplete(buffer)===!1&&opts.clearIncomplete&&resetMaskSet(),opts.clearMaskOnLostFocus&&document.activeElement!==el&&(getLastValidPosition()===-1?buffer=[]:clearOptionalTail(buffer)),writeBuffer(el,buffer),document.activeElement===el&&caret(el,seekNext(getLastValidPosition()));}}
var undoValue,el,$el,maxLength,valueBuffer,isRTL=!1,skipKeyPressEvent=!1,skipInputEvent=!1,ignorable=!1,mouseEnter=!0,EventRuler={on:function(input,eventName,eventHandler){var ev=function(e){if(void 0===this.inputmask&&"FORM"!==this.nodeName){var imOpts=$.data(this,"_inputmask_opts");imOpts?new Inputmask(imOpts).mask(this):EventRuler.off(this);}else{if("setvalue"===e.type||!(this.disabled||this.readOnly&&!("keydown"===e.type&&e.ctrlKey&&67===e.keyCode||opts.tabThrough===!1&&e.keyCode===Inputmask.keyCode.TAB))){switch(e.type){case"input":if(skipInputEvent===!0)return skipInputEvent=!1,e.preventDefault();break;case"keydown":skipKeyPressEvent=!1,skipInputEvent=!1;break;case"keypress":if(skipKeyPressEvent===!0)return e.preventDefault();skipKeyPressEvent=!0;break;case"click":if(iemobile){var that=this;return setTimeout(function(){eventHandler.apply(that,arguments);},0),!1;}}
var returnVal=eventHandler.apply(this,arguments);return returnVal===!1&&(e.preventDefault(),e.stopPropagation()),returnVal;}
e.preventDefault();}};input.inputmask.events[eventName]=input.inputmask.events[eventName]||[],input.inputmask.events[eventName].push(ev),$.inArray(eventName,["submit","reset"])!==-1?null!=input.form&&$(input.form).on(eventName,ev):$(input).on(eventName,ev);},off:function(input,event){if(input.inputmask&&input.inputmask.events){var events;event?(events=[],events[event]=input.inputmask.events[event]):events=input.inputmask.events,$.each(events,function(eventName,evArr){for(;evArr.length>0;){var ev=evArr.pop();$.inArray(eventName,["submit","reset"])!==-1?null!=input.form&&$(input.form).off(eventName,ev):$(input).off(eventName,ev);}
delete input.inputmask.events[eventName];});}}};if(void 0!==actionObj)switch(actionObj.action){case"isComplete":return el=actionObj.el,isComplete(getBuffer());case"unmaskedvalue":return el=actionObj.el,void 0!==el&&void 0!==el.inputmask?(maskset=el.inputmask.maskset,opts=el.inputmask.opts,isRTL=el.inputmask.isRTL):(valueBuffer=actionObj.value,opts.numericInput&&(isRTL=!0),valueBuffer=($.isFunction(opts.onBeforeMask)?opts.onBeforeMask(valueBuffer,opts)||valueBuffer:valueBuffer).split(""),checkVal(void 0,!1,!1,isRTL?valueBuffer.reverse():valueBuffer),$.isFunction(opts.onBeforeWrite)&&opts.onBeforeWrite(void 0,getBuffer(),0,opts)),unmaskedvalue(el);case"mask":el=actionObj.el,maskset=el.inputmask.maskset,opts=el.inputmask.opts,isRTL=el.inputmask.isRTL,mask(el);break;case"format":return opts.numericInput&&(isRTL=!0),valueBuffer=($.isFunction(opts.onBeforeMask)?opts.onBeforeMask(actionObj.value,opts)||actionObj.value:actionObj.value).split(""),checkVal(void 0,!1,!1,isRTL?valueBuffer.reverse():valueBuffer),$.isFunction(opts.onBeforeWrite)&&opts.onBeforeWrite(void 0,getBuffer(),0,opts),actionObj.metadata?{value:isRTL?getBuffer().slice().reverse().join(""):getBuffer().join(""),metadata:maskScope({action:"getmetadata"},maskset,opts)}:isRTL?getBuffer().slice().reverse().join(""):getBuffer().join("");case"isValid":opts.numericInput&&(isRTL=!0),actionObj.value?(valueBuffer=actionObj.value.split(""),checkVal(void 0,!1,!0,isRTL?valueBuffer.reverse():valueBuffer)):actionObj.value=getBuffer().join("");for(var buffer=getBuffer(),rl=determineLastRequiredPosition(),lmib=buffer.length-1;lmib>rl&&!isMask(lmib);lmib--);return buffer.splice(rl,lmib+1-rl),isComplete(buffer)&&actionObj.value===getBuffer().join("");case"getemptymask":return getBufferTemplate().join("");case"remove":el=actionObj.el,$el=$(el),maskset=el.inputmask.maskset,opts=el.inputmask.opts,el.inputmask._valueSet(unmaskedvalue(el)),EventRuler.off(el);var valueProperty;Object.getOwnPropertyDescriptor&&Object.getPrototypeOf?(valueProperty=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(el),"value"),valueProperty&&el.inputmask.__valueGet&&Object.defineProperty(el,"value",{get:el.inputmask.__valueGet,set:el.inputmask.__valueSet,configurable:!0})):document.__lookupGetter__&&el.__lookupGetter__("value")&&el.inputmask.__valueGet&&(el.__defineGetter__("value",el.inputmask.__valueGet),el.__defineSetter__("value",el.inputmask.__valueSet)),el.inputmask=void 0;break;case"getmetadata":if($.isArray(maskset.metadata)){for(var alternation,lvp=getLastValidPosition(void 0,!0),firstAlt=lvp;firstAlt>=0;firstAlt--)if(getMaskSet().validPositions[firstAlt]&&void 0!==getMaskSet().validPositions[firstAlt].alternation){alternation=getMaskSet().validPositions[firstAlt].alternation;break;}
return void 0!==alternation?maskset.metadata[getMaskSet().validPositions[firstAlt].locator[alternation]]:[];}
return maskset.metadata;}}
Inputmask.prototype={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},quantifiermarker:{start:"{",end:"}"},groupmarker:{start:"(",end:")"},alternatormarker:"|",escapeChar:"\\",mask:null,oncomplete:$.noop,onincomplete:$.noop,oncleared:$.noop,repeat:0,greedy:!0,autoUnmask:!1,removeMaskOnSubmit:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},alias:null,onKeyDown:$.noop,onBeforeMask:null,onBeforePaste:function(pastedValue,opts){return $.isFunction(opts.onBeforeMask)?opts.onBeforeMask(pastedValue,opts):pastedValue;},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:$.noop,skipOptionalPartCharacter:" ",showTooltip:!1,tooltip:void 0,numericInput:!1,rightAlign:!1,undoOnEscape:!0,radixPoint:"",radixPointDefinitionSymbol:void 0,groupSeparator:"",keepStatic:null,positionCaretOnTab:!0,tabThrough:!1,supportsInputType:["text","tel","password"],definitions:{"9":{validator:"[0-9]",cardinality:1,definitionSymbol:"*"},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,definitionSymbol:"*"},"*":{validator:"[0-9A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:null,canClearPosition:$.noop,postValidation:null,staticDefinitionSymbol:void 0,jitMasking:!1,nullable:!0,inputEventOnly:!1,positionCaretOnClick:"lvp",casing:null},masksCache:{},mask:function(elems){var that=this;return"string"==typeof elems&&(elems=document.getElementById(elems)||document.querySelectorAll(elems)),elems=elems.nodeName?[elems]:elems,$.each(elems,function(ndx,el){var scopedOpts=$.extend(!0,{},that.opts);importAttributeOptions(el,scopedOpts,$.extend(!0,{},that.userOptions));var maskset=generateMaskSet(scopedOpts,that.noMasksCache);void 0!==maskset&&(void 0!==el.inputmask&&el.inputmask.remove(),el.inputmask=new Inputmask(),el.inputmask.opts=scopedOpts,el.inputmask.noMasksCache=that.noMasksCache,el.inputmask.userOptions=$.extend(!0,{},that.userOptions),el.inputmask.el=el,el.inputmask.maskset=maskset,el.inputmask.isRTL=!1,$.data(el,"_inputmask_opts",scopedOpts),maskScope({action:"mask",el:el}));}),elems&&elems[0]?elems[0].inputmask||this:this;},option:function(options,noremask){return"string"==typeof options?this.opts[options]:"object"==typeof options?($.extend(this.userOptions,options),this.el&&noremask!==!0&&this.mask(this.el),this):void 0;},unmaskedvalue:function(value){return maskScope({action:"unmaskedvalue",el:this.el,value:value},this.el&&this.el.inputmask?this.el.inputmask.maskset:generateMaskSet(this.opts,this.noMasksCache),this.opts);},remove:function(){if(this.el)return maskScope({action:"remove",el:this.el}),this.el.inputmask=void 0,this.el;},getemptymask:function(){return maskScope({action:"getemptymask"},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts);},hasMaskedValue:function(){return!this.opts.autoUnmask;},isComplete:function(){return maskScope({action:"isComplete",el:this.el},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts);},getmetadata:function(){return maskScope({action:"getmetadata"},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts);},isValid:function(value){return maskScope({action:"isValid",value:value},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts);},format:function(value,metadata){return maskScope({action:"format",value:value,metadata:metadata},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts);}},Inputmask.extendDefaults=function(options){$.extend(!0,Inputmask.prototype.defaults,options);},Inputmask.extendDefinitions=function(definition){$.extend(!0,Inputmask.prototype.defaults.definitions,definition);},Inputmask.extendAliases=function(alias){$.extend(!0,Inputmask.prototype.defaults.aliases,alias);},Inputmask.format=function(value,options,metadata){return Inputmask(options).format(value,metadata);},Inputmask.unmask=function(value,options){return Inputmask(options).unmaskedvalue(value);},Inputmask.isValid=function(value,options){return Inputmask(options).isValid(value);},Inputmask.remove=function(elems){$.each(elems,function(ndx,el){el.inputmask&&el.inputmask.remove();});},Inputmask.escapeRegex=function(str){var specials=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^"];return str.replace(new RegExp("(\\"+specials.join("|\\")+")","gim"),"\\$1");},Inputmask.keyCode={ALT:18,BACKSPACE:8,BACKSPACE_SAFARI:127,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91,X:88};var ua=navigator.userAgent,mobile=/mobile/i.test(ua),iemobile=/iemobile/i.test(ua),iphone=/iphone/i.test(ua)&&!iemobile;return window.Inputmask=Inputmask,Inputmask;}(jQuery),function($,Inputmask){return void 0===$.fn.inputmask&&($.fn.inputmask=function(fn,options){var nptmask,input=this[0];if(void 0===options&&(options={}),"string"==typeof fn)switch(fn){case"unmaskedvalue":return input&&input.inputmask?input.inputmask.unmaskedvalue():$(input).val();case"remove":return this.each(function(){this.inputmask&&this.inputmask.remove();});case"getemptymask":return input&&input.inputmask?input.inputmask.getemptymask():"";case"hasMaskedValue":return!(!input||!input.inputmask)&&input.inputmask.hasMaskedValue();case"isComplete":return!input||!input.inputmask||input.inputmask.isComplete();case"getmetadata":return input&&input.inputmask?input.inputmask.getmetadata():void 0;case"setvalue":$(input).val(options),input&&void 0===input.inputmask&&$(input).triggerHandler("setvalue");break;case"option":if("string"!=typeof options)return this.each(function(){if(void 0!==this.inputmask)return this.inputmask.option(options);});if(input&&void 0!==input.inputmask)return input.inputmask.option(options);break;default:return options.alias=fn,nptmask=new Inputmask(options),this.each(function(){nptmask.mask(this);});}else{if("object"==typeof fn)return nptmask=new Inputmask(fn),void 0===fn.mask&&void 0===fn.alias?this.each(function(){return void 0!==this.inputmask?this.inputmask.option(fn):void nptmask.mask(this);}):this.each(function(){nptmask.mask(this);});if(void 0===fn)return this.each(function(){nptmask=new Inputmask(options),nptmask.mask(this);});}}),$.fn.inputmask;}(jQuery,Inputmask),function($,Inputmask){return Inputmask.extendDefinitions({h:{validator:"[01][0-9]|2[0-3]",cardinality:2,prevalidator:[{validator:"[0-2]",cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:"[0-5]",cardinality:1}]},d:{validator:"0[1-9]|[12][0-9]|3[01]",cardinality:2,prevalidator:[{validator:"[0-3]",cardinality:1}]},m:{validator:"0[1-9]|1[012]",cardinality:2,prevalidator:[{validator:"[01]",cardinality:1}]},y:{validator:"(19|20)\\d{2}",cardinality:4,prevalidator:[{validator:"[12]",cardinality:1},{validator:"(19|20)",cardinality:2},{validator:"(19|20)\\d",cardinality:3}]}}),Inputmask.extendAliases({"dd/mm/yyyy":{mask:"1/2/y",placeholder:"dd/mm/yyyy",regex:{val1pre:new RegExp("[0-3]"),val1:new RegExp("0[1-9]|[12][0-9]|3[01]"),val2pre:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|[12][0-9]|3[01])"+escapedSeparator+"[01])");},val2:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|[12][0-9])"+escapedSeparator+"(0[1-9]|1[012]))|(30"+escapedSeparator+"(0[13-9]|1[012]))|(31"+escapedSeparator+"(0[13578]|1[02]))");}},leapday:"29/02/",separator:"/",yearrange:{minyear:1900,maxyear:2099},isInYearRange:function(chrs,minyear,maxyear){if(isNaN(chrs))return!1;var enteredyear=parseInt(chrs.concat(minyear.toString().slice(chrs.length))),enteredyear2=parseInt(chrs.concat(maxyear.toString().slice(chrs.length)));return!isNaN(enteredyear)&&(minyear<=enteredyear&&enteredyear<=maxyear)||!isNaN(enteredyear2)&&(minyear<=enteredyear2&&enteredyear2<=maxyear);},determinebaseyear:function(minyear,maxyear,hint){var currentyear=new Date().getFullYear();if(minyear>currentyear)return minyear;if(maxyear<currentyear){for(var maxYearPrefix=maxyear.toString().slice(0,2),maxYearPostfix=maxyear.toString().slice(2,4);maxyear<maxYearPrefix+hint;)maxYearPrefix--;var maxxYear=maxYearPrefix+maxYearPostfix;return minyear>maxxYear?minyear:maxxYear;}
if(minyear<=currentyear&&currentyear<=maxyear){for(var currentYearPrefix=currentyear.toString().slice(0,2);maxyear<currentYearPrefix+hint;)currentYearPrefix--;var currentYearAndHint=currentYearPrefix+hint;return currentYearAndHint<minyear?minyear:currentYearAndHint;}
return currentyear;},onKeyDown:function(e,buffer,caretPos,opts){var $input=$(this);if(e.ctrlKey&&e.keyCode===Inputmask.keyCode.RIGHT){var today=new Date();$input.val(today.getDate().toString()+(today.getMonth()+1).toString()+today.getFullYear().toString()),$input.trigger("setvalue");}},getFrontValue:function(mask,buffer,opts){for(var start=0,length=0,i=0;i<mask.length&&"2"!==mask.charAt(i);i++){var definition=opts.definitions[mask.charAt(i)];definition?(start+=length,length=definition.cardinality):length++;}
return buffer.join("").substr(start,length);},definitions:{"1":{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.regex.val1.test(chrs);return strict||isValid||chrs.charAt(1)!==opts.separator&&"-./".indexOf(chrs.charAt(1))===-1||!(isValid=opts.regex.val1.test("0"+chrs.charAt(0)))?isValid:(maskset.buffer[pos-1]="0",{refreshFromBuffer:{start:pos-1,end:pos},pos:pos,c:chrs.charAt(0)});},cardinality:2,prevalidator:[{validator:function(chrs,maskset,pos,strict,opts){var pchrs=chrs;isNaN(maskset.buffer[pos+1])||(pchrs+=maskset.buffer[pos+1]);var isValid=1===pchrs.length?opts.regex.val1pre.test(pchrs):opts.regex.val1.test(pchrs);if(!strict&&!isValid){if(isValid=opts.regex.val1.test(chrs+"0"))return maskset.buffer[pos]=chrs,maskset.buffer[++pos]="0",{pos:pos,c:"0"};if(isValid=opts.regex.val1.test("0"+chrs))return maskset.buffer[pos]="0",pos++,{pos:pos};}
return isValid;},cardinality:1}]},"2":{validator:function(chrs,maskset,pos,strict,opts){var frontValue=opts.getFrontValue(maskset.mask,maskset.buffer,opts);frontValue.indexOf(opts.placeholder[0])!==-1&&(frontValue="01"+opts.separator);var isValid=opts.regex.val2(opts.separator).test(frontValue+chrs);if(!strict&&!isValid&&(chrs.charAt(1)===opts.separator||"-./".indexOf(chrs.charAt(1))!==-1)&&(isValid=opts.regex.val2(opts.separator).test(frontValue+"0"+chrs.charAt(0))))return maskset.buffer[pos-1]="0",{refreshFromBuffer:{start:pos-1,end:pos},pos:pos,c:chrs.charAt(0)};if(opts.mask.indexOf("2")===opts.mask.length-1&&isValid){var dayMonthValue=maskset.buffer.join("").substr(4,4)+chrs;if(dayMonthValue!==opts.leapday)return!0;var year=parseInt(maskset.buffer.join("").substr(0,4),10);return year%4===0&&(year%100!==0||year%400===0);}
return isValid;},cardinality:2,prevalidator:[{validator:function(chrs,maskset,pos,strict,opts){isNaN(maskset.buffer[pos+1])||(chrs+=maskset.buffer[pos+1]);var frontValue=opts.getFrontValue(maskset.mask,maskset.buffer,opts);frontValue.indexOf(opts.placeholder[0])!==-1&&(frontValue="01"+opts.separator);var isValid=1===chrs.length?opts.regex.val2pre(opts.separator).test(frontValue+chrs):opts.regex.val2(opts.separator).test(frontValue+chrs);return strict||isValid||!(isValid=opts.regex.val2(opts.separator).test(frontValue+"0"+chrs))?isValid:(maskset.buffer[pos]="0",pos++,{pos:pos});},cardinality:1}]},y:{validator:function(chrs,maskset,pos,strict,opts){if(opts.isInYearRange(chrs,opts.yearrange.minyear,opts.yearrange.maxyear)){var dayMonthValue=maskset.buffer.join("").substr(0,6);if(dayMonthValue!==opts.leapday)return!0;var year=parseInt(chrs,10);return year%4===0&&(year%100!==0||year%400===0);}
return!1;},cardinality:4,prevalidator:[{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.isInYearRange(chrs,opts.yearrange.minyear,opts.yearrange.maxyear);if(!strict&&!isValid){var yearPrefix=opts.determinebaseyear(opts.yearrange.minyear,opts.yearrange.maxyear,chrs+"0").toString().slice(0,1);if(isValid=opts.isInYearRange(yearPrefix+chrs,opts.yearrange.minyear,opts.yearrange.maxyear))return maskset.buffer[pos++]=yearPrefix.charAt(0),{pos:pos};if(yearPrefix=opts.determinebaseyear(opts.yearrange.minyear,opts.yearrange.maxyear,chrs+"0").toString().slice(0,2),isValid=opts.isInYearRange(yearPrefix+chrs,opts.yearrange.minyear,opts.yearrange.maxyear))return maskset.buffer[pos++]=yearPrefix.charAt(0),maskset.buffer[pos++]=yearPrefix.charAt(1),{pos:pos};}
return isValid;},cardinality:1},{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.isInYearRange(chrs,opts.yearrange.minyear,opts.yearrange.maxyear);if(!strict&&!isValid){var yearPrefix=opts.determinebaseyear(opts.yearrange.minyear,opts.yearrange.maxyear,chrs).toString().slice(0,2);if(isValid=opts.isInYearRange(chrs[0]+yearPrefix[1]+chrs[1],opts.yearrange.minyear,opts.yearrange.maxyear))return maskset.buffer[pos++]=yearPrefix.charAt(1),{pos:pos};if(yearPrefix=opts.determinebaseyear(opts.yearrange.minyear,opts.yearrange.maxyear,chrs).toString().slice(0,2),opts.isInYearRange(yearPrefix+chrs,opts.yearrange.minyear,opts.yearrange.maxyear)){var dayMonthValue=maskset.buffer.join("").substr(0,6);if(dayMonthValue!==opts.leapday)isValid=!0;else{var year=parseInt(chrs,10);isValid=year%4===0&&(year%100!==0||year%400===0);}}else isValid=!1;if(isValid)return maskset.buffer[pos-1]=yearPrefix.charAt(0),maskset.buffer[pos++]=yearPrefix.charAt(1),maskset.buffer[pos++]=chrs.charAt(0),{refreshFromBuffer:{start:pos-3,end:pos},pos:pos};}
return isValid;},cardinality:2},{validator:function(chrs,maskset,pos,strict,opts){return opts.isInYearRange(chrs,opts.yearrange.minyear,opts.yearrange.maxyear);},cardinality:3}]}},insertMode:!1,autoUnmask:!1},"mm/dd/yyyy":{placeholder:"mm/dd/yyyy",alias:"dd/mm/yyyy",regex:{val2pre:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[13-9]|1[012])"+escapedSeparator+"[0-3])|(02"+escapedSeparator+"[0-2])");},val2:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|1[012])"+escapedSeparator+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+escapedSeparator+"30)|((0[13578]|1[02])"+escapedSeparator+"31)");},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(e,buffer,caretPos,opts){var $input=$(this);if(e.ctrlKey&&e.keyCode===Inputmask.keyCode.RIGHT){var today=new Date();$input.val((today.getMonth()+1).toString()+today.getDate().toString()+today.getFullYear().toString()),$input.trigger("setvalue");}}},"yyyy/mm/dd":{mask:"y/1/2",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",leapday:"/02/29",onKeyDown:function(e,buffer,caretPos,opts){var $input=$(this);if(e.ctrlKey&&e.keyCode===Inputmask.keyCode.RIGHT){var today=new Date();$input.val(today.getFullYear().toString()+(today.getMonth()+1).toString()+today.getDate().toString()),$input.trigger("setvalue");}}},"dd.mm.yyyy":{mask:"1.2.y",placeholder:"dd.mm.yyyy",leapday:"29.02.",separator:".",alias:"dd/mm/yyyy"},"dd-mm-yyyy":{mask:"1-2-y",placeholder:"dd-mm-yyyy",leapday:"29-02-",separator:"-",alias:"dd/mm/yyyy"},"mm.dd.yyyy":{mask:"1.2.y",placeholder:"mm.dd.yyyy",leapday:"02.29.",separator:".",alias:"mm/dd/yyyy"},"mm-dd-yyyy":{mask:"1-2-y",placeholder:"mm-dd-yyyy",leapday:"02-29-",separator:"-",alias:"mm/dd/yyyy"},"yyyy.mm.dd":{mask:"y.1.2",placeholder:"yyyy.mm.dd",leapday:".02.29",separator:".",alias:"yyyy/mm/dd"},"yyyy-mm-dd":{mask:"y-1-2",placeholder:"yyyy-mm-dd",leapday:"-02-29",separator:"-",alias:"yyyy/mm/dd"},datetime:{mask:"1/2/y h:s",placeholder:"dd/mm/yyyy hh:mm",alias:"dd/mm/yyyy",regex:{hrspre:new RegExp("[012]"),hrs24:new RegExp("2[0-4]|1[3-9]"),hrs:new RegExp("[01][0-9]|2[0-4]"),ampm:new RegExp("^[a|p|A|P][m|M]"),mspre:new RegExp("[0-5]"),ms:new RegExp("[0-5][0-9]")},timeseparator:":",hourFormat:"24",definitions:{h:{validator:function(chrs,maskset,pos,strict,opts){if("24"===opts.hourFormat&&24===parseInt(chrs,10))return maskset.buffer[pos-1]="0",maskset.buffer[pos]="0",{refreshFromBuffer:{start:pos-1,end:pos},c:"0"};var isValid=opts.regex.hrs.test(chrs);if(!strict&&!isValid&&(chrs.charAt(1)===opts.timeseparator||"-.:".indexOf(chrs.charAt(1))!==-1)&&(isValid=opts.regex.hrs.test("0"+chrs.charAt(0))))return maskset.buffer[pos-1]="0",maskset.buffer[pos]=chrs.charAt(0),pos++,{refreshFromBuffer:{start:pos-2,end:pos},pos:pos,c:opts.timeseparator};if(isValid&&"24"!==opts.hourFormat&&opts.regex.hrs24.test(chrs)){var tmp=parseInt(chrs,10);return 24===tmp?(maskset.buffer[pos+5]="a",maskset.buffer[pos+6]="m"):(maskset.buffer[pos+5]="p",maskset.buffer[pos+6]="m"),tmp-=12,tmp<10?(maskset.buffer[pos]=tmp.toString(),maskset.buffer[pos-1]="0"):(maskset.buffer[pos]=tmp.toString().charAt(1),maskset.buffer[pos-1]=tmp.toString().charAt(0)),{refreshFromBuffer:{start:pos-1,end:pos+6},c:maskset.buffer[pos]};}
return isValid;},cardinality:2,prevalidator:[{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.regex.hrspre.test(chrs);return strict||isValid||!(isValid=opts.regex.hrs.test("0"+chrs))?isValid:(maskset.buffer[pos]="0",pos++,{pos:pos});},cardinality:1}]},s:{validator:"[0-5][0-9]",cardinality:2,prevalidator:[{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.regex.mspre.test(chrs);return strict||isValid||!(isValid=opts.regex.ms.test("0"+chrs))?isValid:(maskset.buffer[pos]="0",pos++,{pos:pos});},cardinality:1}]},t:{validator:function(chrs,maskset,pos,strict,opts){return opts.regex.ampm.test(chrs+"m");},casing:"lower",cardinality:1}},insertMode:!1,autoUnmask:!1},datetime12:{mask:"1/2/y h:s t\\m",placeholder:"dd/mm/yyyy hh:mm xm",alias:"datetime",hourFormat:"12"},"mm/dd/yyyy hh:mm xm":{mask:"1/2/y h:s t\\m",placeholder:"mm/dd/yyyy hh:mm xm",alias:"datetime12",regex:{val2pre:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[13-9]|1[012])"+escapedSeparator+"[0-3])|(02"+escapedSeparator+"[0-2])");},val2:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|1[012])"+escapedSeparator+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+escapedSeparator+"30)|((0[13578]|1[02])"+escapedSeparator+"31)");},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},leapday:"02/29/",onKeyDown:function(e,buffer,caretPos,opts){var $input=$(this);if(e.ctrlKey&&e.keyCode===Inputmask.keyCode.RIGHT){var today=new Date();$input.val((today.getMonth()+1).toString()+today.getDate().toString()+today.getFullYear().toString()),$input.trigger("setvalue");}}},"hh:mm t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"h:s t":{mask:"h:s t\\m",placeholder:"hh:mm xm",alias:"datetime",hourFormat:"12"},"hh:mm:ss":{mask:"h:s:s",placeholder:"hh:mm:ss",alias:"datetime",autoUnmask:!1},"hh:mm":{mask:"h:s",placeholder:"hh:mm",alias:"datetime",autoUnmask:!1},date:{alias:"dd/mm/yyyy"},"mm/yyyy":{mask:"1/y",placeholder:"mm/yyyy",leapday:"donotuse",separator:"/",alias:"mm/dd/yyyy"},shamsi:{regex:{val2pre:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|1[012])"+escapedSeparator+"[0-3])");},val2:function(separator){var escapedSeparator=Inputmask.escapeRegex.call(this,separator);return new RegExp("((0[1-9]|1[012])"+escapedSeparator+"(0[1-9]|[12][0-9]))|((0[1-9]|1[012])"+escapedSeparator+"30)|((0[1-6])"+escapedSeparator+"31)");},val1pre:new RegExp("[01]"),val1:new RegExp("0[1-9]|1[012]")},yearrange:{minyear:1300,maxyear:1499},mask:"y/1/2",leapday:"/12/30",placeholder:"yyyy/mm/dd",alias:"mm/dd/yyyy",clearIncomplete:!0}}),Inputmask;}(jQuery,Inputmask),function($,Inputmask){return Inputmask.extendDefinitions({A:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,casing:"upper"},"&":{validator:"[0-9A-Za-z\u0410-\u044f\u0401\u0451\xc0-\xff\xb5]",cardinality:1,casing:"upper"},"#":{validator:"[0-9A-Fa-f]",cardinality:1,casing:"upper"}}),Inputmask.extendAliases({url:{definitions:{i:{validator:".",cardinality:1}},mask:"(\\http://)|(\\http\\s://)|(ftp://)|(ftp\\s://)i{+}",insertMode:!1,autoUnmask:!1},ip:{mask:"i[i[i]].i[i[i]].i[i[i]].i[i[i]]",definitions:{i:{validator:function(chrs,maskset,pos,strict,opts){return pos-1>-1&&"."!==maskset.buffer[pos-1]?(chrs=maskset.buffer[pos-1]+chrs,chrs=pos-2>-1&&"."!==maskset.buffer[pos-2]?maskset.buffer[pos-2]+chrs:"0"+chrs):chrs="00"+chrs,new RegExp("25[0-5]|2[0-4][0-9]|[01][0-9][0-9]").test(chrs);},cardinality:1}},onUnMask:function(maskedValue,unmaskedValue,opts){return maskedValue;}},email:{mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,63}]@-{1,63}.-{1,63}[.-{1,63}][.-{1,63}]",greedy:!1,onBeforePaste:function(pastedValue,opts){return pastedValue=pastedValue.toLowerCase(),pastedValue.replace("mailto:","");},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"},"-":{validator:"[0-9A-Za-z-]",cardinality:1,casing:"lower"}},onUnMask:function(maskedValue,unmaskedValue,opts){return maskedValue;}},mac:{mask:"##:##:##:##:##:##"},vin:{mask:"V{13}9{4}",definitions:{V:{validator:"[A-HJ-NPR-Za-hj-npr-z\\d]",cardinality:1,casing:"upper"}},clearIncomplete:!0,autoUnmask:!0}}),Inputmask;}(jQuery,Inputmask),function($,Inputmask){return Inputmask.extendAliases({numeric:{mask:function(opts){function autoEscape(txt){for(var escapedTxt="",i=0;i<txt.length;i++)escapedTxt+=opts.definitions[txt.charAt(i)]||opts.optionalmarker.start===txt.charAt(i)||opts.optionalmarker.end===txt.charAt(i)||opts.quantifiermarker.start===txt.charAt(i)||opts.quantifiermarker.end===txt.charAt(i)||opts.groupmarker.start===txt.charAt(i)||opts.groupmarker.end===txt.charAt(i)||opts.alternatormarker===txt.charAt(i)?"\\"+txt.charAt(i):txt.charAt(i);return escapedTxt;}
if(0!==opts.repeat&&isNaN(opts.integerDigits)&&(opts.integerDigits=opts.repeat),opts.repeat=0,opts.groupSeparator===opts.radixPoint&&("."===opts.radixPoint?opts.groupSeparator=",":","===opts.radixPoint?opts.groupSeparator=".":opts.groupSeparator="")," "===opts.groupSeparator&&(opts.skipOptionalPartCharacter=void 0),opts.autoGroup=opts.autoGroup&&""!==opts.groupSeparator,opts.autoGroup&&("string"==typeof opts.groupSize&&isFinite(opts.groupSize)&&(opts.groupSize=parseInt(opts.groupSize)),isFinite(opts.integerDigits))){var seps=Math.floor(opts.integerDigits/opts.groupSize),mod=opts.integerDigits%opts.groupSize;opts.integerDigits=parseInt(opts.integerDigits)+(0===mod?seps-1:seps),opts.integerDigits<1&&(opts.integerDigits="*");}
opts.placeholder.length>1&&(opts.placeholder=opts.placeholder.charAt(0)),"radixFocus"===opts.positionCaretOnClick&&""===opts.placeholder&&opts.integerOptional===!1&&(opts.positionCaretOnClick="lvp"),opts.definitions[";"]=opts.definitions["~"],opts.definitions[";"].definitionSymbol="~",opts.numericInput===!0&&(opts.positionCaretOnClick="radixFocus"===opts.positionCaretOnClick?"lvp":opts.positionCaretOnClick,opts.digitsOptional=!1,isNaN(opts.digits)&&(opts.digits=2),opts.decimalProtect=!1);var mask=autoEscape(opts.prefix);if(mask+="[+]",mask+=opts.integerOptional===!0?"~{1,"+opts.integerDigits+"}":"~{"+opts.integerDigits+"}",void 0!==opts.digits){opts.decimalProtect&&(opts.radixPointDefinitionSymbol=":");var dq=opts.digits.toString().split(",");isFinite(dq[0]&&dq[1]&&isFinite(dq[1]))?mask+=(opts.decimalProtect?":":opts.radixPoint)+";{"+opts.digits+"}":(isNaN(opts.digits)||parseInt(opts.digits)>0)&&(mask+=opts.digitsOptional?"["+(opts.decimalProtect?":":opts.radixPoint)+";{1,"+opts.digits+"}]":(opts.decimalProtect?":":opts.radixPoint)+";{"+opts.digits+"}");}
return mask+="[-]",mask+=autoEscape(opts.suffix),opts.greedy=!1,null!==opts.min&&(opts.min=opts.min.toString().replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),""),","===opts.radixPoint&&(opts.min=opts.min.replace(opts.radixPoint,"."))),null!==opts.max&&(opts.max=opts.max.toString().replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),""),","===opts.radixPoint&&(opts.max=opts.max.replace(opts.radixPoint,"."))),mask;},placeholder:"",greedy:!1,digits:"*",digitsOptional:!0,radixPoint:".",positionCaretOnClick:"radixFocus",groupSize:3,groupSeparator:"",autoGroup:!1,allowPlus:!0,allowMinus:!0,negationSymbol:{front:"-",back:""},integerDigits:"+",integerOptional:!0,prefix:"",suffix:"",rightAlign:!0,decimalProtect:!0,min:null,max:null,step:1,insertMode:!0,autoUnmask:!1,unmaskAsNumber:!1,postFormat:function(buffer,pos,opts){opts.numericInput===!0&&(buffer=buffer.reverse(),isFinite(pos)&&(pos=buffer.join("").length-pos-1));var i,l;pos=pos>=buffer.length?buffer.length-1:pos<opts.prefix.length?opts.prefix.length:pos;var charAtPos=buffer[pos],cbuf=buffer.slice();charAtPos===opts.groupSeparator&&(cbuf.splice(pos--,1),charAtPos=cbuf[pos]),cbuf[pos]="!";var bufVal=cbuf.join(""),bufValOrigin=bufVal;if(bufVal=bufVal.replace(new RegExp(Inputmask.escapeRegex(opts.suffix)+"$"),""),bufVal=bufVal.replace(new RegExp("^"+Inputmask.escapeRegex(opts.prefix)),""),bufVal.length>0&&opts.autoGroup||bufVal.indexOf(opts.groupSeparator)!==-1){var escapedGroupSeparator=Inputmask.escapeRegex(opts.groupSeparator);bufVal=bufVal.replace(new RegExp(escapedGroupSeparator,"g"),"");var radixSplit=bufVal.split(charAtPos===opts.radixPoint?"!":opts.radixPoint);if(bufVal=""===opts.radixPoint?bufVal:radixSplit[0],charAtPos!==opts.negationSymbol.front&&(bufVal=bufVal.replace("!","?")),bufVal.length>opts.groupSize)for(var reg=new RegExp("([-+]?[\\d?]+)([\\d?]{"+opts.groupSize+"})");reg.test(bufVal)&&""!==opts.groupSeparator;)bufVal=bufVal.replace(reg,"$1"+opts.groupSeparator+"$2"),bufVal=bufVal.replace(opts.groupSeparator+opts.groupSeparator,opts.groupSeparator);bufVal=bufVal.replace("?","!"),""!==opts.radixPoint&&radixSplit.length>1&&(bufVal+=(charAtPos===opts.radixPoint?"!":opts.radixPoint)+radixSplit[1]);}
bufVal=opts.prefix+bufVal+opts.suffix;var needsRefresh=bufValOrigin!==bufVal;if(needsRefresh)for(buffer.length=bufVal.length,i=0,l=bufVal.length;i<l;i++)buffer[i]=bufVal.charAt(i);var newPos=$.inArray("!",bufVal);return buffer[newPos]=charAtPos,newPos=opts.numericInput&&isFinite(pos)?buffer.join("").length-newPos-1:newPos,opts.numericInput&&(buffer=buffer.reverse(),$.inArray(opts.radixPoint,buffer)<newPos&&buffer.join("").length-opts.suffix.length!==newPos&&(newPos-=1)),{pos:newPos,refreshFromBuffer:needsRefresh,buffer:buffer};},onBeforeWrite:function(e,buffer,caretPos,opts){var rslt;if(e&&("blur"===e.type||"checkval"===e.type||"keydown"===e.type)){var maskedValue=opts.numericInput?buffer.slice().reverse().join(""):buffer.join(""),processValue=maskedValue.replace(opts.prefix,"");processValue=processValue.replace(opts.suffix,""),processValue=processValue.replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),""),","===opts.radixPoint&&(processValue=processValue.replace(opts.radixPoint,"."));var isNegative=processValue.match(new RegExp("[-"+Inputmask.escapeRegex(opts.negationSymbol.front)+"]","g"));if(isNegative=null!==isNegative&&1===isNegative.length,processValue=processValue.replace(new RegExp("[-"+Inputmask.escapeRegex(opts.negationSymbol.front)+"]","g"),""),processValue=processValue.replace(new RegExp(Inputmask.escapeRegex(opts.negationSymbol.back)+"$"),""),isNaN(opts.placeholder)&&(processValue=processValue.replace(new RegExp(Inputmask.escapeRegex(opts.placeholder),"g"),"")),processValue=processValue===opts.negationSymbol.front?processValue+"0":processValue,""!==processValue&&isFinite(processValue)){var floatValue=parseFloat(processValue),signedFloatValue=isNegative?floatValue*-1:floatValue;if(null!==opts.min&&isFinite(opts.min)&&signedFloatValue<parseFloat(opts.min)?(floatValue=Math.abs(opts.min),isNegative=opts.min<0,maskedValue=void 0):null!==opts.max&&isFinite(opts.max)&&signedFloatValue>parseFloat(opts.max)&&(floatValue=Math.abs(opts.max),isNegative=opts.max<0,maskedValue=void 0),processValue=floatValue.toString().replace(".",opts.radixPoint).split(""),isFinite(opts.digits)){var radixPosition=$.inArray(opts.radixPoint,processValue),rpb=$.inArray(opts.radixPoint,maskedValue);radixPosition===-1&&(processValue.push(opts.radixPoint),radixPosition=processValue.length-1);for(var i=1;i<=opts.digits;i++)opts.digitsOptional||void 0!==processValue[radixPosition+i]&&processValue[radixPosition+i]!==opts.placeholder.charAt(0)?rpb!==-1&&void 0!==maskedValue[rpb+i]&&(processValue[radixPosition+i]=processValue[radixPosition+i]||maskedValue[rpb+i]):processValue[radixPosition+i]="0";processValue[processValue.length-1]===opts.radixPoint&&delete processValue[processValue.length-1];}
if(floatValue.toString()!==processValue&&floatValue.toString()+"."!==processValue||isNegative)return!isNegative||0===floatValue&&"blur"===e.type||(processValue.unshift(opts.negationSymbol.front),processValue.push(opts.negationSymbol.back)),processValue=(opts.prefix+processValue.join("")).split(""),opts.numericInput&&(processValue=processValue.reverse()),rslt=opts.postFormat(processValue,opts.numericInput?caretPos:caretPos-1,opts),rslt.buffer&&(rslt.refreshFromBuffer=rslt.buffer.join("")!==buffer.join("")),rslt;}}
if(opts.autoGroup)return rslt=opts.postFormat(buffer,opts.numericInput?caretPos:caretPos-1,opts),rslt.caret=caretPos<=opts.prefix.length?rslt.pos:rslt.pos+1,rslt;},regex:{integerPart:function(opts){return new RegExp("["+Inputmask.escapeRegex(opts.negationSymbol.front)+"+]?\\d+");},integerNPart:function(opts){return new RegExp("[\\d"+Inputmask.escapeRegex(opts.groupSeparator)+Inputmask.escapeRegex(opts.placeholder.charAt(0))+"]+");}},signHandler:function(chrs,maskset,pos,strict,opts){if(!strict&&opts.allowMinus&&"-"===chrs||opts.allowPlus&&"+"===chrs){var matchRslt=maskset.buffer.join("").match(opts.regex.integerPart(opts));if(matchRslt&&matchRslt[0].length>0)return maskset.buffer[matchRslt.index]===("-"===chrs?"+":opts.negationSymbol.front)?"-"===chrs?""!==opts.negationSymbol.back?{pos:matchRslt.index,c:opts.negationSymbol.front,remove:matchRslt.index,caret:pos,insert:{pos:maskset.buffer.length-opts.suffix.length-1,c:opts.negationSymbol.back}}:{pos:matchRslt.index,c:opts.negationSymbol.front,remove:matchRslt.index,caret:pos}:""!==opts.negationSymbol.back?{pos:matchRslt.index,c:"+",remove:[matchRslt.index,maskset.buffer.length-opts.suffix.length-1],caret:pos}:{pos:matchRslt.index,c:"+",remove:matchRslt.index,caret:pos}:maskset.buffer[matchRslt.index]===("-"===chrs?opts.negationSymbol.front:"+")?"-"===chrs&&""!==opts.negationSymbol.back?{remove:[matchRslt.index,maskset.buffer.length-opts.suffix.length-1],caret:pos-1}:{remove:matchRslt.index,caret:pos-1}:"-"===chrs?""!==opts.negationSymbol.back?{pos:matchRslt.index,c:opts.negationSymbol.front,caret:pos+1,insert:{pos:maskset.buffer.length-opts.suffix.length,c:opts.negationSymbol.back}}:{pos:matchRslt.index,c:opts.negationSymbol.front,caret:pos+1}:{pos:matchRslt.index,c:chrs,caret:pos+1};}
return!1;},radixHandler:function(chrs,maskset,pos,strict,opts){if(!strict&&opts.numericInput!==!0&&chrs===opts.radixPoint&&void 0!==opts.digits&&(isNaN(opts.digits)||parseInt(opts.digits)>0)){var radixPos=$.inArray(opts.radixPoint,maskset.buffer),integerValue=maskset.buffer.join("").match(opts.regex.integerPart(opts));if(radixPos!==-1&&maskset.validPositions[radixPos])return maskset.validPositions[radixPos-1]?{caret:radixPos+1}:{pos:integerValue.index,c:integerValue[0],caret:radixPos+1};if(!integerValue||"0"===integerValue[0]&&integerValue.index+1!==pos)return maskset.buffer[integerValue?integerValue.index:pos]="0",{pos:(integerValue?integerValue.index:pos)+1,c:opts.radixPoint};}
return!1;},leadingZeroHandler:function(chrs,maskset,pos,strict,opts,isSelection){if(!strict){var buffer=maskset.buffer.slice("");if(buffer.splice(0,opts.prefix.length),buffer.splice(buffer.length-opts.suffix.length,opts.suffix.length),opts.numericInput===!0){var buffer=buffer.reverse(),bufferChar=buffer[0];if("0"===bufferChar&&void 0===maskset.validPositions[pos-1])return{pos:pos,remove:buffer.length-1};}else{pos-=opts.prefix.length;var radixPosition=$.inArray(opts.radixPoint,buffer),matchRslt=buffer.slice(0,radixPosition!==-1?radixPosition:void 0).join("").match(opts.regex.integerNPart(opts));if(matchRslt&&(radixPosition===-1||pos<=radixPosition)){var decimalPart=radixPosition===-1?0:parseInt(buffer.slice(radixPosition+1).join(""));if(0===matchRslt[0].indexOf(""!==opts.placeholder?opts.placeholder.charAt(0):"0")&&(matchRslt.index+1===pos||isSelection!==!0&&0===decimalPart))return maskset.buffer.splice(matchRslt.index+opts.prefix.length,1),{pos:matchRslt.index+opts.prefix.length,remove:matchRslt.index+opts.prefix.length};if("0"===chrs&&pos<=matchRslt.index&&matchRslt[0]!==opts.groupSeparator)return!1;}}}
return!0;},definitions:{"~":{validator:function(chrs,maskset,pos,strict,opts,isSelection){var isValid=opts.signHandler(chrs,maskset,pos,strict,opts);if(!isValid&&(isValid=opts.radixHandler(chrs,maskset,pos,strict,opts),!isValid&&(isValid=strict?new RegExp("[0-9"+Inputmask.escapeRegex(opts.groupSeparator)+"]").test(chrs):new RegExp("[0-9]").test(chrs),isValid===!0&&(isValid=opts.leadingZeroHandler(chrs,maskset,pos,strict,opts,isSelection),isValid===!0)))){var radixPosition=$.inArray(opts.radixPoint,maskset.buffer);isValid=radixPosition!==-1&&(opts.digitsOptional===!1||maskset.validPositions[pos])&&opts.numericInput!==!0&&pos>radixPosition&&!strict?{pos:pos,remove:pos}:{pos:pos};}
return isValid;},cardinality:1},"+":{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.signHandler(chrs,maskset,pos,strict,opts);return!isValid&&(strict&&opts.allowMinus&&chrs===opts.negationSymbol.front||opts.allowMinus&&"-"===chrs||opts.allowPlus&&"+"===chrs)&&(isValid=!(!strict&&"-"===chrs)||(""!==opts.negationSymbol.back?{pos:pos,c:"-"===chrs?opts.negationSymbol.front:"+",caret:pos+1,insert:{pos:maskset.buffer.length,c:opts.negationSymbol.back}}:{pos:pos,c:"-"===chrs?opts.negationSymbol.front:"+",caret:pos+1})),isValid;},cardinality:1,placeholder:""},"-":{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.signHandler(chrs,maskset,pos,strict,opts);return!isValid&&strict&&opts.allowMinus&&chrs===opts.negationSymbol.back&&(isValid=!0),isValid;},cardinality:1,placeholder:""},":":{validator:function(chrs,maskset,pos,strict,opts){var isValid=opts.signHandler(chrs,maskset,pos,strict,opts);if(!isValid){var radix="["+Inputmask.escapeRegex(opts.radixPoint)+"]";isValid=new RegExp(radix).test(chrs),isValid&&maskset.validPositions[pos]&&maskset.validPositions[pos].match.placeholder===opts.radixPoint&&(isValid={caret:pos+1});}
return isValid?{c:opts.radixPoint}:isValid;},cardinality:1,placeholder:function(opts){return opts.radixPoint;}}},onUnMask:function(maskedValue,unmaskedValue,opts){if(""===unmaskedValue&&opts.nullable===!0)return unmaskedValue;var processValue=maskedValue.replace(opts.prefix,"");return processValue=processValue.replace(opts.suffix,""),processValue=processValue.replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),""),opts.unmaskAsNumber?(""!==opts.radixPoint&&processValue.indexOf(opts.radixPoint)!==-1&&(processValue=processValue.replace(Inputmask.escapeRegex.call(this,opts.radixPoint),".")),Number(processValue)):processValue;},isComplete:function(buffer,opts){var maskedValue=buffer.join(""),bufClone=buffer.slice();if(opts.postFormat(bufClone,0,opts),bufClone.join("")!==maskedValue)return!1;var processValue=maskedValue.replace(opts.prefix,"");return processValue=processValue.replace(opts.suffix,""),processValue=processValue.replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),""),","===opts.radixPoint&&(processValue=processValue.replace(Inputmask.escapeRegex(opts.radixPoint),".")),isFinite(processValue);},onBeforeMask:function(initialValue,opts){if(opts.numericInput===!0&&(initialValue=initialValue.split("").reverse().join("")),""!==opts.radixPoint&&isFinite(initialValue))initialValue=initialValue.toString().replace(".",opts.radixPoint);else{var kommaMatches=initialValue.match(/,/g),dotMatches=initialValue.match(/\./g);dotMatches&&kommaMatches?dotMatches.length>kommaMatches.length?(initialValue=initialValue.replace(/\./g,""),initialValue=initialValue.replace(",",opts.radixPoint)):kommaMatches.length>dotMatches.length?(initialValue=initialValue.replace(/,/g,""),initialValue=initialValue.replace(".",opts.radixPoint)):initialValue=initialValue.indexOf(".")<initialValue.indexOf(",")?initialValue.replace(/\./g,""):initialValue=initialValue.replace(/,/g,""):initialValue=initialValue.replace(new RegExp(Inputmask.escapeRegex(opts.groupSeparator),"g"),"");}
if(0===opts.digits&&(initialValue.indexOf(".")!==-1?initialValue=initialValue.substring(0,initialValue.indexOf(".")):initialValue.indexOf(",")!==-1&&(initialValue=initialValue.substring(0,initialValue.indexOf(",")))),""!==opts.radixPoint&&isFinite(opts.digits)&&initialValue.indexOf(opts.radixPoint)!==-1){var valueParts=initialValue.split(opts.radixPoint),decPart=valueParts[1].match(new RegExp("\\d*"))[0];if(parseInt(opts.digits)<decPart.toString().length){var digitsFactor=Math.pow(10,parseInt(opts.digits));initialValue=initialValue.replace(Inputmask.escapeRegex(opts.radixPoint),"."),initialValue=Math.round(parseFloat(initialValue)*digitsFactor)/digitsFactor,initialValue=initialValue.toString().replace(".",opts.radixPoint);}}
return opts.numericInput===!0&&(initialValue=initialValue.split("").reverse().join("")),initialValue.toString();},canClearPosition:function(maskset,position,lvp,strict,opts){var positionInput=maskset.validPositions[position].input,canClear=positionInput!==opts.radixPoint||null!==maskset.validPositions[position].match.fn&&opts.decimalProtect===!1||isFinite(positionInput)||position===lvp||positionInput===opts.groupSeparator||positionInput===opts.negationSymbol.front||positionInput===opts.negationSymbol.back;return canClear;},onKeyDown:function(e,buffer,caretPos,opts){var $input=$(this);if(e.ctrlKey)switch(e.keyCode){case Inputmask.keyCode.UP:$input.val(parseFloat(this.inputmask.unmaskedvalue())+parseInt(opts.step)),$input.trigger("setvalue");break;case Inputmask.keyCode.DOWN:$input.val(parseFloat(this.inputmask.unmaskedvalue())-parseInt(opts.step)),$input.trigger("setvalue");}}},currency:{prefix:"$ ",groupSeparator:",",alias:"numeric",placeholder:"0",autoGroup:!0,digits:2,digitsOptional:!1,clearMaskOnLostFocus:!1},decimal:{alias:"numeric"},integer:{alias:"numeric",digits:0,radixPoint:""},percentage:{alias:"numeric",digits:2,radixPoint:".",placeholder:"0",autoGroup:!1,min:0,max:100,suffix:" %",allowPlus:!1,allowMinus:!1}}),Inputmask;}(jQuery,Inputmask),function($,Inputmask){return Inputmask.extendAliases({abstractphone:{countrycode:"",phoneCodes:[],mask:function(opts){opts.definitions={"#":opts.definitions[9]};var masks=opts.phoneCodes.sort(function(a,b){var maska=(a.mask||a).replace(/#/g,"9").replace(/[\+\(\)#-]/g,""),maskb=(b.mask||b).replace(/#/g,"9").replace(/[\+\(\)#-]/g,""),maskas=(a.mask||a).split("#")[0],maskbs=(b.mask||b).split("#")[0];return 0===maskbs.indexOf(maskas)?-1:0===maskas.indexOf(maskbs)?1:maska.localeCompare(maskb);});return masks;},keepStatic:!0,onBeforeMask:function(value,opts){var processedValue=value.replace(/^0{1,2}/,"").replace(/[\s]/g,"");return(processedValue.indexOf(opts.countrycode)>1||processedValue.indexOf(opts.countrycode)===-1)&&(processedValue="+"+opts.countrycode+processedValue),processedValue;},onUnMask:function(maskedValue,unmaskedValue,opts){return unmaskedValue;}}}),Inputmask;}(jQuery,Inputmask),function($,Inputmask){return Inputmask.extendAliases({Regex:{mask:"r",greedy:!1,repeat:"*",regex:null,regexTokens:null,tokenizer:/\[\^?]?(?:[^\\\]]+|\\[\S\s]?)*]?|\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9][0-9]*|x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4}|c[A-Za-z]|[\S\s]?)|\((?:\?[:=!]?)?|(?:[?*+]|\{[0-9]+(?:,[0-9]*)?\})\??|[^.?*+^${[()|\\]+|./g,quantifierFilter:/[0-9]+[^,]/,isComplete:function(buffer,opts){return new RegExp(opts.regex).test(buffer.join(""));},definitions:{r:{validator:function(chrs,maskset,pos,strict,opts){function RegexToken(isGroup,isQuantifier){this.matches=[],this.isGroup=isGroup||!1,this.isQuantifier=isQuantifier||!1,this.quantifier={min:1,max:1},this.repeaterPart=void 0;}
function analyseRegex(){var match,m,currentToken=new RegexToken(),opengroups=[];for(opts.regexTokens=[];match=opts.tokenizer.exec(opts.regex);)switch(m=match[0],m.charAt(0)){case"(":opengroups.push(new RegexToken((!0)));break;case")":groupToken=opengroups.pop(),opengroups.length>0?opengroups[opengroups.length-1].matches.push(groupToken):currentToken.matches.push(groupToken);break;case"{":case"+":case"*":var quantifierToken=new RegexToken((!1),(!0));m=m.replace(/[{}]/g,"");var mq=m.split(","),mq0=isNaN(mq[0])?mq[0]:parseInt(mq[0]),mq1=1===mq.length?mq0:isNaN(mq[1])?mq[1]:parseInt(mq[1]);if(quantifierToken.quantifier={min:mq0,max:mq1},opengroups.length>0){var matches=opengroups[opengroups.length-1].matches;match=matches.pop(),match.isGroup||(groupToken=new RegexToken((!0)),groupToken.matches.push(match),match=groupToken),matches.push(match),matches.push(quantifierToken);}else match=currentToken.matches.pop(),match.isGroup||(groupToken=new RegexToken((!0)),groupToken.matches.push(match),match=groupToken),currentToken.matches.push(match),currentToken.matches.push(quantifierToken);break;default:opengroups.length>0?opengroups[opengroups.length-1].matches.push(m):currentToken.matches.push(m);}
currentToken.matches.length>0&&opts.regexTokens.push(currentToken);}
function validateRegexToken(token,fromGroup){var isvalid=!1;fromGroup&&(regexPart+="(",openGroupCount++);for(var mndx=0;mndx<token.matches.length;mndx++){var matchToken=token.matches[mndx];if(matchToken.isGroup===!0)isvalid=validateRegexToken(matchToken,!0);else if(matchToken.isQuantifier===!0){var crrntndx=$.inArray(matchToken,token.matches),matchGroup=token.matches[crrntndx-1],regexPartBak=regexPart;if(isNaN(matchToken.quantifier.max)){for(;matchToken.repeaterPart&&matchToken.repeaterPart!==regexPart&&matchToken.repeaterPart.length>regexPart.length&&!(isvalid=validateRegexToken(matchGroup,!0)););isvalid=isvalid||validateRegexToken(matchGroup,!0),isvalid&&(matchToken.repeaterPart=regexPart),regexPart=regexPartBak+matchToken.quantifier.max;}else{for(var i=0,qm=matchToken.quantifier.max-1;i<qm&&!(isvalid=validateRegexToken(matchGroup,!0));i++);regexPart=regexPartBak+"{"+matchToken.quantifier.min+","+matchToken.quantifier.max+"}";}}else if(void 0!==matchToken.matches)for(var k=0;k<matchToken.length&&!(isvalid=validateRegexToken(matchToken[k],fromGroup));k++);else{var testExp;if("["==matchToken.charAt(0)){testExp=regexPart,testExp+=matchToken;for(var j=0;j<openGroupCount;j++)testExp+=")";var exp=new RegExp("^("+testExp+")$");isvalid=exp.test(bufferStr);}else for(var l=0,tl=matchToken.length;l<tl;l++)if("\\"!==matchToken.charAt(l)){testExp=regexPart,testExp+=matchToken.substr(0,l+1),testExp=testExp.replace(/\|$/,"");for(var j=0;j<openGroupCount;j++)testExp+=")";var exp=new RegExp("^("+testExp+")$");if(isvalid=exp.test(bufferStr))break;}
regexPart+=matchToken;}
if(isvalid)break;}
return fromGroup&&(regexPart+=")",openGroupCount--),isvalid;}
var bufferStr,groupToken,cbuffer=maskset.buffer.slice(),regexPart="",isValid=!1,openGroupCount=0;null===opts.regexTokens&&analyseRegex(),cbuffer.splice(pos,0,chrs),bufferStr=cbuffer.join("");for(var i=0;i<opts.regexTokens.length;i++){var regexToken=opts.regexTokens[i];if(isValid=validateRegexToken(regexToken,regexToken.isGroup))break;}
return isValid;},cardinality:1}}}}),Inputmask;}(jQuery,Inputmask);;jQuery.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1;}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000));}else{date=options.expires;}
expires='; expires='+date.toUTCString();}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('');}else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}};;
/*! jQuery printElement - v2.0.1 - 2014-08-22
* https://github.com/erikzaadi/jQuery.printElement
* Copyright (c) 2014 erikzaadi; Licensed MIT, GPL */
(function(window,undefined){var document=window.document;var $=window.jQuery;$.fn.printElement=function(options){var mainOptions=$.extend({},$.fn.printElement.defaults,options);if(mainOptions.printMode==='iframe'){if(/chrome/.test(navigator.userAgent.toLowerCase())){mainOptions.printMode='popup';}}
$("[id^='printElement_']").remove();return this.each(function(){var opts=$.meta?$.extend({},mainOptions,$(this).data()):mainOptions;_printElement($(this),opts);});};$.fn.printElement.defaults={"printMode":'iframe',"pageTitle":'',"overrideElementCSS":null,"printBodyOptions":{"styleToAdd":'padding:10px;margin:10px;',"classNameToAdd":''},"leaveOpen":false,"iframeElementOptions":{"styleToAdd":'border:none;position:absolute;width:0px;height:0px;bottom:0px;left:0px;',"classNameToAdd":''}};$.fn.printElement.cssElement={"href":'',"media":''};function _printElement(element,opts){var html=_getMarkup(element,opts);var popupOrIframe=null;var documentToWriteTo=null;if(opts.printMode.toLowerCase()==='popup'){popupOrIframe=window.open('about:blank','printElementWindow'+Math.floor(Math.random()*1000000),'width=650,height=440,scrollbars=yes');documentToWriteTo=popupOrIframe.document;}else{var printElementID="printElement_"+(Math.round(Math.random()*99999)).toString();var iframe=document.createElement('IFRAME');$(iframe).attr({style:opts.iframeElementOptions.styleToAdd,id:printElementID,className:opts.iframeElementOptions.classNameToAdd,frameBorder:0,scrolling:'no',src:'about:blank'});document.body.appendChild(iframe);documentToWriteTo=(iframe.contentWindow||iframe.contentDocument);if(documentToWriteTo.document){documentToWriteTo=documentToWriteTo.document;}
iframe=document.frames?document.frames[printElementID]:document.getElementById(printElementID);popupOrIframe=iframe.contentWindow||iframe;}
focus();documentToWriteTo.open();documentToWriteTo.write(html);documentToWriteTo.close();_callPrint(popupOrIframe);}
function _callPrint(element){if(element&&element.printPage){element.printPage();}else{setTimeout(function(){_callPrint(element);},50);}}
function _getElementHTMLIncludingFormElements(element){var $element=$(element);$(":checked",$element).each(function(){this.setAttribute('checked','checked');});$("input[type='text'],input[type='number']",$element).each(function(){this.setAttribute('value',$(this).val());});$("select",$element).each(function(){var $select=$(this);$("option",$select).each(function(){if($select.val()===$(this).val()){this.setAttribute('selected','selected');}});});$("textarea",$element).each(function(){var value=$(this).attr('value');if(this.firstChild){this.firstChild.textContent=value;}else{this.innerHTML=value;}});var elementHtml=$('<div></div>').append($element.clone()).html();return elementHtml;}
function _getBaseHref(){var port=(window.location.port)?':'+window.location.port:'';return window.location.protocol+'//'+window.location.hostname+port+window.location.pathname;}
function _getMarkup(element,opts){var $element=$(element);var elementHtml=_getElementHTMLIncludingFormElements(element);var html=[];html.push('<html><head><title>'+opts.pageTitle+'</title>');if(opts.overrideElementCSS){if(opts.overrideElementCSS.length>0){for(var x=0;x<opts.overrideElementCSS.length;x+=1){var current=opts.overrideElementCSS[x];if(typeof(current)==='string'){html.push('<link type="text/css" rel="stylesheet" href="'+current+'" >');}else{var media=current.media||'';html.push('<link type="text/css" rel="stylesheet" href="'+current.href+'" media="'+media+'" >');}}}}else{$("link",document).filter(function(){return $(this).attr("rel").toLowerCase()==="stylesheet";}).each(function(){var media=$(this).attr('media')||'';html.push('<link type="text/css" rel="stylesheet" href="'+$(this).attr("href")+'" media="'+media+'" >');});}
html.push('<base href="'+_getBaseHref()+'" />');html.push('</head><body style="'+opts.printBodyOptions.styleToAdd+'" class="'+opts.printBodyOptions.classNameToAdd+'">');html.push('<div class="'+$element.attr('class')+'">'+elementHtml+'</div>');html.push('<script type="text/javascript">function printPage(){focus();print();'+((!opts.leaveOpen&&opts.printMode.toLowerCase()==='popup')?'close();':'')+'}</script>');html.push('</body></html>');return html.join('');}}(window));;;(function(b){var m,t,u,f,D,j,E,n,z,A,q=0,e={},o=[],p=0,d={},l=[],G=null,v=new Image,J=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,W=/[^\.]\.(swf)\s*$/i,K,L=1,y=0,s="",r,i,h=false,B=b.extend(b("<div/>")[0],{prop:0}),M=b.browser.msie&&b.browser.version<7&&!window.XMLHttpRequest,N=function(){t.hide();v.onerror=v.onload=null;G&&G.abort();m.empty()},O=function(){if(false===e.onError(o,q,e)){t.hide();h=false}else{e.titleShow=false;e.width="auto";e.height="auto";m.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');F()}},I=function(){var a=o[q],c,g,k,C,P,w;N();e=b.extend({},b.fn.fancybox.defaults,typeof b(a).data("fancybox")=="undefined"?e:b(a).data("fancybox"));w=e.onStart(o,q,e);if(w===false)h=false;else{if(typeof w=="object")e=b.extend(e,w);k=e.title||(a.nodeName?b(a).attr("title"):a.title)||"";if(a.nodeName&&!e.orig)e.orig=b(a).children("img:first").length?b(a).children("img:first"):b(a);if(k===""&&e.orig&&e.titleFromAlt)k=e.orig.attr("alt");c=e.href||(a.nodeName?b(a).attr("href"):a.href)||null;if(/^(?:javascript)/i.test(c)||c=="#")c=null;if(e.type){g=e.type;if(!c)c=e.content}else if(e.content)g="html";else if(c)g=c.match(J)?"image":c.match(W)?"swf":b(a).hasClass("iframe")?"iframe":c.indexOf("#")===0?"inline":"ajax";if(g){if(g=="inline"){a=c.substr(c.indexOf("#"));g=b(a).length>0?"inline":"ajax"}e.type=g;e.href=c;e.title=k;if(e.autoDimensions)if(e.type=="html"||e.type=="inline"||e.type=="ajax"){e.width="auto";e.height="auto"}else e.autoDimensions=false;if(e.modal){e.overlayShow=true;e.hideOnOverlayClick=false;e.hideOnContentClick=false;e.enableEscapeButton=false;e.showCloseButton=false}e.padding=parseInt(e.padding,10);e.margin=parseInt(e.margin,10);m.css("padding",e.padding+e.margin);b(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){b(this).replaceWith(j.children())});switch(g){case"html":m.html(e.content);F();break;case"inline":if(b(a).parent().is("#fancybox-content")===true){h=false;break}b('<div class="fancybox-inline-tmp" />').hide().insertBefore(b(a)).bind("fancybox-cleanup",function(){b(this).replaceWith(j.children())}).bind("fancybox-cancel",function(){b(this).replaceWith(m.children())});b(a).appendTo(m);F();break;case"image":h=false;b.fancybox.showActivity();v=new Image;v.onerror=function(){O()};v.onload=function(){h=true;v.onerror=v.onload=null;e.width=v.width;e.height=v.height;b("<img />").attr({id:"fancybox-img",src:v.src,alt:e.title}).appendTo(m);Q()};v.src=c;break;case"swf":e.scrolling="no";C='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+e.width+'" height="'+e.height+'"><param name="movie" value="'+c+'"></param>';P="";b.each(e.swf,function(x,H){C+='<param name="'+x+'" value="'+H+'"></param>';P+=" "+x+'="'+H+'"'});C+='<embed src="'+c+'" type="application/x-shockwave-flash" width="'+e.width+'" height="'+e.height+'"'+P+"></embed></object>";m.html(C);F();break;case"ajax":h=false;b.fancybox.showActivity();e.ajax.win=e.ajax.success;G=b.ajax(b.extend({},e.ajax,{url:c,data:e.ajax.data||{},error:function(x){x.status>0&&O()},success:function(x,H,R){if((typeof R=="object"?R:G).status==200){if(typeof e.ajax.win=="function"){w=e.ajax.win(c,x,H,R);if(w===false){t.hide();return}else if(typeof w=="string"||typeof w=="object")x=w}m.html(x);F()}}}));break;case"iframe":Q()}}else O()}},F=function(){var a=e.width,c=e.height;a=a.toString().indexOf("%")>-1?parseInt((b(window).width()-e.margin*2)*parseFloat(a)/100,10)+"px":a=="auto"?"auto":a+"px";c=c.toString().indexOf("%")>-1?parseInt((b(window).height()-e.margin*2)*parseFloat(c)/100,10)+"px":c=="auto"?"auto":c+"px";m.wrapInner('<div style="width:'+a+";height:"+c+";overflow: "+(e.scrolling=="hidden"?"hidden":e.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>');e.width=m.width();e.height=m.height();Q()},Q=function(){var a,c;t.hide();if(f.is(":visible")&&false===d.onCleanup(l,p,d)){b.event.trigger("fancybox-cancel");h=false}else{h=true;b(j.add(u)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");f.is(":visible")&&d.titlePosition!=="outside"&&f.css("height",f.height());l=o;p=q;d=e;if(d.overlayShow){u.css({"background-color":d.overlayColor,opacity:d.overlayOpacity,cursor:d.hideOnOverlayClick?"pointer":"auto",height:b(document).height()});if(!u.is(":visible")){M&&b("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"});u.show()}}else u.hide();i=X();s=d.title||"";y=0;n.empty().removeAttr("style").removeClass();if(d.titleShow!==false){if(b.isFunction(d.titleFormat))a=d.titleFormat(s,l,p,d);else a=s&&s.length?d.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+s+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+d.titlePosition+'">'+s+"</div>":false;s=a;if(!(!s||s==="")){n.addClass("fancybox-title-"+d.titlePosition).html(s).appendTo("body").show();switch(d.titlePosition){case"inside":n.css({width:i.width-d.padding*2,marginLeft:d.padding,marginRight:d.padding});y=n.outerHeight(true);n.appendTo(D);i.height+=y;break;case"over":n.css({marginLeft:d.padding,width:i.width-d.padding*2,bottom:d.padding}).appendTo(D);break;case"float":n.css("left",parseInt((n.width()-i.width-40)/2,10)*-1).appendTo(f);break;default:n.css({width:i.width-d.padding*2,paddingLeft:d.padding,paddingRight:d.padding}).appendTo(f)}}}n.hide();if(f.is(":visible")){b(E.add(z).add(A)).hide();a=f.position();r={top:a.top,left:a.left,width:f.width(),height:f.height()};c=r.width==i.width&&r.height==i.height;j.fadeTo(d.changeFade,0.3,function(){var g=function(){j.html(m.contents()).fadeTo(d.changeFade,1,S)};b.event.trigger("fancybox-change");j.empty().removeAttr("filter").css({"border-width":d.padding,width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2});if(c)g();else{B.prop=0;b(B).animate({prop:1},{duration:d.changeSpeed,easing:d.easingChange,step:T,complete:g})}})}else{f.removeAttr("style");j.css("border-width",d.padding);if(d.transitionIn=="elastic"){r=V();j.html(m.contents());f.show();if(d.opacity)i.opacity=0;B.prop=0;b(B).animate({prop:1},{duration:d.speedIn,easing:d.easingIn,step:T,complete:S})}else{d.titlePosition=="inside"&&y>0&&n.show();j.css({width:i.width-d.padding*2,height:e.autoDimensions?"auto":i.height-y-d.padding*2}).html(m.contents());f.css(i).fadeIn(d.transitionIn=="none"?0:d.speedIn,S)}}}},Y=function(){if(d.enableEscapeButton||d.enableKeyboardNav)b(document).bind("keydown.fb",function(a){if(a.keyCode==27&&d.enableEscapeButton){a.preventDefault();b.fancybox.close()}else if((a.keyCode==37||a.keyCode==39)&&d.enableKeyboardNav&&a.target.tagName!=="INPUT"&&a.target.tagName!=="TEXTAREA"&&a.target.tagName!=="SELECT"){a.preventDefault();b.fancybox[a.keyCode==37?"prev":"next"]()}});if(d.showNavArrows){if(d.cyclic&&l.length>1||p!==0)z.show();if(d.cyclic&&l.length>1||p!=l.length-1)A.show()}else{z.hide();A.hide()}},S=function(){if(!b.support.opacity){j.get(0).style.removeAttribute("filter");f.get(0).style.removeAttribute("filter")}e.autoDimensions&&j.css("height","auto");f.css("height","auto");s&&s.length&&n.show();d.showCloseButton&&E.show();Y();d.hideOnContentClick&&j.bind("click",b.fancybox.close);d.hideOnOverlayClick&&u.bind("click",b.fancybox.close);b(window).bind("resize.fb",b.fancybox.resize);d.centerOnScroll&&b(window).bind("scroll.fb",b.fancybox.center);if(d.type=="iframe")b('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(b.browser.msie?'allowtransparency="true""':"")+' scrolling="'+e.scrolling+'" src="'+d.href+'"></iframe>').appendTo(j);f.show();h=false;b.fancybox.center();d.onComplete(l,p,d);var a,c;if(l.length-1>p){a=l[p+1].href;if(typeof a!=="undefined"&&a.match(J)){c=new Image;c.src=a}}if(p>0){a=l[p-1].href;if(typeof a!=="undefined"&&a.match(J)){c=new Image;c.src=a}}},T=function(a){var c={width:parseInt(r.width+(i.width-r.width)*a,10),height:parseInt(r.height+(i.height-r.height)*a,10),top:parseInt(r.top+(i.top-r.top)*a,10),left:parseInt(r.left+(i.left-r.left)*a,10)};if(typeof i.opacity!=="undefined")c.opacity=a<0.5?0.5:a;f.css(c);j.css({width:c.width-d.padding*2,height:c.height-y*a-d.padding*2})},U=function(){return[b(window).width()-d.margin*2,b(window).height()-d.margin*2,b(document).scrollLeft()+d.margin,b(document).scrollTop()+d.margin]},X=function(){var a=U(),c={},g=d.autoScale,k=d.padding*2;c.width=d.width.toString().indexOf("%")>-1?parseInt(a[0]*parseFloat(d.width)/100,10):d.width+k;c.height=d.height.toString().indexOf("%")>-1?parseInt(a[1]*parseFloat(d.height)/100,10):d.height+k;if(g&&(c.width>a[0]||c.height>a[1]))if(e.type=="image"||e.type=="swf"){g=d.width/d.height;if(c.width>a[0]){c.width=a[0];c.height=parseInt((c.width-k)/g+k,10)}if(c.height>a[1]){c.height=a[1];c.width=parseInt((c.height-k)*g+k,10)}}else{c.width=Math.min(c.width,a[0]);c.height=Math.min(c.height,a[1])}c.top=parseInt(Math.max(a[3]-20,a[3]+(a[1]-c.height-40)*0.5),10);c.left=parseInt(Math.max(a[2]-20,a[2]+(a[0]-c.width-40)*0.5),10);return c},V=function(){var a=e.orig?b(e.orig):false,c={};if(a&&a.length){c=a.offset();c.top+=parseInt(a.css("paddingTop"),10)||0;c.left+=parseInt(a.css("paddingLeft"),10)||0;c.top+=parseInt(a.css("border-top-width"),10)||0;c.left+=parseInt(a.css("border-left-width"),10)||0;c.width=a.width();c.height=a.height();c={width:c.width+d.padding*2,height:c.height+d.padding*2,top:c.top-d.padding-20,left:c.left-d.padding-20}}else{a=U();c={width:d.padding*2,height:d.padding*2,top:parseInt(a[3]+a[1]*0.5,10),left:parseInt(a[2]+a[0]*0.5,10)}}return c},Z=function(){if(t.is(":visible")){b("div",t).css("top",L*-40+"px");L=(L+1)%12}else clearInterval(K)};b.fn.fancybox=function(a){if(!b(this).length)return this;b(this).data("fancybox",b.extend({},a,b.metadata?b(this).metadata():{})).unbind("click.fb").bind("click.fb",function(c){c.preventDefault();if(!h){h=true;b(this).blur();o=[];q=0;c=b(this).attr("rel")||"";if(!c||c==""||c==="nofollow")o.push(this);else{o=b("a[rel="+c+"], area[rel="+c+"]");q=o.index(this)}I()}});return this};b.fancybox=function(a,c){var g;if(!h){h=true;g=typeof c!=="undefined"?c:{};o=[];q=parseInt(g.index,10)||0;if(b.isArray(a)){for(var k=0,C=a.length;k<C;k++)if(typeof a[k]=="object")b(a[k]).data("fancybox",b.extend({},g,a[k]));else a[k]=b({}).data("fancybox",b.extend({content:a[k]},g));o=jQuery.merge(o,a)}else{if(typeof a=="object")b(a).data("fancybox",b.extend({},g,a));else a=b({}).data("fancybox",b.extend({content:a},g));o.push(a)}if(q>o.length||q<0)q=0;I()}};b.fancybox.showActivity=function(){clearInterval(K);t.show();K=setInterval(Z,66)};b.fancybox.hideActivity=function(){t.hide()};b.fancybox.next=function(){return b.fancybox.pos(p+
1)};b.fancybox.prev=function(){return b.fancybox.pos(p-1)};b.fancybox.pos=function(a){if(!h){a=parseInt(a);o=l;if(a>-1&&a<l.length){q=a;I()}else if(d.cyclic&&l.length>1){q=a>=l.length?0:l.length-1;I()}}};b.fancybox.cancel=function(){if(!h){h=true;b.event.trigger("fancybox-cancel");N();e.onCancel(o,q,e);h=false}};b.fancybox.close=function(){function a(){u.fadeOut("fast");n.empty().hide();f.hide();b.event.trigger("fancybox-cleanup");j.empty();d.onClosed(l,p,d);l=e=[];p=q=0;d=e={};h=false}if(!(h||f.is(":hidden"))){h=true;if(d&&false===d.onCleanup(l,p,d))h=false;else{N();b(E.add(z).add(A)).hide();b(j.add(u)).unbind();b(window).unbind("resize.fb scroll.fb");b(document).unbind("keydown.fb");j.find("iframe").attr("src",M&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");d.titlePosition!=="inside"&&n.empty();f.stop();if(d.transitionOut=="elastic"){r=V();var c=f.position();i={top:c.top,left:c.left,width:f.width(),height:f.height()};if(d.opacity)i.opacity=1;n.empty().hide();B.prop=1;b(B).animate({prop:0},{duration:d.speedOut,easing:d.easingOut,step:T,complete:a})}else f.fadeOut(d.transitionOut=="none"?0:d.speedOut,a)}}};b.fancybox.resize=function(){u.is(":visible")&&u.css("height",b(document).height());b.fancybox.center(true)};b.fancybox.center=function(a){var c,g;if(!h){g=a===true?1:0;c=U();!g&&(f.width()>c[0]||f.height()>c[1])||f.stop().animate({top:parseInt(Math.max(c[3]-20,c[3]+(c[1]-j.height()-40)*0.5-d.padding)),left:parseInt(Math.max(c[2]-20,c[2]+(c[0]-j.width()-40)*0.5-
d.padding))},typeof a=="number"?a:200)}};b.fancybox.init=function(){if(!b("#fancybox-wrap").length){b("body").append(m=b('<div id="fancybox-tmp"></div>'),t=b('<div id="fancybox-loading"><div></div></div>'),u=b('<div id="fancybox-overlay"></div>'),f=b('<div id="fancybox-wrap"></div>'));D=b('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(f);D.append(j=b('<div id="fancybox-content"></div>'),E=b('<a id="fancybox-close"></a>'),n=b('<div id="fancybox-title"></div>'),z=b('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),A=b('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));E.click(b.fancybox.close);t.click(b.fancybox.cancel);z.click(function(a){a.preventDefault();b.fancybox.prev()});A.click(function(a){a.preventDefault();b.fancybox.next()});b.fn.mousewheel&&f.bind("mousewheel.fb",function(a,c){if(h)a.preventDefault();else if(b(a.target).get(0).clientHeight==0||b(a.target).get(0).scrollHeight===b(a.target).get(0).clientHeight){a.preventDefault();b.fancybox[c>0?"prev":"next"]()}});b.support.opacity||f.addClass("fancybox-ie");if(M){t.addClass("fancybox-ie6");f.addClass("fancybox-ie6");b('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(D)}}};b.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};b(document).ready(function(){b.fancybox.init()})})(jQuery);
;(function defineMustache(global,factory){if(typeof exports==="object"&&exports&&typeof exports.nodeName!=="string"){factory(exports)}else if(typeof define==="function"&&define.amd){define(["exports"],factory)}else{global.Mustache={};factory(Mustache)}})(this,function mustacheFactory(mustache){var objectToString=Object.prototype.toString;var isArray=Array.isArray||function isArrayPolyfill(object){return objectToString.call(object)==="[object Array]"};function isFunction(object){return typeof object==="function"}function typeStr(obj){return isArray(obj)?"array":typeof obj}function escapeRegExp(string){return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(obj,propName){return obj!=null&&typeof obj==="object"&&propName in obj}var regExpTest=RegExp.prototype.test;function testRegExp(re,string){return regExpTest.call(re,string)}var nonSpaceRe=/\S/;function isWhitespace(string){return!testRegExp(nonSpaceRe,string)}var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escapeHtml(string){return String(string).replace(/[&<>"'\/]/g,function fromEntityMap(s){return entityMap[s]})}var whiteRe=/\s*/;var spaceRe=/\s+/;var equalsRe=/\s*=/;var curlyRe=/\s*\}/;var tagRe=/#|\^|\/|>|\{|&|=|!/;function parseTemplate(template,tags){if(!template)return[];var sections=[];var tokens=[];var spaces=[];var hasTag=false;var nonSpace=false;function stripSpace(){if(hasTag&&!nonSpace){while(spaces.length)delete tokens[spaces.pop()]}else{spaces=[]}hasTag=false;nonSpace=false}var openingTagRe,closingTagRe,closingCurlyRe;function compileTags(tagsToCompile){if(typeof tagsToCompile==="string")tagsToCompile=tagsToCompile.split(spaceRe,2);if(!isArray(tagsToCompile)||tagsToCompile.length!==2)throw new Error("Invalid tags: "+tagsToCompile);openingTagRe=new RegExp(escapeRegExp(tagsToCompile[0])+"\\s*");closingTagRe=new RegExp("\\s*"+escapeRegExp(tagsToCompile[1]));closingCurlyRe=new RegExp("\\s*"+escapeRegExp("}"+tagsToCompile[1]))}compileTags(tags||mustache.tags);var scanner=new Scanner(template);var start,type,value,chr,token,openSection;while(!scanner.eos()){start=scanner.pos;value=scanner.scanUntil(openingTagRe);if(value){for(var i=0,valueLength=value.length;i<valueLength;++i){chr=value.charAt(i);if(isWhitespace(chr)){spaces.push(tokens.length)}else{nonSpace=true}tokens.push(["text",chr,start,start+1]);start+=1;if(chr==="\n")stripSpace()}}if(!scanner.scan(openingTagRe))break;hasTag=true;type=scanner.scan(tagRe)||"name";scanner.scan(whiteRe);if(type==="="){value=scanner.scanUntil(equalsRe);scanner.scan(equalsRe);scanner.scanUntil(closingTagRe)}else if(type==="{"){value=scanner.scanUntil(closingCurlyRe);scanner.scan(curlyRe);scanner.scanUntil(closingTagRe);type="&"}else{value=scanner.scanUntil(closingTagRe)}if(!scanner.scan(closingTagRe))throw new Error("Unclosed tag at "+scanner.pos);token=[type,value,start,scanner.pos];tokens.push(token);if(type==="#"||type==="^"){sections.push(token)}else if(type==="/"){openSection=sections.pop();if(!openSection)throw new Error('Unopened section "'+value+'" at '+start);if(openSection[1]!==value)throw new Error('Unclosed section "'+openSection[1]+'" at '+start)}else if(type==="name"||type==="{"||type==="&"){nonSpace=true}else if(type==="="){compileTags(value)}}openSection=sections.pop();if(openSection)throw new Error('Unclosed section "'+openSection[1]+'" at '+scanner.pos);return nestTokens(squashTokens(tokens))}function squashTokens(tokens){var squashedTokens=[];var token,lastToken;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];if(token){if(token[0]==="text"&&lastToken&&lastToken[0]==="text"){lastToken[1]+=token[1];lastToken[3]=token[3]}else{squashedTokens.push(token);lastToken=token}}}return squashedTokens}function nestTokens(tokens){var nestedTokens=[];var collector=nestedTokens;var sections=[];var token,section;for(var i=0,numTokens=tokens.length;i<numTokens;++i){token=tokens[i];switch(token[0]){case"#":case"^":collector.push(token);sections.push(token);collector=token[4]=[];break;case"/":section=sections.pop();section[5]=token[2];collector=sections.length>0?sections[sections.length-1][4]:nestedTokens;break;default:collector.push(token)}}return nestedTokens}function Scanner(string){this.string=string;this.tail=string;this.pos=0}Scanner.prototype.eos=function eos(){return this.tail===""};Scanner.prototype.scan=function scan(re){var match=this.tail.match(re);if(!match||match.index!==0)return"";var string=match[0];this.tail=this.tail.substring(string.length);this.pos+=string.length;return string};Scanner.prototype.scanUntil=function scanUntil(re){var index=this.tail.search(re),match;switch(index){case-1:match=this.tail;this.tail="";break;case 0:match="";break;default:match=this.tail.substring(0,index);this.tail=this.tail.substring(index)}this.pos+=match.length;return match};function Context(view,parentContext){this.view=view;this.cache={".":this.view};this.parent=parentContext}Context.prototype.push=function push(view){return new Context(view,this)};Context.prototype.lookup=function lookup(name){var cache=this.cache;var value;if(cache.hasOwnProperty(name)){value=cache[name]}else{var context=this,names,index,lookupHit=false;while(context){if(name.indexOf(".")>0){value=context.view;names=name.split(".");index=0;while(value!=null&&index<names.length){if(index===names.length-1)lookupHit=hasProperty(value,names[index]);value=value[names[index++]]}}else{value=context.view[name];lookupHit=hasProperty(context.view,name)}if(lookupHit)break;context=context.parent}cache[name]=value}if(isFunction(value))value=value.call(this.view);return value};function Writer(){this.cache={}}Writer.prototype.clearCache=function clearCache(){this.cache={}};Writer.prototype.parse=function parse(template,tags){var cache=this.cache;var tokens=cache[template];if(tokens==null)tokens=cache[template]=parseTemplate(template,tags);return tokens};Writer.prototype.render=function render(template,view,partials){var tokens=this.parse(template);var context=view instanceof Context?view:new Context(view);return this.renderTokens(tokens,context,partials,template)};Writer.prototype.renderTokens=function renderTokens(tokens,context,partials,originalTemplate){var buffer="";var token,symbol,value;for(var i=0,numTokens=tokens.length;i<numTokens;++i){value=undefined;token=tokens[i];symbol=token[0];if(symbol==="#")value=this.renderSection(token,context,partials,originalTemplate);else if(symbol==="^")value=this.renderInverted(token,context,partials,originalTemplate);else if(symbol===">")value=this.renderPartial(token,context,partials,originalTemplate);else if(symbol==="&")value=this.unescapedValue(token,context);else if(symbol==="name")value=this.escapedValue(token,context);else if(symbol==="text")value=this.rawValue(token);if(value!==undefined)buffer+=value}return buffer};Writer.prototype.renderSection=function renderSection(token,context,partials,originalTemplate){var self=this;var buffer="";var value=context.lookup(token[1]);function subRender(template){return self.render(template,context,partials)}if(!value)return;if(isArray(value)){for(var j=0,valueLength=value.length;j<valueLength;++j){buffer+=this.renderTokens(token[4],context.push(value[j]),partials,originalTemplate)}}else if(typeof value==="object"||typeof value==="string"||typeof value==="number"){buffer+=this.renderTokens(token[4],context.push(value),partials,originalTemplate)}else if(isFunction(value)){if(typeof originalTemplate!=="string")throw new Error("Cannot use higher-order sections without the original template");value=value.call(context.view,originalTemplate.slice(token[3],token[5]),subRender);if(value!=null)buffer+=value}else{buffer+=this.renderTokens(token[4],context,partials,originalTemplate)}return buffer};Writer.prototype.renderInverted=function renderInverted(token,context,partials,originalTemplate){var value=context.lookup(token[1]);if(!value||isArray(value)&&value.length===0)return this.renderTokens(token[4],context,partials,originalTemplate)};Writer.prototype.renderPartial=function renderPartial(token,context,partials){if(!partials)return;var value=isFunction(partials)?partials(token[1]):partials[token[1]];if(value!=null)return this.renderTokens(this.parse(value),context,partials,value)};Writer.prototype.unescapedValue=function unescapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return value};Writer.prototype.escapedValue=function escapedValue(token,context){var value=context.lookup(token[1]);if(value!=null)return mustache.escape(value)};Writer.prototype.rawValue=function rawValue(token){return token[1]};mustache.name="mustache.js";mustache.version="2.1.3";mustache.tags=["{{","}}"];var defaultWriter=new Writer;mustache.clearCache=function clearCache(){return defaultWriter.clearCache()};mustache.parse=function parse(template,tags){return defaultWriter.parse(template,tags)};mustache.render=function render(template,view,partials){if(typeof template!=="string"){throw new TypeError('Invalid template! Template should be a "string" '+'but "'+typeStr(template)+'" was given as the first '+"argument for mustache#render(template, view, partials)")}return defaultWriter.render(template,view,partials)};mustache.to_html=function to_html(template,view,partials,send){var result=mustache.render(template,view,partials);if(isFunction(send)){send(result)}else{return result}};mustache.escape=escapeHtml;mustache.Scanner=Scanner;mustache.Context=Context;mustache.Writer=Writer});

;/* Scrollport.js 1.0.4  Plugin for something more interesting then usual scroll to. Author: Sergey Dmitriev (serdmi.com). Licensed MIT. */
(function(){!function(t){var o,n;return o=function(){function o(o,n,i,s){var r,e,l;if(r=this._normalize_args(o,n,i,s),this.$container=r.$container,this.target=r.target,l=r.init_options,this._is_window=!this.$container[0].nodeName||-1!==t.inArray(this.$container[0].nodeName.toLowerCase(),["iframe","#document","html","body"]),this._is_window&&(this.$container=t(this.$container[0].contentWindow||window),l.container=this.$container),this._$container_for_scroll=this.$container.is(t(window))?t("body, html"):this.$container,l=this._normalize_options(l),this.options=t.extend(!0,{},this.constructor.defaults,l),this.options=this._normalize_mode_options(this.options),null==this.target)return t.extend(!0,this.constructor.defaults,l),this._set_status("cancel"),this;if(this._is_in_motion()){if(!this.constructor.last_scrollport.options.interrupt_scrollport)return this._set_status("cancel"),this;this.constructor.last_scrollport.stop("interrupt")}return this.final_position=this._get_final_position(this.target),this.final_position.top_distance+this.final_position.left_distance===0?(this._set_status("cancel"),this):(e=this._$container_for_scroll.offset(),this.scroll_position={top:this.$container.scrollTop(),left:this.$container.scrollLeft()},this.constructor.last_scrollport=this,this._do_scroll(this.final_position))}return o.defaults={mode:"usual",interrupt:null,interrupt_user:!0,interrupt_scrollport:!0,container:t(window),delta:{top:0,left:0},on_start:null,on_stop:null,on_interrupt:null,on_finish:null},o.prototype._normalize_args=function(o,n,i,s){var r,e;return r={},e=null,null!=s?(r=s,e={top:parseFloat(n),left:parseFloat(i)}):null!=i?!isNaN(parseFloat(i))&&isFinite(i)?e={top:parseFloat(n),left:parseFloat(i)}:(r=i,e=!isNaN(parseFloat(n))&&isFinite(n)?{top:parseFloat(n)}:n):null!=n&&(!isNaN(parseFloat(n))&&isFinite(n)?e={top:parseFloat(n)}:"object"!=typeof n||n instanceof jQuery?e=n:r=n),null==o&&(o=null!=r.container?r.container:t(window)),r.container=o,{$container:o,target:e,init_options:r}},o.last_scrollport=!1,o.prototype.status="init",o.prototype._is_window=function(o){return!o.nodeName||-1!==t.inArray(o.nodeName.toLowerCase(),["iframe","#document","html","body"])},o.prototype._get_final_position=function(o){var n,i,s,r,e,l,a,c,_,p,u,f,d,h,g,$,m;return f=this.$container.scrollTop(),u=this.$container.scrollLeft(),o instanceof jQuery||"object"==typeof o?o instanceof jQuery&&(n=o):n=t(o),r=this._$container_for_scroll.offset(),a=r.top,s=r.left,e=this._$container_for_scroll[0].scrollHeight,l=this._$container_for_scroll[0].scrollWidth,i=this.$container.innerHeight(),c=this.$container.innerWidth(),null!=n?(h=n.offset(),g=h.top-this.options.delta.top,d=h.left-this.options.delta.left):(g=null!=o.top?o.top-this.options.delta.top:f,d=null!=o.left?o.left-this.options.delta.left:u),c>=l?(_=0,p=0):(_=d+(this._is_window?0:u)-s,_>l-c&&(_=l-c),p=_-u),i>=e?($=0,m=0):($=g+(this._is_window?0:f)-a,$>e-i&&($=e-i),m=$-f),{top:$,left:_,top_distance:m,left_distance:p}},o.prototype._get_distance_betwin_points=function(t,o,n,i){var s,r;return r=i-o,s=n-t,Math.sqrt(r*r+s*s)},o.prototype._get_point_betwin_points=function(t,o,n,i,s){var r,e,l,a;return a=i-o,l=n-t,r=Math.sqrt(a*a+l*l),0>s&&(s=r+s),e=s/r,{left:t+l*e,top:o+a*e}},o.prototype._modes={usual:{defaults:{easing:"swing",duration:700},do_scroll:function(t,o){return t._$container_for_scroll.stop(!0).animate({scrollTop:o.top,scrollLeft:o.left},t.options.duration,t.options.easing,function(){return t._$container_for_scroll.last().is(this)?t.stop("finish"):void 0})},stop_scroll:function(t,o){return t._$container_for_scroll.stop(!0),t._set_status(o),t._call_end_callbacks()}},roll:{defaults:{easing:"swing",speed:2500,max_duration:700,min_duration:300},do_scroll:function(t,o){var n,i;return n=Math.sqrt(o.top_distance*o.top_distance+o.left_distance*o.left_distance),i=n/t.options.speed*1e3,t.options.max_duration&&i<t.options.min_duration&&(i=t.options.min_duration),t.options.min_duration&&i>t.options.max_duration&&(i=t.options.max_duration),t._$container_for_scroll.stop(!0).animate({scrollTop:o.top,scrollLeft:o.left},i,t.options.easing,function(){return t._$container_for_scroll.last().is(this)?t.stop("finish"):void 0}),t},stop_scroll:function(t,o){return t._$container_for_scroll.stop(!0),t._set_status(o),t._call_end_callbacks()}},hard:{defaults:{easing:"swing",distance:5,duration:100},do_scroll:function(t,o){var n;return n=t._get_point_betwin_points(t.scroll_position.left,t.scroll_position.top,o.left,o.top,-t.options.distance),t._$container_for_scroll.scrollTop(n.top).scrollLeft(n.left),t._$container_for_scroll.stop(!0).animate({scrollTop:o.top,scrollLeft:o.left},t.options.duration,t.options.easing,function(){return t._$container_for_scroll.last().is(this)?t.stop("finish"):void 0}),t},stop_scroll:function(t,o){return t._$container_for_scroll.stop(!0),t._set_status(o),t._call_end_callbacks()}},soft:{defaults:{easing:null,easing_before:"swing",easing_after:"swing",distance:null,distance_before:200,distance_after:200,duration:null,duration_before:200,duration_after:400,speed:null,waiting:100},do_scroll:function(n,i){var s,r,e,l;return l=Math.sqrt(i.top_distance*i.top_distance+i.left_distance*i.left_distance),l<1.5*(n.options.distance_before+n.options.distance_before)?null!=n.target.top?null!=n.target.left?new o(n.$container,n.target.top,n.target.left,t.extend(!0,{},n.options,{mode:"roll",speed:n.options.speed})):new o(n.$container,n.target.top,t.extend(!0,{},n.options,{mode:"roll",speed:n.options.speed})):new o(n.$container,n.target,t.extend(!0,{},n.options,{mode:"roll",speed:n.options.speed})):(e=n._get_point_betwin_points(n.scroll_position.left,n.scroll_position.top,i.left,i.top,n.options.distance_before),r=n._get_point_betwin_points(n.scroll_position.left,n.scroll_position.top,i.left,i.top,-n.options.distance_after),s=n._get_or_create_overlay(),s.stop(!0).show().animate({opacity:1},n.options.duration_before),n._$container_for_scroll.stop(!0).animate({scrollTop:e.top,scrollLeft:e.left},n.options.duration_before,n.options.easing_before,function(){return n._$container_for_scroll.last().is(this)?(n._$container_for_scroll.scrollTop(r.top).scrollLeft(r.left),s.animate({opacity:1},n.options.waiting,function(){return s.stop(!0).animate({opacity:0},n.options.duration_after,function(){return s.hide()}),n._$container_for_scroll.stop(!0).animate({scrollTop:i.top,scrollLeft:i.left},n.options.duration_after,n.options.easing_after,function(){return n._$container_for_scroll.last().is(this)?n.stop("finish"):void 0})})):void 0}),n)},stop_scroll:function(t,o){var n,i,s;return n=t._get_or_create_overlay(),"none"===n.css("display")?(t._set_status(o),void t._call_end_callbacks()):(s=parseFloat(n.css("opacity")),i=t.options.duration_after*s,t._$container_for_scroll.stop(!0),t._set_status(o),t._call_end_callbacks(),n.stop(!0).animate({opacity:0},i,function(){return n.hide()}))}}},o.prototype.stop=function(t){return this._modes[this.options.mode].stop_scroll(this,t),this._$container_for_scroll.off("mousewheel.scrollport DOMMouseScroll.scrollport")},o.prototype._do_scroll=function(t){var o;return o=this,this._$container_for_scroll.on("mousewheel.scrollport DOMMouseScroll.scrollport",function(t){return o.options.interrupt_user?(o._$container_for_scroll.off("mousewheel.scrollport DOMMouseScroll.scrollport"),o.stop("interrupt")):t.preventDefault()}),this._set_status("motion"),null!=this.options.on_start&&this.options.on_start.call(this._$container_for_scroll,this),this._modes[this.options.mode].do_scroll(this,t)},o.prototype._set_status=function(t){return this.status=t},o.prototype._is_in_motion=function(){return!!this.constructor.last_scrollport&&"motion"===this.constructor.last_scrollport.status},o.prototype._call_end_callbacks=function(){return null!=this.options.on_stop&&this.options.on_stop.call(this._$container_for_scroll,this),null!=this.options.on_finish&&"finish"===this.status&&this.options.on_finish.call(this._$container_for_scroll,this),null!=this.options.on_interrupt&&"interrupt"===this.status?this.options.on_interrupt.call(this._$container_for_scroll,this):void 0},o.prototype._get_or_create_overlay=function(){return null!=this.constructor._$overlay&&t(".scrollport-overlay").length?this.constructor._$overlay.css({width:this._$container_for_scroll[0].scrollWidth,height:this._$container_for_scroll[0].scrollHeight}):(this.constructor._$overlay=t("<div>").attr("class","scrollport-overlay").hide().appendTo(this._$container_for_scroll.first()).css({backgroundColor:"#ffffff",width:this._$container_for_scroll[0].scrollWidth,height:this._$container_for_scroll[0].scrollHeight,top:"0",left:"0",position:"absolute",opacity:0}),this.constructor._$overlay)},o.prototype._normalize_options=function(t){return null!=t.delta&&("object"==typeof t.delta?(t.delta.top=null!=t.delta.top?parseFloat(t.delta.top):0,t.delta.left=null!=t.delta.left?parseFloat(t.delta.left):0):t.delta={top:t.delta,left:0}),null!=t.interrupt&&(t.interrupt_user=t.interrupt,t.interrupt_scrollport=t.interrupt),t},o.prototype._normalize_mode_options=function(o){return o=t.extend(!0,{},this._modes[this.options.mode].defaults,o),"soft"===o.mode&&(null!=o.distance&&(o.distance_before=o.distance,o.distance_after=o.distance),null!=o.duration&&(o.duration_before=o.duration,o.duration_after=o.duration),null!=o.easing&&(o.easing_before=o.easing,o.easing_after=o.easing),null==o.speed&&(o.speed=(o.distance_before+o.distance_after)/(o.duration_before+o.duration_after)*1e3)),o},o}(),n=function(){function n(n,i,s,r,e){var l,a,c,_,p,u,f;if(u=this,l=this._normalize_args(i,s,r,e),this.$link=n,this.target=l.target,this.$container=l.$container,f=l.scrollport_options,null==this.target){for(c=["data-scrollport","href","data-href"],_=!1,p=0;!_&&p<c.length;)a=this.$link.attr(c[p]),null!=a&&""!==a&&(_=!0),p++;if(!_)return;this.target=t(a)}this.$link.on("click",function(t){return t.preventDefault(),null!=this.target.top?null!=this.target.left?new o(u.$container,u.target.top,u.target.left,f):new o(u.$container,u.target.top,f):new o(u.$container,u.target,f)})}return n.prototype._normalize_args=function(t,o,n,i){var s,r,e;return s=null,r={},e=null,null!=i?(r=i,s=n,e={top:t,left:o}):null!=n?n instanceof jQuery?(s=n,e={top:t,left:o}):(r=n,o instanceof jQuery?(s=o,e=!isNaN(parseFloat(t))&&isFinite(t)?{top:t}:t):e={top:t,left:o}):null!=o?!isNaN(parseFloat(o))&&isFinite(o)?e={top:t,left:o}:o instanceof jQuery?(s=o,e=!isNaN(parseFloat(t))&&isFinite(t)?{top:t}:t):(r=o,e=!isNaN(parseFloat(t))&&isFinite(t)?{top:t}:t):null!=t&&(!isNaN(parseFloat(t))&&isFinite(t)?e={top:t}:"object"!=typeof t||t instanceof jQuery?e=t:r=t),{$container:s,target:e,scrollport_options:r}},n}(),t.scrollport=function(t,n,i){return new o(null,t,n,i)},t.fn.scrollport=function(t,n,i){return new o(this.first(),t,n,i),this},t.fn.scrollport_link=function(o,i,s,r){return this.each(function(){return new n(t(this),o,i,s,r)})},t(function(){return t("[data-scrollport]").scrollport_link()})}(jQuery)}).call(this);
;(function($){var d=$(document);var h=$("head");var drag=null;var tables=[];var count=0;var ID="id";var PX="px";var SIGNATURE="JColResizer";var I=parseInt;var M=Math;var ie=$.browser.msie;h.append("<style type='text/css'>  .JColResizer{table-layout:fixed;} .JColResizer td, .JColResizer th{overflow:hidden;padding-left:0!important; padding-right:0!important;}  .JCLRgrips{ height:0px; position:relative;} .JCLRgrip{margin-left:-5px; position:absolute; z-index:5; } .JCLRgrip .JColResizer{position:absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;height:100%;top:0px} .JCLRLastGrip{position:absolute; width:1px; } .JCLRgripDrag{ border-left:1px dotted black; }</style>");var init=function(tb,options){var t=$(tb);if(options.disable)return destroy(t);var id=t.id=t.attr(ID)||SIGNATURE+count++;t.p=options.postbackSafe;t.ck=options.rememberColumnsSize;if(!t.is("table")||tables[id])return;t.addClass(SIGNATURE).attr(ID,id).before('<div class="JCLRgrips"/>');t.opt=options;t.g=[];t.c=[];t.w=t.width();t.gc=t.prev();if(options.marginLeft)t.gc.css("marginLeft",options.marginLeft);if(options.marginRight)t.gc.css("marginRight",options.marginRight);t.cs=I(ie?tb.cellSpacing||tb.currentStyle.borderSpacing:t.css('border-spacing'))||2;t.b=I(ie?tb.border||tb.currentStyle.borderLeftWidth:t.css('border-left-width'))||1;tables[id]=t;localforage.getItem(t.id,function(err,value){if(value==null){createGrips(t,[]);}else{createGrips(t,value.split(';'));}});};var destroy=function(t){var id=t.attr(ID),t=tables[id];if(!t||!t.is("table"))return;t.removeClass(SIGNATURE).gc.remove();delete tables[id];};var createGrips=function(t,originalColumnWidths){var th=t.find(">thead>tr>th,>thead>tr>td");if(!th.length)th=t.find(">tbody>tr:first>th,>tr:first>th,>tbody>tr:first>td, >tr:first>td");t.cg=t.find("col");t.ln=th.length;if(t.p)memento(t,th);else if(t.ck&&originalColumnWidths.length)memento(t,th,originalColumnWidths);th.each(function(i){var c=$(this);var g=$(t.gc.append('<div class="JCLRgrip"></div>')[0].lastChild);g.t=t;g.i=i;g.c=c;if(originalColumnWidths.length&&originalColumnWidths[originalColumnWidths.length]<=100){c.w=parseInt(originalColumnWidths[i])+'%';}else{c.w=parseInt(c.width()/t.w*100)+'%';}
t.g.push(g);t.c.push(c);c.width(c.w).removeAttr("width");if(i<t.ln-1)g.mousedown(onGripMouseDown).append(t.opt.gripInnerHtml).append('<div class="'+SIGNATURE+'" style="cursor:'+t.opt.hoverCursor+'"></div>');else g.addClass("JCLRLastGrip").removeClass("JCLRgrip");g.data(SIGNATURE,{i:i,t:t.attr(ID)});});t.cg.removeAttr("width");syncGrips(t);t.find('td, th').not(th).not('table th, table td').each(function(){$(this).removeAttr('width');});if(t.opt.onGripCreated){t.opt.onGripCreated(t);}};var memento=function(t,th,sizes){var w,m=0,i=0,aux=[],columns;if(th){t.cg.removeAttr("width");w=sizes;for(;i<t.ln;i++){aux.push(100*w[i]/w[t.ln]+"%");th.eq(i).css("width",aux[i]);}
for(i=0;i<t.ln;i++){t.cg.eq(i).css("width",aux[i]);}}else{columns="";for(i in t.c){w=parseInt(t.c[i].width()/t.w*100);columns+=w+";";m+=w;}
columns+=m;localforage.setItem(t.id,columns,function(err){localforage.getItem(t.id,function(err,value){console.log(t.id+' = '+value);});});}};var syncGrips=function(t){t.gc.width(t.w);for(var i=0;i<t.ln;i++){var c=t.c[i];t.g[i].css({left:c.offset().left-t.offset().left+c.outerWidth()+t.cs/2+PX,height:t.opt.headerOnly?t.c[0].outerHeight():t.outerHeight()});}};var syncCols=function(t,i,isOver){var inc=parseInt((drag.x-drag.l)/parseInt(t.w)*100),c=t.c[i],c2=t.c[i+1];var w=parseInt(c.w)+inc;var w2=parseInt(c2.w)-inc;c.width(w+'%');c2.width(w2+'%');t.cg.eq(i).width(w+'%');t.cg.eq(i+1).width(w2+'%');if(isOver){c.w=w;c2.w=w2;}};var onGripDrag=function(e){if(!drag)return;var t=drag.t;var x=e.pageX-drag.ox+drag.l;var mw=t.opt.minWidth,i=drag.i;var l=t.cs*1.5+mw+t.b;var max=i==t.ln-1?t.w-l:t.g[i+1].position().left-t.cs-mw;var min=i?t.g[i-1].position().left+t.cs+mw:l;x=M.max(min,M.min(max,x));drag.x=x;drag.css("left",x+PX);if(t.opt.liveDrag){syncCols(t,i);syncGrips(t);var cb=t.opt.onDrag;if(cb){e.currentTarget=t[0];cb(e);}}
return false;};var onGripDragOver=function(e){d.unbind('mousemove.'+SIGNATURE).unbind('mouseup.'+SIGNATURE);$("head :last-child").remove();if(!drag)return;drag.removeClass(drag.t.opt.draggingClass);var t=drag.t,cb=t.opt.onResize;if(drag.x){syncCols(t,drag.i,true);syncGrips(t);if(cb){e.currentTarget=t[0];cb(e);}}
if(t.p)memento(t);else if(t.ck)memento(t);drag=null;};var onGripMouseDown=function(e){var o=$(this).data(SIGNATURE);var t=tables[o.t],g=t.g[o.i];g.ox=e.pageX;g.l=g.position().left;d.bind('mousemove.'+SIGNATURE,onGripDrag).bind('mouseup.'+SIGNATURE,onGripDragOver);h.append("<style type='text/css'>*{cursor:"+t.opt.dragCursor+"!important}</style>");g.addClass(t.opt.draggingClass);drag=g;if(t.c[o.i].l)for(var i=0,c;i<t.ln;i++){c=t.c[i];c.l=false;c.w=c.width();}
return false;};var onResize=function(){for(t in tables){var t=tables[t];t.removeClass(SIGNATURE);syncGrips(t.addClass(SIGNATURE));}};$(window).bind('resize.'+SIGNATURE,onResize);$.fn.extend({colResizable:function(options){var defaults={draggingClass:'JCLRgripDrag',gripInnerHtml:'',liveDrag:false,minWidth:15,headerOnly:false,hoverCursor:"e-resize",dragCursor:"e-resize",postbackSafe:false,rememberColumnsSize:true,flush:false,marginLeft:null,marginRight:null,disable:false,onGripCreated:null,onDrag:null,onResize:null}
var options=$.extend(defaults,options);return this.each(function(){init(this,options);});}});})(jQuery);;(function($){$.fn.keyboard=function(){$k.bind(this,arguments);return this;}
$.keyboard=function(){$k.bind($(document),arguments);return this;}
var $k={setup:{'strict':true,'event':'keydown','preventDefault':false},keys:{cont:[],getCodes:function(){var codes=[];for(var i=0;i<$k.keys.cont.length;i++){codes.push($k.keys.cont[i].keyCode);}
return codes;},add:function(e){if(e.keyCode==0){}else{$k.keys.rm(e);$k.keys.cont.push(e);$k.keys.dump();}},rm:function(e){for(var i=0;i<$k.keys.cont.length;i++){if($k.keys.cont[i].keyCode==e.keyCode){$k.keys.cont.splice(i,1);return;}}},clear:function(){$k.keys.cont=[];},dump:function(){}},keyCodes:{a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,n0:48,n1:49,n2:50,n3:51,n4:52,n5:53,n6:54,n7:55,n8:56,n9:57,tab:9,enter:13,shift:16,backspace:8,ctrl:17,alt:18,esc:27,space:32,menu:93,pause:19,cmd:91,insert:45,home:36,pageup:33,'delete':46,end:35,pagedown:34,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,np0:96,np1:97,np2:98,np3:99,np4:100,np5:101,np6:102,np7:103,np8:104,np9:105,npslash:11,npstar:106,nphyphen:109,npplus:107,npdot:110,capslock:20,numlock:144,scrolllock:145,equals:61,hyphen:109,coma:188,dot:190,gravis:192,backslash:220,sbopen:219,sbclose:221,slash:191,semicolon:59,apostrophe:222,aleft:37,aup:38,aright:39,adown:40},parseArgs:function(args){if(typeof args[0]=='object'){return{setup:args[0]};}else{var secondIsFunc=(typeof args[1]=='function');var isDelete=!secondIsFunc&&(typeof args[2]!='function');var argsObj={};argsObj.keys=args[0];if($.isArray(argsObj.keys)){argsObj.keys=argsObj.keys.join(' ');}
if(isDelete){argsObj.isDelete=true;}else{argsObj.func=secondIsFunc?args[1]:args[2];argsObj.cfg=secondIsFunc?args[2]:args[1];if(typeof argsObj.cfg!='object'){argsObj.cfg={};}
argsObj.cfg=$.extend(clone($k.setup),argsObj.cfg);}
return argsObj;}},getIndex:function(keyCodes,order){return(order=='strict')?'s.'+keyCodes.join('.'):'f.'+clone(keyCodes).sort().join('.');},getIndexCode:function(index){if($k.keyCodes[index]){return $k.keyCodes[index];}else{throw'No such index: '+index+'';}},getRange:function(title){var c=$k.keyCodes;var f=arguments.callee;switch(title){case'letters':return range(c['a'],c['z']);case'numbers':return range(c['n0'],c['n9']);case'numpad':return range(c['np0'],c['np9']);case'fkeys':return range(c['f1'],c['f12']);case'arrows':return range(c['aleft'],c['adown']);case'symbols':return[c.equals,c.hyphen,c.coma,c.dot,c.gravis,c.backslash,c.sbopen,c.sbclose,c.slash,c.semicolon,c.apostrophe,c.npslash,c.npstar,c.nphyphen,c.npplus,c.npdot];case'allnum':return f('numbers').concat(f('numpad'));case'printable':return f('letters').concat(f('allnum').concat(f('symbols')))
default:throw'No such range: '+title+'';}},stringGetCodes:function(str){var parts;str=str.toLowerCase();if(str.match(/^\[[\w\d\s\|\)\(\-]*\]$/i)){var codes=[];parts=str.substring(1,str.length-1).replace(/\s/,'').split('|');for(var i=0;i<parts.length;i++){var p=$k.stringGetCodes(parts[i])
codes=codes.concat(p);}
return codes;}else if(str.match(/^\([\w\d\s\-]*\)$/i)){parts=str.substring(1,str.length-1).replace(/\s/,'').split('-');if(parts.length==2){return range($k.getIndexCode(parts[0]),$k.getIndexCode(parts[1]));}else{return $k.getRange(parts[0]);}}else{return[$k.getIndexCode(str)];}},getCodes:function(keys){var keycodes=[];for(var i=0;i<keys.length;i++){var key=keys[i];if(!isNaN(key)){key=[1*key];}else if(typeof key=='string'){key=$k.stringGetCodes(key);}else{throw'Wrong key type: '+(typeof key)+'';}
keycodes.push(key);}
return keycodes;},parseKeysString:function(str){var parts=str.split(',');for(var i=0;i<parts.length;i++){var string=$.trim(parts[i]);parts[i]={};parts[i].order=string.indexOf('+')>=0?'strict':'float';parts[i].codes=$k.getCodes(string.split(parts[i].order=='strict'?'+':' '));parts[i].index=$k.getIndex(parts[i].codes,parts[i].order);parts[i].group=i;}
return parts;},match:function(bind){var k,i,matched,cur=undefined;var cont=$k.keys.getCodes();var codes=clone(bind.keys.codes);var eventIndexes=[];if(codes.length==0){return false;}
if(bind.keys.order=='strict'){for(i=0;i<cont.length;i++){if(!codes.length){break;}
if(cur===undefined){cur=codes.shift();}
if(inArray(cont[i],cur)){cur=undefined;eventIndexes.push(i);}else if(bind.cfg.strict){return false;}}
return(codes.length===0&&cur===undefined)?eventIndexes:false;}else{for(i=0;i<codes.length;i++){matched=false;for(k=0;k<codes[i].length;k++){cur=$.inArray(codes[i][k],cont);if(cur>=0){eventIndexes.push(cur);matched=true;break;}}
if(!matched){return false;}}
if(bind.cfg.strict){for(i=0;i<cont.length;i++){matched=false;for(k in codes){if(inArray(cont[i],codes[k])){matched=true;break;}}
if(!matched){return false;}}}
return eventIndexes;}},hasCurrent:function(bind,e){var last=bind.keys.codes.length-1;return(bind.keys.order=='strict')?inArray(e.keyCode,bind.keys.codes[last]):inArrayR(e.keyCode,bind.keys.codes);},checkBinds:function($obj,e){var ei,okb=$obj.keyboardBinds;for(var i in okb){var bind=okb[i];if(bind.cfg&&e.originalEvent&&bind.cfg.event==e.originalEvent.type){ei=$k.match(bind);if(ei&&$k.hasCurrent(bind,e)){var backup=$obj.keyboardFunc;var events=[];for(var k in ei){events.push($k.keys.cont[ei[k]])}
$obj.keyboardFunc=bind.func;$obj.keyboardFunc(events,bind);$obj.keyboardFunc=backup;if(bind.cfg.preventDefault){e.preventDefault();}}}}},bind:function($obj,args){args=$k.parseArgs(args);if(args.setup){$k.setup=$.extend($k.setup,args.setup);}else{if(!$obj.keyboardBinds){$obj.keyboardBinds={};$obj.keydown(function(e){$k.keys.add(e);$k.checkBinds($obj,e);}).keyup(function(e){$k.checkBinds($obj,e);});}
var parts=$k.parseKeysString(args.keys);for(var i=0;i<parts.length;i++){if(args.keys.isDelete){$obj.keyboardBinds[parts[i].index]=undefined;}else{$obj.keyboardBinds[parts[i].index]=clone(args);$obj.keyboardBinds[parts[i].index].keys=parts[i];}}}},init:function(){$(document).keydown($k.keys.add).keyup(function(e){setTimeout(function(){$k.keys.rm(e)},0);}).blur($k.keys.clear);}}
var inArrayR=function(value,array){for(var i=0;i<array.length;i++){if(typeof array[i]=='object'||$.isArray(array[i])){if(inArrayR(value,array[i])){return true;}}else if(value==array[i]){return true;}}
return false;}
var inArray=function(value,array){return($.inArray(value,array)!=-1);};var range=function(from,to){var r=[];do{r.push(from);}while(from++<to)
return r;};var clone=function(obj){var newObj,i;if($.isArray(obj)){newObj=[];for(i=0;i<obj.length;i++){newObj[i]=(typeof obj[i]=='object'||$.isArray(obj[i]))?clone(obj[i]):obj[i];}}else{newObj={};for(i in obj){newObj[i]=(typeof obj[i]=='object'||$.isArray(obj[i]))?clone(obj[i]):obj[i];}}
return newObj;};$k.init();})(jQuery);;$(document).ready(function(){$.fn.spinLoader=function(){this.startAnimation=function(){var $this=$(this);$this.append('<div class="tw-await" style="height: '+
(2+$this.height())+'px; width: '+(2+$this.width())+'px;"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>');}
this.stopAnimation=function(){$('.tw-await').remove();}
return this;}
$(window).on("click",".view-tariff-page, .one-thing-head .print_button_img",function(event){event.stopPropagation();});$(window).on("click",".fancybox_client_good",function(event){event.preventDefault();event.stopPropagation();$.fancybox({autoScale:true,height:'100%',width:'auto',href:$(this).attr('href'),ajax:{type:'POST'},onComplete:function(){var this_wrap=$('.form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');setTimeout(function(){$('.form_gen_wrapper .estimate-name-input').trigger('estimate-price');$(window).trigger('need-init-fileupload');},0);}});});$(window).on("click",".fancybox_client_pawn",function(event){event.stopPropagation();event.preventDefault();$.fancybox({autoScale:true,height:'100%',width:'auto',href:$(this).attr('href'),ajax:{type:'POST'},onComplete:function(){var this_wrap=$('.form_gen_wrapper');genFormInit(this_wrap);setTimeout(function(){$(window).trigger('need-init-fileupload');},0);$('#form_edit_pawn .field_input').each(function(){if(!$(this).children(':first').attr('disabled')){$(this).children(':first').focus();return false;}});}});});$(window).on("click",".one-thing-head",function(event){var $this=$(this),$parent=$this.parent(),$content=$parent.children('.one-thing-content'),chainId=$parent.data('chain-id'),operationId=$parent.data('operation-id');if($content.hasClass('active')){$content.slideUp({complete:function(){$this.removeClass('one-thing-expanded').addClass('one-thing-hidden');$content.removeClass('active').html('');$this.children('.pawn_delete_btn').hide();$this.attr('title','');},duration:0});}else{$parent.spinLoader().startAnimation();$.ajax({url:"/ajax/ajax_215.php",type:"POST",dataType:"json",data:{pawn_chain_id:chainId,op_id:operationId},success:function(result){if(result.status){var verticalSpacer="<div class=\"vertical-spacer\"></div>";$this.removeClass('one-thing-hidden').addClass('one-thing-expanded');$this.children('.action-buttons').html(result.html_action_buttons);$content.hide().html(verticalSpacer+result.html+verticalSpacer).addClass('active').slideDown({complete:function(){$parent.spinLoader().stopAnimation();$this.children('.pawn_delete_btn').show();$this.attr('title','');setTimeout(function(){$(window).trigger('need-init-fileupload');},0);},duration:0});}else{alert(result.message);}}});}});$(window).on("click",".one-thing-old-head",function(event){console.log('click!');var $this=$(this).parent(),$content=$this.children('.one-thing-old-content'),operation=$this.data('oid'),isActive=$this.hasClass('active');if(isActive){$content.slideUp({complete:function(){$this.removeClass('active');$content.html('');},duration:0});}else{$this.spinLoader().startAnimation();$.ajax({url:"/ajax/ajax_215_old.php",type:"POST",dataType:"json",data:{op_id:operation,backurl:window.location.pathname+window.location.hash},success:function(result){var verticalSpacer="<div class=\"vertical-spacer-old\"></div>";$content.hide().html(verticalSpacer+result+verticalSpacer).slideDown({complete:function(){$this.spinLoader().stopAnimation();$this.addClass('active');$('.one-thing-old-content .client_images_list .fancybox').fancybox();setTimeout(function(){$(window).trigger('need-init-fileupload');},0);},duration:0});}});}});$(window).on("click",".pawn-chainer-controller",function(event){event.preventDefault();var $this=$(this),$chainer=$this.next('.pawn-chainer');if($chainer.hasClass('active')){$chainer.slideUp({complete:function(){$chainer.removeClass('active');$this.html('');},duration:0});}else{$chainer.slideDown({complete:function(){$chainer.addClass('active');$this.html('  ');},duration:0});}});$('.sub_active_button, .item_active').live('click',function(e){e.stopPropagation();var input_name=$(this).data('name'),$that=$(this);var type=$(this).siblings('input[name="operation_type_sub"]').val();var submit_form=function(){$('.sub_hidden_image_x').attr('name',input_name+'_x');$('.sub_hidden_image_y').attr('name',input_name+'_y');$that.closest('form').submit();};if($(this).hasClass('vivod_alert_msg')){var confirm_text='         .           .';swal({title:confirm_text,type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},submit_form);}else if(type==109&&input_name!='vivod_iz_zaloga'){var confirm_text='!         .';swal({title:confirm_text,type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},submit_form);}else{submit_form();}});$('.one-thing-old-content .remove-from-sale').live('click',function(){var good_id=$(this).data('good-id');var name=$(this).data('good-name');swal({title:' '+name+'  ?',type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:"",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},function(){$.ajax({type:'GET',dataType:'json',url:'/good/remove_from_sale/'+good_id,data:{},success:function(data){if(!data.status){swal(' ',data.message,'error');}else{if(data.need_redirect){location.href=data.redirect_path;}}},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown);}});});});$(document).on('click','.delete-client, #delete_client',function(e){var name=$(this).data('fio'),id=$(this).data('id');swal({title:' ',text:'     \n'+name+'?\n    !',type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:", !",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},function(){$.ajax({type:'GET',dataType:'json',url:'/edit_client/ajax/remove',data:{act:'delete',id:id},success:function(data){if(data=='0'){swal(':',' -   .   .','error');}else{window.location.href='/clients/';}},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown);}});});});$(window).on("click",".rating_points_balance_popup",function(event){event.stopPropagation();event.preventDefault();var client_id=$(this).data('id');$.fancybox({href:$(this).attr('href'),ajax:{type:'POST',data:{'client_id':client_id}},onComplete:function(){var this_wrap=$('.form_gen_wrapper');genFormInit(this_wrap);$("#base_rating").live("keyup",function(){var base_rating=($(this).val()===''?0:$(this).val());$.ajax({type:'POST',url:'/client/'+client_id+'/savefirstrating/',data:{base_rating:parseFloat(base_rating.toString().replace(',','.'))},success:function(data){if(data.status){var i=0;var itogo=0;var base_rating=($("#base_rating").val()===''?0:$("#base_rating").val());$('.column_sum span.operation_rating_total').each(function(){itogo+=Number($(this).html());});itogo+=parseFloat(base_rating.toString().replace(',','.'));$('#itogorating').html(itogo);$('.rating_points_balance_popup').html(itogo);}else{swal(',   ',null,'error');}}});});}});});$(window).on("client-after-load-items",function(event){$(".datepicker").datepicker();});$(document).on("click",".datepicker_date_btn",function(event){event.preventDefault();event.stopPropagation();$(this).siblings('input.datepicker').focus();});$(document).on("change",".datepicker_date_hidden",function(event){const $that=$(this),type=$(this).data('type'),pawn_id=$(this).data('pawn-id'),current_date_string=new Date().toLocaleString("ru",{year:'numeric',month:'numeric',day:'numeric'}),date=$(this).val();$.ajax({type:'GET',dataType:'json',url:'/client/pawn_percent_calculator/',data:{pawn_id:pawn_id,date:date},success:function(data){if(data.status){$that.siblings('.datepicker_date_btn').html((date===current_date_string?'':date));$('#datepicker_'+type+'_'+pawn_id).html(data[type]+' '+data.currency);}else{swal(data.error,null,'error');}},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown);}});});$(window).on('click','.test_operation',function(){var value=0;var type=$(this).data("type");const POKUPKA=11;const VIVOD=6;var url='';if($(this).attr('checked')!==undefined){value=1;}
if(type==POKUPKA||type==VIVOD){url="/good/update/test_operation/"+$(this).data("goodid");}else{url="/pawntickets/update/test_operation/"+$(this).data("pawnchainid");}
$.ajax({type:"POST",dataType:"json",data:{"value":value},url:url,success:function(result){console.log(result);}});});$(document).on("change","#fancybox-content #category_id_select",function(){replace_subcategory_options($(this).val(),"#subcategory_id_select");});$(document).on("change","#fancybox-content .shop_export_status input",function(){const $this=$(this);const input_check=$this.is(":checked");const $form_gen_wrapper=$this.closest("#fancybox-content").find(".form_gen_wrapper");const id=$form_gen_wrapper.find('[name="id"]').val();$.ajax({url:"/good/",type:"POST",dataType:"json",data:{id:id,export_status:input_check,type:"ajax"},success:function(result){const $polomb_block=$this.closest(".polombardam_good_block");$polomb_block.empty().html(result);},error:function(xhr,str){console.log(" : "+xhr.responseCode+";  : "+str);}});if(input_check){$('.form_gen_wrapper [name="shop_export_status"]').removeAttr("disabled");}else{$('.form_gen_wrapper [name="shop_export_status"]').attr("disabled","disabled");}});$(document).on("click","#fancybox-content .good_returned_item_active",function(){const input_name=$(this).data("name");$(".sub_hidden_image_x").attr("name",input_name+"_x");$(".form_returned_op").submit();});});var good_reload_href;function fancyboxClientGoodPopupUpdate(good_hash,client_goods_link){$.fancybox({autoScale:true,height:'100%',width:'auto',href:$('div[data-hash="'+good_hash+'"]').find("a.fancybox_client_good ").attr('href'),ajax:{type:'POST'},onComplete:function(){good_reload_href=client_goods_link;var this_wrap=$('.form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');saveGoodSuccessMessage();setTimeout(function(){$(window).trigger('need-init-fileupload');},0);},onClosed:function(){if(good_reload_href){location.href=good_reload_href;}}});}
function saveGoodSuccessMessage(){$("#fancybox-content form[action=\"/good/\"]").before("<div class=\"alter_login save_good_success_message\" style=\"width:524px; margin-top: 20px; cursor:pointer;\">  (    ).</div>");$(".save_good_success_message").click(function(){$(this).hide(100).remove();});};function renderMustacheTemplate(templateName,data,partials){var template=$('#'+templateName).html();Mustache.parse(template);return Mustache.render(template,data,partials);}
$.clientComponent={plugin_name:'Client Component',route:null,client_id:null,page_params:null,client_data:null,log:function(log_message){console.log(this.plugin_name+': '+log_message);},init:function(){this.addEvents();this.route=this.routeConstructor();this.client_id=this.route.parameters.client;this.page_params=this.route.parameters;this.loadClient();},routeConstructor:function(){function route(){if(document.location.hash===""){throw new Error("Route problems");return false;}
this.parameters={};var this_route=this,hash_array=document.location.hash.split('#'),hash_params=hash_array.shift();hash_params=hash_array.toString().split('/');hash_array=hash_params.pop();for(var index in hash_params){var hash_param=hash_params[index].split(':'),hash_param_name=hash_param[0],hash_param_value=hash_param[1];if(hash_param_name!=='anchor'){this.parameters[hash_param_name]=parseInt(hash_param_value);}else{this.parameters[hash_param_name]=hash_param_value;}}
this.go=function(object){var path='#';$.extend(this_route.parameters,object);for(var index in this_route.parameters){path=path+index+':'+this_route.parameters[index]+'/';}
window.location.hash=path;};}
return new route();},updateUI:function(){$('#client-component .tabs li').removeClass('active');if(this.page_params.section!==undefined){$('#client-component .tabs li[data-section="'+this.page_params.section+'"]').addClass('active');if(this.page_params.section==1){$('#buy_filter').show();}else{$('#buy_filter').hide();}}
if(!this.page_params.wp){$('#client-component .filters #filter-from-current').prop('checked',true);$('#client-component .filters #filter-from-all').prop('checked',false);}else{$('#client-component .filters #filter-from-all').prop('checked',true);$('#client-component .filters #filter-from-current').prop('checked',false);}},updateRoute:function(){this.log('updating client route');this.route=this.routeConstructor();this.client_id=this.route.parameters.client;this.page_params=this.route.parameters;this.updateUI();this.loadItems();},addEvents:function(){var that=this;this.log('reinitializing events');function hash_changed(){that.log('hash changed to: '+window.location.hash);that.updateRoute();}
$(window).off('.clientComponent');removeEventListener('hashchange',hash_changed);$(window).on('click.clientComponent','#client-component .info a.name',function(e){that.loadInfoBlock();});$(window).on('click.clientComponent','#client-component .tabs li',function(e){e.stopPropagation();e.preventDefault();that.route.go({section:$(this).data('section')});});$(window).on("change.clientComponent",'#client-component .filters input',function(e){var new_route={};new_route[$(this).attr('name')]=$(this).val();that.route.go(new_route);});addEventListener('hashchange',hash_changed);},loadClient:function(){var apiPath='/client/'+this.client_id+'/load/',that=this;function renderClientPage(templateName,data){that.log('rendering client page');data.uri=that.route.parameters;var rendered_template=renderMustacheTemplate(templateName,data,{infoTemplate:$('#client-info').html()});$('#client-component').html(rendered_template);if(data&&data.fullName){document.title=data.fullName;$('#breadcrumbs').children().last().html(data.fullName);}
if(data&&data.warning){swal("",data.warning,'warning');}}
that.log('requesting client data');$.post(apiPath,this.page_params,function(answer){if(answer&&answer.status){that.client_data=answer;setTimeout(function(){renderClientPage('client-component-template',answer);if(that.page_params.info==1){that.loadInfoBlock();}
that.loadItems();},0);}else if(answer&&!answer.status){$('#client-component').after(answer.error);}else{$('#client-component').after("  ,  ");}},'json').fail(function(){swal(' ','     .     .','error');});},loadItems:function(){var apiPath='/client/'+this.client_id+'/items/',that=this;function renderClientItems(templateName,data){that.log('rendering client items');that.updateUI();data.uri=that.route.parameters;$('.things-list').html(renderMustacheTemplate(templateName,data));if(that.page_params.anchor){that.log('trying to find anchor');var params=that.page_params,$pawn=$('[data-chain-id="'+params.anchor+'"]'),$good=$('[data-hash="'+params.anchor+'"]');if(!!$pawn.length&&!$pawn.children('.one-thing-content').hasClass('active')){that.log('pawn anchor is found');$pawn.children('.one-thing-head').trigger('click');setTimeout(function(){$.scrollport($pawn,{mode:'hard'});},0);}
if(!!$good.length&&!$good.hasClass('active')){that.log('good anchor is found');$good.children('.one-thing-old-head').trigger('click');setTimeout(function(){$.scrollport($good,{mode:'hard'});},0);}
if(that.page_params.section==1){$('#buy_filter').show();}else{$('#buy_filter').hide();}}}
if(that.page_params.section===undefined){if(that.client_data.sections&&that.client_data.sections.length){that.log('section is not specified - force to first available');that.route.go({section:that.client_data.sections[0].i});}else{that.log('no sections available');}
return false;}
$('.things-list').html('<div class="wait-message"> ...\n\
                                    <div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>\n\
                                </div>');that.log('requesting client items');that.page_params.good_list_type=$('input[name="good_list_type"]:checked').val();$.post(apiPath,this.page_params,function(answer){if(answer&&answer.status){that.client_data=answer;setTimeout(function(){renderClientItems('client-items',answer);setTimeout(function(){$(window).trigger('need-init-fileupload');$(window).trigger('client-after-load-items');},0);},0);}else if(answer&&!answer.status){$('#client-component').after(answer.error);}else{$('#client-component').after("  ,  ");}},'json').fail(function(){$('.things-list').html('<h3>     .     .</h3>');swal(' ','     .     .','error');});},loadInfoBlock:function(){var that=this,$target=$('.full-info'),apiPathInfo='/client/'+that.client_id+'/info/';if($target.hasClass('closed')){that.log('requesting client info block');$.post(apiPathInfo,{},function(answer){answer.uri=that.page_params;that.log('rendering client info block');$('.full-info').html(renderMustacheTemplate('client-info',answer));$target.slideDown(function(){$target.removeClass('closed');setTimeout(function(){$(window).trigger('need-init-fileupload');},0);});},'json').fail(function(){swal(' ','     .     .','error');});}else{$target.slideUp(function(){$target.addClass('closed');});}}};$(function(){$.clientComponent.init();});;$(document).ready(function(){$('.DelAllHistory.button').live('click',function(e){e.preventDefault();var id_op=$(this).next().val();var id_op_item=$(this).closest('.sub_operations').attr('id');if(confirm('      ?')){$.ajax({url:'/ajax_remove_operation',type:'POST',dataType:"json",data:{'id_op':id_op,'DelAllHistory':'all'},success:function(result){if(result.status){$('#'+id_op_item).prev().remove();$('#'+id_op_item).next().remove();$('#'+id_op_item).remove();swal({title:'  .',type:"success"},function(){window.location.reload();});}else{console.log(result.message);if(result.message){swal(result.message,null,"error");}else{swal(' ',null,'error');}}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});}});$('.del_op_btn').live('click',function(e){e.preventDefault();var id_op=$(this).siblings("input[name='id_op']").val();$this=$(this);if(confirm('    ?')){$.ajax({url:'/ajax_remove_operation',type:'POST',dataType:"json",data:{'id_op':id_op,'cash_id':'cash_id'},success:function(result){if(result.status){swal({title:'  .',type:"success"},function(){window.location.reload();});}else{if(result.message){swal(result.message,null,"error");}else{swal(' ',null,'error');}}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});}});$('.magic_unicorn_delete_izyatie').live('click',function(e){e.preventDefault();var op_id=$(this).siblings("input[name='op_id']").val();$this=$(this);if(confirm('    ?')){$.ajax({url:'/ajax_remove_operation',type:'POST',dataType:"json",data:{'op_id':op_id,'act':'pawn_operation'},success:function(result){if(result.status){swal({title:'  .',type:"success"},function(){window.location.reload();});}else{if(result.message){swal(result.message,null,"error");}else{swal(' ',null,'error');}}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});}});$('.pawn_delete_btn, .pawn_close_delete_btn, .pawn_close_delete_btn_img, .remove_pawn_history').live('click',function(){var pawn_id=$(this).data('pawn');var op_id=$(this).data('opid');var act=$(this).data('act');var printing=$(this).data('printing');var number=$(this).data('number');var type_op=$(this).data('type_op');var msg;var msgp;var prichina;var spisan;var aj=false;if(act=='all_history'){msg='    ?';if(printing!='0'){msgp='       '+number+'.   ?';}else{msgp='';}}else if(act=='last_pawn'){if(printing!='0'){msg='    ?';msgp='       '+number+'.   ?';}else{msg='        . ,          ,         .     ?';msgp='';}}else if((type_op==101||type_op==104||type_op==105||type_op==102)&&printing!=0){msg='       . ?';msgp='       '+number+'.   ?';}else{msg='    ?';msgp='';}
if(confirm(msg)){if(printing!='0'&&msgp!=''){if(confirm(msgp)){prichina=prompt('     '+number);if(prichina||prichina==''){spisan='1';aj=true;}else{spisan='0';aj=true;}}else{aj=true;}}else{aj=true;}
if(aj){$.ajax({url:'/ajax_remove_operation',type:'POST',dataType:"json",data:{'pawn_id':pawn_id,'act':act,'op_id':op_id,'prichina':prichina,'spisan':spisan},success:function(result){if(result.status){swal({title:'  .',type:"success"},function(){window.location.reload();});}else{if(result.message){swal(result.message,null,"error");}else{swal(' ',null,'error');}}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});}}});});;$(document).ready(function(){$('.documents-input-holder').val(JSON.stringify([]));$('.pick-client-document').live('click',showAllDocuments);$('.apply-client-document').live('click',setClientDocument);$('.add-client-document').live('click',addClientDocument);$('.edit-client-document').live('click',editClientDocument);$('.delete-client-document').live('click',deleteClientDocument);$('.add-temp-document').live('click',addTempDocument);$('.edit-temp-document').live('click',editTempDocument);$('.delete-tmp-document').live('click',deleteTempDocument);if(window.location.hash==='#popup-add-client-document'){$('.add-client-document').click();window.location.hash='';}});function removeTmpDocument(hash){var array=getAllTmpDocuments();array.forEach(function(element,index,array){if(element.hash==hash){array.splice(index,1);}});$('.documents-input-holder').val(JSON.stringify(array));}
function updateDocumentInfo(obj){if(obj){if(obj.status&&obj.close){$.fancybox.close();}
if(obj.status&&obj.reload){location.reload();return;}
if(obj.status&&obj.document_id){var elements=$('.edit-client-document[data-document-id="'+obj.document_id+'"]');elements.each(function(index){$(this).text(obj.document_description);});}}}
function addTmpDocument(obj){var array=getAllTmpDocuments();array.push(obj);$('.documents-input-holder').val(JSON.stringify(array));}
function getAllTmpDocuments(){try{var array=JSON.parse($('.documents-input-holder').val());}catch(e){var array=[];}
return array;}
function getTmpDocument(hash){var array=getAllTmpDocuments();for(x in array){if(array[x].hash==hash){return array[x];}}
return false;}
function showAllDocuments(){var client_id=$(this).data('client-id');$.ajax({type:'GET',url:'/client/'+client_id+'/document/show_all/',dataType:'json',data:{},success:function(data){$.fancybox(data);}});}
function addClientDocument(){var client_id=$(this).data('client-id'),custom_event=$(this).data('document-event');if(custom_event){custom_event({client_id:client_id});}else{$.ajax({type:'GET',url:'/client/'+client_id+'/document/add/',dataType:'json',data:{},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');this_wrap.find('.d_input_mask').inputmask('999-999');}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function addTempDocument(){var custom_event=$(this).data('document-event');if(custom_event){custom_event();}else{$.ajax({type:'GET',url:'/client/document/add/',dataType:'json',data:{},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');this_wrap.find('.d_input_mask').inputmask('999-999');}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function postponeTempDocument(json,$wrp){$wrp=$wrp||$('.documents-wrp');var tmp_document_wrp=document.createElement("div"),tmp_document=document.createElement("span"),remove_button=document.createElement("img");var existing_element=$('#tmp-document-'+json.hash);if(existing_element.length){existing_element.children('.client-document-name').text(json.document_description);}else{remove_button.style.cursor='pointer';remove_button.style.position='absolute';remove_button.style.right='0';remove_button.style.top='4px';remove_button.alt='X';remove_button.src='/img/cross_ico.png';remove_button.title='';remove_button.className='delete-tmp-document';remove_button.setAttribute("data-document-hash",json.hash);tmp_document.textContent=json.document_description;tmp_document.className='link-action client-document-name edit-temp-document';tmp_document.setAttribute("data-document-hash",json.hash);tmp_document_wrp.id='tmp-document-'+json.hash;tmp_document_wrp.style.position='relative';tmp_document_wrp.appendChild(tmp_document);tmp_document_wrp.appendChild(remove_button);$wrp.append(tmp_document_wrp);$wrp.children('.no-docs-message').hide();}
removeTmpDocument(json.hash);addTmpDocument(json);}
function editTempDocument(){var document_hash=$(this).data('document-hash'),custom_event=$(this).data('document-event');if(custom_event){custom_event();}else{var document=getTmpDocument(document_hash);console.log(document,document_hash);if(typeof document==='object'){$.ajax({type:'POST',url:'/client/document/edit',dataType:'json',data:{hash:document.hash,number:document.number,document_type:document.document_type,issued_by:document.issued_by,issued_date:document.issued_date,note:document.note},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');this_wrap.find('.d_input_mask').inputmask('999-999');}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}else{alert('   - ');}}}
function editClientDocument(){var document_id=$(this).data('document-id'),custom_event=$(this).data('document-event');if(custom_event){custom_event({document_id:document_id});}else{$.ajax({type:'GET',url:'/client/document/'+document_id+'/edit/',dataType:'json',data:{},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);this_wrap.find('.date_input_mask').inputmask('99.99.9999');this_wrap.find('.d_input_mask').inputmask('999-999');}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function deleteClientDocument(){var document_id=$(this).data('document-id'),custom_event=$(this).data('document-event');if(custom_event){custom_event({document_id:document_id});}else{$.ajax({type:'GET',url:'/client/document/'+document_id+'/delete/',dataType:'json',data:{},beforeSend:function(){if(!confirm('     ?')){return false;}},success:function(data){if(data.status){location.reload();}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function deleteTempDocument(){var document_hash=$(this).data('document-hash'),custom_event=$(this).data('document-event');if(custom_event){custom_event({document_id:document_hash});}else{$('#tmp-document-'+document_hash).remove();removeTmpDocument(document_hash);if(!$('.documents-wrp div').length){$('.documents-wrp .no-docs-message').show();}}}
function setClientDocument(){var document_name=$(this).data('document-name'),document_id=$(this).data('document-id'),custom_event=$(this).data('document-event');if(custom_event){custom_event({document_id:document_id,document_name:document_name});}else{$('.client-document-name').text(document_name).data('document-id',document_id);$('.client-document-id').val(document_id);$.fancybox.close();}}
function showClientNeedDocumentError(client_id){const message='  .    .       .';swal({title:message,type:'error'},function(){window.location.href='/edit_client/?id='+client_id+'#popup-add-client-document';});};$(document).ready(function(){$.priceTag.init();$('.price-tags-table .check_id').on('change',checkUncheckProxy);$('.selected-all-price-tag').on('click',selectAllProxy);$('.clear-selected-price-tag').on('click',clearAllProxy);$('.add-price-tag-list').on('click',addGoodToPriceTags);$('.remove-price-tag').on('click',removePriceTag);$('.print-selected-price-tags').live('click',printSelectedPriceTag);$('.print-price-tag').live('click',printPriceTag);$('.postpone-price-tag').live('click',postponePriceTag);$('.price-tag-form').live('click',showPriceTagForm);$('.specs-container .specs-button').live('click',function(){if(!$(this).hasClass('global')){$('.specs-container').show();$('.specs-container.global').hide();$('input[name="use_global_specs"]').val('0');}else{$('.specs-container').hide();$('.specs-container.global').show();$('input[name="use_global_specs"]').val('1');}});$('.price-tags-table .MainTable .check_id').on('checked',function(){$.priceTag.add($(this).val());});$('.price-tags-table .MainTable .check_id').on('unchecked',function(){$.priceTag.remove($(this).val());});$('.good-specifications-form').live('click',showGoodSpecificationsForm);$('.goods-price-tags-table .add-goods2pricetag-button').live('click',postponePriceTagsBatch);$('.goods-price-tags-table .check_id').live('change',checkUncheckGoodsProxy);$('.goods-price-tags-table .task_table_navigation a').live('click',tableNavigationProxy);});$.priceTag={scope:'price_tags',indexPrefix:'pt',countWrapper:'.selected-price-tag-cnt',checkboxWrapper:'.price-tags-table .check_id',cache:{},init:function(){var that=this;localforage.getItem(that.scope,function(err,value){var data;if(value==null){that.selectAll(false);}else{data=JSON.parse(value);that.save(data);that.syncState();}});},checkUncheck:function(event){var id=event.target.value;if(event.target.checked){this.add(id);}else{this.remove(id);}},updateCount:function(){$(this.countWrapper).text(this.getCacheCount());},updateUI:function(){if(this.getCacheCount()){$('.link-action.remove-price-tag').removeClass('disabled').attr('title','');}else{$('.link-action.remove-price-tag').addClass('disabled').attr('title','     .');}},syncCheckbox:function(){const object=this.get();const $checkboxes=$(this.checkboxWrapper);if($checkboxes.length>0){$checkboxes.each(function(index,html_element){var current_id=html_element.value;var isChecked=false;for(var stored_id in object){if(current_id==object[stored_id]){isChecked=true;}}
if(isChecked){html_element.checked=true;}else{html_element.checked=false;}});const $checkboxes_checked=$(this.checkboxWrapper+':checked');if($checkboxes.length===$checkboxes_checked.length){$('.price-tags-table .check_all_tables_class').prop('checked',true);}else{$('.price-tags-table .check_all_tables_class').prop('checked',false);}}else{$('.price-tags-table .check_all_tables_class').prop('checked',false);}},syncState:function(){this.syncCheckbox();this.updateCount();this.updateUI();},clearAll:function(){this.save({});this.syncState();},clearScope:function(callback){var that=this;localforage.removeItem(that.scope,function(err){localforage.getItem(that.scope,function(err,value){if(value===null){console.log('Storage is cleared!');if(callback){callback();}}else{console.log('Value not cleared! '+value);}});});},selectAll:function(reload_page){var that=this;if(reload_page===undefined){reload_page=true;}
$.ajax({type:'POST',url:'/price_tag/get/all',dataType:'json',data:{not_printed:true,current_workplace:true},success:function(data){if(data.status){if(reload_page){that.save(that.addPrefix(data.id),function(){location.reload();});}else{that.save(that.addPrefix(data.id));that.syncState();}}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});},appendPrefix:function(callback){var source_object;var appended_object;source_object=this.get();appended_object=this.addPrefix(source_object);this.save(appended_object,callback);},addPrefix:function(ids,callback){var new_object={};if(ids===undefined||ids===null){ids=[];}
for(var id in ids){new_object[this.indexPrefix+ids[id]]=ids[id];}
if(callback){callback(new_object);}
return new_object;},add:function(id,sync,callback){if(sync===undefined){sync=true;}
this.cache[this.indexPrefix+id]=id;this.save(this.get());if(sync){this.syncState();}},addBatch:function(ids,sync,callback){if(sync===undefined){sync=true;}
if(ids.length>0){for(var index in ids){this.cache[this.indexPrefix+ids[index]]=ids[index];}}
this.save(this.get(),callback);if(sync){this.syncState();}},remove:function(id,sync){if(sync===undefined){sync=true;}
delete this.cache[this.indexPrefix+id];this.save(this.get());if(sync){this.syncState();}},getCacheCount:function(){return Object.keys(this.get()).length;},get:function(){return this.cache;},save:function(object,callback){var that=this;this.cache=object;localforage.setItem(that.scope,JSON.stringify(object),function(err){localforage.getItem(that.scope,function(err,value){if(callback){callback();}});});}};$.goods2PriceTag={countWrapper:'.selected-goods2pricetag-cnt',checkboxWrapper:'#fancybox-content .goods-price-tags-table input.check_id',cache:{},init:function(){},checkUncheck:function(event){var id=event.target.value;if(event.target.checked){this.add(id);}else{this.remove(id);}},updateCount:function(){$(this.countWrapper).text(Object.keys(this.get()).length);},syncCheckbox:function(){var object=this.get();var $checkboxes=$(this.checkboxWrapper);if($checkboxes.length>0){$checkboxes.each(function(index,html_element){var current_id=html_element.value;var isChecked=false;for(var stored_id in object){if(current_id==stored_id){isChecked=true;}}
if(isChecked){html_element.checked=true;}else{html_element.checked=false;}});const $checkboxes_checked=$(this.checkboxWrapper+':checked');if($checkboxes.length===$checkboxes_checked.length){$('#fancybox-content .goods-price-tags-table .check_all_tables_class').prop('checked',true);}else{$('#fancybox-content .goods-price-tags-table .check_all_tables_class').prop('checked',false);}}else{$('#fancybox-content .goods-price-tags-table .check_all_tables_class').prop('checked',false);}},syncState:function(){this.syncCheckbox();this.updateCount();},clearAll:function(){this.save({});this.syncState();},add:function(id,sync){if(sync===undefined){sync=true;}
this.cache[id]=id;this.save(this.get());if(sync){this.syncState();}},remove:function(id,sync){if(sync===undefined){sync=true;}
delete this.cache[id];this.save(this.get());if(sync){this.syncState();}},get:function(){return this.cache;},save:function(object){this.cache=object;}};function checkUncheckProxy(e){$.priceTag.checkUncheck(e);}
function checkUncheckGoodsProxy(e){$.goods2PriceTag.checkUncheck(e);}
function clearAllProxy(e){$.priceTag.clearAll();}
function selectAllProxy(e){$.priceTag.selectAll(true);}
function removePriceTag(e){var selected=$.priceTag.get();var custom_event=$(this).data('price-tag-event');if(!selected||!Object.keys(selected).length){return;}
if(custom_event){custom_event();}else{swal({title:"      ?",type:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:", !",cancelButtonText:"",showLoaderOnConfirm:true,closeOnConfirm:false},function(){$.ajax({type:'POST',url:'/price_tag/remove',dataType:'json',data:{price_tags:JSON.stringify(selected)},success:function(data){if(data.status){$.priceTag.clearAll();location.reload();}else{swal(' :',data.message,'error');}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});});}}
function showPriceTagForm(){var custom_event=$(this).data('good-event');var good_id=$(this).data('good-id');if(custom_event){custom_event();}else{$.ajax({type:'GET',url:'/price_tag/add/'+good_id,dataType:'json',data:{},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function showGoodSpecificationsForm(){var custom_event=$(this).data('good-event');var good_id=$(this).data('good-id');if(custom_event){custom_event();}else{$.ajax({type:'GET',url:'/price_tag/edit/'+good_id,dataType:'json',data:{},success:function(data){$.fancybox(data,{onComplete:function(){var this_wrap=$('#fancybox-content .form_gen_wrapper');genFormInit(this_wrap);}});},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function printSelectedPriceTag(){var custom_event=$(this).data('print-event');var selected_array=getObjectValues($.priceTag.get());if(custom_event){custom_event();}else{if(selected_array.length>0){$.priceTag.clearScope(function(){location.href='/blanks/?price_tag='+selected_array.join(',');});}else{alert('     ');}}}
function printPriceTag(){var custom_event=$(this).data('good-event');if(custom_event){custom_event();}else{$.ajax({type:'POST',url:'/price_tag/print',dataType:'json',data:$('#fancybox-content .good-info .form_gen_wrapper form').serialize(),success:function(data){if(data.status){if(data.need_redirect){location.href=data.redirect_path;}else{$.fancybox.close();}}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function postponePriceTag(){var custom_event=$(this).data('good-event');if(custom_event){custom_event();}else{$.ajax({type:'POST',url:'/price_tag/postpone',dataType:'json',data:$('#fancybox-content .good-info .form_gen_wrapper form').serialize(),success:function(data){if(data.status){$.priceTag.add(data.id);$.fancybox(data.html);}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function postponePriceTagsBatch(){var custom_event=$(this).data('good-event');var selected_array=Object.keys($.goods2PriceTag.get());if(custom_event){custom_event();}else{$.ajax({type:'POST',url:'/price_tag/postpone/batch',dataType:'json',data:{goods_id:selected_array.join(',')},success:function(data){if(data.status){var ids=data.new_ids.split(',');$.priceTag.addBatch(ids,false,function(){$.fancybox.close();location.reload();});}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function addGoodToPriceTags(e,url_params){var custom_event=$(this).data('good-event');url_params=url_params||'';if(custom_event){custom_event();}else{$.ajax({type:'GET',url:'/ajax/goods_list_price_tag.php'+url_params,dataType:'json',data:{},success:function(data){if(data.status){$.fancybox(data.html,{onComplete:function(){MainTableInit();$.goods2PriceTag.syncState();$('.goods-price-tags-table .task_table_select select.items_on_page').die('change').live('change',tableNavigationProxyItemsOnPage);$('.goods-price-tags-table .MainTable .check_id').on('checked',function(){$.goods2PriceTag.add($(this).val());});$('.goods-price-tags-table .MainTable .check_id').on('unchecked',function(){$.goods2PriceTag.remove($(this).val());});}});}else{alert(data.message);}},error:function(xhr,str){console.log(' : '+xhr.responseCode+';  : '+str);}});}}
function tableNavigationProxy(e){e.preventDefault();e.stopImmediatePropagation();var href=$(this).attr('href');addGoodToPriceTags(e,href);}
function tableNavigationProxyNavSelect(e){var href=$(this).children('option:selected').data('url');addGoodToPriceTags(e,href);}
function tableNavigationProxyItemsOnPage(e){var href=$(this).children('option:selected').data('uri');addGoodToPriceTags(e,href);};
/*! jQuery UI - v1.11.4+CommonJS - 2015-08-28
* http://jqueryui.com
* Includes: widget.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else if(typeof exports==="object"){factory(require("jquery"));}else{factory(jQuery);}}(function($){
/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=(function(orig){return function(elems){var events,elem,i;for(i=0;(elem=elems[i])!=null;i++){try{events=$._data(elem,"events");if(events&&events.remove){$(elem).triggerHandler("remove");}}catch(e){}}
orig(elems);};})($.cleanData);$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?(basePrototype.widgetEventPrefix||name):name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);return constructor;};$.widget.extend=function(target){var input=widget_slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=widget_slice.call(arguments,1),returnValue=this;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(options==="instance"){returnValue=instance;return false;}
if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{if(args.length){options=$.widget.extend.apply(null,[options].concat(args));}
this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});if(instance._init){instance._init();}}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widget_uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(arguments.length===1){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled",!!value);if(value){this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}}
return this;},enable:function(){return this._setOptions({disabled:false});},disable:function(){return this._setOptions({disabled:true});},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+
this.eventNamespace;element.unbind(eventName).undelegate(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get());},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});var widget=$.widget;}));;;(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){factory(require('jquery'));}else{factory(window.jQuery);}}(function($){'use strict';var counter=0;$.ajaxTransport('iframe',function(options){if(options.async){var initialIframeSrc=options.initialIframeSrc||'javascript:false;',form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style="display:none;"></form>');form.attr('accept-charset',options.formAcceptCharset);addParamChar=/\?/.test(options.url)?'&':'?';if(options.type==='DELETE'){options.url=options.url+addParamChar+'_method=DELETE';options.type='POST';}else if(options.type==='PUT'){options.url=options.url+addParamChar+'_method=PUT';options.type='POST';}else if(options.type==='PATCH'){options.url=options.url+addParamChar+'_method=PATCH';options.type='POST';}
counter+=1;iframe=$('<iframe src="'+initialIframeSrc+'" name="iframe-transport-'+counter+'"></iframe>').bind('load',function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind('load').bind('load',function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error();}}catch(e){response=undefined;}
completeCallback(200,'success',{'iframe':response});$('<iframe src="'+initialIframeSrc+'"></iframe>').appendTo(form);window.setTimeout(function(){form.remove();},0);});form.prop('target',iframe.prop('name')).prop('action',options.url).prop('method',options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type="hidden"/>').prop('name',field.name).val(field.value).appendTo(form);});}
if(options.fileInput&&options.fileInput.length&&options.type==='POST'){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index];});if(options.paramName){options.fileInput.each(function(index){$(this).prop('name',paramNames[index]||options.paramName);});}
form.append(options.fileInput).prop('enctype','multipart/form-data').prop('encoding','multipart/form-data');options.fileInput.removeAttr('form');}
form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop('name',clone.prop('name')).attr('form',clone.attr('form'));clone.replaceWith(input);});}});form.append(iframe).appendTo(document.body);},abort:function(){if(iframe){iframe.unbind('load').prop('src',initialIframeSrc);}
if(form){form.remove();}}};}});$.ajaxSetup({converters:{'iframe text':function(iframe){return iframe&&$(iframe[0].body).text();},'iframe json':function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text());},'iframe html':function(iframe){return iframe&&$(iframe[0].body).html();},'iframe xml':function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML((xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml)||$(xmlDoc.body).html());},'iframe script':function(iframe){return iframe&&$.globalEval($(iframe[0].body).text());}}});}));;function goodEstimatePrice(name,wrp){$.ajax({type:'POST',url:'/estimate/get/',dataType:'json',cache:false,data:{name:name},success:function(data){if(data.status){if(data.estimate>0){var current_city_url='';var output='   '+data.name+' - '+data.estimate+' '+data.currency_short;if(data.estimate_by_city){current_city_url='&filter_same_city=on';output+='<br>   '+data.name+'  . '+data.city_name+' - '+data.estimate_by_city+' '+data.currency_short;}
output+='<br><a href="/estimate/?name='+name+current_city_url+'" target="_blank"></a>';$(wrp).html(output);}else{$(wrp).html('       .');}}else{alert(data.message);}},error:function(xhr,str){alert(' : '+xhr.responseCode+';  : '+str);}});}
var timer;$(document).ready(function(){$('.form_gen_wrapper .estimate-name-input').live('input estimate-price',function(){var estimate_wrp='.form_gen_wrapper .estimate-price-wrp',name=$(this).val();clearTimeout(timer);timer=setTimeout(function(){goodEstimatePrice(name,estimate_wrp);},2000);});});;function saveSettingTestOperation(value){$.ajax({type:"POST",dataType:"json",data:{"value":value},url:"/account/settings/savetestoperation",success:function(result){console.log(result);}});}
function setTestOperations(container){var isTestOperaton=null;var $container=$(container).parent().find('input');var undefinedVar=$container.attr("checked");if(typeof undefinedVar=="undefined"){isTestOperaton=0;$("#test_operation_default").removeAttr("checked");$("#test_operation").removeAttr("checked");}else{isTestOperaton=1;$("#test_operation_default").attr("checked","checked");$("#test_operation").attr("checked","checked");}
saveSettingTestOperation(isTestOperaton);$(container).hide();}
$(document).ready(function(){$('.test_operation').live('change',function(){var this_checked=$(this).is(':checked');var $that=$('.set_default_test_operation');$.ajax({type:"GET",dataType:"json",url:"/account/settings/defaulttestoperation",success:function(result){if(result!='error'){var test_operation=!!result;if(this_checked!==test_operation){$that.show();}else{$that.hide();}}}});});});;